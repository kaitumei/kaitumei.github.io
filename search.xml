<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Hexoåšå®¢è¿›é˜¶ï¼šè‡ªåŠ¨åŒ–éƒ¨ç½²ä¸é‡‡å‘å®å½•</title>
      <link href="/2026/02/07/hexo-deployment-troubleshooting/"/>
      <url>/2026/02/07/hexo-deployment-troubleshooting/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨æ­å»ºå’Œç»´æŠ¤ Hexo åšå®¢çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°å„ç§å„æ ·çš„é—®é¢˜ã€‚æœ¬æ–‡è®°å½•äº†æˆ‘åœ¨è¿‘æœŸç»´æŠ¤åšå®¢æ—¶é‡åˆ°çš„ä¸‰ä¸ªä¸»è¦æŒ‘æˆ˜åŠå…¶è§£å†³æ–¹æ¡ˆï¼š</p><ol><li><strong>åŒä»“åº“è‡ªåŠ¨åŒ–éƒ¨ç½²</strong>ï¼šæºç ä¸é¡µé¢åˆ†ç¦»ï¼Œå¦‚ä½•é…ç½® GitHub Actionsï¼Ÿ</li><li><strong>è‡ªå®šä¹‰åŸŸåæŒä¹…åŒ–</strong>ï¼šæ¯æ¬¡éƒ¨ç½²å GitHub Pages çš„åŸŸåè®¾ç½®éƒ½ä¼šè¢«é‡ç½®ã€‚</li><li><strong>Butterfly ä¸»é¢˜å®šåˆ¶</strong>ï¼šå¦‚ä½•ä¿®å¤æ¬¢è¿å¡ç‰‡å¹¶å°†å…¶é™åˆ¶åœ¨é¦–é¡µæ˜¾ç¤ºã€‚</li></ol><hr><h1 id="ä¸€ã€GitHub-Actions-åŒä»“åº“è‡ªåŠ¨åŒ–éƒ¨ç½²"><a href="#ä¸€ã€GitHub-Actions-åŒä»“åº“è‡ªåŠ¨åŒ–éƒ¨ç½²" class="headerlink" title="ä¸€ã€GitHub Actions åŒä»“åº“è‡ªåŠ¨åŒ–éƒ¨ç½²"></a>ä¸€ã€GitHub Actions åŒä»“åº“è‡ªåŠ¨åŒ–éƒ¨ç½²</h1><p>ä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œæˆ‘é‡‡ç”¨äº†<strong>æºç ä¸éƒ¨ç½²åˆ†ç¦»</strong>çš„æ¶æ„ï¼š</p><ul><li>**æºç ä»“åº“ (Source)**ï¼š<code>Hexo-Blog</code> (ç§æœ‰æˆ–å…¬å¼€ï¼Œå­˜æ”¾ Hexo åŸå§‹æ–‡ä»¶)</li><li>**éƒ¨ç½²ä»“åº“ (Pages)**ï¼š<code>kaitumei.github.io</code> (å…¬å¼€ï¼Œå­˜æ”¾ç”Ÿæˆçš„é™æ€ç½‘é¡µ)</li></ul><h2 id="1-é‡åˆ°çš„é—®é¢˜"><a href="#1-é‡åˆ°çš„é—®é¢˜" class="headerlink" title="1. é‡åˆ°çš„é—®é¢˜"></a>1. é‡åˆ°çš„é—®é¢˜</h2><p>åœ¨ä½¿ç”¨ GitHub Actions è¿›è¡Œè‡ªåŠ¨éƒ¨ç½²æ—¶ï¼Œé»˜è®¤çš„ <code>GITHUB_TOKEN</code> åªæœ‰å½“å‰ä»“åº“çš„æƒé™ã€‚å½“è„šæœ¬å°è¯•å°†ç”Ÿæˆçš„ <code>public</code> ç›®å½•æ¨é€åˆ°å¦ä¸€ä¸ªä»“åº“ï¼ˆ<code>kaitumei.github.io</code>ï¼‰æ—¶ï¼Œä¼šæŠ¥é”™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">remote: Permission to kaitumei/kaitumei.github.io.git denied to github-actions[bot].</span><br><span class="line">fatal: unable to access ...: The requested URL returned error: 403</span><br></pre></td></tr></table></figure><h2 id="2-è§£å†³æ–¹æ¡ˆ"><a href="#2-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="2. è§£å†³æ–¹æ¡ˆ"></a>2. è§£å†³æ–¹æ¡ˆ</h2><p>æˆ‘ä»¬éœ€è¦ä½¿ç”¨ <strong>Personal Access Token (PAT)</strong> æ¥æ›¿ä»£é»˜è®¤çš„ Tokenã€‚</p><h3 id="ç¬¬ä¸€æ­¥ï¼šç”Ÿæˆ-Token"><a href="#ç¬¬ä¸€æ­¥ï¼šç”Ÿæˆ-Token" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šç”Ÿæˆ Token"></a>ç¬¬ä¸€æ­¥ï¼šç”Ÿæˆ Token</h3><ol><li>å‰å¾€ <a href="https://github.com/settings/tokens">GitHub Settings &gt; Developer settings &gt; Personal access tokens</a>ã€‚</li><li>ç”Ÿæˆä¸€ä¸ªæ–°çš„ Token (Classic)ï¼Œå‹¾é€‰ <code>repo</code> å’Œ <code>workflow</code> æƒé™ã€‚</li><li>å¤åˆ¶ç”Ÿæˆçš„ Tokenã€‚</li></ol><h3 id="ç¬¬äºŒæ­¥ï¼šé…ç½®-Secrets"><a href="#ç¬¬äºŒæ­¥ï¼šé…ç½®-Secrets" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šé…ç½® Secrets"></a>ç¬¬äºŒæ­¥ï¼šé…ç½® Secrets</h3><ol><li>åœ¨æºç ä»“åº“ (<code>Hexo-Blog</code>) çš„ <code>Settings &gt; Secrets and variables &gt; Actions</code> ä¸­ã€‚</li><li>æ–°å»ºä¸€ä¸ª Repository secretï¼Œå‘½åä¸º <code>GH_PAT</code>ï¼Œå€¼ä¸ºåˆšæ‰å¤åˆ¶çš„ Tokenã€‚</li></ol><h3 id="ç¬¬ä¸‰æ­¥ï¼šä¼˜åŒ–-Workflow-é…ç½®"><a href="#ç¬¬ä¸‰æ­¥ï¼šä¼˜åŒ–-Workflow-é…ç½®" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šä¼˜åŒ– Workflow é…ç½®"></a>ç¬¬ä¸‰æ­¥ï¼šä¼˜åŒ– Workflow é…ç½®</h3><p>ä¿®æ”¹ <code>.github/workflows/autodeploy.yml</code>ï¼Œä½¿ç”¨ <code>peaceiris/actions-gh-pages</code> æ’ä»¶ï¼Œå¹¶æŒ‡å®š <code>personal_token</code> å’Œ <code>external_repository</code>ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">deploy:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="comment"># ... çœç•¥å®‰è£… Node å’Œ Hexo çš„æ­¥éª¤ ...</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">éƒ¨ç½²</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">peaceiris/actions-gh-pages@v4</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="comment"># å…³é”®ç‚¹ 1ï¼šä½¿ç”¨ PAT è€Œä¸æ˜¯ GITHUB_TOKEN</span></span><br><span class="line">          <span class="attr">personal_token:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GH_PAT</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="comment"># å…³é”®ç‚¹ 2ï¼šæŒ‡å®šç”Ÿæˆçš„é™æ€æ–‡ä»¶ç›®å½•</span></span><br><span class="line">          <span class="attr">publish_dir:</span> <span class="string">./public</span></span><br><span class="line">          <span class="comment"># å…³é”®ç‚¹ 3ï¼šæŒ‡å®šç›®æ ‡ä»“åº“</span></span><br><span class="line">          <span class="attr">external_repository:</span> <span class="string">kaitumei/kaitumei.github.io</span></span><br><span class="line">          <span class="comment"># å…³é”®ç‚¹ 4ï¼šæŒ‡å®šç›®æ ‡åˆ†æ”¯ (é€šå¸¸æ˜¯ main æˆ– master)</span></span><br><span class="line">          <span class="attr">publish_branch:</span> <span class="string">main</span></span><br><span class="line">          <span class="attr">commit_message:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.event.head_commit.message</span> <span class="string">&#125;&#125;</span></span><br></pre></td></tr></table></figure><hr><h1 id="äºŒã€è§£å†³è‡ªå®šä¹‰åŸŸåé¢‘ç¹é‡ç½®"><a href="#äºŒã€è§£å†³è‡ªå®šä¹‰åŸŸåé¢‘ç¹é‡ç½®" class="headerlink" title="äºŒã€è§£å†³è‡ªå®šä¹‰åŸŸåé¢‘ç¹é‡ç½®"></a>äºŒã€è§£å†³è‡ªå®šä¹‰åŸŸåé¢‘ç¹é‡ç½®</h1><h2 id="1-ç°è±¡"><a href="#1-ç°è±¡" class="headerlink" title="1. ç°è±¡"></a>1. ç°è±¡</h2><p>æ¯æ¬¡ GitHub Actions è¿è¡Œå®Œæˆåï¼Œè®¿é—®åšå®¢åŸŸåï¼ˆå¦‚ <code>kaitumei.2345.plus</code>ï¼‰ä¼šå¤±æ•ˆï¼ŒGitHub Pages çš„è®¾ç½®é‡Œ â€œCustom domainâ€ å˜ä¸ºç©ºç™½ã€‚</p><h2 id="2-åŸå› "><a href="#2-åŸå› " class="headerlink" title="2. åŸå› "></a>2. åŸå› </h2><p>Hexo æ¯æ¬¡ <code>hexo generate</code> æ—¶ä¼šæ¸…ç©ºå¹¶é‡æ–°ç”Ÿæˆ <code>public</code> ç›®å½•ã€‚å¦‚æœ <code>source</code> ç›®å½•ä¸‹æ²¡æœ‰ <code>CNAME</code> æ–‡ä»¶ï¼Œç”Ÿæˆçš„ <code>public</code> ç›®å½•é‡Œä¹Ÿå°±æ²¡æœ‰ã€‚GitHub åœ¨éƒ¨ç½²æ—¶æ£€æµ‹åˆ°æ²¡æœ‰ CNAME æ–‡ä»¶ï¼Œå°±ä¼šé‡ç½®åŸŸåè®¾ç½®ã€‚</p><h2 id="3-è§£å†³æ–¹æ¡ˆ"><a href="#3-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="3. è§£å†³æ–¹æ¡ˆ"></a>3. è§£å†³æ–¹æ¡ˆ</h2><p>åœ¨ <code>source</code> ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º <code>CNAME</code> çš„æ–‡ä»¶ï¼ˆæ— åç¼€ï¼‰ï¼Œå†…å®¹ä¸ºä½ çš„åŸŸåï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kaitumei.2345.plus</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼ŒHexo ç”Ÿæˆé™æ€èµ„æºæ—¶ä¼šè‡ªåŠ¨å°† <code>CNAME</code> å¤åˆ¶åˆ° <code>public</code> æ ¹ç›®å½•ï¼ŒGitHub Pages å°±èƒ½è¯†åˆ«å¹¶ä¿æŒåŸŸåç»‘å®šäº†ã€‚</p><hr><h1 id="ä¸‰ã€Butterfly-ä¸»é¢˜æ¬¢è¿å¡ç‰‡ä¼˜åŒ–"><a href="#ä¸‰ã€Butterfly-ä¸»é¢˜æ¬¢è¿å¡ç‰‡ä¼˜åŒ–" class="headerlink" title="ä¸‰ã€Butterfly ä¸»é¢˜æ¬¢è¿å¡ç‰‡ä¼˜åŒ–"></a>ä¸‰ã€Butterfly ä¸»é¢˜æ¬¢è¿å¡ç‰‡ä¼˜åŒ–</h1><h2 id="1-ä¿®å¤-â€œNetwork-Errorâ€"><a href="#1-ä¿®å¤-â€œNetwork-Errorâ€" class="headerlink" title="1. ä¿®å¤ â€œNetwork Errorâ€"></a>1. ä¿®å¤ â€œNetwork Errorâ€</h2><p>å¦‚æœæ¬¢è¿å¡ç‰‡æ˜¾ç¤º â€œNetwork Errorâ€ï¼Œé€šå¸¸æ˜¯å› ä¸ºè·å– IP çš„ API è¯·æ±‚å¤±è´¥ï¼Œæˆ–è€… JS è„šæœ¬æœªæ­£ç¡®åŠ è½½ã€‚<br>ç¡®ä¿ <code>_config.butterfly.yml</code> ä¸­æ³¨å…¥äº†è„šæœ¬ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">src=&quot;/js/card-welcome.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-ä»…åœ¨é¦–é¡µæ˜¾ç¤º"><a href="#2-ä»…åœ¨é¦–é¡µæ˜¾ç¤º" class="headerlink" title="2. ä»…åœ¨é¦–é¡µæ˜¾ç¤º"></a>2. ä»…åœ¨é¦–é¡µæ˜¾ç¤º</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒWidget ç»„ä»¶å¯èƒ½ä¼šåœ¨æ‰€æœ‰é¡µé¢æ˜¾ç¤ºã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›æ¬¢è¿å¡ç‰‡<strong>åªåœ¨é¦–é¡µ</strong>å‡ºç°ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹ Pug æ¨¡æ¿å®ç°ã€‚</p><p><strong>ä¿®æ”¹æ–‡ä»¶</strong>ï¼š<code>themes/butterfly/layout/includes/widget/index.pug</code></p><p><strong>ä¿®æ”¹å‰</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!=partial(&#x27;includes/widget/card_welcome&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br></pre></td></tr></table></figure><p><strong>ä¿®æ”¹å</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if is_home()</span><br><span class="line">  !=partial(&#x27;includes/widget/card_welcome&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br></pre></td></tr></table></figure><p>å°†åˆ¤æ–­é€»è¾‘æ”¾åœ¨çˆ¶å®¹å™¨ä¸­ï¼Œå¯ä»¥é¿å…ç»„ä»¶å†…éƒ¨é€»è¾‘å¯¼è‡´çš„å¸ƒå±€é”™ä¹±é—®é¢˜ã€‚</p><hr><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æŠ˜è…¾åšå®¢çš„è¿‡ç¨‹å°±æ˜¯ä¸æ–­è¸©å‘å’Œå¡«å‘çš„è¿‡ç¨‹ã€‚é€šè¿‡é…ç½® GitHub Actions å’Œ PATï¼Œæˆ‘ä»¬å®ç°äº†ä¼˜é›…çš„è·¨ä»“åº“è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼›é€šè¿‡ç®€å•çš„ <code>CNAME</code> æ–‡ä»¶ï¼Œè§£å†³äº†åŸŸåé‡ç½®çš„çƒ¦æ¼ï¼›é€šè¿‡å¯¹ Pug æ¨¡æ¿çš„å¾®è°ƒï¼Œè®©ä¸»é¢˜å±•ç°æ›´åŠ ç¬¦åˆå¿ƒæ„ã€‚</p><p>å¸Œæœ›è¿™ç¯‡è®°å½•èƒ½å¸®åŠ©åˆ°é‡åˆ°åŒæ ·é—®é¢˜çš„ä½ ï¼</p>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Butterfly </tag>
            
            <tag> CI/CD </tag>
            
            <tag> GitHub Actions </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo Butterfly ä¸»é¢˜ç¾åŒ–ï¼šè‡ªå®šä¹‰å¤åˆ¶æç¤ºä¸å¢å¼ºå…¼å®¹æ€§</title>
      <link href="/2026/02/07/hexo-butterfly-copy-optimization/"/>
      <url>/2026/02/07/hexo-butterfly-copy-optimization/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ä½¿ç”¨ Hexo Butterfly ä¸»é¢˜æ—¶ï¼Œé»˜è®¤çš„å¤åˆ¶æç¤ºæ¯”è¾ƒå•è°ƒã€‚æœ¬æ–‡è®°å½•äº†å¦‚ä½•å°†å¤åˆ¶æç¤ºä¿®æ”¹ä¸º â€œğŸ˜Š å¤åˆ¶æˆåŠŸï¼è½¬è½½è¯·æ³¨æ˜å‡ºå¤„å“¦~â€ï¼Œå¹¶è§£å†³ä»£ç å—å¤åˆ¶æ—¶çš„å…¼å®¹æ€§é—®é¢˜ï¼Œä»¥åŠç»Ÿä¸€æ™®é€šæ–‡æœ¬å¤åˆ¶æ—¶çš„æç¤ºæ•ˆæœã€‚</p><h2 id="1-ä¿®æ”¹æç¤ºæ–‡æ¡ˆ"><a href="#1-ä¿®æ”¹æç¤ºæ–‡æ¡ˆ" class="headerlink" title="1. ä¿®æ”¹æç¤ºæ–‡æ¡ˆ"></a>1. ä¿®æ”¹æç¤ºæ–‡æ¡ˆ</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸»é¢˜çš„è¯­è¨€æ–‡ä»¶ï¼Œå°†é»˜è®¤çš„ â€œå¤åˆ¶æˆåŠŸâ€ ä¿®æ”¹ä¸ºæˆ‘ä»¬å–œæ¬¢çš„æ–‡æ¡ˆã€‚</p><p>ç¼–è¾‘æ–‡ä»¶ï¼š<code>themes/butterfly/languages/zh-CN.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">copy:</span></span><br><span class="line">  <span class="attr">success:</span> <span class="string">ğŸ˜Š</span> <span class="string">å¤åˆ¶æˆåŠŸï¼è½¬è½½è¯·æ³¨æ˜å‡ºå¤„å“¦~</span>  <span class="comment"># ä¿®æ”¹è¿™é‡Œ</span></span><br><span class="line">  <span class="attr">error:</span> <span class="string">å¤åˆ¶å¤±è´¥</span></span><br><span class="line">  <span class="attr">noSupport:</span> <span class="string">æµè§ˆå™¨ä¸æ”¯æŒ</span></span><br></pre></td></tr></table></figure><h2 id="2-å¢å¼º-JS-é€»è¾‘-themes-butterfly-source-js-main-js"><a href="#2-å¢å¼º-JS-é€»è¾‘-themes-butterfly-source-js-main-js" class="headerlink" title="2. å¢å¼º JS é€»è¾‘ (themes&#x2F;butterfly&#x2F;source&#x2F;js&#x2F;main.js)"></a>2. å¢å¼º JS é€»è¾‘ (themes&#x2F;butterfly&#x2F;source&#x2F;js&#x2F;main.js)</h2><p>ä¸ºäº†å®ç°æ›´å¥½çš„ä½“éªŒï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ <code>main.js</code> æ–‡ä»¶ã€‚ä¸»è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li><strong>å…¼å®¹æ€§</strong>ï¼šéƒ¨åˆ†æµè§ˆå™¨ä¸æ”¯æŒæ–°çš„ Clipboard APIï¼Œéœ€è¦å›é€€æ–¹æ¡ˆã€‚</li><li><strong>ç»Ÿä¸€ä½“éªŒ</strong>ï¼šè®©æ™®é€šæ–‡æœ¬å¤åˆ¶ï¼ˆCtrl+Cï¼‰ä¹Ÿèƒ½å¼¹å‡ºæ¼‚äº®çš„æç¤ºã€‚</li><li><strong>ä¿®å¤Bug</strong>ï¼šé˜²æ­¢ä»£ç å—å¤åˆ¶æ—¶åŒæ—¶è§¦å‘ä¸¤æ¬¡æç¤ºï¼ˆä¸€æ¬¡ä»£ç å—é€»è¾‘ï¼Œä¸€æ¬¡å…¨å±€ç›‘å¬ï¼‰ã€‚</li></ol><h3 id="ä¿®æ”¹ä»£ç å—å¤åˆ¶é€»è¾‘-copy-å‡½æ•°"><a href="#ä¿®æ”¹ä»£ç å—å¤åˆ¶é€»è¾‘-copy-å‡½æ•°" class="headerlink" title="ä¿®æ”¹ä»£ç å—å¤åˆ¶é€»è¾‘ (copy å‡½æ•°)"></a>ä¿®æ”¹ä»£ç å—å¤åˆ¶é€»è¾‘ (<code>copy</code> å‡½æ•°)</h3><p>æ‰¾åˆ° <code>const copy = async (text, ctx) =&gt; &#123;</code>ï¼Œå°†å…¶æ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">copy</span> = <span class="keyword">async</span> (<span class="params">text, ctx</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// è®¾ç½®æ ‡å¿—ä½ï¼Œé˜²æ­¢è§¦å‘å…¨å±€çš„ copy äº‹ä»¶ç›‘å¬ï¼Œé¿å…åŒé‡æç¤º</span></span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">isCodeCopy</span> = <span class="literal">true</span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// ä¼˜å…ˆä½¿ç”¨ç°ä»£ Clipboard API</span></span><br><span class="line">    <span class="keyword">if</span> (navigator.<span class="property">clipboard</span> &amp;&amp; navigator.<span class="property">clipboard</span>.<span class="property">writeText</span>) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">await</span> navigator.<span class="property">clipboard</span>.<span class="title function_">writeText</span>(text)</span><br><span class="line">        <span class="title function_">alertInfo</span>(ctx, <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">copy</span>.<span class="property">success</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Failed to copy via clipboard API: &#x27;</span>, err)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å…¼å®¹æ€§å›é€€æ–¹æ¡ˆï¼šåˆ›å»ºä¸€ä¸ªéšè—çš„ textarea è¿›è¡Œå¤åˆ¶</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> textArea = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;textarea&#x27;</span>)</span><br><span class="line">      textArea.<span class="property">value</span> = text</span><br><span class="line">      <span class="comment">// ç¡®ä¿ textarea ä¸å¯è§ä½†å­˜åœ¨äº DOM ä¸­</span></span><br><span class="line">      textArea.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&#x27;fixed&#x27;</span></span><br><span class="line">      textArea.<span class="property">style</span>.<span class="property">left</span> = <span class="string">&#x27;-9999px&#x27;</span></span><br><span class="line">      textArea.<span class="property">style</span>.<span class="property">top</span> = <span class="string">&#x27;0&#x27;</span></span><br><span class="line">      <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(textArea)</span><br><span class="line">      textArea.<span class="title function_">focus</span>()</span><br><span class="line">      textArea.<span class="title function_">select</span>()</span><br><span class="line">      <span class="keyword">const</span> successful = <span class="variable language_">document</span>.<span class="title function_">execCommand</span>(<span class="string">&#x27;copy&#x27;</span>)</span><br><span class="line">      <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(textArea)</span><br><span class="line">      <span class="keyword">if</span> (successful) &#123;</span><br><span class="line">        <span class="title function_">alertInfo</span>(ctx, <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">copy</span>.<span class="property">success</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">alertInfo</span>(ctx, <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">copy</span>.<span class="property">noSupport</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Fallback copy failed: &#x27;</span>, err)</span><br><span class="line">      <span class="title function_">alertInfo</span>(ctx, <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">copy</span>.<span class="property">noSupport</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="comment">// æ¢å¤æ ‡å¿—ä½</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">isCodeCopy</span> = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹å…¨å±€å¤åˆ¶ç›‘å¬-addCopyright-å‡½æ•°"><a href="#ä¿®æ”¹å…¨å±€å¤åˆ¶ç›‘å¬-addCopyright-å‡½æ•°" class="headerlink" title="ä¿®æ”¹å…¨å±€å¤åˆ¶ç›‘å¬ (addCopyright å‡½æ•°)"></a>ä¿®æ”¹å…¨å±€å¤åˆ¶ç›‘å¬ (<code>addCopyright</code> å‡½æ•°)</h3><p>æ‰¾åˆ° <code>const addCopyright = () =&gt; &#123;</code>ï¼Œæ›´æ–° <code>handleCopy</code> é€»è¾‘ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">addCopyright</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; limitCount, languages &#125; = <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">copyright</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleCopy</span> = e =&gt; &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯ä»£ç å—å¤åˆ¶å¼•èµ·çš„ copy äº‹ä»¶ï¼Œç›´æ¥è¿”å›ï¼Œä¸å¤„ç†</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">isCodeCopy</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    e.<span class="title function_">preventDefault</span>()</span><br><span class="line">    <span class="keyword">const</span> copyFont = <span class="variable language_">window</span>.<span class="title function_">getSelection</span>(<span class="number">0</span>).<span class="title function_">toString</span>()</span><br><span class="line">    <span class="keyword">let</span> textFont = copyFont</span><br><span class="line">    <span class="keyword">if</span> (copyFont.<span class="property">length</span> &gt; limitCount) &#123;</span><br><span class="line">      textFont = <span class="string">`<span class="subst">$&#123;copyFont&#125;</span>\n\n\n<span class="subst">$&#123;languages.author&#125;</span>\n<span class="subst">$&#123;languages.link&#125;</span><span class="subst">$&#123;<span class="variable language_">window</span>.location.href&#125;</span>\n<span class="subst">$&#123;languages.source&#125;</span>\n<span class="subst">$&#123;languages.info&#125;</span>`</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (e.<span class="property">clipboardData</span>) &#123;</span><br><span class="line">      e.<span class="property">clipboardData</span>.<span class="title function_">setData</span>(<span class="string">&#x27;text&#x27;</span>, textFont)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">window</span>.<span class="property">clipboardData</span>.<span class="title function_">setData</span>(<span class="string">&#x27;text&#x27;</span>, textFont)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ˜¾ç¤ºå¤åˆ¶æˆåŠŸçš„æç¤º (ä½¿ç”¨ Butterfly å†…ç½®çš„ Snackbar æˆ– fallback)</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">Snackbar</span> !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">      btf.<span class="title function_">snackbarShow</span>(<span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">copy</span>.<span class="property">success</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// å¦‚æœæ²¡æœ‰å¼€å¯ Snackbarï¼Œæ‰‹åŠ¨åˆ›å»ºä¸€ä¸ª toast</span></span><br><span class="line">      <span class="keyword">const</span> newEle = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">      newEle.<span class="property">className</span> = <span class="string">&#x27;copy-notice&#x27;</span></span><br><span class="line">      newEle.<span class="property">textContent</span> = <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">copy</span>.<span class="property">success</span></span><br><span class="line">      newEle.<span class="property">style</span>.<span class="property">cssText</span> = <span class="string">&#x27;position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 9999; background: #49b1f5; color: #fff; padding: 10px 20px; border-radius: 4px;&#x27;</span></span><br><span class="line">      <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(newEle)</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        newEle.<span class="title function_">remove</span>()</span><br><span class="line">      &#125;, <span class="number">2000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;copy&#x27;</span>, handleCopy)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-æ€»ç»“"><a href="#3-æ€»ç»“" class="headerlink" title="3. æ€»ç»“"></a>3. æ€»ç»“</h2><p>é€šè¿‡ä»¥ä¸Šä¿®æ”¹ï¼Œæˆ‘ä»¬å®ç°äº†ï¼š</p><ol><li>è‡ªå®šä¹‰äº†å¤åˆ¶æˆåŠŸçš„æç¤ºæ–‡æ¡ˆã€‚</li><li>åœ¨ä»»æ„ä½ç½®å¤åˆ¶æ–‡æœ¬éƒ½ä¼šå¼¹å‡ºæç¤ºã€‚</li><li>è§£å†³äº†ä»£ç å—å¤åˆ¶æ—¶çš„å…¼å®¹æ€§é—®é¢˜ã€‚</li><li>å®Œç¾è§£å†³äº†ä»£ç å—å¤åˆ¶æ—¶æç¤ºå‡ºç°ä¸¤æ¬¡çš„ Bugã€‚</li></ol><p>å¿«å»è¯•è¯•å§ï¼</p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Butterfly </tag>
            
            <tag> ç¾åŒ– </tag>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸»é¢˜ Butterfly 5.5.4 é­”æ”¹æ•™ç¨‹</title>
      <link href="/2026/02/05/hexo%E9%AD%94%E6%94%B9%E7%AF%87/"/>
      <url>/2026/02/05/hexo%E9%AD%94%E6%94%B9%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<h1 id="åŠ è½½åŠ¨ç”»"><a href="#åŠ è½½åŠ¨ç”»" class="headerlink" title="åŠ è½½åŠ¨ç”»"></a>åŠ è½½åŠ¨ç”»</h1><p>ä»¥ä¸‹é…ç½®æ— éœ€æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶ã€‚</p><details class="folding-tag" cyan close><summary> å…·ä½“æ­¥éª¤ </summary>              <div class='content'>              <p>æ·»åŠ <code>[BlogRoot]\source\csscustom-loader.css</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* è‡ªå®šä¹‰åŠ è½½åŠ¨ç”»æ ·å¼ */</span></span><br><span class="line"><span class="selector-class">.custom-loader-container</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.85</span>); <span class="comment">/* åŠé€æ˜èƒŒæ™¯ */</span></span><br><span class="line">  <span class="attribute">backdrop-filter</span>: <span class="built_in">blur</span>(<span class="number">20px</span>); <span class="comment">/* æ¯›ç»ç’ƒæ¨¡ç³Šæ•ˆæœ */</span></span><br><span class="line">  -webkit-<span class="attribute">backdrop-filter</span>: <span class="built_in">blur</span>(<span class="number">20px</span>);</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">9999</span>;</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">0.6s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.7</span>, <span class="number">0</span>, <span class="number">0.3</span>, <span class="number">1</span>), opacity <span class="number">0.6s</span> ease-out; <span class="comment">/* å¹•å¸ƒæ‹‰èµ·åŠ¨ç”» */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.custom-loader-container</span><span class="selector-class">.dark</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">13</span>, <span class="number">13</span>, <span class="number">13</span>, <span class="number">0.85</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.custom-loader-container</span><span class="selector-class">.fade-out</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">100%</span>); <span class="comment">/* å‘ä¸Šæ‹‰èµ·å¹•å¸ƒ */</span></span><br><span class="line">  <span class="comment">/* opacity: 0; å¦‚æœæƒ³è¦æ·¡å‡ºè€Œä¸æ˜¯æ‹‰èµ·ï¼Œå¯ä»¥ä½¿ç”¨ opacity */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åŠ è½½åŠ¨ç”»å†…å®¹ */</span></span><br><span class="line"><span class="selector-class">.loader-content</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å›¾ç‰‡åŠ è½½å™¨ */</span></span><br><span class="line"><span class="selector-class">.loader-image</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">120px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">120px</span>;</span><br><span class="line">  <span class="attribute">animation</span>: spin <span class="number">1s</span> linear infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ—‹è½¬åŠ¨ç”» */</span></span><br><span class="line"><span class="keyword">@keyframes</span> spin &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è„‰å†²åŠ¨ç”» */</span></span><br><span class="line"><span class="keyword">@keyframes</span> pulse &#123;</span><br><span class="line">  <span class="number">0%</span>, <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0.7</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.loader-image</span><span class="selector-class">.pulse</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: pulse <span class="number">1.5s</span> ease-in-out infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åŠ è½½æ–‡å­— */</span></span><br><span class="line"><span class="selector-class">.loader-text</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">500</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.custom-loader-container</span><span class="selector-class">.dark</span> <span class="selector-class">.loader-text</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åŠ è½½è¿›åº¦æ¡ */</span></span><br><span class="line"><span class="selector-class">.loader-progress</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f0f0f0</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">2px</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.custom-loader-container</span><span class="selector-class">.dark</span> <span class="selector-class">.loader-progress</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.loader-progress-bar</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">90deg</span>, <span class="number">#49b1f5</span>, <span class="number">#00c4b6</span>);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">2px</span>;</span><br><span class="line">  <span class="attribute">animation</span>: progress <span class="number">2s</span> ease-in-out infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> progress &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å“åº”å¼è®¾è®¡ */</span></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.loader-image</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">80px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">80px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.loader-text</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.loader-progress</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">150px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ·»åŠ <code>[BlogRoot]\source\js\custom-loader.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰åŠ è½½åŠ¨ç”»</span></span><br><span class="line"><span class="comment"> * é…ç½®å‚æ•°é€šè¿‡ window.loaderConfig ä¼ é€’</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è·å–åŠ è½½åŠ¨ç”»é…ç½®</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">getLoaderConfig</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">window</span>.<span class="property">loaderConfig</span> || &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–åŠ è½½å™¨</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">initLoader</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> config = <span class="title function_">getLoaderConfig</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¦‚æœç¦ç”¨åŠ è½½å™¨åˆ™ç›´æ¥è¿”å›</span></span><br><span class="line">    <span class="keyword">if</span> (config.<span class="property">enable</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> container = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">    container.<span class="property">className</span> = <span class="string">&#x27;custom-loader-container&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ£€æŸ¥æ˜¯å¦ä¸ºæ·±è‰²æ¨¡å¼</span></span><br><span class="line">    <span class="keyword">if</span> (config.<span class="property">darkMode</span> || (<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-theme&#x27;</span>) === <span class="string">&#x27;dark&#x27;</span>)) &#123;</span><br><span class="line">      container.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;dark&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºåŠ è½½å†…å®¹</span></span><br><span class="line">    <span class="keyword">const</span> content = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">    content.<span class="property">className</span> = <span class="string">&#x27;loader-content&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ·»åŠ åŠ è½½å›¾ç‰‡</span></span><br><span class="line">    <span class="keyword">if</span> (config.<span class="property">imageUrl</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> img = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;img&#x27;</span>);</span><br><span class="line">      img.<span class="property">className</span> = <span class="string">&#x27;loader-image &#x27;</span> + (config.<span class="property">animationType</span> || <span class="string">&#x27;spin&#x27;</span>);</span><br><span class="line">      img.<span class="property">src</span> = config.<span class="property">imageUrl</span>;</span><br><span class="line">      img.<span class="property">alt</span> = <span class="string">&#x27;Loading&#x27;</span>;</span><br><span class="line">      content.<span class="title function_">appendChild</span>(img);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// é»˜è®¤åŠ è½½åŠ¨ç”»ï¼ˆçº¯CSSï¼‰</span></span><br><span class="line">      <span class="keyword">const</span> defaultLoader = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">      defaultLoader.<span class="property">className</span> = <span class="string">&#x27;loader-image &#x27;</span> + (config.<span class="property">animationType</span> || <span class="string">&#x27;spin&#x27;</span>);</span><br><span class="line">      defaultLoader.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;svg viewBox=&quot;0 0 50 50&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;circle cx=&quot;25&quot; cy=&quot;25&quot; r=&quot;20&quot; fill=&quot;none&quot; stroke=&quot;#49b1f5&quot; stroke-width=&quot;3&quot;/&gt;&lt;/svg&gt;&#x27;</span>;</span><br><span class="line">      content.<span class="title function_">appendChild</span>(defaultLoader);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ·»åŠ åŠ è½½æ–‡å­—</span></span><br><span class="line">    <span class="keyword">if</span> (config.<span class="property">text</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> text = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">      text.<span class="property">className</span> = <span class="string">&#x27;loader-text&#x27;</span>;</span><br><span class="line">      text.<span class="property">textContent</span> = config.<span class="property">text</span>;</span><br><span class="line">      content.<span class="title function_">appendChild</span>(text);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ·»åŠ è¿›åº¦æ¡</span></span><br><span class="line">    <span class="keyword">if</span> (config.<span class="property">showProgress</span> !== <span class="literal">false</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> progress = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">      progress.<span class="property">className</span> = <span class="string">&#x27;loader-progress&#x27;</span>;</span><br><span class="line">      <span class="keyword">const</span> progressBar = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">      progressBar.<span class="property">className</span> = <span class="string">&#x27;loader-progress-bar&#x27;</span>;</span><br><span class="line">      progress.<span class="title function_">appendChild</span>(progressBar);</span><br><span class="line">      content.<span class="title function_">appendChild</span>(progress);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    container.<span class="title function_">appendChild</span>(content);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">insertBefore</span>(container, <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">firstChild</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç›‘å¬é¡µé¢åŠ è½½å®Œæˆ</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">readyState</span> === <span class="string">&#x27;loading&#x27;</span>) &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">hideLoader</span>(container, config.<span class="property">duration</span> || <span class="number">500</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// é¡µé¢å·²åŠ è½½å®Œæˆ</span></span><br><span class="line">      <span class="title function_">hideLoader</span>(container, config.<span class="property">duration</span> || <span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç›‘å¬ pjax æˆ–å…¶ä»–åŠ¨æ€åŠ è½½äº‹ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">Pjax</span>) &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:beforeSend&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">showLoader</span>(container, config);</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:complete&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">hideLoader</span>(container, config.<span class="property">duration</span> || <span class="number">500</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ˜¾ç¤ºåŠ è½½å™¨</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">showLoader</span>(<span class="params">container, config</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (container.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;fade-out&#x27;</span>)) &#123;</span><br><span class="line">      container.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;fade-out&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ£€æŸ¥æš—è‰²æ¨¡å¼</span></span><br><span class="line">    <span class="keyword">if</span> (config &amp;&amp; config.<span class="property">darkMode</span>) &#123;</span><br><span class="line">      container.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;dark&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-theme&#x27;</span>) === <span class="string">&#x27;dark&#x27;</span>) &#123;</span><br><span class="line">      container.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;dark&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      container.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;dark&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// éšè—åŠ è½½å™¨</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">hideLoader</span>(<span class="params">container, duration</span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      container.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;fade-out&#x27;</span>);</span><br><span class="line">    &#125;, duration);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åœ¨ DOM åŠ è½½å®Œæˆååˆå§‹åŒ–</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">readyState</span> === <span class="string">&#x27;loading&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, initLoader);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">initLoader</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>_config.butterfly.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/custom-loader.css&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">src=&quot;/js/custom-loader.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>              </div>            </details><h1 id="åˆ†ç±»æ¡"><a href="#åˆ†ç±»æ¡" class="headerlink" title="åˆ†ç±»æ¡"></a>åˆ†ç±»æ¡</h1><details class="folding-tag" cyan close><summary> å…·ä½“æ­¥éª¤ </summary>              <div class='content'>              <ol><li><strong>å‚è€ƒ</strong></li></ol><p>â€‹<a href="https://blog.liushen.fun/posts/a64defb4/">é­”æ”¹ç¬”è®°ä¸ƒï¼šåˆ†ç±»æ¡åŠå¤–é“¾å¡ç‰‡ | LiuShenâ€™s Blog</a></p><ol start="2"><li><strong>åˆ›å»º</strong></li></ol><p>å»ºç«‹å¯¹åº”æ–‡ä»¶ï¼š<code>[BlogRoot]\themes\butterfly\layout\includes\categoryBar.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.category-bar-items#category-bar-items(class=is_home() ? &#x27;home&#x27; : &#x27;&#x27;)</span><br><span class="line">  .category-bar-item(class=is_home() ? &#x27;select&#x27; : &#x27;&#x27;, id=&quot;category-bar-home&quot;)</span><br><span class="line">    a(href=url_for(&#x27;/&#x27;))= __(&#x27;åšå®¢é¦–é¡µ&#x27;)</span><br><span class="line">  each item in site.categories.find(&#123; parent: &#123; $exists: false &#125; &#125;).data</span><br><span class="line">    .category-bar-item(class=select ? (select === item.name ? &#x27;select&#x27; : &#x27;&#x27;) : &#x27;&#x27;, id=item.name)</span><br><span class="line">      a(href=url_for(item.path))= item.name</span><br><span class="line">  .category-bar-item</span><br><span class="line">    a(href=url_for(&#x27;/archives/&#x27;))= __(&#x27;æ–‡ç« å­˜æ¡£&#x27;)</span><br><span class="line">div.category-bar-right</span><br><span class="line">  a.category-bar-more(href=url_for(&#x27;/categories/&#x27;))= __(&#x27;æ›´å¤šåˆ†ç±»&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå°±æ˜¯è¯¥æ»šåŠ¨æ¡çš„ç»“æ„ï¼Œä¸‹é¢æˆ‘ä»¬å¼€å§‹å®ç°æ ·å¼çš„å®šä¹‰ï¼Œæ–°å»ºæ–‡ä»¶<code>[BlogRoot]\themes\butterfly\source\css\_layout\category-bar.styl</code>å†™å…¥ä»¥ä¸‹æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">#category-bar</span><br><span class="line">  padding 7px 11px</span><br><span class="line">  // æ–¹æ¡ˆ 1ï¼šæ¨èï¼ˆæ··åˆ --card-bg å’Œæµ…ç°ï¼Œæ— é€æ˜ï¼Œå±‚æ¬¡æ„Ÿå¼ºï¼Œä¸å½±å“å­å…ƒç´ ï¼‰</span><br><span class="line">  background color-mix(var(--card-bg), #f8f9fa, 80%) </span><br><span class="line">  // æ–¹æ¡ˆ 2ï¼šç›´æ¥ä½¿ç”¨ --card-bg å¹¶é™ä½è½»å¾®ä¸é€æ˜åº¦ï¼ˆèƒŒæ™¯ç‹¬ç«‹ä¸é€æ˜ï¼Œä¸å½±å“å­å…ƒç´ ï¼‰</span><br><span class="line">  // background rgba(hue(var(--card-bg)), saturation(var(--card-bg)), lightness(var(--card-bg)), 0.9)</span><br><span class="line">  // æ–¹æ¡ˆ 3ï¼š--card-bg åŸºç¡€ä¸ŠåŠ è½»å¾®æ¸å˜ï¼ˆæ— é€æ˜ï¼Œè§†è§‰æ›´ç«‹ä½“ï¼‰</span><br><span class="line">  // background linear-gradient(180deg, var(--card-bg), color-mix(var(--card-bg), #eee, 95%))</span><br><span class="line">  border-radius 8px</span><br><span class="line">  display flex</span><br><span class="line">  white-space nowrap</span><br><span class="line">  overflow hidden</span><br><span class="line">  transition 0.3s</span><br><span class="line">  height 50px</span><br><span class="line">  width 100%</span><br><span class="line">  justify-content space-between</span><br><span class="line">  user-select none</span><br><span class="line">  align-items center</span><br><span class="line">  margin-bottom 20px</span><br><span class="line"></span><br><span class="line">  .category-bar-right</span><br><span class="line">    display flex</span><br><span class="line">    border-radius 8px</span><br><span class="line">    align-items center</span><br><span class="line"></span><br><span class="line">    .category-bar-more</span><br><span class="line">      margin-left 4px</span><br><span class="line">      margin-right 4px</span><br><span class="line">      font-weight 700</span><br><span class="line">      border-radius 8px</span><br><span class="line">      padding 0 8px</span><br><span class="line"></span><br><span class="line">  .category-bar-items</span><br><span class="line">    width 100%</span><br><span class="line">    white-space nowrap</span><br><span class="line">    overflow-x scroll</span><br><span class="line">    scrollbar-width: none</span><br><span class="line">    -ms-overflow-style: none</span><br><span class="line">    overflow-y hidden</span><br><span class="line">    display flex</span><br><span class="line">    border-radius 8px</span><br><span class="line">    align-items center</span><br><span class="line">    height 30px</span><br><span class="line"></span><br><span class="line">    &amp;::-webkit-scrollbar</span><br><span class="line">      display: none</span><br><span class="line"></span><br><span class="line">    .category-bar-item</span><br><span class="line">      a</span><br><span class="line">        padding .1rem .5rem</span><br><span class="line">        margin-right 6px</span><br><span class="line">        font-weight 700</span><br><span class="line">        border-radius 8px</span><br><span class="line">        display flex</span><br><span class="line">        align-items center</span><br><span class="line">        height 30px</span><br><span class="line">        color var(--font-color) // å¢åŠ é»˜è®¤æ–‡å­—é¢œè‰²</span><br><span class="line">        </span><br><span class="line">        &amp;:hover</span><br><span class="line">          color var(--theme-color) // æ‚¬åœé¢œè‰²</span><br><span class="line"></span><br><span class="line">      &amp;.select</span><br><span class="line">        a</span><br><span class="line">          background #3eb8be</span><br><span class="line">          color var(--btn-color)</span><br></pre></td></tr></table></figure><ol start="3"><li>ä¿®æ”¹</li></ol><p>åœ¨pugæ–‡ä»¶ä¸­ï¼Œæ‰€æœ‰çš„é¢œè‰²æˆ‘éƒ½å°½é‡ä½¿ç”¨äº†butterflyä¸»é¢˜è‡ªå¸¦çš„å˜é‡è¿›è¡Œäº†æ›¿ä»£ï¼Œç¡®ä¿å¤§éƒ¨åˆ†äººå¯ä»¥æ­£å¸¸æ˜¾ç¤ºã€‚</p><p>ç„¶åå°†å…¶æ·»åŠ åˆ°ä¸åŒçš„ä½ç½®ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œå®ç°äº†æ·»åŠ åˆ°åˆ†ç±»é¡µé¢ç­‰ä½ç½®ï¼Œé…åˆä¸Špjaxå¯ä»¥åšåˆ°æ— åˆ·æ›´æ–°ï¼Œæ•ˆæœå¾ˆå¥½ï¼Œæ‰“å¼€æ–‡ä»¶</p><p>[BlogRoot]\themes\butterfly\layout\category.pugï¼Œæ·»åŠ å…¶ä¸­ä¸¤è¡Œä»£ç ï¼Œå»æ‰åŠ å·å³ä¸ºæ­£å¸¸ç¼©è¿›ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">  if theme.category_ui == &#x27;index&#x27;</span><br><span class="line">    include ./includes/mixins/indexPostUI.pug</span><br><span class="line">    +indexPostUI</span><br><span class="line">  else</span><br><span class="line">    include ./includes/mixins/article-sort.pug</span><br><span class="line">+    .recent-posts.nc(id=&quot;category-bar-wrapper&quot;)</span><br><span class="line">+      #category-bar.category-bar</span><br><span class="line">+        include includes/categoryBar.pug</span><br><span class="line">      #category</span><br><span class="line">        .article-sort-title= _p(&#x27;page.category&#x27;) + &#x27; - &#x27; + page.category</span><br><span class="line">        +articleSort(page.posts)</span><br><span class="line">        include includes/pagination.pug</span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¸Šæ–¹çš„ä¿®æ”¹ï¼Œéœ€è¦å°†é…ç½®æ–‡ä»¶ä¸­ï¼Œåˆ†ç±»é¡µé¢çš„ä¸»é¢˜æ”¹æˆindexï¼Œå¦åˆ™ä¸ä¼šæ˜¾ç¤ºã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å°†å…¶æ·»åŠ åˆ°ä¸»é¡µï¼Œæ‰“å¼€æ–‡ä»¶[BlogRoot]\themes\butterfly\layout\index.pugæ–‡ä»¶ï¼Œæ·»åŠ ä¸‹é¢ä¸¤è¡Œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">+  .recent-posts.nc(id=&quot;category-bar-wrapper&quot;)</span><br><span class="line">+    #category-bar.category-bar</span><br><span class="line">+      include includes/categoryBar.pug</span><br><span class="line">      </span><br><span class="line">    include ./includes/mixins/indexPostUI.pug</span><br><span class="line">    +indexPostUI</span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯å®ç°ç‚¹å‡»åˆ‡æ¢åï¼Œé«˜äº®éƒ¨åˆ†è·Ÿéšåˆ†ç±»é¡µé¢èµ°çš„éƒ¨åˆ†ï¼Œä¸ºäº†å’Œä¸»é¢˜èåˆæˆ‘è¿˜æ˜¯ä¿®æ”¹æºç ï¼Œæ‰“å¼€[BlogRoot]\themes\butterfly\source\js\main.jsï¼Œæ·»åŠ jså‡½æ•°ï¼Œæ¯”å¦‚æˆ‘æ·»åŠ åˆ°äº†778è¡Œå·¦å³ï¼ŒswitchCommentså‡½æ•°çš„ä¸Šé¢ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">  const toggleCardCategory = () =&gt; &#123;</span><br><span class="line"></span><br><span class="line">// æ–°å¢</span><br><span class="line">  const setCategoryBarActive = () =&gt; &#123;</span><br><span class="line">    const categoryBar = document.querySelector(&quot;#category-bar&quot;);</span><br><span class="line">    const currentPath = decodeURIComponent(window.location.pathname);</span><br><span class="line">    const isHomePage = currentPath === GLOBAL_CONFIG.root;</span><br><span class="line"></span><br><span class="line">    if (categoryBar) &#123;</span><br><span class="line">        const categoryItems = categoryBar.querySelectorAll(&quot;.category-bar-item&quot;);</span><br><span class="line">        categoryItems.forEach(item =&gt; item.classList.remove(&quot;select&quot;));</span><br><span class="line"></span><br><span class="line">        const activeItemId = isHomePage ? &quot;category-bar-home&quot; : currentPath.split(&quot;/&quot;).slice(-2, -1)[0];</span><br><span class="line">        const activeItem = document.getElementById(activeItemId);</span><br><span class="line"></span><br><span class="line">        if (activeItem) &#123;</span><br><span class="line">            activeItem.classList.add(&quot;select&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">  const addPostOutdateNotice = () =&gt; &#123;</span><br></pre></td></tr></table></figure><p>ç„¶åå†åœ¨å¼•ç”¨éƒ¨åˆ†æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œåœ¨åŒä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰¾åˆ°ä¸‹é¢çš„å‡½æ•°å¹¶æ·»åŠ å‡½æ•°çš„è°ƒç”¨ï¼Œä½ç½®çœ‹ä¸‹æ–¹æ³¨é‡Šï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GLOBAL_CONFIG_SITE.pageType === &#x27;home&#x27; &amp;&amp; scrollDownInIndex()</span><br><span class="line">scrollFn()</span><br><span class="line"></span><br><span class="line">// ========== æ–°å¢ï¼šè°ƒç”¨åˆ†ç±»æ æ¿€æ´»æ€åˆ‡æ¢å‡½æ•° ==========</span><br><span class="line">setCategoryBarActive()</span><br><span class="line"></span><br><span class="line">forPostFn()</span><br></pre></td></tr></table></figure><blockquote><p>ä»¥ä¸‹ä¸åˆ†ç±»æ¡çš„æ”¹åŠ¨æ— å…³ï¼Œä¸ºæˆ‘ä¸ªäººä¿®æ”¹ï¼Œä»¥é˜²å¿˜è®°ï¼Œç‰¹è®°å½•ä¸‹æ¥</p></blockquote><hr><h2 id="é¦–é¡µæ–‡ç« åˆ—è¡¨-indexPostUI-pug"><a href="#é¦–é¡µæ–‡ç« åˆ—è¡¨-indexPostUI-pug" class="headerlink" title="é¦–é¡µæ–‡ç« åˆ—è¡¨ (indexPostUI.pug)"></a>é¦–é¡µæ–‡ç« åˆ—è¡¨ (indexPostUI.pug)</h2><p>æ–‡ä»¶è·¯å¾„ï¼š themes&#x2F;butterfly&#x2F;layout&#x2F;includes&#x2F;mixins&#x2F;indexPostUI.pug</p><p>ç›®çš„æ˜¯ä¸ºäº†åœ¨æ–‡ç« åˆ—è¡¨å®¹å™¨ #recent-posts çš„æœ€å¼€å§‹æ’å…¥åˆ†ç±»æ¡ä»£ç ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">//- åŸå§‹ä»£ç  (Before)</span><br><span class="line">mixin indexPostUI()</span><br><span class="line">  // ... (çœç•¥å˜é‡å®šä¹‰)</span><br><span class="line">  #recent-posts.recent-posts.nc</span><br><span class="line">  (class=masonryLayoutClass)</span><br><span class="line">    .recent-post-items</span><br><span class="line">      each article, index in page.</span><br><span class="line">      posts.data</span><br><span class="line">        // ...</span><br><span class="line"></span><br><span class="line">//- ç°åœ¨ä»£ç  (After)</span><br><span class="line">mixin indexPostUI()</span><br><span class="line">  // ... (çœç•¥å˜é‡å®šä¹‰)</span><br><span class="line">  #recent-posts.recent-posts.nc</span><br><span class="line">  (class=masonryLayoutClass)</span><br><span class="line">    // [æ–°å¢] æ’å…¥åˆ†ç±»æ¡ã€‚Swiper ä¼šé€š</span><br><span class="line">    è¿‡ JS æ’åœ¨å®ƒä¸Šé¢ï¼Œæ–‡ç« åœ¨å®ƒä¸‹é¢ã€‚</span><br><span class="line">    #category-bar.category-bar</span><br><span class="line">      include ../categoryBar.pug</span><br><span class="line">    .recent-post-items</span><br><span class="line">      each article, index in page.</span><br><span class="line">      posts.data</span><br><span class="line">        // ...</span><br></pre></td></tr></table></figure><h3 id="åˆ†ç±»å½’æ¡£é¡µé¢-category-pug"><a href="#åˆ†ç±»å½’æ¡£é¡µé¢-category-pug" class="headerlink" title="åˆ†ç±»å½’æ¡£é¡µé¢ (category.pug)"></a>åˆ†ç±»å½’æ¡£é¡µé¢ (category.pug)</h3><p>æ–‡ä»¶è·¯å¾„ï¼š themes&#x2F;butterfly&#x2F;layout&#x2F;category.pug</p><p>ä¸ºäº†è®©åˆ†ç±»é¡µé¢çš„å¸ƒå±€ä¸å´©åï¼ˆä¿æŒ 74% å®½åº¦ï¼‰ï¼Œå¹¶æ˜¾ç¤ºåˆ†ç±»æ¡ï¼Œé‡æ„ else åˆ†æ”¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">//- åŸå§‹ä»£ç  (Before)</span><br><span class="line">  else</span><br><span class="line">    include ./includes/mixins/</span><br><span class="line">    article-sort.pug</span><br><span class="line">    #category</span><br><span class="line">      .article-sort-title= _p(&#x27;page.</span><br><span class="line">      category&#x27;) + &#x27; - &#x27; + page.</span><br><span class="line">      category</span><br><span class="line">      +articleSort(page.posts)</span><br><span class="line">      include includes/pagination.</span><br><span class="line">      pug</span><br><span class="line"></span><br><span class="line">//- ç°åœ¨ä»£ç  (After)</span><br><span class="line">  else</span><br><span class="line">    include ./includes/mixins/</span><br><span class="line">    article-sort.pug</span><br><span class="line">    // [ä¿®æ”¹] æ·»åŠ å¤–å±‚å®¹å™¨ .</span><br><span class="line">    recent-posts.nc ä»¥ä¿®å¤å¸ƒå±€å®½åº¦é—®é¢˜</span><br><span class="line">    .recent-posts.nc</span><br><span class="line">    (id=&quot;category-bar-wrapper&quot;)</span><br><span class="line">      // [æ–°å¢] æ·»åŠ åˆ†ç±»æ¡</span><br><span class="line">      #category-bar.category-bar</span><br><span class="line">        include includes/</span><br><span class="line">        categoryBar.pug</span><br><span class="line">      // åŸæœ‰çš„åˆ†ç±»å†…å®¹</span><br><span class="line">      #category</span><br><span class="line">        .article-sort-title= _p</span><br><span class="line">        (&#x27;page.category&#x27;) + &#x27; - &#x27; + </span><br><span class="line">        page.category</span><br><span class="line">        +articleSort(page.posts)</span><br><span class="line">        include includes/pagination.</span><br><span class="line">        pug</span><br></pre></td></tr></table></figure>              </div>            </details><h1 id="å¤–æŒ‚æ ‡ç­¾"><a href="#å¤–æŒ‚æ ‡ç­¾" class="headerlink" title="å¤–æŒ‚æ ‡ç­¾"></a>å¤–æŒ‚æ ‡ç­¾</h1><details class="folding-tag" cyan close><summary> å…·ä½“æ­¥éª¤ </summary>              <div class='content'>              <p>[BlogRoot]\themes\liushen\scripts\tag\note.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * note å¤–æŒ‚æ ‡ç­¾ï¼Œåˆ†ä¸ºè­¦å‘Šã€é”™è¯¯ã€é—®é¢˜ã€ä¿¡æ¯ï¼Œæ¯”åŸç‰ˆæ›´åŠ ç®€å•ï¼Œæ ·å¼æ›´åŠ æ¼‚äº®</span><br><span class="line"> * by: LiuShen</span><br><span class="line"> * æ ·å¼å‚è€ƒ: https://blog.zhilu.cyou/</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">&#x27;use strict&#x27;</span><br><span class="line"></span><br><span class="line">const postNote = (args, content) =&gt; &#123;</span><br><span class="line">  // å®šä¹‰äº”ç§ç±»å‹åŠå…¶å¯¹åº”çš„ Font Awesome å›¾æ ‡</span><br><span class="line">  const types = &#123;</span><br><span class="line">    warning: &#x27;fa-circle-dot&#x27;,          // è­¦å‘Š</span><br><span class="line">    error: &#x27;fa-circle-xmark&#x27;,          // é”™è¯¯</span><br><span class="line">    question: &#x27;fa-circle-question&#x27;,    // é—®é¢˜</span><br><span class="line">    info: &#x27;fa-circle-check&#x27;,           // ä¿¡æ¯</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  // è·å–æ ‡ç­¾ç±»å‹å’Œæ ‡é¢˜</span><br><span class="line">  const type = args[0] || &#x27;info&#x27;; // å¦‚æœæœªæä¾›ç±»å‹ï¼Œé»˜è®¤ä¸º info</span><br><span class="line">  const title = args.slice(1).join(&#x27; &#x27;) || &#x27;é™„åŠ ä¿¡æ¯&#x27;; // æå–æ ‡é¢˜ï¼Œé»˜è®¤ä¸º &quot;æç¤º&quot;</span><br><span class="line">  const icon = types[type] || types.info; // å¦‚æœç±»å‹æœªå®šä¹‰ï¼Œä½¿ç”¨ info ç±»å‹çš„å›¾æ ‡</span><br><span class="line"></span><br><span class="line">  // åˆ¤æ–­æ ‡ç­¾ç±»å‹æ˜¯å¦åœ¨ types ä¸­å®šä¹‰</span><br><span class="line">  if (!types[type]) &#123;</span><br><span class="line">    console.warn(`\`$&#123;type&#125;\` ç±»å‹æœªå®šä¹‰ï¼Œå·²è‡ªåŠ¨åˆ‡æ¢ä¸º \`info\` ç±»å‹`);</span><br><span class="line">    type = &#x27;info&#x27;;</span><br><span class="line">    title = &#x27;é™„åŠ ä¿¡æ¯&#x27;;</span><br><span class="line">    icon = types.info;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // è¿”å› HTML ç»“æ„</span><br><span class="line">  return `</span><br><span class="line">    &lt;div class=&quot;note note-$&#123;type&#125;&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;note-header&quot;&gt;</span><br><span class="line">        &lt;i class=&quot;note-icon fa-regular $&#123;icon&#125;&quot;&gt;&lt;/i&gt;</span><br><span class="line">        &lt;span class=&quot;note-title&quot;&gt;$&#123;title&#125;&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;note-content&quot;&gt;</span><br><span class="line">        $&#123;hexo.render.renderSync(&#123; text: content, engine: &#x27;markdown&#x27; &#125;)&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  `;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// æ³¨å†Œè‡ªå®šä¹‰æ ‡ç­¾</span><br><span class="line">hexo.extend.tag.register(&#x27;note&#x27;, postNote, &#123; ends: true &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç¾åŒ–æ ‡ç­¾ [BlogRoot]\themes\liushen\source\css_tags\note.styl</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">.note</span><br><span class="line">  addBorderRadius()</span><br><span class="line">  border var(--liushen-card-border)</span><br><span class="line">  position: relative</span><br><span class="line">  margin: 0 0 20px</span><br><span class="line">  padding: 15px 15px 7px 15px</span><br><span class="line">  background-color: var(--liushen-card-bg)</span><br><span class="line">  transition: transform 0.3s ease</span><br><span class="line"></span><br><span class="line">  &amp;:hover</span><br><span class="line">    transform: translateY(-3px)</span><br><span class="line"></span><br><span class="line">  &amp;.note-warning</span><br><span class="line">    background-image: radial-gradient(circle at 4em -25em, #f0ad4e, transparent 30em),</span><br><span class="line">                linear-gradient(#f0ad4e -2000%, transparent)</span><br><span class="line">    .note-header</span><br><span class="line">      color: #f0ad4e</span><br><span class="line"></span><br><span class="line">  &amp;.note-info</span><br><span class="line">    background-image: radial-gradient(circle at 4em -25em, #5cb85c, transparent 30em),</span><br><span class="line">                linear-gradient(#5cb85c -2000%, transparent)</span><br><span class="line">    .note-header</span><br><span class="line">      color: #5cb85c</span><br><span class="line"></span><br><span class="line">  &amp;.note-error</span><br><span class="line">    background-image: radial-gradient(circle at 4em -25em, #d9534f, transparent 30em),</span><br><span class="line">                linear-gradient(#d9534f -2000%, transparent)</span><br><span class="line">    .note-header</span><br><span class="line">      color: #d9534f</span><br><span class="line"></span><br><span class="line">  &amp;.note-question</span><br><span class="line">    background-image: radial-gradient(circle at 4em -25em, #5bc0de, transparent 30em),</span><br><span class="line">                linear-gradient(#5bc0de -2000%, transparent)</span><br><span class="line">    .note-header</span><br><span class="line">      color: #5bc0de</span><br><span class="line"></span><br><span class="line">  .note-header</span><br><span class="line">    display: flex</span><br><span class="line">    align-items: center</span><br><span class="line">    font-weight: bold</span><br><span class="line">    margin-bottom: 10px</span><br><span class="line">    font-size: 1.0em</span><br><span class="line">    i.note-icon</span><br><span class="line">      margin-right: 10px</span><br><span class="line">      color: inherit</span><br></pre></td></tr></table></figure>              </div>            </details><ol><li><p>infoæ ‡ç­¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note info è¿™æ˜¯æ ‡é¢˜ %&#125;</span><br><span class="line">è¿™ä¸ªæ˜¯å†…å®¹å±•ç¤ºï¼Œé‡Œé¢å¯ä»¥æ­£å¸¸ä½¿ç”¨`Markdown`çš„ç›¸å…³æ¸²æŸ“æ ¼å¼</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p>    <div class="note note-info">      <div class="note-header">        <i class="note-icon fa-regular fa-circle-check"></i>        <span class="note-title">è¿™æ˜¯æ ‡é¢˜</span>      </div>      <div class="note-content">        <p>è¿™ä¸ªæ˜¯å†…å®¹å±•ç¤ºï¼Œé‡Œé¢å¯ä»¥æ­£å¸¸ä½¿ç”¨<code>Markdown</code>çš„ç›¸å…³æ¸²æŸ“æ ¼å¼</p>      </div>    </div>  </li><li><p>warningæ ‡ç­¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note warning è¿™æ˜¯æ ‡é¢˜ %&#125;</span><br><span class="line">è¿™ä¸ªæ˜¯å†…å®¹å±•ç¤ºï¼Œé‡Œé¢å¯ä»¥æ­£å¸¸ä½¿ç”¨`Markdown`çš„ç›¸å…³æ¸²æŸ“æ ¼å¼</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p>    <div class="note note-warning">      <div class="note-header">        <i class="note-icon fa-regular fa-circle-dot"></i>        <span class="note-title">è¿™æ˜¯æ ‡é¢˜</span>      </div>      <div class="note-content">        <p>è¿™ä¸ªæ˜¯å†…å®¹å±•ç¤ºï¼Œé‡Œé¢å¯ä»¥æ­£å¸¸ä½¿ç”¨<code>Markdown</code>çš„ç›¸å…³æ¸²æŸ“æ ¼å¼</p>      </div>    </div>  </li><li><p>questionæ ‡ç­¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note question è¿™æ˜¯æ ‡é¢˜ %&#125;</span><br><span class="line">è¿™ä¸ªæ˜¯å†…å®¹å±•ç¤ºï¼Œé‡Œé¢å¯ä»¥æ­£å¸¸ä½¿ç”¨`Markdown`çš„ç›¸å…³æ¸²æŸ“æ ¼å¼</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p>    <div class="note note-question">      <div class="note-header">        <i class="note-icon fa-regular fa-circle-question"></i>        <span class="note-title">è¿™æ˜¯æ ‡é¢˜</span>      </div>      <div class="note-content">        <p>è¿™ä¸ªæ˜¯å†…å®¹å±•ç¤ºï¼Œé‡Œé¢å¯ä»¥æ­£å¸¸ä½¿ç”¨<code>Markdown</code>çš„ç›¸å…³æ¸²æŸ“æ ¼å¼</p>      </div>    </div>  </li><li><p>erroræ ‡ç­¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note error è¿™æ˜¯æ ‡é¢˜ %&#125;</span><br><span class="line">è¿™ä¸ªæ˜¯å†…å®¹å±•ç¤ºï¼Œé‡Œé¢å¯ä»¥æ­£å¸¸ä½¿ç”¨`Markdown`çš„ç›¸å…³æ¸²æŸ“æ ¼å¼</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p>    <div class="note note-error">      <div class="note-header">        <i class="note-icon fa-regular fa-circle-xmark"></i>        <span class="note-title">è¿™æ˜¯æ ‡é¢˜</span>      </div>      <div class="note-content">        <p>è¿™ä¸ªæ˜¯å†…å®¹å±•ç¤ºï¼Œé‡Œé¢å¯ä»¥æ­£å¸¸ä½¿ç”¨<code>Markdown</code>çš„ç›¸å…³æ¸²æŸ“æ ¼å¼</p>      </div>    </div>  </li></ol><h1 id="ä¾§è¾¹æ "><a href="#ä¾§è¾¹æ " class="headerlink" title="ä¾§è¾¹æ "></a>ä¾§è¾¹æ </h1><h2 id="æ¥è®¿è€…"><a href="#æ¥è®¿è€…" class="headerlink" title="æ¥è®¿è€…"></a>æ¥è®¿è€…</h2><details class="folding-tag" cyan close><summary> å…·ä½“æ­¥éª¤ </summary>              <div class='content'>              <p>æ–°å»º[BlogRoot]\themes\liushen\layout\includes\widget\card_welcome.pug</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">.card-widget.card-welcome</span><br><span class="line">  .item-headline</span><br><span class="line">    i.fa.fa-user</span><br><span class="line">    span æ¬¢è¿æ¥è®¿è€…!</span><br><span class="line">  .item-content</span><br><span class="line">    p &amp;nbsp&amp;nbspğŸ‘‹ğŸ»æˆ‘æ˜¯Kaitumeiï¼Œä¸€ä¸ª</span><br><span class="line">      span(style=&quot;font-weight: bold; color: #3498db&quot;) çƒ­çˆ±è®°å½•ã€å–œæ¬¢åˆ†äº« </span><br><span class="line">      | çš„å°å¡æ‹‰ç±³ã€‚ğŸ˜Š </span><br><span class="line">    p &amp;nbsp&amp;nbspå¸Œæœ›åœ¨è¿™é‡Œä½ èƒ½æ¢å¯»åˆ°ä½ å¿ƒä¸­çš„é‚£åº§</span><br><span class="line">      span(style=&quot;font-weight: bold; color: #7a3debff&quot;) å²›å±¿ğŸ—»ã€‚</span><br><span class="line">      br</span><br><span class="line">      | &amp;nbsp&amp;nbspç–²æƒ«æ—¶ï¼Œä½ å¯ä»¥ç‚¹å‡»å·¦ä¸‹æ–¹çš„ç¥ç§˜å°ç‰©ä»¶ï¼Œç„¶åæ”¾æ¾æ”¾æ¾å“¦~</span><br><span class="line">      | å¦‚æœé‡åˆ°ä»€ä¹ˆé—®é¢˜è¯·é€šè¿‡</span><br><span class="line">      a(href=&quot;kaitumei@163.com&quot; style=&quot;font-weight: bold; color: #9b59b6&quot;) é‚®ç®±</span><br><span class="line">      | è”ç³»æˆ‘ï¼ğŸ“§</span><br><span class="line">  #welcome-info</span><br><span class="line">    .error-message(style=&quot;height: 200px; display: flex; justify-content: center; align-items: center;&quot;)</span><br><span class="line">      p(style=&quot;text-align: center;&quot;)</span><br><span class="line">        span(style=&quot;font-size: 40px;&quot;) ğŸ˜¥ </span><br><span class="line">        br</span><br><span class="line">        span(style=&quot;font-size: 16px;&quot;) ç”±äºç½‘ç»œé—®é¢˜</span><br><span class="line">        br</span><br><span class="line">        span(style=&quot;font-size: 16px;&quot;) ä½ç½®APIè¯·æ±‚é”™è¯¯</span><br><span class="line">        br</span><br><span class="line">        span(style=&quot;font-size: 16px;&quot;) è¯·åˆ·æ–°é‡è¯•å‘€ğŸ¤—~</span><br></pre></td></tr></table></figure><p>åŒç›®å½•åº•ä¸‹index.pug</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  else</span><br><span class="line">    //- page</span><br><span class="line">    !=partial(&#x27;includes/widget/card_author&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">+    if is_home()</span><br><span class="line">+      !=partial(&#x27;includes/widget/card_welcome&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">    !=partial(&#x27;includes/widget/card_announcement&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">    !=partial(&#x27;includes/widget/card_top_self&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    .sticky_layout</span><br></pre></td></tr></table></figure><p>æ–°å»º<code>[BlogRoot]\themes\liushen\source\css\_layout\card-welcome.styl</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#aside-content</span><br><span class="line">    .card-widget.card-welcome</span><br><span class="line">        padding: 8px</span><br><span class="line">        .item-headline</span><br><span class="line">            margin: 12px 16px 0 16px</span><br><span class="line">        .item-content</span><br><span class="line">            margin: 0 16px 10px 16px</span><br><span class="line">        #welcome-info</span><br><span class="line">            text-align center</span><br><span class="line">            background-color: var(--liushen-card-bg)</span><br><span class="line">            border-radius: 12px</span><br><span class="line">            padding: 16px</span><br><span class="line">            margin: 8px</span><br><span class="line">            // border: 2px solid var(--liushen-text)</span><br><span class="line">            .ip-address</span><br><span class="line">                // æ¨¡ç³Šæ•ˆæœ</span><br><span class="line">                filter: blur(5px)</span><br><span class="line">                color: var(--default-bg-color)</span><br><span class="line">                transition: filter 0.5s</span><br><span class="line">                &amp;:hover</span><br><span class="line">                    filter: none</span><br></pre></td></tr></table></figure><p>ä»»æ„jsä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br></pre></td><td class="code"><pre><span class="line">// è¿›è¡Œ fetch è¯·æ±‚</span><br><span class="line">fetch(&#x27;https://uapis.cn/api/v1/network/myip?source=commercial&#x27;)</span><br><span class="line">    .then(response =&gt; &#123;</span><br><span class="line">        if (!response.ok) &#123;</span><br><span class="line">            throw new Error(&#x27;Network response was not ok&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line">        return response.json();</span><br><span class="line">    &#125;)</span><br><span class="line">    .then(data =&gt; &#123;</span><br><span class="line">        // é€‚é… uapis.cn API è¿”å›æ ¼å¼</span><br><span class="line">        if (data &amp;&amp; data.region) &#123;</span><br><span class="line">            const regions = data.region.split(&#x27; &#x27;);</span><br><span class="line">            ipLocation = &#123;</span><br><span class="line">                ip: data.ip,</span><br><span class="line">                data: &#123;</span><br><span class="line">                    lng: data.longitude,</span><br><span class="line">                    lat: data.latitude,</span><br><span class="line">                    country: regions[0] || &#x27;&#x27;,</span><br><span class="line">                    prov: regions[1] || &#x27;&#x27;,</span><br><span class="line">                    city: regions[2] || &#x27;&#x27;,</span><br><span class="line">                    district: data.district || &#x27;&#x27;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            ipLocation = data;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        if (isHomePage()) &#123;</span><br><span class="line">            showWelcome();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(error =&gt; console.error(&#x27;Error fetching IP data:&#x27;, error));</span><br><span class="line"></span><br><span class="line">let ipLocation; // æ˜¾å¼å£°æ˜å˜é‡</span><br><span class="line"></span><br><span class="line">function getDistance(e1, n1, e2, n2) &#123;</span><br><span class="line">    if ([e1, n1, e2, n2].some(v =&gt; typeof v !== &#x27;number&#x27; || isNaN(v))) &#123;</span><br><span class="line">        console.warn(&#x27;Invalid coordinates for getDistance:&#x27;, e1, n1, e2, n2);</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">    const R = 6371;</span><br><span class="line">    const &#123; sin, cos, asin, PI, hypot &#125; = Math;</span><br><span class="line">    let getPoint = (e, n) =&gt; &#123;</span><br><span class="line">        e *= PI / 180;</span><br><span class="line">        n *= PI / 180;</span><br><span class="line">        return &#123; x: cos(n) * cos(e), y: cos(n) * sin(e), z: sin(n) &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    let a = getPoint(e1, n1);</span><br><span class="line">    let b = getPoint(e2, n2);</span><br><span class="line">    let c = hypot(a.x - b.x, a.y - b.y, a.z - b.z);</span><br><span class="line">    let r = asin(c / 2) * 2 * R;</span><br><span class="line">    return Math.round(r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function showWelcome() &#123;</span><br><span class="line">    if (!ipLocation || !ipLocation.data) &#123;</span><br><span class="line">        console.error(&#x27;ipLocation data is not available.&#x27;);</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    let dist = getDistance(112.377552,26.975294, ipLocation.data.lng, ipLocation.data.lat); // ä¿®æ”¹è‡ªå·±çš„ç»åº¦ï¼ˆ121.413921ï¼‰çº¬åº¦ï¼ˆ31.089290ï¼‰</span><br><span class="line">    let pos = ipLocation.data.country;</span><br><span class="line">    let ip = ipLocation.ip;</span><br><span class="line">    let posdesc;</span><br><span class="line"></span><br><span class="line">    // æ–°å¢ipv6æ˜¾ç¤ºä¸ºæŒ‡å®šå†…å®¹</span><br><span class="line">    if (ip.includes(&quot;:&quot;)) &#123;</span><br><span class="line">        ip = &quot;&lt;br&gt;å¥½å¤æ‚ï¼Œå’±çœ‹ä¸æ‡‚å‘¢~(ipv6)&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // ä»¥ä¸‹çš„ä»£ç éœ€è¦æ ¹æ®æ–°APIè¿”å›çš„ç»“æœè¿›è¡Œç›¸åº”çš„è°ƒæ•´</span><br><span class="line">    switch (ipLocation.data.country) &#123;</span><br><span class="line">        case &quot;æ—¥æœ¬&quot;:</span><br><span class="line">            posdesc = &quot;ã‚ˆã‚ã—ãï¼Œä¸€èµ·å»çœ‹æ¨±èŠ±å—&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case &quot;ç¾å›½&quot;:</span><br><span class="line">            posdesc = &quot;Let us live in peace!&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case &quot;è‹±å›½&quot;:</span><br><span class="line">            posdesc = &quot;æƒ³åŒä½ ä¸€èµ·å¤œä¹˜ä¼¦æ•¦çœ¼&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case &quot;ä¿„ç½—æ–¯&quot;:</span><br><span class="line">            posdesc = &quot;å¹²äº†è¿™ç“¶ä¼ç‰¹åŠ ï¼&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case &quot;æ³•å›½&quot;:</span><br><span class="line">            posdesc = &quot;C&#x27;est La Vie&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case &quot;å¾·å›½&quot;:</span><br><span class="line">            posdesc = &quot;Die Zeit verging im Fluge.&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case &quot;æ¾³å¤§åˆ©äºš&quot;:</span><br><span class="line">            posdesc = &quot;ä¸€èµ·å»å¤§å ¡ç¤å§ï¼&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case &quot;åŠ æ‹¿å¤§&quot;:</span><br><span class="line">            posdesc = &quot;æ‹¾èµ·ä¸€ç‰‡æ«å¶èµ äºˆä½ &quot;;</span><br><span class="line">            break;</span><br><span class="line">        case &quot;ä¸­å›½&quot;:</span><br><span class="line">            pos = ipLocation.data.prov + &quot; &quot; + ipLocation.data.city + &quot; &quot; + ipLocation.data.district;</span><br><span class="line">            switch (ipLocation.data.prov) &#123;</span><br><span class="line">                case &quot;åŒ—äº¬å¸‚&quot;:</span><br><span class="line">                    posdesc = &quot;åŒ—â€”â€”äº¬â€”â€”æ¬¢è¿ä½ ~~~&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;å¤©æ´¥å¸‚&quot;:</span><br><span class="line">                    posdesc = &quot;è®²æ®µç›¸å£°å§&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;æ²³åŒ—çœ&quot;:</span><br><span class="line">                    posdesc = &quot;å±±åŠ¿å·å·æˆå£å’ï¼Œå¤©ä¸‹é›„å…³é“é©¬é‡‘æˆˆç”±æ­¤å‘ï¼Œæ— é™æ±Ÿå±±&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;å±±è¥¿çœ&quot;:</span><br><span class="line">                    posdesc = &quot;å±•å¼€åå…·é•¿ä¸‰å°ºï¼Œå·²å å±±æ²³äº”ç™¾ä½™&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;å†…è’™å¤è‡ªæ²»åŒº&quot;:</span><br><span class="line">                    posdesc = &quot;å¤©è‹è‹ï¼Œé‡èŒ«èŒ«ï¼Œé£å¹è‰ä½è§ç‰›ç¾Š&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;è¾½å®çœ&quot;:</span><br><span class="line">                    posdesc = &quot;æˆ‘æƒ³åƒçƒ¤é¸¡æ¶ï¼&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;å‰æ—çœ&quot;:</span><br><span class="line">                    posdesc = &quot;çŠ¶å…ƒé˜å°±æ˜¯ä¸œåŒ—çƒ§çƒ¤ä¹‹ç‹&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;é»‘é¾™æ±Ÿçœ&quot;:</span><br><span class="line">                    posdesc = &quot;å¾ˆå–œæ¬¢å“ˆå°”æ»¨å¤§å‰§é™¢&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;ä¸Šæµ·å¸‚&quot;:</span><br><span class="line">                    posdesc = &quot;ä¼—æ‰€å‘¨çŸ¥ï¼Œä¸­å›½åªæœ‰ä¸¤ä¸ªåŸå¸‚&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;æ±Ÿè‹çœ&quot;:</span><br><span class="line">                    switch (ipLocation.data.city) &#123;</span><br><span class="line">                        case &quot;å—äº¬å¸‚&quot;:</span><br><span class="line">                            posdesc = &quot;è¿™æ˜¯æˆ‘æŒºæƒ³å»çš„åŸå¸‚å•¦&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                        case &quot;è‹å·å¸‚&quot;:</span><br><span class="line">                            posdesc = &quot;ä¸Šæœ‰å¤©å ‚ï¼Œä¸‹æœ‰è‹æ­&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                        default:</span><br><span class="line">                            posdesc = &quot;æ•£è£…æ˜¯å¿…é¡»è¦æ•£è£…çš„&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;æµ™æ±Ÿçœ&quot;:</span><br><span class="line">                    switch (ipLocation.data.city) &#123;</span><br><span class="line">                        case &quot;æ­å·å¸‚&quot;:</span><br><span class="line">                            posdesc = &quot;ä¸œé£æ¸ç»¿è¥¿æ¹–æŸ³ï¼Œé›å·²è¿˜äººæœªå—å½’&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                        default:</span><br><span class="line">                            posdesc = &quot;æœ›æµ·æ¥¼æ˜ç…§æ›™éœ,æŠ¤æ±Ÿå ¤ç™½è¹‹æ™´æ²™&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;æ²³å—çœ&quot;:</span><br><span class="line">                    switch (ipLocation.data.city) &#123;</span><br><span class="line">                        case &quot;éƒ‘å·å¸‚&quot;:</span><br><span class="line">                            posdesc = &quot;è±«å·ä¹‹åŸŸï¼Œå¤©åœ°ä¹‹ä¸­&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                        case &quot;ä¿¡é˜³å¸‚&quot;:</span><br><span class="line">                            posdesc = &quot;å“ä¿¡é˜³æ¯›å°–ï¼Œæ‚Ÿäººé—´èŠ³å&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                        case &quot;å—é˜³å¸‚&quot;:</span><br><span class="line">                            posdesc = &quot;è‡£æœ¬å¸ƒè¡£ï¼Œèº¬è€•äºå—é˜³æ­¤å—é˜³éå½¼å—é˜³ï¼&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                        case &quot;é©»é©¬åº—å¸‚&quot;:</span><br><span class="line">                            posdesc = &quot;å³°å³°æœ‰å¥‡çŸ³ï¼ŒçŸ³çŸ³æŒŸä»™æ°”åµ–å²ˆå±±çš„èŠ±å¾ˆç¾å“¦ï¼&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                        case &quot;å¼€å°å¸‚&quot;:</span><br><span class="line">                            posdesc = &quot;åˆšæ­£ä¸é˜¿åŒ…é’å¤©&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                        case &quot;æ´›é˜³å¸‚&quot;:</span><br><span class="line">                            posdesc = &quot;æ´›é˜³ç‰¡ä¸¹ç”²å¤©ä¸‹&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                        default:</span><br><span class="line">                            posdesc = &quot;å¯å¦å¸¦æˆ‘å“å°æ²³å—çƒ©é¢å•¦ï¼Ÿ&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;å®‰å¾½çœ&quot;:</span><br><span class="line">                    posdesc = &quot;èšŒåŸ ä½äº†ï¼ŒèŠœæ¹–èµ·é£&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;ç¦å»ºçœ&quot;:</span><br><span class="line">                    posdesc = &quot;äº•é‚‘ç™½äº‘é—´ï¼Œå²©åŸè¿œå¸¦å±±&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;æ±Ÿè¥¿çœ&quot;:</span><br><span class="line">                    posdesc = &quot;è½éœä¸å­¤é¹œé½é£ï¼Œç§‹æ°´å…±é•¿å¤©ä¸€è‰²&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;å±±ä¸œçœ&quot;:</span><br><span class="line">                    posdesc = &quot;é¥æœ›é½å·ä¹ç‚¹çƒŸï¼Œä¸€æ³“æµ·æ°´æ¯ä¸­æ³»&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;æ¹–åŒ—çœ&quot;:</span><br><span class="line">                    switch (ipLocation.data.city) &#123;</span><br><span class="line">                        case &quot;é»„å†ˆå¸‚&quot;:</span><br><span class="line">                            posdesc = &quot;çº¢å®‰å°†å†›å¿ï¼è¾ˆå‡ºå°†æ‰ï¼&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                        default:</span><br><span class="line">                            posdesc = &quot;æ¥ç¢—çƒ­å¹²é¢~&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;æ¹–å—çœ&quot;:</span><br><span class="line">                    switch (ipLocation.data.city) &#123;</span><br><span class="line">                        case &quot;è¡¡é˜³å¸‚&quot;:</span><br><span class="line">                            posdesc = &quot;è€ä¹¡è§è€ä¹¡ï¼Œä¸¤çœ¼æ³ªæ±ªæ±ª&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                        case &quot;é•¿æ²™å¸‚&quot;:</span><br><span class="line">                            posdesc = &quot;74751ï¼Œé•¿æ²™æ–¯å¡”å…‹&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;å¹¿ä¸œçœ&quot;:</span><br><span class="line">                    switch (ipLocation.data.city) &#123;</span><br><span class="line">                        case &quot;å¹¿å·å¸‚&quot;:</span><br><span class="line">                            posdesc = &quot;çœ‹å°è›®è…°ï¼Œå–æ—©èŒ¶äº†å˜›~&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                        case &quot;æ·±åœ³å¸‚&quot;:</span><br><span class="line">                            posdesc = &quot;ä»Šå¤©ä½ é€›å•†åœºäº†å˜›~&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                        case &quot;é˜³æ±Ÿå¸‚&quot;:</span><br><span class="line">                            posdesc = &quot;é˜³æ˜¥åˆæ°´ï¼åšä¸»å®¶ä¹¡~ æ¬¢è¿æ¥ç©~&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                        default:</span><br><span class="line">                            posdesc = &quot;æˆ‘ä»¬éƒ½æ˜¯åœ°çƒäºº~&quot;;</span><br><span class="line">                            break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;å¹¿è¥¿å£®æ—è‡ªæ²»åŒº&quot;:</span><br><span class="line">                    posdesc = &quot;æ¡‚æ—å±±æ°´ç”²å¤©ä¸‹&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;æµ·å—çœ&quot;:</span><br><span class="line">                    posdesc = &quot;æœè§‚æ—¥å‡ºé€ç™½æµªï¼Œå¤•çœ‹äº‘èµ·æ”¶éœå…‰&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;å››å·çœ&quot;:</span><br><span class="line">                    posdesc = &quot;åº·åº·å·å¦¹å­&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;è´µå·çœ&quot;:</span><br><span class="line">                    posdesc = &quot;èŒ…å°ï¼Œå­¦ç”Ÿï¼Œå†å¡200&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;äº‘å—çœ&quot;:</span><br><span class="line">                    posdesc = &quot;ç‰é¾™é£èˆäº‘ç¼ ç»•ï¼Œä¸‡ä»å†°å·ç›´è€¸å¤©&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;è¥¿è—è‡ªæ²»åŒº&quot;:</span><br><span class="line">                    posdesc = &quot;èººåœ¨èŒ«èŒ«è‰åŸä¸Šï¼Œä»°æœ›è“å¤©&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;é™•è¥¿çœ&quot;:</span><br><span class="line">                    posdesc = &quot;æ¥ä»½è‡Šå­é¢åŠ é¦&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;ç”˜è‚ƒçœ&quot;:</span><br><span class="line">                    posdesc = &quot;ç¾Œç¬›ä½•é¡»æ€¨æ¨æŸ³ï¼Œæ˜¥é£ä¸åº¦ç‰é—¨å…³&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;é’æµ·çœ&quot;:</span><br><span class="line">                    posdesc = &quot;ç‰›è‚‰å¹²å’Œè€é…¸å¥¶éƒ½å¥½å¥½åƒ&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;å®å¤å›æ—è‡ªæ²»åŒº&quot;:</span><br><span class="line">                    posdesc = &quot;å¤§æ¼ å­¤çƒŸç›´ï¼Œé•¿æ²³è½æ—¥åœ†&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº&quot;:</span><br><span class="line">                    posdesc = &quot;é©¼é“ƒå¤é“ä¸ç»¸è·¯ï¼Œèƒ¡é©¬çŠ¹é—»å”æ±‰é£&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;å°æ¹¾çœ&quot;:</span><br><span class="line">                    posdesc = &quot;æˆ‘åœ¨è¿™å¤´ï¼Œå¤§é™†åœ¨é‚£å¤´&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒº&quot;:</span><br><span class="line">                    posdesc = &quot;æ°¸å®šè´¼æœ‰æ®‹ç•™åœ°é¬¼åšï¼Œè¿å‡»å…‰éå²ç‰&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒº&quot;:</span><br><span class="line">                    posdesc = &quot;æ€§æ„Ÿè·å®˜ï¼Œåœ¨çº¿å‘ç‰Œ&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                default:</span><br><span class="line">                    posdesc = &quot;å¸¦æˆ‘å»ä½ çš„åŸå¸‚é€›é€›å§ï¼&quot;;</span><br><span class="line">                    break;</span><br><span class="line">            &#125;</span><br><span class="line">            break;</span><br><span class="line">        default:</span><br><span class="line">            posdesc = &quot;å¸¦æˆ‘å»ä½ çš„å›½å®¶é€›é€›å§&quot;;</span><br><span class="line">            break;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // æ ¹æ®æœ¬åœ°æ—¶é—´åˆ‡æ¢æ¬¢è¿è¯­</span><br><span class="line">    let timeChange;</span><br><span class="line">    let date = new Date();</span><br><span class="line">    if (date.getHours() &gt;= 5 &amp;&amp; date.getHours() &lt; 11) timeChange = &quot;&lt;span&gt;ğŸŒ¤ï¸ æ—©ä¸Šå¥½ï¼Œä¸€æ—¥ä¹‹è®¡åœ¨äºæ™¨&lt;/span&gt;&quot;;</span><br><span class="line">    else if (date.getHours() &gt;= 11 &amp;&amp; date.getHours() &lt; 13) timeChange = &quot;&lt;span&gt;â˜€ï¸ ä¸­åˆå¥½ï¼Œè®°å¾—åˆä¼‘å–”~&lt;/span&gt;&quot;;</span><br><span class="line">    else if (date.getHours() &gt;= 13 &amp;&amp; date.getHours() &lt; 17) timeChange = &quot;&lt;span&gt;ğŸ• ä¸‹åˆå¥½ï¼Œé¥®èŒ¶å…ˆå•¦ï¼&lt;/span&gt;&quot;;</span><br><span class="line">    else if (date.getHours() &gt;= 17 &amp;&amp; date.getHours() &lt; 19) timeChange = &quot;&lt;span&gt;ğŸš¶â€â™‚ï¸ å³å°†ä¸‹ç­ï¼Œè®°å¾—æŒ‰æ—¶åƒé¥­~&lt;/span&gt;&quot;;</span><br><span class="line">    else if (date.getHours() &gt;= 19 &amp;&amp; date.getHours() &lt; 24) timeChange = &quot;&lt;span&gt;ğŸŒ™ æ™šä¸Šå¥½ï¼Œå¤œç”Ÿæ´»å—¨èµ·æ¥ï¼&lt;/span&gt;&quot;;</span><br><span class="line">    else timeChange = &quot;å¤œæ·±äº†ï¼Œæ—©ç‚¹ä¼‘æ¯ï¼Œå°‘ç†¬å¤œ&quot;;</span><br><span class="line"></span><br><span class="line">    let welcomeInfoElement = document.getElementById(&quot;welcome-info&quot;);</span><br><span class="line"></span><br><span class="line">    if (welcomeInfoElement) &#123;</span><br><span class="line">        welcomeInfoElement.innerHTML =</span><br><span class="line">            `ğŸ‰æ¬¢è¿ï¼ï¼ï¼â”(*ï½€âˆ€Â´*)ãƒäº»!&lt;b&gt;&lt;span style=&quot;color: var(--tags-blue-color)&quot;&gt; &lt;br&gt;$&#123;pos&#125;&lt;/span&gt;&lt;/b&gt;</span><br><span class="line">             &lt;br&gt;çš„å¤§ç¥ğŸ‘€&lt;br&gt;æ‚¨çš„IPï¼š&lt;b&gt;&lt;span class=&quot;blur-text&quot; style=&quot;color: var(--tags-blue-color)&quot;&gt;$&#123;ip&#125;&lt;/span&gt;&lt;/b&gt;</span><br><span class="line">             &lt;br&gt;å½“å‰ä½ç½®è·åšä¸»çº¦ &lt;b&gt;&lt;span class=&quot;blur-text&quot; style=&quot;color: var(--anzhiyu-main)&quot;&gt;$&#123;dist.toFixed(2)&#125;&lt;/span&gt;&lt;/b&gt; å…¬é‡Œï¼</span><br><span class="line">             &lt;br&gt;$&#123;timeChange&#125;&lt;br&gt;Tipï¼š&lt;b&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;$&#123;posdesc&#125;&lt;/span&gt;&lt;/b&gt;`;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        console.log(&quot;Pjaxæ— æ³•è·å–å…ƒç´ &quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Pjaxå®Œæˆé¡µé¢åˆ‡æ¢çš„äº‹ä»¶å›è°ƒå¤„ç†</span><br><span class="line">function handlePjaxComplete() &#123;</span><br><span class="line">    if (isHomePage()) &#123;</span><br><span class="line">        if (ipLocation &amp;&amp; ipLocation.data) &#123;</span><br><span class="line">            showWelcome();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function isHomePage() &#123;</span><br><span class="line">    return window.location.pathname === &#x27;/&#x27; || window.location.pathname === &#x27;/index.html&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// æ·»åŠ pjax:completeäº‹ä»¶ç›‘å¬</span><br><span class="line">window.onload = function () &#123;</span><br><span class="line">    if (isHomePage()) &#123;</span><br><span class="line">        if (ipLocation &amp;&amp; ipLocation.data) &#123;</span><br><span class="line">            showWelcome();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    document.addEventListener(&quot;pjax:complete&quot;, handlePjaxComplete);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="ä¿¡æ¯å¡ç‰‡"><a href="#ä¿¡æ¯å¡ç‰‡" class="headerlink" title="ä¿¡æ¯å¡ç‰‡"></a>ä¿¡æ¯å¡ç‰‡</h2><details class="folding-tag" cyan close><summary> å…·ä½“æ­¥éª¤ </summary>              <div class='content'>              <p><a href="https://www.fomal.cc/posts/d739261b.html">åšå®¢é­”æ”¹æ•™ç¨‹æ€»ç»“(å››) | FomalhautğŸ¥</a></p><p>ä¿®æ”¹<code>[BlogRoot]\themes\butterfly\layout\includes\widget\card_author.pug</code></p>              </div>            </details><h1 id="å¯¼èˆªæ ç¾åŒ–"><a href="#å¯¼èˆªæ ç¾åŒ–" class="headerlink" title="å¯¼èˆªæ ç¾åŒ–"></a>å¯¼èˆªæ ç¾åŒ–</h1><details class="folding-tag" cyan close><summary> å…·ä½“æ­¥éª¤ </summary>              <div class='content'>              <p>[root]\themes\butterfly\layout\includes\header\nav.pug æ–‡ä»¶ä¸­ä¸‹æ–¹ä»£ç æ ‡å‡ºæ¥çš„å†…å®¹ï¼Œå»æ‰åŠ å·å³ä¸ºæ­£å¸¸ç¼©è¿›ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">nav#nav</span><br><span class="line">  span#blog-info</span><br><span class="line">    a.nav-site-title(href=url_for(&#x27;/&#x27;) title=config.title)</span><br><span class="line">      if theme.nav.logo</span><br><span class="line">        img.site-icon(src=url_for(theme.nav.logo))</span><br><span class="line">      if theme.nav.display_title</span><br><span class="line">        span.site-name=config.title</span><br><span class="line">    </span><br><span class="line">  #menus</span><br><span class="line">    if theme.menu</span><br><span class="line">      != partial(&#x27;includes/header/menu_item&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line"></span><br><span class="line">  div#name-container</span><br><span class="line">    a(id=&quot;page-name&quot; href=&quot;javascript:btf.scrollToDest(0, 500)&quot;) PAGE_NAME</span><br><span class="line"></span><br><span class="line">  #nav-right</span><br><span class="line">    #travellings</span><br><span class="line">      a.site-page(href=url_for(&#x27;https://www.travellings.cn/go.html&#x27;) title=&quot;å‹é“¾æ¥åŠ›-éšæœºå¼€å¾€&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;)</span><br><span class="line">        i.fa-solid.fa-bus.fa-fw</span><br><span class="line">    </span><br><span class="line">    #ten-years</span><br><span class="line">      a.site-page(href=url_for(&#x27;https://foreverblog.cn/go.html&#x27;) title=&quot;å‹é“¾æ¥åŠ›-åå¹´ä¹‹çº¦&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;)</span><br><span class="line">        i.fa-brands.fa-nfc-symbol.fa-fw</span><br><span class="line">        </span><br><span class="line">    #random</span><br><span class="line">      a.site-page(href=&quot;javascript:toRandomPost()&quot; title=&quot;éšæœºå‰å¾€ä¸€ä¸ªæ–‡ç« &quot;)</span><br><span class="line">        i.fa-solid.fa-shuffle.fa-fw</span><br><span class="line">        </span><br><span class="line">    if theme.search.use</span><br><span class="line">      #search-button</span><br><span class="line">        a.site-page.social-icon.search(href=&quot;javascript:void(0);&quot; title=&quot;ç«™å†…æœç´¢&quot;)</span><br><span class="line">          i.fas.fa-search.fa-fw</span><br><span class="line"></span><br><span class="line">    #toggle-menu</span><br><span class="line">      a.site-page(href=&quot;javascript:void(0);&quot; title=&quot;å±•å¼€èœå•&quot;)</span><br><span class="line">        i.fas.fa-bars.fa-fw</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¥ç€ï¼Œæ·»åŠ è‡ªå®šä¹‰ JavaScript è„šæœ¬ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">document.addEventListener(&#x27;pjax:complete&#x27;, tonav);</span><br><span class="line">document.addEventListener(&#x27;DOMContentLoaded&#x27;, tonav);</span><br><span class="line"></span><br><span class="line">function tonav() &#123;</span><br><span class="line">    var nameContainer = document.querySelector(&quot;#nav #name-container&quot;);</span><br><span class="line">    var menusItems = document.querySelector(&quot;#nav .menus_items&quot;);</span><br><span class="line">    </span><br><span class="line">    // å¦‚æœæ‰¾ä¸åˆ°å…ƒç´ ï¼Œç›´æ¥è¿”å›</span><br><span class="line">    if (!nameContainer || !menusItems) return;</span><br><span class="line">    </span><br><span class="line">    // ä½¿ç”¨ requestAnimationFrame ä¼˜åŒ–æ€§èƒ½</span><br><span class="line">    var position = window.scrollY;</span><br><span class="line">    var ticking = false;</span><br><span class="line"></span><br><span class="line">    window.addEventListener(&#x27;scroll&#x27;, function() &#123;</span><br><span class="line">        if (!ticking) &#123;</span><br><span class="line">            window.requestAnimationFrame(function() &#123;</span><br><span class="line">                var scroll = window.scrollY;</span><br><span class="line"></span><br><span class="line">                if (scroll &gt; position + 5) &#123;</span><br><span class="line">                    // å‘ä¸‹æ»šåŠ¨</span><br><span class="line">                    nameContainer.classList.add(&quot;visible&quot;);</span><br><span class="line">                    menusItems.classList.remove(&quot;visible&quot;);</span><br><span class="line">                &#125; else if (scroll &lt; position - 5) &#123;</span><br><span class="line">                    // å‘ä¸Šæ»šåŠ¨</span><br><span class="line">                    nameContainer.classList.remove(&quot;visible&quot;);</span><br><span class="line">                    menusItems.classList.add(&quot;visible&quot;);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                position = scroll;</span><br><span class="line">                ticking = false;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            ticking = true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    // åˆå§‹åŒ– page-name</span><br><span class="line">    var pageName = document.getElementById(&quot;page-name&quot;);</span><br><span class="line">    if (pageName) &#123;</span><br><span class="line">        // è·å–æ ‡é¢˜å¹¶å»é™¤åç¼€</span><br><span class="line">        var title = document.title;</span><br><span class="line">        var separator = &quot; | &quot;; // æ ¹æ®å®é™…æ ‡é¢˜åˆ†éš”ç¬¦è°ƒæ•´</span><br><span class="line">        if (title.includes(separator)) &#123;</span><br><span class="line">            pageName.innerText = title.split(separator)[0];</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            pageName.innerText = title;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‰ç½®å·¥ä½œæ·»åŠ å¥½äº†ï¼Œä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹å®ç°æ ¸å¿ƒçš„ç¾åŒ–éƒ¨åˆ†ï¼Œæ·»åŠ CSSã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br></pre></td><td class="code"><pre><span class="line">/* å¯¼èˆªæ åŸºç¡€å¸ƒå±€ */</span><br><span class="line">#nav-right&#123;</span><br><span class="line">    flex:1;</span><br><span class="line">    justify-content: flex-end;</span><br><span class="line">    margin-left: auto;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-wrap:nowrap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#nav.show &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#nav .site-page &#123;</span><br><span class="line">    padding-bottom: 14px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#page-header.not-top-img #nav &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#nav-group &#123;</span><br><span class="line">    width: 1400px;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    padding: 0 0.6rem;</span><br><span class="line">    margin-left: auto;</span><br><span class="line">    margin-right: auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* é¡¶éƒ¨æ å®½åº¦å®šä¹‰ */</span><br><span class="line">/* ä¿®å¤ï¼šç§»é™¤è¿™é‡Œçš„ margin-topï¼Œé˜²æ­¢è¦†ç›–åç»­çš„æ ·å¼ */</span><br><span class="line">#nav .menus_items .menus_item .menus_item_child &#123;</span><br><span class="line">    margin-top: 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#nav .menus_items .menus_item .menus_item_child li a &#123;</span><br><span class="line">    padding-top: 6px; </span><br><span class="line">    padding-right: 18px; </span><br><span class="line">    padding-bottom: 6px; </span><br><span class="line">    padding-left: 15px; </span><br><span class="line">    text-align: center;</span><br><span class="line">&#125;</span><br><span class="line">#nav #travellings &#123;</span><br><span class="line">    padding: 0 14px 0 ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#nav #ten-years &#123;</span><br><span class="line">    padding: 0 14px 0 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* ç§»åŠ¨ç«¯èœå•é€»è¾‘ï¼ˆå¦‚æœä¸»é¢˜æœ‰ç§»åŠ¨ç«¯èœå•ï¼Œè¿™é‡Œä¸»è¦å¤„ç†æ¡Œé¢ç«¯ï¼‰ */</span><br><span class="line">@media (max-width: 768px) &#123;</span><br><span class="line">    #nav #page-name &#123;</span><br><span class="line">        display: none;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* ===========================================</span><br><span class="line">   æ ¸å¿ƒåŠ¨ç”»ä¸äº¤äº’é€»è¾‘</span><br><span class="line">   =========================================== */</span><br><span class="line"></span><br><span class="line">/* é»˜è®¤çŠ¶æ€ï¼šéšè— */</span><br><span class="line">#nav #name-container &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    left: 50%;</span><br><span class="line">    transform: translate(-50%, -100%); /* å‘ä¸Šåç§» */</span><br><span class="line">    opacity: 0;</span><br><span class="line">    pointer-events: none;</span><br><span class="line">    transition: all 0.3s ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#nav .menus_items &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    width: fit-content;</span><br><span class="line">    left: 50%;</span><br><span class="line">    top: 50%;</span><br><span class="line">    transform: translate(-50%, -100%); /* å‘ä¸Šåç§» */</span><br><span class="line">    opacity: 0;</span><br><span class="line">    pointer-events: none;</span><br><span class="line">    transition: all 0.3s ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* æ˜¾ç¤ºçŠ¶æ€ï¼šå±…ä¸­å¯è§ */</span><br><span class="line">#nav #name-container.visible &#123;</span><br><span class="line">    opacity: 1;</span><br><span class="line">    transform: translate(-50%, -50%);</span><br><span class="line">    pointer-events: auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#nav .menus_items.visible &#123;</span><br><span class="line">    opacity: 1;</span><br><span class="line">    transform: translate(-50%, -50%);</span><br><span class="line">    pointer-events: auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/* ===========================================</span><br><span class="line">   å¯¼èˆªæ æ ·å¼ä¼˜åŒ– (æ¡Œé¢ç«¯)</span><br><span class="line">   =========================================== */</span><br><span class="line">@media (min-width: 768px) &#123;</span><br><span class="line">  </span><br><span class="line">  /* èœå•å±…ä¸­å¸ƒå±€è¡¥å…… */</span><br><span class="line">  #nav .menus_items &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">    margin: 0;</span><br><span class="line">    padding: 0;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /* èœå•é¡¹æ ·å¼ */</span><br><span class="line">  #nav .menus_items .menus_item &#123;</span><br><span class="line">    font-size: 1.2em; </span><br><span class="line">    font-weight: bold;</span><br><span class="line">    margin: 0 5px;</span><br><span class="line">    padding: 5px 10px;</span><br><span class="line">    border-radius: 8px;</span><br><span class="line">    transition: all 0.3s ease;</span><br><span class="line">    flex-shrink: 0;</span><br><span class="line">    white-space: nowrap;</span><br><span class="line">    position: relative;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /* ä¿®å¤ï¼šå¢åŠ é€æ˜æ¡¥æ¢è¿æ¥çˆ¶å­èœå•ï¼Œé˜²æ­¢é¼ æ ‡ç§»å‡ºæ—¶èœå•æ¶ˆå¤± */</span><br><span class="line">  #nav .menus_items .menus_item::after &#123;</span><br><span class="line">    content: &#x27;&#x27;;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 100%;</span><br><span class="line">    left: 0;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 20px; /* è¦†ç›–å­èœå•çš„ margin-top */</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /* æ‚¬åœæ•ˆæœ */</span><br><span class="line">  #nav .menus_items .menus_item:hover &#123;</span><br><span class="line">    background: rgba(0, 0, 0, 0.05);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  [data-theme=&quot;dark&quot;] #nav .menus_items .menus_item:hover &#123;</span><br><span class="line">    background: rgba(255, 255, 255, 0.1);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /* å­èœå•å®¹å™¨ä¼˜åŒ– - å¢åŠ  #nav æé«˜æƒé‡ */</span><br><span class="line">  #nav .menus_items .menus_item .menus_item_child &#123;</span><br><span class="line">    display: none; /* é»˜è®¤éšè— */</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 100%;</span><br><span class="line">    left: 50%;</span><br><span class="line">    transform: translateX(-50%); /* ç¡®ä¿å±…ä¸­ */</span><br><span class="line">    white-space: nowrap;</span><br><span class="line">    </span><br><span class="line">    background: rgba(255, 255, 255, 0.95);</span><br><span class="line">    border-radius: 20px;</span><br><span class="line">    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);</span><br><span class="line">    padding: 5px;</span><br><span class="line">    margin-top: 10px; /* è¿™é‡Œé‡æ–°å®šä¹‰ margin-top */</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    </span><br><span class="line">    /* åŠ¨ç”» */</span><br><span class="line">    animation: subMenuSlide 0.3s ease forwards;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /* hoveræ˜¾ç¤ºå­èœå• */</span><br><span class="line">  #nav .menus_items .menus_item:hover .menus_item_child &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-direction: row;</span><br><span class="line">    gap: 5px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /* æ·±è‰²æ¨¡å¼å­èœå• */</span><br><span class="line">  [data-theme=&quot;dark&quot;] #nav .menus_items .menus_item .menus_item_child &#123;</span><br><span class="line">    background: rgba(40, 40, 40, 0.95);</span><br><span class="line">    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  /* å­èœå•é¡¹æ ·å¼ */</span><br><span class="line">  #nav .menus_items .menus_item .menus_item_child li &#123;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    margin: 0 2px;</span><br><span class="line">    border-radius: 5px;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  #nav .menus_items .menus_item .menus_item_child li a &#123;</span><br><span class="line">    display: block;</span><br><span class="line">    padding: 5px 10px;</span><br><span class="line">    border-radius: 5px;</span><br><span class="line">    transition: background 0.2s;</span><br><span class="line">    color: var(--font-color);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  #nav .menus_items .menus_item .menus_item_child li a:hover &#123;</span><br><span class="line">    background: rgba(0, 0, 0, 0.05);</span><br><span class="line">    color: var(--theme-color);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  [data-theme=&quot;dark&quot;] #nav .menus_items .menus_item .menus_item_child li a:hover &#123;</span><br><span class="line">    background: rgba(255, 255, 255, 0.1);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* æ ‡é¢˜æ ·å¼ */</span><br><span class="line">#nav #page-name &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    padding: 10px 30px;</span><br><span class="line">    font-weight: bold;</span><br><span class="line">    white-space: nowrap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* å›åˆ°é¡¶éƒ¨ æ‚¬åœæ•ˆæœ */</span><br><span class="line">#nav #page-name::before &#123;</span><br><span class="line">    font-size: 18px;</span><br><span class="line">    position: absolute;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 100%;</span><br><span class="line">    border-radius: 12px;</span><br><span class="line">    color: #4C4948;</span><br><span class="line">    top: 0;</span><br><span class="line">    left: 0;</span><br><span class="line">    content: &#x27;å›åˆ°é¡¶éƒ¨&#x27;;</span><br><span class="line">    background-color: #ffffff;</span><br><span class="line">    transition: all 0.3s;</span><br><span class="line">    opacity: 0;</span><br><span class="line">    line-height: 45px;</span><br><span class="line">    border: 1px solid #4C4948;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[data-theme=dark] #nav #page-name::before &#123;</span><br><span class="line">    color: #B9BABB;</span><br><span class="line">    background-color: #000000;</span><br><span class="line">    border: 1px solid #B9BABB;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#nav #page-name:hover:before &#123;</span><br><span class="line">    opacity: 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* Logoå’Œæ–‡å­—ä¼˜åŒ– */</span><br><span class="line">#blog-info .site-name &#123;</span><br><span class="line">  font-weight: bold;</span><br><span class="line">  letter-spacing: 1px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* éšè—å¯¼èˆªæ ä¸‹æ‹‰ç®­å¤´ */</span><br><span class="line">#nav .menus_items .menus_item .fa-chevron-down &#123;</span><br><span class="line">  display: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* éšæœºæ–‡ç« æŒ‰é’®æ ·å¼ */</span><br><span class="line">#randomPost_button &#123;</span><br><span class="line">  display: inline-block;</span><br><span class="line">  padding: 0 0 0 14px;</span><br><span class="line">  vertical-align: middle;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* å­èœå•åŠ¨ç”»å®šä¹‰ */</span><br><span class="line">@keyframes subMenuSlide &#123;</span><br><span class="line">  0% &#123;</span><br><span class="line">    opacity: 0;</span><br><span class="line">    transform: translateX(-50%) translateY(10px);</span><br><span class="line">  &#125;</span><br><span class="line">  100% &#123;</span><br><span class="line">    opacity: 1;</span><br><span class="line">    transform: translateX(-50%) translateY(0);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a.site-page.child &#123;</span><br><span class="line">  border-radius: 4px;</span><br><span class="line">  padding: 5px 10px !important;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰“å¼€ [root]\themes\butterfly\layout\includes\headerï¼Œå¹¶ä¿®æ”¹ menu_item.pug æ–‡ä»¶ä¸­çš„ç¬¬äºŒè¡Œå†…å®¹ï¼Œç¡®ä¿åœ¨ç”Ÿæˆé¡µé¢æ—¶æå‰æ·»åŠ  visible æ ‡ç­¾ï¼Œä»¥é˜²æ­¢åˆ·æ–°åè¢«éšè—ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">if theme.menu</span><br><span class="line">+  .menus_items.visible</span><br><span class="line">-  .menus_items</span><br><span class="line">    each value, label in theme.menu</span><br><span class="line">      if typeof value !== &#x27;object&#x27;</span><br><span class="line">        .menus_item</span><br><span class="line">          - const valueArray = value.split(&#x27;||&#x27;)</span><br><span class="line">          a.site-page(href=url_for(trim(valueArray[0])))</span><br><span class="line">            if valueArray[1]</span><br><span class="line">              i.fa-fw(class=trim(valueArray[1]))</span><br><span class="line">            span=&#x27; &#x27;+label</span><br><span class="line">      else</span><br><span class="line">        .menus_item</span><br><span class="line">          - const labelArray = label.split(&#x27;||&#x27;)</span><br><span class="line">          - const hideClass = labelArray[2] &amp;&amp; trim(labelArray[2]) === &#x27;hide&#x27; ? &#x27;hide&#x27; : &#x27;&#x27;</span><br><span class="line">          a.site-page.group(class=`$&#123;hideClass&#125;` href=&#x27;javascript:void(0);&#x27;)</span><br><span class="line">            if labelArray[1]</span><br><span class="line">              i.fa-fw(class=trim(labelArray[1]))</span><br><span class="line">            span=&#x27; &#x27;+ trim(labelArray[0])</span><br><span class="line">            i.fas.fa-chevron-down</span><br><span class="line">          ul.menus_item_child</span><br><span class="line">            each val,lab in value </span><br><span class="line">              - const valArray = val.split(&#x27;||&#x27;)</span><br><span class="line">              li</span><br><span class="line">                a.site-page.child(href=url_for(trim(valArray[0])))</span><br><span class="line">                  if valArray[1]</span><br><span class="line">                    i.fa-fw(class=trim(valArray[1]))</span><br><span class="line">                  span=&#x27; &#x27;+ lab</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><h1 id="è¯„è®º"><a href="#è¯„è®º" class="headerlink" title="è¯„è®º"></a>è¯„è®º</h1><p>Twikooè¯„è®º</p><details class="folding-tag" cyan close><summary> å…·ä½“æ­¥éª¤ </summary>              <div class='content'>              <ul><li><p>æ­å»º</p><ol><li>æ­å»ºï¼Œæœ¬åšå®¢çš„è¯„è®ºç³»ç»Ÿä¸»è¦é€šè¿‡verceléƒ¨ç½²ã€‚å…·ä½“å¯å‚ç…§<a href="https://twikoo.js.org/intro.html">Twikoo æ–‡æ¡£</a></li><li>éƒ¨ç½²å®Œæˆåä¿®æ”¹<code>_config.butterfly.yml</code>ä¸­çš„<code>comment</code>å’Œ<code>twikoo</code>é…ç½®é¡¹å³å¯ã€‚å¯å‚è€ƒ<a href="https://butterfly.js.org/posts/4aa8abbe/">Butterfly æ–‡æª”(ä¸‰) ä¸»é¡Œé…ç½® | Butterfly</a>ä¸­çš„è¯„è®ºé…ç½®ã€‚<ul><li>ç¬¬ä¸€æ¬¡è¿›å…¥ç®¡ç†é¢æ¿éœ€è®¾ç½®ç®¡ç†å‘˜ç™»å½•å¯†ç ï¼Œåœ¨ç®¡ç†é¢æ¿ä¸­å¯ç®¡ç†è¯„è®º</li></ul></li></ol></li><li><p>ç¾åŒ–</p><ol><li><p>åœ¨_config.butterfly.ymçš„injectä¸­æ·»åŠ placeholderå‚æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">twikoo:</span><br><span class="line">  envId: https://twikoojs-cyan.vercel.app/</span><br><span class="line">  region:</span><br><span class="line">  # ä½¿ç”¨Twikooè®¿å®¢ç»Ÿè®¡ä½œä¸ºé¡µé¢æµè§ˆé‡</span><br><span class="line">  visitor: false</span><br><span class="line">  option:</span><br><span class="line">    placeholder: &#x27;æ¬¢è¿ç•™è¨€ï¼Œæ”¯æŒMarkdownè¯­æ³•ï¼Œå¿«æ¥è¯„è®ºå§~&#x27;</span><br></pre></td></tr></table></figure></li></ol></li></ul>              </div>            </details><h1 id="å¨±ä¹é¡µ"><a href="#å¨±ä¹é¡µ" class="headerlink" title="å¨±ä¹é¡µ"></a>å¨±ä¹é¡µ</h1><details class="folding-tag" cyan close><summary> å…·ä½“æ­¥éª¤ </summary>              <div class='content'>                            </div>            </details><ul><li>è¿½ç•ªæ¸¸æˆé¡µé¢</li></ul><ol><li><p>æ’ä»¶å®‰è£…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-bilibili-bangumi --save</span><br></pre></td></tr></table></figure></li><li><p>åœ¨<a href="https://bgm.tv/">Bangumi ç•ªç»„è®¡åˆ’</a>ä¸­æ”¶è—ç•ªå‰§æˆ–è€…æ¸¸æˆã€‚ç„¶åæ‰“å¼€æ§åˆ¶å°ï¼ˆ<code>f12</code>ï¼‰ï¼Œè¾“å…¥<code>CHOBITS_UID</code>è·å–ç”¨æˆ·ID.</p></li><li><p>æ·»åŠ é…ç½®ï¼šåœ¨<code>_config.yml</code> ä¸­æ·»åŠ ï¼Œ<code>path</code>ã€<code>vimd</code> ç­‰å‚æ•°æ›¿æ¢ä¸ºè‡ªå·±çš„ï¼Œå…·ä½“é…ç½®å¯å‚è€ƒï¼š<a href="https://github.com/HCLonely/hexo-bilibili-bangumi">hexo-bilibili-bangumi</a></p></li><li><pre><code># hexo-bilibili-bangumi# https://github.com/HCLonely/hexo-bilibili-bangumibangumi: # è¿½ç•ªè®¾ç½®  enable: true           # æ˜¯å¦å¯ç”¨  source: bangumi          # æ•°æ®æº  path: animations/index.html  # é¡µé¢è·¯å¾„  vmid: x1ang                # ç”¨æˆ·ID  title: &#39;è¿½ç•ªåˆ—è¡¨&#39;      # é¡µé¢æ ‡é¢˜  quote: &#39;ä½ æ‰€çƒ­çˆ±çš„ å°±æ˜¯ä½ çš„ç”Ÿæ´»&#39; # é¡µé¢å¼•è¨€  show: 2              # åˆå§‹æ˜¾ç¤ºé¡µé¢: 0=æƒ³çœ‹, 1=åœ¨çœ‹, 2=çœ‹è¿‡  lazyload: true       # æ˜¯å¦å¯ç”¨å›¾ç‰‡æ‡’åŠ è½½  metaColor: &#39;#f2b94b&#39;   # meta ä¿¡æ¯å­—ä½“é¢œè‰²  color: &#39;#6587b5&#39;       # ç®€ä»‹å­—ä½“é¢œè‰²  webp: true          # æ˜¯å¦ä½¿ç”¨ webp æ ¼å¼å›¾ç‰‡  pagination: true  progress: true  progressBar: false  extraOrder: 1  order: &#39;-score&#39;game: # æ¸¸æˆè®¾ç½®ï¼Œä»…æ”¯æŒsource: bgmv0  enable: true  path: games/index.html  source: bgmv0  vmid: x1ang  title: &#39;ä¸€éƒ¨æ¸¸æˆä¸€æ®µäººç”Ÿ&#39;  quote: &#39;è·Œå®•èµ·ä¼çš„æ•…äº‹ï¼Œå¼•äººå…¥èƒœçš„ç©æ³•ï¼Œä½™éŸ³ç»•æ¢çš„æ—‹å¾‹ï¼Œæ²‰æµ¸å¼ä½“éªŒå¦ä¸€æ®µæ—¶ç©º&#39;  show: 2  lazyload: true  metaColor: &#39;#f2b94b&#39;  color: &#39;#99A9BF&#39;  webp: true  pagination: true  progress: true  progressBar: false  extraOrder: 1  order: -score<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">é¡µé¢ç¾åŒ–ï¼šåœ¨ `[BlogRoot]/static/css/custom.css` æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç  (å…·ä½“é¢œè‰²å¯ä»¥è‡ªå·±è°ƒèŠ‚)ï¼š</span><br><span class="line">å‚è€ƒï¼š[butterflyä¸»é¢˜é­”æ”¹ | x1ang](https://www.x1ang.com/2025/09/19/butterflyä¸»é¢˜é­”æ”¹/#è¿½ç•ªé¡µé¢ã€æ¸¸æˆæ¨è)</span><br><span class="line"></span><br></pre></td></tr></table></figure>/* ç•ªå‰§æ’ä»¶ */#page #article-container .bangumi-tab.bangumi-active &#123;  background: #425aef !important;  color: #f7f7fa !important;  border-radius: 10px;&#125;#page #article-container .bangumi-tabs .bangumi-tab &#123;  border-bottom: none;  border-radius: 10px;&#125;#page #article-container .bangumi-tabs a.bangumi-tab:hover &#123;  text-decoration: none !important;  border-radius: 10px;  column-gap: #f7f7fa !important;&#125;#page #article-container .bangumi-pagination a.bangumi-button &#123;  border-bottom: none;  border-radius: 10px;&#125;.bangumi-button:hover &#123;  background: #425aef !important;  border-radius: 10px !important;  color: #f7f7fa !important;&#125;a.bangumi-button.bangumi-nextpage:hover &#123;  text-decoration: none !important;&#125;.bangumi-button &#123;  padding: 5px 10px !important;&#125;a.bangumi-tab &#123;  padding: 5px 10px !important;&#125;svg.icon.faa-tada &#123;  font-size: 1.1em;&#125;.bangumi-info-item &#123;  border-right: 1px solid #f2b94b;&#125;.bangumi-info-item span &#123;  color: #f2b94b;&#125;.bangumi-info-item em &#123;  color: #f2b94b;&#125;<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">5. è·å–æ•°æ®ï¼šå‘½ä»¤è¡Œè¿è¡Œï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure>hexo game -u;hexo bangumi -u;<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Github Action</span><br><span class="line"></span><br><span class="line">éšç€æ–‡ç« è¶Šæ¥è¶Šå¤šï¼Œåœ¨æœ¬åœ°ä½¿ç”¨ `Hexo` éƒ¨ç½²çš„æ—¶é—´ä¹Ÿä¼šè¶Šæ¥è¶Šé•¿ï¼Œå€ŸåŠ© `Github Action`ï¼Œæˆ‘ä»¬åªéœ€å°†ä¿®æ”¹ `push` åˆ°è¿œç¨‹ä»“åº“ï¼Œå°†å·¥ä½œäº¤ç»™ `github` å®Œæˆ</span><br><span class="line"></span><br><span class="line">&#123;% folding cyan close, å…·ä½“æ­¥éª¤ %&#125;</span><br><span class="line"></span><br><span class="line">1. è·å– Token</span><br><span class="line"></span><br><span class="line">   è®¿é—® [`Github-&gt;å¤´åƒ-&gt;Settings-&gt;Developer Settings-&gt;Personal access tokens-&gt;Token(classic)`](https://github.com/settings/tokens)`-&gt;generate new token(classic)`</span><br><span class="line"></span><br><span class="line">   `Token` åç§°éšæ„ï¼Œ`Expiration` é€‰æ‹© `No Expiration`ï¼Œå¿…é¡»å‹¾é€‰ `repo` é¡¹å’Œ `workflows` é¡¹ï¼Œä¿å­˜ç”Ÿæˆçš„ `Token`ã€‚</span><br><span class="line"></span><br><span class="line">   *æ³¨æ„ï¼š`Token` åªä¼šæ˜¾ç¤ºä¸€æ¬¡ï¼Œåç»­æ— æ³•æŸ¥çœ‹ï¼Œå¦‚æœé—å¿˜äº†åªèƒ½é‡æ–°ç”Ÿæˆã€‚*</span><br><span class="line"></span><br><span class="line">2. åˆ›å»ºæºç ä»“åº“ï¼ˆå¦‚æœ‰å¯è·³è¿‡ï¼‰</span><br><span class="line"></span><br><span class="line">   éœ€è¦åˆ›å»ºä¸€ä¸ªç”¨æ¥å­˜æ”¾ `Hexo` åšå®¢æºç çš„ç§æœ‰ä»“åº“ï¼Œåˆ›å»ºå®Œæˆåéœ€è¦ä½¿ç”¨ `git` å°†æœ¬åœ°çš„æºç  `push` åˆ°ä»“åº“ã€‚</span><br><span class="line"></span><br><span class="line">   `git` ä½¿ç”¨æ–¹æ³•è¿™é‡Œä¸å±•å¼€ï¼Œå¯ä»¥å‚è€ƒï¼š[ç®€ä»‹ - Git æ•™ç¨‹ - å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™](https://liaoxuefeng.com/books/git/introduction/index.html)</span><br><span class="line"></span><br><span class="line">   ä½¿ç”¨ `git` æäº¤å‰é…ç½®`.gitignore`ï¼Œé¿å…æŠŠä¸€äº›å¯è‡ªåŠ¨ç”Ÿæˆçš„æ–‡ä»¶ä¸Šä¼ ï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure># Hexo ç”Ÿæˆçš„æ–‡ä»¶public/.deploy_git/db.json# ç¼“å­˜ä¸ä¸´æ—¶æ–‡ä»¶node_modules/tmp/.nyc_output/coverage/dist/npm-debug.log*yarn-debug.log*yarn-error.log*# ç¼–è¾‘å™¨ç›¸å…³.DS_StoreThumbs.db.vscode/.idea/# ç³»ç»Ÿä¸´æ—¶æ–‡ä»¶*.swp*.swo*.tmp*.log<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">3. é…ç½® `Github Action`</span><br><span class="line"></span><br><span class="line">   æ–°å»º `[Blogroot]/.github/workflows/autodeploy.yml` æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure># å½“æœ‰æ”¹åŠ¨æ¨é€åˆ°mainåˆ†æ”¯æ—¶ï¼Œå¯åŠ¨Actionname: è‡ªåŠ¨éƒ¨ç½²on:  push:    branches:      - main  release:    types:      - publishedjobs:  deploy:    runs-on: ubuntu-latest    steps:    - name: æ£€æŸ¥åˆ†æ”¯      uses: actions/checkout@v4      with:        ref: main            - name: å®‰è£… Node      uses: actions/setup-node@v4      with:        node-version: &quot;20.x&quot; # æ›¿æ¢æˆä½ æœ¬åœ°ä½¿ç”¨çš„nodeå¤§ç‰ˆæœ¬ï¼Œç”¨node -væŸ¥çœ‹        cache: &#39;npm&#39; # ä½¿ç”¨ç¼“å­˜ï¼Œç¡®ä¿ä½ çš„package-lock.jsonè¢«æ­£ç¡®ä¸Šä¼             - name: å®‰è£… Hexo      run: |        export TZ=&#39;Asia/Shanghai&#39;        npm install hexo-cli -g            - name: ç¼“å­˜ Hexo      uses: actions/cache@v4      id: cache      with:        path: node_modules        key: $&#123;&#123; runner.OS &#125;&#125;-node-modules-$&#123;&#123; hashFiles('**/package.json') &#125;&#125;        restore-keys: |          $&#123;&#123; runner.OS &#125;&#125;-node-modules-              - name: å®‰è£…ä¾èµ–      if: steps.cache.outputs.cache-hit != &#39;true&#39;      run: |        npm install --prefer-offline --no-audit            - name: ç”Ÿæˆé™æ€æ–‡ä»¶      run: | # æœ‰å…¶ä»–éœ€è¦è¿è¡Œçš„å‘½ä»¤ï¼Œè‡ªè¡Œæ·»åŠ ï¼ˆä¾‹å¦‚glupå‹ç¼©ç­‰ï¼‰        hexo clean        hexo generate            - name: éƒ¨ç½²       run: | # æœ«å°¾main:mainæŒ‡ä»æœ¬åœ°mainåˆ†æ”¯æ¨é€åˆ°è¿œç¨‹mainåˆ†æ”¯ï¼Œæœ¬åœ°åˆ†æ”¯åä¸ç”¨ä¿®æ”¹ï¼Œè¿œç¨‹æ”¹æˆåšå®¢é™æ€æ–‡ä»¶ä»“åº“çš„ä¸»åˆ†æ”¯        cd ./public        git init        git config --global user.name &#39;$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;&#39;        git config --global user.email &#39;$&#123;&#123; secrets.GITHUBEMAIL &#125;&#125;&#39;        git add .        git commit -m &quot;$&#123;&#123; github.event.head_commit.message &#125;&#125; $(date +&quot;%Z %Y-%m-%d %A %H:%M:%S&quot;) Updated By Github Actions&quot;        git branch -M main        git push --force --quiet &quot;https://$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;:$&#123;&#123; secrets.GITHUBTOKEN &#125;&#125;@github.com/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;.github.io.git&quot; main:main <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">4. æ·»åŠ ä»“åº“ç§˜é’¥</span><br><span class="line"></span><br><span class="line">   åˆ°ä½ çš„åšå®¢**æºç **ä»“åº“çš„ `Settings-&gt;Secrets and variables-&gt;Actions` ä¸­æ·»åŠ  `Repository secrets`</span><br><span class="line"></span><br><span class="line">   ç‚¹å‡» `New repository secret`ï¼Œå°† `autodeploy.yml` ä¸­ä½¿ç”¨çš„å‡ ä¸ªç§˜é’¥æ·»åŠ ï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure>GITHUBUSERNAME ï¼šä½ çš„ `github` ç”¨æˆ·åï¼Œä¾‹å¦‚ï¼šæˆ‘çš„åšå®¢é™æ€æ–‡ä»¶ä»“åº“ä¸º `x1angji/x1angji.github.io`ï¼Œåœ¨æ­¤å¤„å¡«å…¥ `x1angji`GITHUBEMAIL ï¼šç”¨äºæ¥æ”¶éƒ¨ç½²ä¿¡æ¯çš„é‚®ç®±GITHUBTOKEN ï¼šç¬¬ä¸€æ­¥è·å–çš„ `Token`<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">5. è‡ªåŠ¨éƒ¨ç½²</span><br><span class="line"></span><br><span class="line">   ä½¿ç”¨ `git` éšæ„æ¨é€ä¸€æ¬¡æäº¤åˆ°`æºç `ä»“åº“</span><br><span class="line"></span><br><span class="line">   æ‰“å¼€æºç ä»“åº“ï¼Œæ‰¾åˆ° `Actions-&gt;è‡ªåŠ¨éƒ¨ç½²`ï¼Œæ ¹æ®æäº¤è®°å½•ç‚¹è¿›åˆšåˆšçš„æäº¤ï¼Œç‚¹å‡» `deploy` å³å¯æŸ¥çœ‹éƒ¨ç½²è¿‡ç¨‹</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># æ–‡ç« ç»Ÿè®¡å›¾</span><br><span class="line"></span><br><span class="line">1. å®‰è£…æ¨¡å—</span><br><span class="line"></span><br></pre></td></tr></table></figure>npm install cheerio --save<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. æ–°å»º `[ThemeRoot]\scripts\helpers\charts.js` æ–‡ä»¶ï¼Œç„¶åæ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure>const cheerio = require(&#39;cheerio&#39;)const moment = require(&#39;moment&#39;)hexo.extend.filter.register(&#39;after_render:html&#39;, function (locals) &#123;  const $ = cheerio.load(locals)  const post = $(&#39;#posts-chart&#39;)  const tag = $(&#39;#tags-chart&#39;)  const category = $(&#39;#categories-chart&#39;)  const htmlEncode = false  if (post.length &gt; 0 || tag.length &gt; 0 || category.length &gt; 0) &#123;    if (post.length &gt; 0 &amp;&amp; $(&#39;#postsChart&#39;).length === 0) &#123;      if (post.attr(&#39;data-encode&#39;) === &#39;true&#39;) htmlEncode = true      post.after(postsChart(post.attr(&#39;data-start&#39;)))    &#125;    if (tag.length &gt; 0 &amp;&amp; $(&#39;#tagsChart&#39;).length === 0) &#123;      if (tag.attr(&#39;data-encode&#39;) === &#39;true&#39;) htmlEncode = true      tag.after(tagsChart(tag.attr(&#39;data-length&#39;)))    &#125;    if (category.length &gt; 0 &amp;&amp; $(&#39;#categoriesChart&#39;).length === 0) &#123;      if (category.attr(&#39;data-encode&#39;) === &#39;true&#39;) htmlEncode = true      category.after(categoriesChart(category.attr(&#39;data-parent&#39;)))    &#125;    if (htmlEncode) &#123;      return $.root().html().replace(/&amp;amp;#/g, &#39;&amp;#&#39;)    &#125; else &#123;      return $.root().html()    &#125;  &#125; else &#123;    return locals  &#125;&#125;, 15)function postsChart (startMonth) &#123;  const startDate = moment(startMonth || &#39;2020-01&#39;)  const endDate = moment()  const monthMap = new Map()  const dayTime = 3600 * 24 * 1000  for (let time = startDate; time &lt;= endDate; time += dayTime) &#123;    const month = moment(time).format(&#39;YYYY-MM&#39;)    if (!monthMap.has(month)) &#123;      monthMap.set(month, 0)    &#125;  &#125;  hexo.locals.get(&#39;posts&#39;).forEach(function (post) &#123;    const month = post.date.format(&#39;YYYY-MM&#39;)    if (monthMap.has(month)) &#123;      monthMap.set(month, monthMap.get(month) + 1)    &#125;  &#125;)  const monthArr = JSON.stringify([...monthMap.keys()])  const monthValueArr = JSON.stringify([...monthMap.values()])  return `  &lt;script id=&quot;postsChart&quot;&gt;    var color = document.documentElement.getAttribute(&#39;data-theme&#39;) === &#39;light&#39; ? &#39;#4c4948&#39; : &#39;rgba(255,255,255,0.7)&#39;    var postsChart = echarts.init(document.getElementById(&#39;posts-chart&#39;), &#39;light&#39;);    var postsOption = &#123;      title: &#123;        text: &#39;æ–‡ç« å‘å¸ƒç»Ÿè®¡å›¾&#39;,        x: &#39;center&#39;,        textStyle: &#123;          color: color        &#125;      &#125;,      tooltip: &#123;        trigger: &#39;axis&#39;      &#125;,      xAxis: &#123;        name: &#39;æ—¥æœŸ&#39;,        type: &#39;category&#39;,        boundaryGap: false,        nameTextStyle: &#123;          color: color        &#125;,        axisTick: &#123;          show: false        &#125;,        axisLabel: &#123;          show: true,          color: color        &#125;,        axisLine: &#123;          show: true,          lineStyle: &#123;            color: color          &#125;        &#125;,        data: $&#123;monthArr&#125;      &#125;,      yAxis: &#123;        name: &#39;æ–‡ç« ç¯‡æ•°&#39;,        type: &#39;value&#39;,        nameTextStyle: &#123;          color: color        &#125;,        splitLine: &#123;          show: false        &#125;,        axisTick: &#123;          show: false        &#125;,        axisLabel: &#123;          show: true,          color: color        &#125;,        axisLine: &#123;          show: true,          lineStyle: &#123;            color: color          &#125;        &#125;      &#125;,      series: [&#123;        name: &#39;æ–‡ç« ç¯‡æ•°&#39;,        type: &#39;line&#39;,        smooth: true,        lineStyle: &#123;            width: 0        &#125;,        showSymbol: false,        itemStyle: &#123;          opacity: 1,          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [&#123;            offset: 0,            color: &#39;rgba(128, 255, 165)&#39;          &#125;,          &#123;            offset: 1,            color: &#39;rgba(1, 191, 236)&#39;          &#125;])        &#125;,        areaStyle: &#123;          opacity: 1,          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [&#123;            offset: 0,            color: &#39;rgba(128, 255, 165)&#39;          &#125;, &#123;            offset: 1,            color: &#39;rgba(1, 191, 236)&#39;          &#125;])        &#125;,        data: $&#123;monthValueArr&#125;,        markLine: &#123;          data: [&#123;            name: &#39;å¹³å‡å€¼&#39;,            type: &#39;average&#39;,            label: &#123;              color: color            &#125;          &#125;]        &#125;      &#125;]    &#125;;    postsChart.setOption(postsOption);    window.addEventListener(&#39;resize&#39;, () =&gt; &#123;       postsChart.resize();    &#125;);    postsChart.on(&#39;click&#39;, &#39;series&#39;, (event) =&gt; &#123;      if (event.componentType === &#39;series&#39;) window.location.href = &#39;/archives/&#39; + event.name.replace(&#39;-&#39;, &#39;/&#39;);    &#125;);  &lt;/script&gt;`&#125;function tagsChart (len) &#123;  const tagArr = []  hexo.locals.get(&#39;tags&#39;).map(function (tag) &#123;    tagArr.push(&#123; name: tag.name, value: tag.length, path: tag.path &#125;)  &#125;)  tagArr.sort((a, b) =&gt; &#123; return b.value - a.value &#125;)  const dataLength = Math.min(tagArr.length, len) || tagArr.length  const tagNameArr = []  for (let i = 0; i &lt; dataLength; i++) &#123;    tagNameArr.push(tagArr[i].name)  &#125;  const tagNameArrJson = JSON.stringify(tagNameArr)  const tagArrJson = JSON.stringify(tagArr)  return `  &lt;script id=&quot;tagsChart&quot;&gt;    var color = document.documentElement.getAttribute(&#39;data-theme&#39;) === &#39;light&#39; ? &#39;#4c4948&#39; : &#39;rgba(255,255,255,0.7)&#39;    var tagsChart = echarts.init(document.getElementById(&#39;tags-chart&#39;), &#39;light&#39;);    var tagsOption = &#123;      title: &#123;        text: &#39;Top $&#123;dataLength&#125; æ ‡ç­¾ç»Ÿè®¡å›¾&#39;,        x: &#39;center&#39;,        textStyle: &#123;          color: color        &#125;      &#125;,      tooltip: &#123;&#125;,      xAxis: &#123;        name: &#39;æ ‡ç­¾&#39;,        type: &#39;category&#39;,        nameTextStyle: &#123;          color: color        &#125;,        axisTick: &#123;          show: false        &#125;,        axisLabel: &#123;          show: true,          color: color,          interval: 0        &#125;,        axisLine: &#123;          show: true,          lineStyle: &#123;            color: color          &#125;        &#125;,        data: $&#123;tagNameArrJson&#125;      &#125;,      yAxis: &#123;        name: &#39;æ–‡ç« ç¯‡æ•°&#39;,        type: &#39;value&#39;,        splitLine: &#123;          show: false        &#125;,        nameTextStyle: &#123;          color: color        &#125;,        axisTick: &#123;          show: false        &#125;,        axisLabel: &#123;          show: true,          color: color        &#125;,        axisLine: &#123;          show: true,          lineStyle: &#123;            color: color          &#125;        &#125;      &#125;,      series: [&#123;        name: &#39;æ–‡ç« ç¯‡æ•°&#39;,        type: &#39;bar&#39;,        data: $&#123;tagArrJson&#125;,        itemStyle: &#123;          borderRadius: [5, 5, 0, 0],          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [&#123;            offset: 0,            color: &#39;rgba(128, 255, 165)&#39;          &#125;,          &#123;            offset: 1,            color: &#39;rgba(1, 191, 236)&#39;          &#125;])        &#125;,        emphasis: &#123;          itemStyle: &#123;            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [&#123;              offset: 0,              color: &#39;rgba(128, 255, 195)&#39;            &#125;,            &#123;              offset: 1,              color: &#39;rgba(1, 211, 255)&#39;            &#125;])          &#125;        &#125;,        markLine: &#123;          data: [&#123;            name: &#39;å¹³å‡å€¼&#39;,            type: &#39;average&#39;,            label: &#123;              color: color            &#125;          &#125;]        &#125;      &#125;]    &#125;;    tagsChart.setOption(tagsOption);    window.addEventListener(&#39;resize&#39;, () =&gt; &#123;       tagsChart.resize();    &#125;);    tagsChart.on(&#39;click&#39;, &#39;series&#39;, (event) =&gt; &#123;      if(event.data.path) window.location.href = &#39;/&#39; + event.data.path;    &#125;);  &lt;/script&gt;`&#125;function categoriesChart (dataParent) &#123;  const categoryArr = []  let categoryParentFlag = false  hexo.locals.get(&#39;categories&#39;).map(function (category) &#123;    if (category.parent) categoryParentFlag = true    categoryArr.push(&#123;      name: category.name,      value: category.length,      path: category.path,      id: category._id,      parentId: category.parent || &#39;0&#39;    &#125;)  &#125;)  categoryParentFlag = categoryParentFlag &amp;&amp; dataParent === &#39;true&#39;  categoryArr.sort((a, b) =&gt; &#123; return b.value - a.value &#125;)  function translateListToTree (data, parent) &#123;    let tree = []    let temp    data.forEach((item, index) =&gt; &#123;      if (data[index].parentId == parent) &#123;        let obj = data[index];        temp = translateListToTree(data, data[index].id);        if (temp.length &gt; 0) &#123;          obj.children = temp        &#125;        if (tree.indexOf())          tree.push(obj)      &#125;    &#125;)    return tree  &#125;  const categoryNameJson = JSON.stringify(categoryArr.map(function (category) &#123; return category.name &#125;))  const categoryArrJson = JSON.stringify(categoryArr)  const categoryArrParentJson = JSON.stringify(translateListToTree(categoryArr, &#39;0&#39;))  return `  &lt;script id=&quot;categoriesChart&quot;&gt;    var color = document.documentElement.getAttribute(&#39;data-theme&#39;) === &#39;light&#39; ? &#39;#4c4948&#39; : &#39;rgba(255,255,255,0.7)&#39;    var categoriesChart = echarts.init(document.getElementById(&#39;categories-chart&#39;), &#39;light&#39;);    var categoryParentFlag = $&#123;categoryParentFlag&#125;    var categoriesOption = &#123;      title: &#123;        text: &#39;æ–‡ç« åˆ†ç±»ç»Ÿè®¡å›¾&#39;,        x: &#39;center&#39;,        textStyle: &#123;          color: color        &#125;      &#125;,      legend: &#123;        top: &#39;bottom&#39;,        data: $&#123;categoryNameJson&#125;,        textStyle: &#123;          color: color        &#125;      &#125;,      tooltip: &#123;        trigger: &#39;item&#39;      &#125;,      series: []    &#125;;    categoriesOption.series.push(      categoryParentFlag ?       &#123;        nodeClick :false,        name: &#39;æ–‡ç« ç¯‡æ•°&#39;,        type: &#39;sunburst&#39;,        radius: [&#39;15%&#39;, &#39;90%&#39;],        center: [&#39;50%&#39;, &#39;55%&#39;],        sort: &#39;desc&#39;,        data: $&#123;categoryArrParentJson&#125;,        itemStyle: &#123;          borderColor: &#39;#fff&#39;,          borderWidth: 2,          emphasis: &#123;            focus: &#39;ancestor&#39;,            shadowBlur: 10,            shadowOffsetX: 0,            shadowColor: &#39;rgba(255, 255, 255, 0.5)&#39;          &#125;        &#125;      &#125;      :      &#123;        name: &#39;æ–‡ç« ç¯‡æ•°&#39;,        type: &#39;pie&#39;,        radius: [30, 80],        roseType: &#39;area&#39;,        label: &#123;          color: color,          formatter: &#39;&#123;b&#125; : &#123;c&#125; (&#123;d&#125;%)&#39;        &#125;,        data: $&#123;categoryArrJson&#125;,        itemStyle: &#123;          emphasis: &#123;            shadowBlur: 10,            shadowOffsetX: 0,            shadowColor: &#39;rgba(255, 255, 255, 0.5)&#39;          &#125;        &#125;      &#125;    )    categoriesChart.setOption(categoriesOption);    window.addEventListener(&#39;resize&#39;, () =&gt; &#123;       categoriesChart.resize();    &#125;);    categoriesChart.on(&#39;click&#39;, &#39;series&#39;, (event) =&gt; &#123;      if(event.data.path) window.location.href = &#39;/&#39; + event.data.path;    &#125;);  &lt;/script&gt;`&#125;<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">3. `categories` é¡µé¢æ·»åŠ ç»Ÿè®¡å›¾</span><br><span class="line"></span><br><span class="line">   æ³¨æ„ï¼šä¸€å®šè¦æ³¨é‡Šæ‰ `type: categories` å¦‚æœæƒ³ä¿ç•™åˆ†ç±»é¡µé¢åŸåŠŸèƒ½ï¼Œå‚è€ƒå®Œæ•´æ•™ç¨‹</span><br><span class="line"></span><br></pre></td></tr></table></figure>---title: åˆ†ç±»date: 2025-07-31 15:59:03# type: categories---&lt;!-- å¼•å…¥echarts.js --&gt;&lt;script src=&quot;https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js&quot;&gt;&lt;/script&gt;&lt;!-- æ–‡ç« åˆ†ç±»ç»Ÿè®¡å›¾ --&gt;&lt;div id=&quot;categories-chart&quot; data-parent=&quot;true&quot; style=&quot;height: 320px; padding: 10px;&quot;&gt;&lt;/div&gt;<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">4. `archives` é¡µé¢æ·»åŠ ç»Ÿè®¡å›¾</span><br><span class="line"></span><br><span class="line">   ä¿®æ”¹ `[ThemeRoot]\layout\archive.pug`ï¼Œå¦‚ä¸‹ï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure>@@ -5,4 +5,8 @@  block content    include ./includes/mixins/article-sort.pug    #archive+     &lt;!-- å¼•å…¥echarts.js --&gt;+     &lt;script src=&quot;https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js&quot;&gt;&lt;/script&gt;+     &lt;!-- æ–‡ç« å‘å¸ƒæ—¶é—´ç»Ÿè®¡å›¾ --&gt;+     &lt;div id=&quot;posts-chart&quot; data-start=&quot;2024-09&quot; style=&quot;border-radius: 8px; height: 320px; padding: 5px;&quot;&gt;&lt;/div&gt;      .article-sort-title= `$&#123;_p(&#39;page.articles&#39;)&#125; - $&#123;getArchiveLength()&#125;`<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">5. `pjax` é€‚é…</span><br><span class="line">   ä¿®æ”¹ `[ThemeRoot]/layout/includes/third-party/pjax.pug` å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure>@@ -1,6 +1,6 @@ - var pjaxExclude = &#39;a:not([target=&quot;_blank&quot;])&#39; if theme.pjax.exclude   each val in theme.pjax.exclude     - pjaxExclude += `:not([href=&quot;$&#123;val&#125;&quot;])`- - let pjaxSelectors = [&#39;head &gt; title&#39;, &#39;#config-diff&#39;, &#39;#body-wrap&#39;, &#39;#rightside-config-hide&#39;, &#39;#rightside-config-show&#39;, &#39;.js-pjax&#39;]+ - let pjaxSelectors = [&#39;head &gt; title&#39;, &#39;#config-diff&#39;, &#39;#body-wrap&#39;, &#39;#rightside-config-hide&#39;, &#39;#rightside-config-show&#39;, &#39;.js-pjax&#39;, &#39;#posts-chart&#39;, &#39;#categories-chart&#39;]</code></pre></li></ol>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸»é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸»é¢˜ Butterfly 5.5.4 åŸºç¡€æ•™ç¨‹</title>
      <link href="/2026/02/04/front-mateer%E8%AF%B4%E6%98%8E/"/>
      <url>/2026/02/04/front-mateer%E8%AF%B4%E6%98%8E/</url>
      
        <content type="html"><![CDATA[<h1 id="åŸºç¡€ç¯‡"><a href="#åŸºç¡€ç¯‡" class="headerlink" title="åŸºç¡€ç¯‡"></a>åŸºç¡€ç¯‡</h1><h2 id="Front-matter-è¯´æ˜ï¼ˆç®€ä½“ä¸­æ–‡ç‰ˆï¼‰"><a href="#Front-matter-è¯´æ˜ï¼ˆç®€ä½“ä¸­æ–‡ç‰ˆï¼‰" class="headerlink" title="Front-matter è¯´æ˜ï¼ˆç®€ä½“ä¸­æ–‡ç‰ˆï¼‰"></a>Front-matter è¯´æ˜ï¼ˆç®€ä½“ä¸­æ–‡ç‰ˆï¼‰</h2><p>Front-matter æ˜¯ Markdown æ–‡ä»¶æœ€ä¸Šæ–¹ä»¥ <code>---</code> åˆ†éš”çš„åŒºåŸŸï¼Œç”¨äºæŒ‡å®šå•ä¸ªæ–‡ä»¶çš„å˜é‡ã€‚</p><ul><li>Page Front-matterï¼šç”¨äº<strong>é¡µé¢</strong>é…ç½®</li><li>Post Front-matterï¼šç”¨äº<strong>æ–‡ç« é¡µ</strong>é…ç½®</li></ul><p>æ ‡æ³¨ä¸º<strong>å¯é€‰</strong>çš„å‚æ•°å¯æ ¹æ®è‡ªèº«éœ€æ±‚æ·»åŠ ï¼Œæ— éœ€å…¨éƒ¨å†™åœ¨ Markdown ä¸­ã€‚</p><h3 id="é¡µé¢-Page-Front-matter"><a href="#é¡µé¢-Page-Front-matter" class="headerlink" title="é¡µé¢ (Page) Front-matter"></a>é¡µé¢ (Page) Front-matter</h3><table><thead><tr><th>å‚æ•°</th><th>å¿…å¡« &#x2F; å¯é€‰</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>title</td><td><strong>å¿…å¡«</strong></td><td>é¡µé¢æ ‡é¢˜</td></tr><tr><td>date</td><td><strong>å¿…å¡«</strong></td><td>é¡µé¢åˆ›å»ºæ—¥æœŸ</td></tr><tr><td>updated</td><td>å¯é€‰</td><td>é¡µé¢æ›´æ–°æ—¥æœŸ</td></tr><tr><td>type</td><td><strong>å¿…å¡«</strong></td><td>æ ‡ç­¾ã€åˆ†ç±»å’Œå‹æƒ…é“¾æ¥è¿™ä¸‰ä¸ªé¡µé¢éœ€é…ç½®è¯¥å‚æ•°</td></tr><tr><td>comments</td><td>å¯é€‰</td><td>æ˜¾ç¤ºé¡µé¢è¯„è®ºæ¨¡å—ï¼ˆé»˜è®¤ <code>true</code>ï¼‰</td></tr><tr><td>description</td><td>å¯é€‰</td><td>é¡µé¢æè¿°</td></tr><tr><td>keywords</td><td>å¯é€‰</td><td>é¡µé¢å…³é”®è¯</td></tr><tr><td>top_img</td><td>å¯é€‰</td><td>é¡µé¢é¡¶éƒ¨å›¾ç‰‡</td></tr><tr><td>mathjax</td><td>å¯é€‰</td><td>æ˜¾ç¤º MathJaxï¼ˆä»…å½“ MathJax çš„ <code>per_page: false</code> æ—¶éœ€é…ç½®ï¼Œé»˜è®¤ <code>false</code>ï¼‰</td></tr><tr><td>katex</td><td>å¯é€‰</td><td>æ˜¾ç¤º KaTeXï¼ˆä»…å½“ KaTeX çš„ <code>per_page: false</code> æ—¶éœ€é…ç½®ï¼Œé»˜è®¤ <code>false</code>ï¼‰</td></tr><tr><td>aside</td><td>å¯é€‰</td><td>æ˜¾ç¤ºä¾§è¾¹æ ï¼ˆé»˜è®¤ <code>true</code>ï¼‰</td></tr><tr><td>aplayer</td><td>å¯é€‰</td><td>åœ¨å¯¹åº”é¡µé¢åŠ è½½ APlayer çš„ JS å’Œ CSSï¼Œå‚è€ƒä¸‹æ–¹éŸ³ä¹é…ç½®</td></tr><tr><td>highlight_shrink</td><td>å¯é€‰</td><td>é…ç½®ä»£ç æ¡†æ˜¯å¦å±•å¼€ï¼ˆ<code>true</code>&#x2F;<code>false</code>ï¼‰ï¼Œé»˜è®¤æ²¿ç”¨ä¸»é¢˜é…ç½®çš„ <code>highlight_shrink</code> è®¾ç½®</td></tr><tr><td>random</td><td>å¯é€‰</td><td>é…ç½®å‹æƒ…é“¾æ¥æ˜¯å¦éšæœºæ’åºï¼ˆé»˜è®¤ <code>false</code>ï¼‰</td></tr><tr><td>limit.type</td><td>å¯é€‰</td><td>é…ç½®è¯´è¯´æ˜¾ç¤ºæ•°é‡çš„ç±»å‹ï¼ˆ<code>date</code> æˆ– <code>num</code>ï¼‰</td></tr><tr><td>limit.value</td><td>å¯é€‰</td><td>é…ç½®è¯´è¯´æ˜¾ç¤ºæ•°é‡çš„æ•°å€¼</td></tr></tbody></table><h3 id="æ–‡ç« -Post-Front-matter"><a href="#æ–‡ç« -Post-Front-matter" class="headerlink" title="æ–‡ç«  (Post) Front-matter"></a>æ–‡ç«  (Post) Front-matter</h3><table><thead><tr><th>å‚æ•°</th><th>å¿…å¡« &#x2F; å¯é€‰</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>title</td><td><strong>å¿…å¡«</strong></td><td>æ–‡ç« æ ‡é¢˜</td></tr><tr><td>date</td><td><strong>å¿…å¡«</strong></td><td>æ–‡ç« åˆ›å»ºæ—¥æœŸ</td></tr><tr><td>updated</td><td>å¯é€‰</td><td>æ–‡ç« æ›´æ–°æ—¥æœŸ</td></tr><tr><td>tags</td><td>å¯é€‰</td><td>æ–‡ç« æ ‡ç­¾</td></tr><tr><td>categories</td><td>å¯é€‰</td><td>æ–‡ç« åˆ†ç±»</td></tr><tr><td>keywords</td><td>å¯é€‰</td><td>æ–‡ç« å…³é”®è¯</td></tr><tr><td>description</td><td>å¯é€‰</td><td>æ–‡ç« æè¿°</td></tr><tr><td>top_img</td><td>å¯é€‰</td><td>æ–‡ç« é¡¶éƒ¨å›¾ç‰‡</td></tr><tr><td>cover</td><td>å¯é€‰</td><td>æ–‡ç« ç¼©ç•¥å›¾ï¼ˆæœªè®¾ç½® <code>top_img</code> æ—¶ï¼Œæ–‡ç« é¡µé¡¶éƒ¨æ˜¾ç¤ºè¯¥ç¼©ç•¥å›¾ï¼›å¯è®¾ä¸º <code>false</code>&#x2F; å›¾ç‰‡åœ°å€ &#x2F; ç•™ç©ºï¼‰</td></tr><tr><td>comments</td><td>å¯é€‰</td><td>æ˜¾ç¤ºæ–‡ç« è¯„è®ºæ¨¡å—ï¼ˆé»˜è®¤ <code>true</code>ï¼‰</td></tr><tr><td>toc</td><td>å¯é€‰</td><td>æ˜¾ç¤ºæ–‡ç« ç›®å½•ï¼ˆé»˜è®¤æ²¿ç”¨ä¸»é¢˜é…ç½®ä¸­ <code>toc</code> çš„ <code>enable</code> è®¾ç½®ï¼‰</td></tr><tr><td>toc_number</td><td>å¯é€‰</td><td>æ˜¾ç¤ºç›®å½•ç¼–å·ï¼ˆé»˜è®¤æ²¿ç”¨ä¸»é¢˜é…ç½®ä¸­ <code>toc</code> çš„ <code>number</code> è®¾ç½®ï¼‰</td></tr><tr><td>toc_style_simple</td><td>å¯é€‰</td><td>å¯ç”¨ç›®å½•ç®€æ´æ¨¡å¼</td></tr><tr><td>copyright</td><td>å¯é€‰</td><td>æ˜¾ç¤ºæ–‡ç« ç‰ˆæƒæ¨¡å—ï¼ˆé»˜è®¤æ²¿ç”¨ä¸»é¢˜é…ç½®ä¸­ <code>post_copyright</code> çš„ <code>enable</code> è®¾ç½®ï¼‰</td></tr><tr><td>copyright_author</td><td>å¯é€‰</td><td>æ–‡ç« ç‰ˆæƒæ¨¡å—çš„æ–‡ç« ä½œè€…</td></tr><tr><td>copyright_author_href</td><td>å¯é€‰</td><td>æ–‡ç« ç‰ˆæƒæ¨¡å—çš„ä½œè€…é“¾æ¥</td></tr><tr><td>copyright_url</td><td>å¯é€‰</td><td>æ–‡ç« ç‰ˆæƒæ¨¡å—çš„æ–‡ç« é“¾æ¥</td></tr><tr><td>copyright_info</td><td>å¯é€‰</td><td>æ–‡ç« ç‰ˆæƒæ¨¡å—çš„ç‰ˆæƒå£°æ˜æ–‡å­—</td></tr><tr><td>mathjax</td><td>å¯é€‰</td><td>æ˜¾ç¤º MathJaxï¼ˆä»…å½“ MathJax çš„ <code>per_page: false</code> æ—¶éœ€é…ç½®ï¼Œé»˜è®¤ <code>false</code>ï¼‰</td></tr><tr><td>katex</td><td>å¯é€‰</td><td>æ˜¾ç¤º KaTeXï¼ˆä»…å½“ KaTeX çš„ <code>per_page: false</code> æ—¶éœ€é…ç½®ï¼Œé»˜è®¤ <code>false</code>ï¼‰</td></tr><tr><td>aplayer</td><td>å¯é€‰</td><td>åœ¨å¯¹åº”é¡µé¢åŠ è½½ APlayer çš„ JS å’Œ CSSï¼Œå‚è€ƒä¸‹æ–¹éŸ³ä¹é…ç½®</td></tr><tr><td>highlight_shrink</td><td>å¯é€‰</td><td>é…ç½®ä»£ç æ¡†æ˜¯å¦å±•å¼€ï¼ˆ<code>true</code>&#x2F;<code>false</code>ï¼‰ï¼Œé»˜è®¤æ²¿ç”¨ä¸»é¢˜é…ç½®çš„ <code>highlight_shrink</code> è®¾ç½®</td></tr><tr><td>aside</td><td>å¯é€‰</td><td>æ˜¾ç¤ºä¾§è¾¹æ ï¼ˆé»˜è®¤ <code>true</code>ï¼‰</td></tr><tr><td>abcjs</td><td>å¯é€‰</td><td>åŠ è½½ ABCJSï¼ˆä»…å½“ ABCJS çš„ <code>per_page: false</code> æ—¶éœ€é…ç½®ï¼Œé»˜è®¤ <code>false</code>ï¼‰</td></tr><tr><td>noticeOutdate</td><td>å¯é€‰</td><td>å¯ç”¨æ–‡ç« è¿‡æœŸæé†’ï¼ˆé»˜è®¤æ²¿ç”¨ä¸»é¢˜é…ç½®ä¸­ <code>noticeOutdate</code> çš„ <code>enable</code> è®¾ç½®ï¼‰</td></tr><tr><td>swiper_index</td><td>å¯é€‰</td><td>ç½®é¡¶ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜</td></tr></tbody></table><h2 id="Hexo-å¤–æŒ‚æ ‡ç­¾æ±‡æ€»è¡¨æ ¼"><a href="#Hexo-å¤–æŒ‚æ ‡ç­¾æ±‡æ€»è¡¨æ ¼" class="headerlink" title="Hexo å¤–æŒ‚æ ‡ç­¾æ±‡æ€»è¡¨æ ¼"></a>Hexo å¤–æŒ‚æ ‡ç­¾æ±‡æ€»è¡¨æ ¼</h2><table><thead><tr><th align="center">æ ‡ç­¾ç±»å‹</th><th align="center">æ ‡ç­¾åç§° &#x2F; æ ¸å¿ƒè¯­æ³•</th><th align="center">åŠŸèƒ½è¯´æ˜</th><th align="center">å¯ç›´æ¥ä½¿ç”¨çš„ç¤ºä¾‹</th><th align="center">å¤‡æ³¨ &#x2F; å‰ç½®è¦æ±‚</th></tr></thead><tbody><tr><td align="center">å†…ç½®ï¼ˆæ— éœ€å®‰è£…ï¼‰</td><td align="center">æ³¨è„š <code>footnote</code>&#x2F;<code>footnoteref</code></td><td align="center">ä¸ºæ–‡ç« æ·»åŠ æ­£æ–‡å¼•ç”¨ + æ–‡æœ«æ³¨è„šï¼Œæå‡æ–‡ç« ä¸¥è°¨æ€§</td><td align="center">æ­£æ–‡ï¼š<code>è¿™æ˜¯éœ€è¦æ³¨é‡Šçš„å†…å®¹&#123;% footnoteref 1 %&#125;</code>æ–‡æœ«ï¼š<code>&#123;% footnote 1 %&#125;è¿™æ˜¯æ³¨è„šçš„å…·ä½“å†…å®¹&#123;% endfootnote %&#125;</code></td><td align="center">ç”Ÿæˆçš„æ³¨è„šä¼šè‡ªåŠ¨æ’åˆ—åœ¨æ–‡ç« æœ«å°¾ï¼Œæ”¯æŒå¤šä¸ªæ³¨è„šï¼ˆä¿®æ”¹æ•°å­—ç¼–å·å³å¯ï¼‰</td></tr><tr><td align="center">å†…ç½®ï¼ˆæ— éœ€å®‰è£…ï¼‰</td><td align="center">ä»£ç å— <code>code</code></td><td align="center">å¢å¼ºåŸç”Ÿ Markdown ä»£ç å—ï¼Œæ”¯æŒæŒ‡å®šè¯­è¨€ã€æ˜¾ç¤ºè¡Œå·ã€éšè—ä»£ç è¯­è¨€æ ‡è¯†</td><td align="center"><code>&#123;% code javascript [1,3] %&#125;<br>const a = 10;<br>console.log(a);<br>function fn() &#123;&#125;<br>&#123;% endcode %&#125;</code></td><td align="center"><code>[1,3]</code> è¡¨ç¤ºä»…æ˜¾ç¤ºç¬¬ 1ã€3 è¡Œï¼ˆä¹Ÿå¯å†™ <code>1-5</code> æ˜¾ç¤ºç¬¬ 1 åˆ° 5 è¡Œï¼‰ï¼Œä¸å†™åˆ™æ˜¾ç¤ºå…¨éƒ¨è¡Œ</td></tr><tr><td align="center">å†…ç½®ï¼ˆæ— éœ€å®‰è£…ï¼‰</td><td align="center">å›¾ç‰‡ <code>img</code></td><td align="center">å¢å¼ºåŸç”Ÿ Markdown å›¾ç‰‡è¯­æ³•ï¼Œæ”¯æŒæŒ‡å®šå®½é«˜ã€è‡ªå®šä¹‰ alt æ–‡æœ¬</td><td align="center"><code>&#123;% img https://xxx/photo.jpg 400 300 "è¿™æ˜¯ä¸€å¼ ç¤ºä¾‹å›¾ç‰‡" "å›¾ç‰‡æè¿°" %&#125;</code></td><td align="center">è¯­æ³•æ ¼å¼ï¼š<code>&#123;% img å›¾ç‰‡é“¾æ¥ å®½åº¦ é«˜åº¦ "altæ–‡æœ¬" "æ ‡é¢˜æ–‡æœ¬" %&#125;</code>ï¼Œå®½é«˜å¯çœç•¥ï¼ˆè‡ªé€‚åº”ï¼‰</td></tr><tr><td align="center">å†…ç½®ï¼ˆæ— éœ€å®‰è£…ï¼‰</td><td align="center">é“¾æ¥ <code>link</code></td><td align="center">å¢å¼ºåŸç”Ÿ Markdown é“¾æ¥ï¼Œæ”¯æŒæŒ‡å®šæ–°çª—å£æ‰“å¼€ã€æ·»åŠ é¢å¤–å±æ€§</td><td align="center"><code>&#123;% link æˆ‘çš„åšå®¢ https://xxx.com _blank "noopener noreferrer" %&#125;</code></td><td align="center"><code>_blank</code> è¡¨ç¤ºæ–°çª—å£æ‰“å¼€ï¼Œåç»­å±æ€§ä¸ºå®‰å…¨ä¼˜åŒ–ï¼Œå¯çœç•¥ï¼›æ ¼å¼ï¼š<code>&#123;% link é“¾æ¥æ–‡æœ¬ é“¾æ¥åœ°å€ é¢å¤–å±æ€§ %&#125;</code></td></tr><tr><td align="center">å†…ç½®ï¼ˆæ— éœ€å®‰è£…ï¼‰</td><td align="center">æŠ˜å éšè— <code>hide</code>ï¼ˆä¸»é¢˜å…¼å®¹ï¼‰</td><td align="center">å°†å¤§æ®µå†…å®¹æŠ˜å ï¼Œç‚¹å‡»å±•å¼€ï¼ŒèŠ‚çœé¡µé¢ç©ºé—´</td><td align="center"><code>&#123;% hide ç‚¹å‡»å±•å¼€æŸ¥çœ‹è¯¦ç»†å†…å®¹ %&#125;<br>è¿™é‡Œæ˜¯éœ€è¦éšè—çš„å¤§æ®µæ­£æ–‡/ä»£ç /å›¾ç‰‡<br>&#123;% endhide %&#125;</code></td><td align="center">å¹¶éæ‰€æœ‰ Hexo ä¸»é¢˜éƒ½æ”¯æŒï¼Œéœ€ä¸»é¢˜å†…ç½®è¯¥æ ‡ç­¾æ ·å¼ï¼ˆå¦‚ Nextã€Butterfly ä¸»é¢˜æ”¯æŒï¼‰</td></tr><tr><td align="center">ç¬¬ä¸‰æ–¹ï¼ˆéœ€å®‰è£…ï¼‰</td><td align="center">éŸ³ä¹åµŒå…¥ <code>aplayer</code>ï¼ˆhexo-tag-aplayerï¼‰</td><td align="center">åµŒå…¥ç½‘æ˜“äº‘éŸ³ä¹ã€QQ éŸ³ä¹ã€æœ¬åœ°éŸ³é¢‘ï¼Œæ”¯æŒè‡ªå®šä¹‰æ’­æ”¾å™¨æ ·å¼</td><td align="center"><code>&#123;% aplayer "èŠ±æµ·" "å‘¨æ°ä¼¦" "https://xxx/huahai.mp3" "https://xxx/cover.jpg" %&#125;</code></td><td align="center">1. å®‰è£…å‘½ä»¤ï¼š<code>npm install hexo-tag-aplayer --save</code>2. æ”¯æŒæ‰¹é‡æ·»åŠ æ­Œæ›²ï¼Œå…¼å®¹ä¸»æµä¸»é¢˜</td></tr><tr><td align="center">ç¬¬ä¸‰æ–¹ï¼ˆéœ€å®‰è£…ï¼‰</td><td align="center">è§†é¢‘åµŒå…¥ <code>video</code>ï¼ˆhexo-tag-videoï¼‰</td><td align="center">åµŒå…¥æœ¬åœ°è§†é¢‘æˆ–åœ¨çº¿è§†é¢‘ï¼ˆMP4&#x2F;WEBM ç­‰æ ¼å¼ï¼‰ï¼Œæ”¯æŒæŒ‡å®šå®½é«˜</td><td align="center"><code>&#123;% video https://xxx/video.mp4 640 480 %&#125;`          | 1. å®‰è£…å‘½ä»¤ï¼š`npm install hexo-tag-video --save`2. æœ¬åœ°è§†é¢‘æ”¾å…¥ `source/images` ç›®å½• || ç¬¬ä¸‰æ–¹ï¼ˆéœ€å®‰è£…ï¼‰ | æµç¨‹å›¾ `mermaid`ï¼ˆhexo-filter-mermaid-diagramsï¼‰ |    åµŒå…¥æµç¨‹å›¾ã€æ—¶åºå›¾ã€é¥¼å›¾ç­‰ï¼Œæ— éœ€å¤–éƒ¨æˆªå›¾ï¼Œæ”¯æŒå®æ—¶æ¸²æŸ“    | `&#123;% mermaid %&#125;<br>flowchart LR<br>A[å¼€å§‹] --> B[æ‰§è¡Œæ“ä½œ]<br>B --> C[ç»“æŸ]<br>&#123;% endmermaid %&#125;` | 1. å®‰è£…å‘½ä»¤ï¼š`npm install hexo-filter-mermaid-diagrams --save`2. éœ€åœ¨ Hexo é…ç½®æ–‡ä»¶å¼€å¯ mermaid æ”¯æŒ || ç¬¬ä¸‰æ–¹ï¼ˆéœ€å®‰è£…ï¼‰ |         å¾…åŠæ¸…å• `todo`ï¼ˆhexo-tag-todoï¼‰         |   æ·»åŠ å¯å‹¾é€‰çš„å¾…åŠäº‹é¡¹ï¼Œæ”¯æŒã€Œå·²å®Œæˆã€å’Œã€Œæœªå®Œæˆã€ä¸¤ç§çŠ¶æ€   | `&#123;% todo %&#125; æœªå®Œæˆçš„å¾…åŠäº‹é¡¹1<br>&#123;% todo done %&#125; å·²å®Œæˆçš„å¾…åŠäº‹é¡¹2&#123;% endtodo %&#125;` | 1. å®‰è£…å‘½ä»¤ï¼š`npm install hexo-tag-todo --save`2. ç”Ÿæˆçš„æ¸…å•è‡ªå¸¦å‹¾é€‰æ ·å¼ï¼Œä¸»é¢˜å…¼å®¹åº¦é«˜ || ç¬¬ä¸‰æ–¹ï¼ˆéœ€å®‰è£…ï¼‰ |   ç®€æ´å¡ç‰‡ `card`ï¼ˆhexo-tag-bootstrap-cardsï¼‰    | åˆ¶ä½œå¸¦æ ‡é¢˜ã€å†…å®¹ã€æŒ‰é’®çš„ Bootstrap é£æ ¼å¡ç‰‡ï¼Œæå‡é¡µé¢ç¾è§‚åº¦  | `&#123;% card "å¡ç‰‡æ ‡é¢˜" "å¡ç‰‡æ­£æ–‡å†…å®¹ï¼Œæ”¯æŒç®€å• Markdown" "https://xxx.com" "æŒ‰é’®æ–‡æœ¬" %&#125;` | 1. å®‰è£…å‘½ä»¤ï¼š`npm install hexo-tag-bootstrap-cards --save`2. ä¾èµ– Bootstrap æ ·å¼ï¼Œéƒ¨åˆ†ä¸»é¢˜éœ€é¢å¤–å¼•å…¥ |### ä¸€ã€è¡Œå†…æ–‡æœ¬æ ‡ç­¾ï¼ˆInline Tagsï¼‰| æ ‡ç­¾åç§°    | è¯­æ³•æ ¼å¼                      | åŠŸèƒ½è¯´æ˜                             | ç¤ºä¾‹                                         || ----------- | ----------------------------- | ------------------------------------ | -------------------------------------------- || **u**       | `&#123;% u æ–‡æœ¬å†…å®¹ %&#125;`            | æ·»åŠ ä¸‹åˆ’çº¿æ–‡æœ¬                       | `&#123;% u è¿™æ˜¯å¸¦ä¸‹åˆ’çº¿çš„æ–‡æœ¬ %&#125;`                 || **emp**     | `&#123;% emp æ–‡æœ¬å†…å®¹ %&#125;`          | æ·»åŠ ç€é‡å·ï¼ˆåº•çº¹ï¼‰æ–‡æœ¬               | `&#123;% emp è¿™æ˜¯å¸¦ç€é‡å·çš„æ–‡æœ¬ %&#125;`               || **wavy**    | `&#123;% wavy æ–‡æœ¬å†…å®¹ %&#125;`         | æ·»åŠ æ³¢æµªçº¿æ–‡æœ¬                       | `&#123;% wavy è¿™æ˜¯å¸¦æ³¢æµªçº¿çš„æ–‡æœ¬ %&#125;`              || **del**     | `&#123;% del æ–‡æœ¬å†…å®¹ %&#125;`          | æ·»åŠ åˆ é™¤çº¿æ–‡æœ¬                       | `&#123;% del è¿™æ˜¯å¸¦åˆ é™¤çº¿çš„æ–‡æœ¬ %&#125;`               || **kbd**     | `&#123;% kbd æ–‡æœ¬å†…å®¹ %&#125;`          | æ·»åŠ é”®ç›˜æŒ‰é”®æ ·å¼æ–‡æœ¬                 | `&#123;% kbd Ctrl+C %&#125;`                           || **psw**     | `&#123;% psw æ–‡æœ¬å†…å®¹ %&#125;`          | æ·»åŠ å¯†ç éšè—æ•ˆæœæ–‡æœ¬ï¼ˆé¼ æ ‡æ‚¬æµ®æ˜¾ç¤ºï¼‰ | `&#123;% psw è¿™æ˜¯éšè—çš„å¯†ç  %&#125;`                   || **mark**    | `&#123;% mark [color] æ–‡æœ¬å†…å®¹ %&#125;` | æ·»åŠ é«˜äº®æ ‡è®°æ–‡æœ¬ï¼Œæ”¯æŒè‡ªå®šä¹‰é¢œè‰²     | `&#123;% mark #ff0 è¿™æ˜¯é«˜äº®æ–‡æœ¬ %&#125;`               || **sup**     | `&#123;% sup æ–‡æœ¬å†…å®¹ %&#125;`          | æ·»åŠ ä¸Šæ ‡æ–‡æœ¬                         | `X&#123;% sup 2 %&#125; + Y&#123;% sup 2 %&#125; = Z&#123;% sup 2 %&#125;` || **sub**     | `&#123;% sub æ–‡æœ¬å†…å®¹ %&#125;`          | æ·»åŠ ä¸‹æ ‡æ–‡æœ¬                         | `H&#123;% sub 2 %&#125;O`                              || **spoiler** | `&#123;% spoiler æ–‡æœ¬å†…å®¹ %&#125;`      | æ·»åŠ å‰§é€éšè—æ–‡æœ¬ï¼ˆç‚¹å‡»æ˜¾ç¤ºï¼‰         | `&#123;% spoiler è¿™æ˜¯å‰§é€å†…å®¹ %&#125;`                 |------### äºŒã€å—çº§å®¹å™¨æ ‡ç­¾ï¼ˆBlock Containersï¼‰| æ ‡ç­¾åç§°     | è¯­æ³•æ ¼å¼                                                     | åŠŸèƒ½è¯´æ˜                                | ç¤ºä¾‹                                                         || ------------ | ------------------------------------------------------------ | --------------------------------------- | ------------------------------------------------------------ || **note**     | `&#123;% note [class] [no-icon] [style] %&#125; å†…å®¹ &#123;% endnote %&#125;`    | æç¤ºå—å®¹å™¨ï¼Œæ”¯æŒ 6 ç§é¢„è®¾æ ·å¼           | `&#123;% note success %&#125; æ“ä½œæˆåŠŸæç¤º &#123;% endnote %&#125;`              || **collapse** | `&#123;% collapse [æ ‡é¢˜] [open] %&#125; å†…å®¹ &#123;% endcollapse %&#125;`        | å¯æŠ˜å é¢æ¿ï¼Œ`open`å‚æ•°é»˜è®¤å±•å¼€          | `&#123;% collapse ç‚¹å‡»å±•å¼€å†…å®¹ open %&#125; éšè—çš„è¯¦ç»†å†…å®¹ &#123;% endcollapse %&#125;` || **tabs**     | `&#123;% tabs [åˆ†ç»„å] [index] %&#125;<br>&#123;% tab æ ‡ç­¾1 %&#125; å†…å®¹1 &#123;% endtab %&#125;<br>&#123;% tab æ ‡ç­¾2 %&#125; å†…å®¹2 &#123;% endtab %&#125;<br>&#123;% endtabs %&#125;` | é€‰é¡¹å¡åˆ‡æ¢é¢æ¿ï¼Œ`index`æŒ‡å®šé»˜è®¤æ¿€æ´»æ ‡ç­¾ | `&#123;% tabs ç¤ºä¾‹ 1 %&#125;<br>&#123;% tab æ ‡ç­¾ä¸€ %&#125; å†…å®¹ä¸€ &#123;% endtab %&#125;<br>&#123;% tab æ ‡ç­¾äºŒ %&#125; å†…å®¹äºŒ &#123;% endtab %&#125;<br>&#123;% endtabs %&#125;` || **timeline** | `&#123;% timeline %&#125;<br>&#123;% timelineItem [æ ‡é¢˜] [æ—¶é—´] [å›¾æ ‡] %&#125; å†…å®¹ &#123;% endtimelineItem %&#125;<br>&#123;% endtimeline %&#125;` | æ—¶é—´è½´å±•ç¤ºå®¹å™¨ï¼Œæ”¯æŒè‡ªå®šä¹‰å›¾æ ‡          | `&#123;% timeline %&#125;<br>&#123;% timelineItem é¡¹ç›®å¯åŠ¨ 2023-01-01 fa-solid fa-rocket %&#125; é¡¹ç›®å¼€å§‹å¼€å‘ &#123;% endtimelineItem %&#125;<br>&#123;% endtimeline %&#125;` || **mermaid**  | `&#123;% mermaid %&#125; å›¾è¡¨ä»£ç  &#123;% endmermaid %&#125;`                    | æ¸²æŸ“ Mermaid æµç¨‹å›¾ / æ—¶åºå›¾ç­‰          | `&#123;% mermaid %&#125;<br>graph LR<br>A[å¼€å§‹] --> B[ç»“æŸ]<br>&#123;% endmermaid %&#125;` || **chart**    | `&#123;% chart [ç±»å‹] [æ ‡é¢˜] [height] %&#125; æ•°æ®é…ç½® &#123;% endchart %&#125;` | æ¸²æŸ“ Chart.js å›¾è¡¨                      | `&#123;% chart bar é”€é‡ç»Ÿè®¡ 300px %&#125;<br>&#123;labels: ['1æœˆ','2æœˆ'], datasets: [&#123;data: [100, 200]&#125;]&#125;<br>&#123;% endchart %&#125;` |------### ä¸‰ã€åª’ä½“å†…å®¹æ ‡ç­¾ï¼ˆMedia Tagsï¼‰| æ ‡ç­¾åç§°    | è¯­æ³•æ ¼å¼                                                     | åŠŸèƒ½è¯´æ˜                              | ç¤ºä¾‹                                                         || ----------- | ------------------------------------------------------------ | ------------------------------------- | ------------------------------------------------------------ || **gallery** | `&#123;% gallery %&#125;<br>![å›¾ç‰‡1](url1)<br>![å›¾ç‰‡2](url2)<br>&#123;% endgallery %&#125;` | å›¾ç‰‡ç›¸å†Œï¼Œè‡ªåŠ¨æ’ç‰ˆï¼Œæ”¯æŒç¯ç®±æ•ˆæœ      | `&#123;% gallery %&#125;<br>![é£æ™¯](https://example.com/1.jpg)<br>![äººç‰©](https://example.com/2.jpg)<br>&#123;% endgallery %&#125;` || **video**   | `&#123;% video [width] [height] [poster] %&#125; è§†é¢‘URL &#123;% endvideo %&#125;</code></td><td align="center">è§†é¢‘æ’­æ”¾å™¨ï¼Œæ”¯æŒè‡ªå®šä¹‰å°ºå¯¸å’Œå°é¢</td></tr><tr><td align="center"><strong>audio</strong></td><td align="center"><code>&#123;% audio [autoplay] [loop] [controls] %&#125; éŸ³é¢‘URL &#123;% endaudio %&#125;</code></td><td align="center">éŸ³é¢‘æ’­æ”¾å™¨ï¼Œæ”¯æŒè‡ªåŠ¨æ’­æ”¾å’Œå¾ªç¯</td><td align="center"><code>&#123;% audio autoplay loop %&#125; https://example.com/music.mp3 &#123;% endaudio %&#125;</code></td><td align="center"></td></tr><tr><td align="center"><strong>aplayer</strong></td><td align="center"><code>&#123;% aplayer æ ‡é¢˜, æ­Œæ‰‹, éŸ³é¢‘URL, å°é¢URL, [lrc] %&#125;</code></td><td align="center">é«˜çº§éŸ³é¢‘æ’­æ”¾å™¨ï¼Œæ”¯æŒæ­Œè¯æ˜¾ç¤º</td><td align="center"><code>&#123;% aplayer ä¸ƒé‡Œé¦™, å‘¨æ°ä¼¦, https://example.com/qlx.mp3, https://example.com/cover.jpg, https://example.com/qlx.lrc %&#125;</code></td><td align="center"></td></tr><tr><td align="center"><strong>meting</strong></td><td align="center"><code>&#123;% meting [type], [id], [server], [option] %&#125;</code></td><td align="center">éŸ³ä¹ API æ’­æ”¾å™¨ï¼ˆç½‘æ˜“äº‘ &#x2F; QQ éŸ³ä¹ç­‰ï¼‰</td><td align="center"><code>&#123;% meting song, 123456, netease, "autoplay: true" %&#125;</code></td><td align="center"></td></tr></tbody></table><hr><h3 id="å››ã€åŠŸèƒ½ç»„ä»¶æ ‡ç­¾ï¼ˆFunctional-Componentsï¼‰"><a href="#å››ã€åŠŸèƒ½ç»„ä»¶æ ‡ç­¾ï¼ˆFunctional-Componentsï¼‰" class="headerlink" title="å››ã€åŠŸèƒ½ç»„ä»¶æ ‡ç­¾ï¼ˆFunctional Componentsï¼‰"></a>å››ã€åŠŸèƒ½ç»„ä»¶æ ‡ç­¾ï¼ˆFunctional Componentsï¼‰</h3><table><thead><tr><th>æ ‡ç­¾åç§°</th><th>è¯­æ³•æ ¼å¼</th><th>åŠŸèƒ½è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>progress</strong></td><td><code>&#123;% progress [ç™¾åˆ†æ¯”] [é¢œè‰²] [æ–‡å­—] %&#125;</code></td><td>è¿›åº¦æ¡ç»„ä»¶ï¼Œæ”¯æŒè‡ªå®šä¹‰é¢œè‰²å’Œæ˜¾ç¤ºæ–‡æœ¬</td><td><code>&#123;% progress 75 #3eb8be å®Œæˆ75% %&#125;</code></td></tr><tr><td><strong>button</strong></td><td><code>&#123;% button [text] [url] [type] [icon] %&#125;</code></td><td>æŒ‰é’®ç»„ä»¶ï¼Œæ”¯æŒ 6 ç§é¢„è®¾æ ·å¼å’Œè‡ªå®šä¹‰å›¾æ ‡</td><td><code>&#123;% button ç‚¹å‡»è·³è½¬ https://example.com primary fa-solid fa-arrow-right %&#125;</code></td></tr><tr><td><strong>badge</strong></td><td><code>&#123;% badge [text] [type] [icon] %&#125;</code></td><td>å¾½ç« ç»„ä»¶ï¼Œç”¨äºæ ‡è®°çŠ¶æ€æˆ–åˆ†ç±»</td><td><code>&#123;% badge æ–° primary fa-solid fa-star %&#125;</code></td></tr><tr><td><strong>bilibili</strong></td><td><code>&#123;% bilibili [avå·/bvå·] [width] [height] %&#125;</code></td><td>åµŒå…¥ B ç«™è§†é¢‘</td><td><code>&#123;% bilibili BV1xx411c7m9 640 360 %&#125;</code></td></tr><tr><td><strong>youtube</strong></td><td><code>&#123;% youtube [è§†é¢‘ID] [width] [height] %&#125;</code></td><td>åµŒå…¥ YouTube è§†é¢‘</td><td><code>&#123;% youtube dQw4w9WgXcQ 640 360 %&#125;</code></td></tr><tr><td><strong>abcjs</strong></td><td><code>&#123;% abcjs %&#125; ä¹è°±ä»£ç  &#123;% endabcjs %&#125;</code></td><td>æ¸²æŸ“ ABC ä¹è°±</td><td><code>&#123;% abcjs %&#125;X:1<br>T:Simple Song<br>M:4/4<br>L:1/8<br>K:C<br>C D E F G A B c&#123;% endabcjs %&#125;</code></td></tr><tr><td><strong>note</strong></td><td>ï¼ˆè¡¥å……ï¼‰æ”¯æŒçš„ class å‚æ•°ï¼šdefault&#x2F;primary&#x2F;success&#x2F;info&#x2F;warning&#x2F;danger</td><td>æç¤ºå—é¢œè‰²æ ·å¼é¢„è®¾</td><td><code>&#123;% note danger %&#125; é”™è¯¯è­¦å‘Š &#123;% endnote %&#125;</code></td></tr><tr><td><strong>collapse</strong></td><td>ï¼ˆè¡¥å……ï¼‰<code>open</code>å‚æ•°æ§åˆ¶é»˜è®¤å±•å¼€çŠ¶æ€</td><td>æŠ˜å é¢æ¿åˆå§‹çŠ¶æ€è®¾ç½®</td><td><code>&#123;% collapse é»˜è®¤å±•å¼€ open %&#125; å†…å®¹ &#123;% endcollapse %&#125;</code></td></tr></tbody></table><hr><h3 id="äº”ã€ç‰¹æ®Šå†…å®¹æ ‡ç­¾ï¼ˆSpecial-Contentï¼‰"><a href="#äº”ã€ç‰¹æ®Šå†…å®¹æ ‡ç­¾ï¼ˆSpecial-Contentï¼‰" class="headerlink" title="äº”ã€ç‰¹æ®Šå†…å®¹æ ‡ç­¾ï¼ˆSpecial Contentï¼‰"></a>äº”ã€ç‰¹æ®Šå†…å®¹æ ‡ç­¾ï¼ˆSpecial Contentï¼‰</h3><table><thead><tr><th>æ ‡ç­¾åç§°</th><th>è¯­æ³•æ ¼å¼</th><th>åŠŸèƒ½è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>center</strong></td><td><code>&#123;% center æ–‡æœ¬å†…å®¹ %&#125;</code></td><td>å±…ä¸­å¯¹é½æ–‡æœ¬</td><td><code>&#123;% center è¿™æ˜¯å±…ä¸­æ˜¾ç¤ºçš„æ–‡æœ¬ %&#125;</code></td></tr><tr><td><strong>right</strong></td><td><code>&#123;% right æ–‡æœ¬å†…å®¹ %&#125;</code></td><td>å³å¯¹é½æ–‡æœ¬</td><td><code>&#123;% right è¿™æ˜¯å³å¯¹é½æ˜¾ç¤ºçš„æ–‡æœ¬ %&#125;</code></td></tr><tr><td><strong>quote</strong></td><td><code>&#123;% quote [ä½œè€…] [æ¥æº] [æ ‡é¢˜] %&#125; å¼•ç”¨å†…å®¹ &#123;% endquote %&#125;</code></td><td>å¸¦å¼•ç”¨ä¿¡æ¯çš„å—å¼•ç”¨</td><td><code>&#123;% quote é²è¿… ç‹‚äººæ—¥è®° ç»å…¸åè¨€ %&#125; æ•‘æ•‘å­©å­ï¼ &#123;% endquote %&#125;</code></td></tr><tr><td><strong>code</strong></td><td><code>&#123;% code [è¯­è¨€] [æ ‡é¢˜] %&#125; ä»£ç å†…å®¹ &#123;% endcode %&#125;</code></td><td>ä»£ç å—ï¼Œæ”¯æŒè¯­æ³•é«˜äº®å’Œæ ‡é¢˜</td><td><code>&#123;% code javascript ç¤ºä¾‹ä»£ç  %&#125;<br>console.log("Hello World");<br>&#123;% endcode %&#125;</code></td></tr></tbody></table><hr><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸»é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº‘åŸç”Ÿ-Linuxçš„é«˜çº§éƒ¨åˆ†ç¬”è®°</title>
      <link href="/2026/02/02/%E4%BA%91%E5%8E%9F%E7%94%9F%E9%AB%98%E7%BA%A7%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"/>
      <url>/2026/02/02/%E4%BA%91%E5%8E%9F%E7%94%9F%E9%AB%98%E7%BA%A7%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="26-1-13-å¤ä¹ "><a href="#26-1-13-å¤ä¹ " class="headerlink" title="26-1-13 (å¤ä¹ )"></a>26-1-13 (å¤ä¹ )</h1><h2 id="1-ä»€ä¹ˆæ˜¯å†…æ ¸ã€ä»€ä¹ˆæ˜¯shellã€ä»€ä¹ˆæ˜¯Linuxã€ä»€ä¹ˆæ˜¯å¼€æºï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯å†…æ ¸ã€ä»€ä¹ˆæ˜¯shellã€ä»€ä¹ˆæ˜¯Linuxã€ä»€ä¹ˆæ˜¯å¼€æºï¼Ÿ" class="headerlink" title="1.ä»€ä¹ˆæ˜¯å†…æ ¸ã€ä»€ä¹ˆæ˜¯shellã€ä»€ä¹ˆæ˜¯Linuxã€ä»€ä¹ˆæ˜¯å¼€æºï¼Ÿ"></a>1.ä»€ä¹ˆæ˜¯å†…æ ¸ã€ä»€ä¹ˆæ˜¯shellã€ä»€ä¹ˆæ˜¯Linuxã€ä»€ä¹ˆæ˜¯å¼€æºï¼Ÿ</h2><blockquote><p><strong>å†…æ ¸ã€shellã€linuxã€å¼€æºçš„æ¦‚å¿µ</strong></p></blockquote><p><strong>å†…æ ¸</strong>ï¼šæ˜¯æ“ä½œç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶ï¼Œæ˜¯ç¡¬ä»¶ä¸è½¯ä»¶çš„â€œæ¡¥æ¢â€ï¼Œå¤œè§†æ•´ä¸ªæ“ä½œç³»ç»Ÿçš„åŸºçŸ³</p><p><strong>Shell</strong>ï¼šæ˜¯<strong>ç”¨æˆ·ä¸å†…æ ¸ä¹‹é—´çš„äº¤äº’ç•Œé¢</strong>ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸º â€œå‘½ä»¤è§£é‡Šå™¨â€ï¼Œä½ ä¹‹å‰æåˆ°çš„ Linux Shell è„šæœ¬ï¼Œå°±æ˜¯åŸºäºå®ƒæ¥å†™çš„ã€‚</p><p><strong>å¼€æº</strong>ï¼šæ˜¯ä¸€ç§<strong>è½¯ä»¶çš„æˆæƒæ¨¡å¼</strong>ï¼Œå’Œ â€œé—­æºâ€ ç›¸å¯¹ï¼Œæ ¸å¿ƒæ˜¯<strong>æºä»£ç å…¬å¼€</strong>ã€‚</p><h2 id="2-Linuxä¸­å‘½ä»¤å½•å…¥æ–¹å¼"><a href="#2-Linuxä¸­å‘½ä»¤å½•å…¥æ–¹å¼" class="headerlink" title="2.Linuxä¸­å‘½ä»¤å½•å…¥æ–¹å¼"></a>2.Linuxä¸­å‘½ä»¤å½•å…¥æ–¹å¼</h2><h3 id="2-1-å‘½ä»¤è¡Œå¿«æ·é”®"><a href="#2-1-å‘½ä»¤è¡Œå¿«æ·é”®" class="headerlink" title="2.1.å‘½ä»¤è¡Œå¿«æ·é”®"></a>2.1.å‘½ä»¤è¡Œå¿«æ·é”®</h3><h4 id="2-1-1-å…‰æ ‡ç§»åŠ¨å¿«æ·é”®"><a href="#2-1-1-å…‰æ ‡ç§»åŠ¨å¿«æ·é”®" class="headerlink" title="2.1.1.å…‰æ ‡ç§»åŠ¨å¿«æ·é”®"></a>2.1.1.å…‰æ ‡ç§»åŠ¨å¿«æ·é”®</h4><table><thead><tr><th align="center">å¿«æ·é”®</th><th align="center">ä½œç”¨</th></tr></thead><tbody><tr><td align="center"><code>Ctrl + A</code></td><td align="center">å…‰æ ‡è·³åˆ°<strong>å‘½ä»¤è¡Œå¼€å¤´</strong></td></tr><tr><td align="center"><code>Ctrl + E</code></td><td align="center">å…‰æ ‡è·³åˆ°<strong>å‘½ä»¤è¡Œç»“å°¾</strong></td></tr><tr><td align="center"><code>Alt + F</code></td><td align="center">å…‰æ ‡<strong>å‘å³è·³ä¸€ä¸ªå•è¯</strong>ï¼ˆæŒ‰ç©ºæ ¼åˆ†éš”çš„å•ä½ï¼‰</td></tr><tr><td align="center"><code>Alt + B</code></td><td align="center">å…‰æ ‡<strong>å‘å·¦è·³ä¸€ä¸ªå•è¯</strong></td></tr><tr><td align="center"><code>Ctrl + â†</code></td><td align="center">ç­‰ä»·äº <code>Alt + B</code>ï¼ˆéƒ¨åˆ†ç»ˆç«¯æ”¯æŒï¼‰</td></tr><tr><td align="center"><code>Ctrl + â†’</code></td><td align="center">ç­‰ä»·äº <code>Alt + F</code>ï¼ˆéƒ¨åˆ†ç»ˆç«¯æ”¯æŒï¼‰</td></tr></tbody></table><h4 id="2-1-2-å‘½ä»¤ç¼–è¾‘å¿«æ·é”®"><a href="#2-1-2-å‘½ä»¤ç¼–è¾‘å¿«æ·é”®" class="headerlink" title="2.1.2.å‘½ä»¤ç¼–è¾‘å¿«æ·é”®"></a>2.1.2.å‘½ä»¤ç¼–è¾‘å¿«æ·é”®</h4><table><thead><tr><th align="center">å¿«æ·é”®</th><th align="center">ä½œç”¨</th></tr></thead><tbody><tr><td align="center"><code>Ctrl + U</code></td><td align="center">åˆ é™¤<strong>å…‰æ ‡å·¦ä¾§çš„æ‰€æœ‰å­—ç¬¦</strong>ï¼ˆæ¸…ç©ºåˆ°è¡Œé¦–ï¼‰</td></tr><tr><td align="center"><code>Ctrl + K</code></td><td align="center">åˆ é™¤<strong>å…‰æ ‡å³ä¾§çš„æ‰€æœ‰å­—ç¬¦</strong>ï¼ˆæ¸…ç©ºåˆ°è¡Œå°¾ï¼‰</td></tr><tr><td align="center"><code>Ctrl + W</code></td><td align="center">åˆ é™¤<strong>å…‰æ ‡å·¦ä¾§çš„ä¸€ä¸ªå•è¯</strong></td></tr><tr><td align="center"><code>Alt + D</code></td><td align="center">åˆ é™¤<strong>å…‰æ ‡å³ä¾§çš„ä¸€ä¸ªå•è¯</strong></td></tr><tr><td align="center"><code>Ctrl + Y</code></td><td align="center">ç²˜è´´ä¹‹å‰ç”¨ <code>Ctrl+U/K/W</code> åˆ é™¤çš„å†…å®¹ï¼ˆå‰ªè´´æ¿å¤ç”¨ï¼‰</td></tr><tr><td align="center"><code>Ctrl + H</code></td><td align="center">ç­‰åŒäº<strong>é€€æ ¼é”®</strong>ï¼ˆåˆ é™¤å…‰æ ‡å‰ä¸€ä¸ªå­—ç¬¦ï¼‰</td></tr><tr><td align="center"><code>Ctrl + T</code></td><td align="center">äº¤æ¢<strong>å…‰æ ‡å‰ä¸¤ä¸ªå­—ç¬¦</strong>çš„ä½ç½®ï¼ˆè¾“é”™å­—ç¬¦æ—¶è¶…å®ç”¨ï¼‰</td></tr></tbody></table><h4 id="2-1-3-å†å²å‘½ä»¤å¿«æ·é”®"><a href="#2-1-3-å†å²å‘½ä»¤å¿«æ·é”®" class="headerlink" title="2.1.3.å†å²å‘½ä»¤å¿«æ·é”®"></a>2.1.3.å†å²å‘½ä»¤å¿«æ·é”®</h4><table><thead><tr><th align="center">å¿«æ·é”®</th><th align="center">ä½œç”¨</th></tr></thead><tbody><tr><td align="center"><code>â†‘</code> &#x2F; <code>â†“</code></td><td align="center">å‘ä¸Š &#x2F; å‘ä¸‹ç¿»æ‰¾å†å²å‘½ä»¤ï¼ˆæŒ‰è¾“å…¥é¡ºåºï¼‰</td></tr><tr><td align="center"><code>Ctrl + R</code></td><td align="center"><strong>æœç´¢å†å²å‘½ä»¤</strong>ï¼ˆè¾“å…¥å…³é”®è¯ï¼Œä¼šè‡ªåŠ¨åŒ¹é…æœ€è¿‘çš„å‘½ä»¤ï¼ŒæŒ‰ <code>Ctrl+R</code> ç»§ç»­æ‰¾æ›´æ—©çš„ï¼‰</td></tr><tr><td align="center"><code>Ctrl + G</code></td><td align="center">é€€å‡º <code>Ctrl+R</code> çš„æœç´¢æ¨¡å¼ï¼Œå›åˆ°å½“å‰å‘½ä»¤è¡Œ</td></tr><tr><td align="center"><code>!!</code></td><td align="center">å¿«é€Ÿæ‰§è¡Œ<strong>ä¸Šä¸€æ¡å‘½ä»¤</strong>ï¼ˆæ¯”ç¿»ç®­å¤´æ›´å¿«ï¼‰</td></tr><tr><td align="center"><code>!n</code></td><td align="center">æ‰§è¡Œå†å²å‘½ä»¤ä¸­ç¬¬ <code>n</code> æ¡ï¼ˆ<code>history</code> å‘½ä»¤å¯æŸ¥çœ‹å†å²åˆ—è¡¨åŠåºå·ï¼‰</td></tr><tr><td align="center"><code>!å­—ç¬¦</code></td><td align="center">æ‰§è¡Œæœ€è¿‘ä¸€æ¬¡ä»¥è¯¥<strong>å­—ç¬¦å¼€å¤´</strong>çš„å‘½ä»¤ï¼ˆä¾‹ï¼š<code>!ls</code> æ‰§è¡Œæœ€è¿‘çš„ <code>ls</code> å‘½ä»¤ï¼‰</td></tr><tr><td align="center"><code>Alt + .</code></td><td align="center">ç²˜è´´<strong>ä¸Šä¸€æ¡å‘½ä»¤çš„æœ€åä¸€ä¸ªå‚æ•°</strong>ï¼ˆä¾‹ï¼šä¸Šä¸€æ¡æ˜¯ <code>cp a.txt /home</code>ï¼ŒæŒ‰åç›´æ¥å‡ºç° <code>/home</code>ï¼‰</td></tr></tbody></table><h4 id="2-1-4-è¿›ç¨‹æ§åˆ¶å¿«æ·é”®"><a href="#2-1-4-è¿›ç¨‹æ§åˆ¶å¿«æ·é”®" class="headerlink" title="2.1.4.è¿›ç¨‹æ§åˆ¶å¿«æ·é”®"></a>2.1.4.è¿›ç¨‹æ§åˆ¶å¿«æ·é”®</h4><table><thead><tr><th align="center">å¿«æ·é”®</th><th align="center">ä½œç”¨</th></tr></thead><tbody><tr><td align="center"><code>Ctrl + C</code></td><td align="center"><strong>å¼ºåˆ¶ç»ˆæ­¢</strong>å½“å‰æ­£åœ¨è¿è¡Œçš„å‘½ä»¤ï¼ˆæœ€å¸¸ç”¨ï¼Œæ¯”å¦‚å‘½ä»¤å¡æ­»æ—¶ï¼‰</td></tr><tr><td align="center"><code>Ctrl + Z</code></td><td align="center">æŠŠå½“å‰å‘½ä»¤<strong>æŒ‚èµ·</strong>ï¼ˆæ”¾åˆ°åå°æš‚åœï¼‰ï¼Œç”¨ <code>fg</code> å‘½ä»¤å¯æ¢å¤åˆ°å‰å°</td></tr><tr><td align="center"><code>Ctrl + D</code></td><td align="center">é€€å‡ºå½“å‰ Shell ä¼šè¯ï¼ˆç­‰ä»·äºè¾“å…¥ <code>exit</code> å‘½ä»¤ï¼‰</td></tr></tbody></table><h4 id="2-1-5-ç»ˆç«¯æ“ä½œå¿«æ·é”®"><a href="#2-1-5-ç»ˆç«¯æ“ä½œå¿«æ·é”®" class="headerlink" title="2.1.5.ç»ˆç«¯æ“ä½œå¿«æ·é”®"></a>2.1.5.ç»ˆç«¯æ“ä½œå¿«æ·é”®</h4><table><thead><tr><th align="center">å¿«æ·é”®</th><th align="center">ä½œç”¨</th></tr></thead><tbody><tr><td align="center"><code>Ctrl + L</code></td><td align="center">æ¸…ç©ºç»ˆç«¯å±å¹•ï¼ˆç­‰ä»·äºè¾“å…¥ <code>clear</code> å‘½ä»¤ï¼Œä¸ä¼šåˆ é™¤å†å²å‘½ä»¤ï¼‰</td></tr><tr><td align="center"><code>Ctrl + Shift + C</code></td><td align="center">å¤åˆ¶ç»ˆç«¯ä¸­é€‰ä¸­çš„å†…å®¹ï¼ˆå›¾å½¢åŒ–ç»ˆç«¯æ¨¡æ‹Ÿå™¨é€‚ç”¨ï¼‰</td></tr><tr><td align="center"><code>Ctrl + Shift + V</code></td><td align="center">ç²˜è´´å¤åˆ¶çš„å†…å®¹åˆ°ç»ˆç«¯ï¼ˆå›¾å½¢åŒ–ç»ˆç«¯æ¨¡æ‹Ÿå™¨é€‚ç”¨ï¼‰</td></tr></tbody></table><h4 id="2-1-6-Linux-Bash-å‘½ä»¤è¡Œå¿«æ·é”®é€ŸæŸ¥è¡¨"><a href="#2-1-6-Linux-Bash-å‘½ä»¤è¡Œå¿«æ·é”®é€ŸæŸ¥è¡¨" class="headerlink" title="2.1.6.Linux Bash å‘½ä»¤è¡Œå¿«æ·é”®é€ŸæŸ¥è¡¨"></a>2.1.6.Linux Bash å‘½ä»¤è¡Œå¿«æ·é”®é€ŸæŸ¥è¡¨</h4><table><thead><tr><th>åˆ†ç±»</th><th>å¿«æ·é”®</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><strong>å…‰æ ‡ç§»åŠ¨</strong></td><td><code>Ctrl + A</code></td><td>è·³åˆ°å‘½ä»¤è¡Œå¼€å¤´</td></tr><tr><td></td><td><code>Ctrl + E</code></td><td>è·³åˆ°å‘½ä»¤è¡Œç»“å°¾</td></tr><tr><td></td><td><code>Alt + F</code></td><td>å‘å³è·³ä¸€ä¸ªå•è¯</td></tr><tr><td></td><td><code>Alt + B</code></td><td>å‘å·¦è·³ä¸€ä¸ªå•è¯</td></tr><tr><td></td><td><code>Ctrl + â†</code></td><td>å‘å·¦è·³ä¸€ä¸ªå•è¯ï¼ˆéƒ¨åˆ†ç»ˆç«¯æ”¯æŒï¼‰</td></tr><tr><td></td><td><code>Ctrl + â†’</code></td><td>å‘å³è·³ä¸€ä¸ªå•è¯ï¼ˆéƒ¨åˆ†ç»ˆç«¯æ”¯æŒï¼‰</td></tr><tr><td><strong>å‘½ä»¤ç¼–è¾‘</strong></td><td><code>Ctrl + U</code></td><td>åˆ é™¤å…‰æ ‡å·¦ä¾§æ‰€æœ‰å­—ç¬¦</td></tr><tr><td></td><td><code>Ctrl + K</code></td><td>åˆ é™¤å…‰æ ‡å³ä¾§æ‰€æœ‰å­—ç¬¦</td></tr><tr><td></td><td><code>Ctrl + W</code></td><td>åˆ é™¤å…‰æ ‡å·¦ä¾§ä¸€ä¸ªå•è¯</td></tr><tr><td></td><td><code>Alt + D</code></td><td>åˆ é™¤å…‰æ ‡å³ä¾§ä¸€ä¸ªå•è¯</td></tr><tr><td></td><td><code>Ctrl + Y</code></td><td>ç²˜è´´ä¹‹å‰åˆ é™¤çš„å†…å®¹</td></tr><tr><td></td><td><code>Ctrl + H</code></td><td>ç­‰åŒäºé€€æ ¼é”®</td></tr><tr><td></td><td><code>Ctrl + T</code></td><td>äº¤æ¢å…‰æ ‡å‰ä¸¤ä¸ªå­—ç¬¦</td></tr><tr><td><strong>å†å²å‘½ä»¤</strong></td><td><code>â†‘</code> &#x2F; <code>â†“</code></td><td>å‘ä¸Š &#x2F; å‘ä¸‹ç¿»å†å²å‘½ä»¤</td></tr><tr><td></td><td><code>Ctrl + R</code></td><td>æœç´¢å†å²å‘½ä»¤ï¼ˆæŒ‰ <code>Ctrl+R</code> ç»§ç»­æ‰¾æ›´æ—©çš„ï¼‰</td></tr><tr><td></td><td><code>Ctrl + G</code></td><td>é€€å‡ºå†å²å‘½ä»¤æœç´¢æ¨¡å¼</td></tr><tr><td></td><td><code>!!</code></td><td>æ‰§è¡Œä¸Šä¸€æ¡å‘½ä»¤</td></tr><tr><td></td><td><code>!n</code></td><td>æ‰§è¡Œå†å²å‘½ä»¤åˆ—è¡¨ä¸­ç¬¬ <code>n</code> æ¡</td></tr><tr><td></td><td><code>!å­—ç¬¦</code></td><td>æ‰§è¡Œæœ€è¿‘ä¸€æ¬¡ä»¥è¯¥å­—ç¬¦å¼€å¤´çš„å‘½ä»¤</td></tr><tr><td></td><td><code>Alt + .</code></td><td>ç²˜è´´ä¸Šä¸€æ¡å‘½ä»¤çš„æœ€åä¸€ä¸ªå‚æ•°</td></tr><tr><td><strong>è¿›ç¨‹æ§åˆ¶</strong></td><td><code>Ctrl + C</code></td><td>å¼ºåˆ¶ç»ˆæ­¢å½“å‰è¿è¡Œçš„å‘½ä»¤</td></tr><tr><td></td><td><code>Ctrl + Z</code></td><td>æŒ‚èµ·å½“å‰å‘½ä»¤ï¼ˆåå°æš‚åœï¼Œ<code>fg</code> å¯æ¢å¤ï¼‰</td></tr><tr><td></td><td><code>Ctrl + D</code></td><td>é€€å‡ºå½“å‰ Shell ä¼šè¯</td></tr><tr><td><strong>ç»ˆç«¯æ“ä½œ</strong></td><td><code>Ctrl + L</code></td><td>æ¸…ç©ºç»ˆç«¯å±å¹•</td></tr><tr><td></td><td><code>Ctrl + Shift + C</code></td><td>å¤åˆ¶é€‰ä¸­å†…å®¹ï¼ˆå›¾å½¢åŒ–ç»ˆç«¯é€‚ç”¨ï¼‰</td></tr><tr><td></td><td><code>Ctrl + Shift + V</code></td><td>ç²˜è´´å†…å®¹åˆ°ç»ˆç«¯ï¼ˆå›¾å½¢åŒ–ç»ˆç«¯é€‚ç”¨ï¼‰</td></tr></tbody></table><h2 id="3-å‘½ä»¤è¡Œä¸­å¦‚ä½•è·å¾—å¸®åŠ©"><a href="#3-å‘½ä»¤è¡Œä¸­å¦‚ä½•è·å¾—å¸®åŠ©" class="headerlink" title="3.å‘½ä»¤è¡Œä¸­å¦‚ä½•è·å¾—å¸®åŠ©"></a>3.å‘½ä»¤è¡Œä¸­å¦‚ä½•è·å¾—å¸®åŠ©</h2><blockquote><p>å‘½ä»¤ â€“help  </p><p>man å‘½ä»¤</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¼€å¯ç›‘æ§</span></span><br><span class="line">watch -n 1 <span class="built_in">ls</span> -Rl</span><br></pre></td></tr></table></figure><h2 id="4-linuxä¸Šä¸‹æ–‡ç®¡ç†"><a href="#4-linuxä¸Šä¸‹æ–‡ç®¡ç†" class="headerlink" title="4.linuxä¸Šä¸‹æ–‡ç®¡ç†"></a>4.linuxä¸Šä¸‹æ–‡ç®¡ç†</h2><h3 id="4-1-å¸¸è§å‘½ä»¤è¡¨"><a href="#4-1-å¸¸è§å‘½ä»¤è¡¨" class="headerlink" title="4.1.å¸¸è§å‘½ä»¤è¡¨"></a>4.1.å¸¸è§å‘½ä»¤è¡¨</h3><p>Linux ä¸‹æ–‡ä»¶ç®¡ç†æ˜¯ç³»ç»Ÿæ“ä½œçš„æ ¸å¿ƒå†…å®¹ï¼Œå¸¸ç”¨å‘½ä»¤è¦†ç›–<strong>æ–‡ä»¶ &#x2F; ç›®å½•çš„åˆ›å»ºã€æŸ¥çœ‹ã€å¤åˆ¶ã€ç§»åŠ¨ã€åˆ é™¤ã€æƒé™ä¿®æ”¹</strong>ç­‰åœºæ™¯ã€‚ä»¥ä¸‹æ˜¯æ•´ç†çš„å¸¸ç”¨å‘½ä»¤è¡¨ï¼ŒæŒ‰åŠŸèƒ½åˆ†ç±»å¹¶é™„å…³é”®å‚æ•°è¯´æ˜ï¼š</p><table><thead><tr><th align="center">å‘½ä»¤åˆ†ç±»</th><th align="center">å‘½ä»¤</th><th align="center">åŠŸèƒ½è¯´æ˜</th><th align="center">å¸¸ç”¨å‚æ•° &amp; ç¤ºä¾‹</th></tr></thead><tbody><tr><td align="center"><strong>ç›®å½•æ“ä½œ</strong></td><td align="center"><code>pwd</code></td><td align="center">æ˜¾ç¤ºå½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„</td><td align="center">æ— å‚æ•°ç¤ºä¾‹ï¼š<code>pwd</code> â†’ <code>/home/user</code></td></tr><tr><td align="center"></td><td align="center"><code>cd</code></td><td align="center">åˆ‡æ¢å·¥ä½œç›®å½•</td><td align="center">- <code>cd ~</code>ï¼šåˆ‡æ¢åˆ°å½“å‰ç”¨æˆ·å®¶ç›®å½•- <code>cd ..</code>ï¼šåˆ‡æ¢åˆ°ä¸Šçº§ç›®å½•- <code>cd /usr/local</code>ï¼šåˆ‡æ¢åˆ°æŒ‡å®šç»å¯¹è·¯å¾„</td></tr><tr><td align="center"></td><td align="center"><code>ls</code></td><td align="center">åˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶å’Œå­ç›®å½•</td><td align="center">- <code>-l</code>ï¼šä»¥é•¿æ ¼å¼æ˜¾ç¤ºï¼ˆæƒé™ã€å¤§å°ã€æ—¶é—´ç­‰ï¼‰- <code>-a</code>ï¼šæ˜¾ç¤ºéšè—æ–‡ä»¶ï¼ˆä»¥ <code>.</code> å¼€å¤´çš„æ–‡ä»¶ï¼‰- <code>-h</code>ï¼šäººæ€§åŒ–æ˜¾ç¤ºæ–‡ä»¶å¤§å°ï¼ˆKB&#x2F;MB&#x2F;GBï¼‰ç¤ºä¾‹ï¼š<code>ls -lah</code></td></tr><tr><td align="center"></td><td align="center"><code>mkdir</code></td><td align="center">åˆ›å»ºæ–°ç›®å½•</td><td align="center">- <code>-p</code>ï¼šé€’å½’åˆ›å»ºå¤šçº§ç›®å½•ç¤ºä¾‹ï¼š<code>mkdir -p /tmp/test/abc</code></td></tr><tr><td align="center"></td><td align="center"><code>rmdir</code></td><td align="center">åˆ é™¤ç©ºç›®å½•</td><td align="center">ä»…èƒ½åˆ é™¤ç©ºç›®å½•ç¤ºä¾‹ï¼š<code>rmdir /tmp/test/abc</code></td></tr><tr><td align="center"><strong>æ–‡ä»¶æ“ä½œ</strong></td><td align="center"><code>touch</code></td><td align="center">åˆ›å»ºç©ºæ–‡ä»¶æˆ–ä¿®æ”¹æ–‡ä»¶æ—¶é—´æˆ³</td><td align="center">ç¤ºä¾‹ï¼š<code>touch newfile.txt</code> â†’ åˆ›å»ºç©ºæ–‡ä»¶</td></tr><tr><td align="center"></td><td align="center"><code>cp</code></td><td align="center">å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•</td><td align="center">- <code>-r</code>ï¼šé€’å½’å¤åˆ¶ç›®å½•ï¼ˆå¿…é€‰å‚æ•°ï¼‰- <code>-f</code>ï¼šå¼ºåˆ¶è¦†ç›–ç›®æ ‡æ–‡ä»¶ç¤ºä¾‹ 1ï¼š<code>cp file.txt /tmp/</code> â†’ å¤åˆ¶æ–‡ä»¶ç¤ºä¾‹ 2ï¼š<code>cp -r dir1 /tmp/</code> â†’ å¤åˆ¶ç›®å½•</td></tr><tr><td align="center"></td><td align="center"><code>mv</code></td><td align="center">ç§»åŠ¨ &#x2F; é‡å‘½åæ–‡ä»¶æˆ–ç›®å½•</td><td align="center">åŒä¸€ç›®å½•ä¸‹æ‰§è¡Œæ˜¯é‡å‘½åï¼Œè·¨ç›®å½•æ˜¯ç§»åŠ¨ç¤ºä¾‹ 1ï¼š<code>mv oldname.txt newname.txt</code> â†’ é‡å‘½åç¤ºä¾‹ 2ï¼š<code>mv file.txt /tmp/</code> â†’ ç§»åŠ¨æ–‡ä»¶</td></tr><tr><td align="center"></td><td align="center"><code>rm</code></td><td align="center">åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•</td><td align="center">- <code>-r</code>ï¼šé€’å½’åˆ é™¤ç›®å½•- <code>-f</code>ï¼šå¼ºåˆ¶åˆ é™¤ï¼Œä¸æç¤ºç¡®è®¤<strong>å±é™©å‘½ä»¤</strong>ï¼š<code>rm -rf /</code>ï¼ˆåˆ‡å‹¿æ‰§è¡Œï¼ä¼šåˆ é™¤ç³»ç»Ÿæ‰€æœ‰æ–‡ä»¶ï¼‰ç¤ºä¾‹ï¼š<code>rm -rf dir1</code> â†’ åˆ é™¤ç›®å½•åŠæ‰€æœ‰å†…å®¹</td></tr><tr><td align="center"><strong>æ–‡ä»¶æŸ¥çœ‹</strong></td><td align="center"><code>cat</code></td><td align="center">æŸ¥çœ‹æ–‡ä»¶å…¨éƒ¨å†…å®¹ï¼ˆé€‚åˆå°æ–‡ä»¶ï¼‰</td><td align="center">- <code>-n</code>ï¼šæ˜¾ç¤ºè¡Œå·ç¤ºä¾‹ï¼š<code>cat -n /etc/hosts</code></td></tr><tr><td align="center"></td><td align="center"><code>more</code></td><td align="center">åˆ†é¡µæŸ¥çœ‹å¤§æ–‡ä»¶ï¼ˆåªèƒ½å‘ä¸‹ç¿»é¡µï¼‰</td><td align="center">ç¤ºä¾‹ï¼š<code>more /var/log/messages</code> â†’ æŒ‰ç©ºæ ¼ç¿»é¡µï¼Œ<code>q</code> é€€å‡º</td></tr><tr><td align="center"></td><td align="center"><code>less</code></td><td align="center">åˆ†é¡µæŸ¥çœ‹å¤§æ–‡ä»¶ï¼ˆå¯ä¸Šä¸‹ç¿»é¡µï¼‰</td><td align="center">ç¤ºä¾‹ï¼š<code>less /var/log/syslog</code> â†’ æŒ‰ <code>â†‘/â†“</code> æ»šåŠ¨ï¼Œ<code>q</code> é€€å‡º</td></tr><tr><td align="center"></td><td align="center"><code>head</code></td><td align="center">æŸ¥çœ‹æ–‡ä»¶å‰ N è¡Œï¼ˆé»˜è®¤å‰ 10 è¡Œï¼‰</td><td align="center"><code>-n</code>ï¼šæŒ‡å®šè¡Œæ•°ç¤ºä¾‹ï¼š<code>head -n 5 file.txt</code> â†’ æŸ¥çœ‹å‰ 5 è¡Œ</td></tr><tr><td align="center"></td><td align="center"><code>tail</code></td><td align="center">æŸ¥çœ‹æ–‡ä»¶å N è¡Œï¼ˆé»˜è®¤å 10 è¡Œï¼‰</td><td align="center">- <code>-n</code>ï¼šæŒ‡å®šè¡Œæ•°- <code>-f</code>ï¼šå®æ—¶è·Ÿè¸ªæ–‡ä»¶æ–°å¢å†…å®¹ï¼ˆæ—¥å¿—ç›‘æ§å¸¸ç”¨ï¼‰ç¤ºä¾‹ 1ï¼š<code>tail -n 20 log.txt</code> â†’ æŸ¥çœ‹å 20 è¡Œç¤ºä¾‹ 2ï¼š<code>tail -f /var/log/nginx/access.log</code> â†’ å®æ—¶ç›‘æ§æ—¥å¿—</td></tr><tr><td align="center"><strong>æƒé™ç®¡ç†</strong></td><td align="center"><code>chmod</code></td><td align="center">ä¿®æ”¹æ–‡ä»¶ &#x2F; ç›®å½•çš„æƒé™</td><td align="center">ä¸¤ç§æ–¹å¼ï¼š1. ç¬¦å·æ³•ï¼š<code>chmod u+x file.sh</code>ï¼ˆç»™æ‰€æœ‰è€…åŠ æ‰§è¡Œæƒé™ï¼‰2. æ•°å­—æ³•ï¼š<code>chmod 755 file.sh</code>ï¼ˆr&#x3D;4,w&#x3D;2,x&#x3D;1ï¼Œ7&#x3D;4+2+1ï¼‰å¸¸ç”¨æƒé™ï¼š755ï¼ˆç”¨æˆ·å¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œå…¶ä»–åªè¯»å¯æ‰§è¡Œï¼‰ã€644ï¼ˆç”¨æˆ·å¯è¯»å¯å†™ï¼Œå…¶ä»–åªè¯»ï¼‰</td></tr><tr><td align="center"></td><td align="center"><code>chown</code></td><td align="center">ä¿®æ”¹æ–‡ä»¶ &#x2F; ç›®å½•çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„</td><td align="center">- <code>-R</code>ï¼šé€’å½’ä¿®æ”¹ç›®å½•æƒé™ç¤ºä¾‹ï¼š<code>chown -R user:group /home/user/data</code></td></tr><tr><td align="center"><strong>æ–‡ä»¶æŸ¥æ‰¾</strong></td><td align="center"><code>find</code></td><td align="center">æŒ‰è·¯å¾„ã€åç§°ã€å¤§å°ç­‰æ¡ä»¶æŸ¥æ‰¾æ–‡ä»¶</td><td align="center">- æŒ‰åç§°ï¼š<code>find /tmp -name &quot;*.txt&quot;</code> â†’ æŸ¥æ‰¾ tmp ä¸‹æ‰€æœ‰ txt æ–‡ä»¶- æŒ‰å¤§å°ï¼š<code>find / -size +100M</code> â†’ æŸ¥æ‰¾ç³»ç»Ÿä¸­å¤§äº 100M çš„æ–‡ä»¶- æŒ‰ç±»å‹ï¼š<code>find /home -type d</code> â†’ æŸ¥æ‰¾ home ä¸‹æ‰€æœ‰ç›®å½•</td></tr><tr><td align="center"></td><td align="center"><code>which</code></td><td align="center">æŸ¥æ‰¾å‘½ä»¤çš„å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„</td><td align="center">ç¤ºä¾‹ï¼š<code>which ls</code> â†’ <code>/usr/bin/ls</code></td></tr><tr><td align="center"></td><td align="center"><code>locate</code></td><td align="center">å¿«é€ŸæŸ¥æ‰¾æ–‡ä»¶ï¼ˆåŸºäºæ•°æ®åº“ç´¢å¼•ï¼‰</td><td align="center">éœ€å…ˆæ›´æ–°æ•°æ®åº“ï¼š<code>updatedb</code>ç¤ºä¾‹ï¼š<code>locate passwd</code> â†’ æŸ¥æ‰¾æ‰€æœ‰å« passwd çš„æ–‡ä»¶</td></tr><tr><td align="center"><strong>æ–‡ä»¶é“¾æ¥</strong></td><td align="center"><code>ln</code></td><td align="center">åˆ›å»ºç¡¬é“¾æ¥æˆ–è½¯é“¾æ¥</td><td align="center">- è½¯é“¾æ¥ï¼ˆå¸¸ç”¨ï¼‰ï¼š<code>ln -s /path/source /path/link</code> â†’ ç±»ä¼¼å¿«æ·æ–¹å¼- ç¡¬é“¾æ¥ï¼š<code>ln /path/source /path/link</code> â†’ ä¸æºæ–‡ä»¶å…±äº« inode</td></tr></tbody></table><hr><h3 id="4-2-è¡¥å……è¯´æ˜"><a href="#4-2-è¡¥å……è¯´æ˜" class="headerlink" title="4.2.è¡¥å……è¯´æ˜"></a>4.2.è¡¥å……è¯´æ˜</h3><ol><li><strong>éšè—æ–‡ä»¶</strong>ï¼šLinux ä¸­ä»¥ <code>.</code> å¼€å¤´çš„æ–‡ä»¶ä¸ºéšè—æ–‡ä»¶ï¼Œéœ€ç”¨ <code>ls -a</code> æŸ¥çœ‹ã€‚</li><li>ç»å¯¹è·¯å¾„ vs ç›¸å¯¹è·¯å¾„<ul><li>ç»å¯¹è·¯å¾„ï¼šä»æ ¹ç›®å½• <code>/</code> å¼€å§‹ï¼Œå¦‚ <code>/home/user/file.txt</code></li><li>ç›¸å¯¹è·¯å¾„ï¼šç›¸å¯¹äºå½“å‰ç›®å½•ï¼Œå¦‚ <code>../file.txt</code>ï¼ˆä¸Šçº§ç›®å½•çš„æ–‡ä»¶ï¼‰</li></ul></li><li><strong>æƒé™ç¬¦å·å«ä¹‰</strong>ï¼š<code>r</code>ï¼ˆè¯»ï¼Œ4ï¼‰ã€<code>w</code>ï¼ˆå†™ï¼Œ2ï¼‰ã€<code>x</code>ï¼ˆæ‰§è¡Œï¼Œ1ï¼‰ï¼Œæƒé™åˆ†ä¸‰ç±»ï¼š<code>u</code>ï¼ˆæ‰€æœ‰è€…ï¼‰ã€<code>g</code>ï¼ˆæ‰€å±ç»„ï¼‰ã€<code>o</code>ï¼ˆå…¶ä»–ç”¨æˆ·ï¼‰ã€‚</li></ol><h2 id="5-æ–‡ä»¶æ‰¹å¤„ç†"><a href="#5-æ–‡ä»¶æ‰¹å¤„ç†" class="headerlink" title="5.æ–‡ä»¶æ‰¹å¤„ç†"></a>5.æ–‡ä»¶æ‰¹å¤„ç†</h2><h3 id="5-1-Linux-æ–‡ä»¶æ‰¹å¤„ç†å‘½ä»¤è¡¨"><a href="#5-1-Linux-æ–‡ä»¶æ‰¹å¤„ç†å‘½ä»¤è¡¨" class="headerlink" title="5.1.Linux æ–‡ä»¶æ‰¹å¤„ç†å‘½ä»¤è¡¨"></a>5.1.Linux æ–‡ä»¶æ‰¹å¤„ç†å‘½ä»¤è¡¨</h3><table><thead><tr><th align="center">æ‰¹å¤„ç†å‘½ä»¤ &#x2F; æ ¸å¿ƒè¯­æ³•</th><th align="center">æ ¸å¿ƒç”¨é€”</th><th align="center">æ‰¹å¤„ç†ç¤ºä¾‹ï¼ˆåœºæ™¯ + æ‰§è¡Œå‘½ä»¤ï¼‰</th><th align="center"></th></tr></thead><tbody><tr><td align="center"><code>for å¾ªç¯</code></td><td align="center">éå†æŒ‡å®šæ–‡ä»¶ &#x2F; ç›®å½•ï¼Œæ‰§è¡Œè‡ªå®šä¹‰æ‰¹å¤„ç†æ“ä½œï¼ˆæ–°æ‰‹æ˜“ç†è§£ï¼‰</td><td align="center"><strong>åœºæ™¯</strong>ï¼šæ‰¹é‡å°†å½“å‰ç›®å½•ä¸‹æ‰€æœ‰ <code>.txt</code> æ–‡ä»¶é‡å‘½åä¸º <code>.bak``bash&lt;br&gt;for f in *.txt; do mv &quot;$f&quot; &quot;$&#123;f%.txt&#125;.bak&quot;; done&lt;br&gt;</code>ï¼ˆ<code>$&#123;f%.txt&#125;</code> è¡¨ç¤ºå»æ‰æ–‡ä»¶ååç¼€ <code>.txt</code>ï¼‰</td><td align="center"></td></tr><tr><td align="center"><code>find + xargs</code></td><td align="center">é«˜æ•ˆæŸ¥æ‰¾æ–‡ä»¶å¹¶æ‰¹é‡æ‰§è¡Œå‘½ä»¤ï¼ˆé€‚åˆå¤§é‡æ–‡ä»¶ï¼‰</td><td align="center"><strong>åœºæ™¯</strong>ï¼šæ‰¹é‡åˆ é™¤å½“å‰ç›®å½•åŠå­ç›®å½•ä¸‹æ‰€æœ‰ <code>.log</code> æ–‡ä»¶&#96;&#96;&#96;bashfind . -type f -name â€œ*.logâ€</td><td align="center">xargs rm -f&#96;&#96;&#96;ï¼ˆ<code>-type f</code> é™å®šæ–‡ä»¶ï¼Œ<code>-f</code> å¼ºåˆ¶åˆ é™¤ï¼Œé¿å…ç¡®è®¤ï¼‰</td></tr><tr><td align="center"><code>mv</code>ï¼ˆæ‰¹é‡é‡å‘½åï¼‰</td><td align="center">åŸºç¡€æ‰¹é‡é‡å‘½å &#x2F; ç§»åŠ¨æ–‡ä»¶</td><td align="center"><strong>åœºæ™¯</strong>ï¼šæ‰¹é‡å°† <code>file1.txt</code>ã€<code>file2.txt</code> ç§»åŠ¨åˆ° <code>backup</code> ç›®å½•<code>bash&lt;br&gt;mv file*.txt backup/&lt;br&gt;</code></td><td align="center"></td></tr><tr><td align="center"><code>cp</code>ï¼ˆæ‰¹é‡å¤åˆ¶ï¼‰</td><td align="center">æ‰¹é‡å¤åˆ¶æ–‡ä»¶åˆ°æŒ‡å®šç›®å½• &#x2F; æ‰¹é‡å¤‡ä»½æ–‡ä»¶</td><td align="center"><strong>åœºæ™¯</strong>ï¼šæ‰¹é‡å¤åˆ¶å½“å‰ç›®å½•ä¸‹æ‰€æœ‰ <code>.sh</code> è„šæœ¬åˆ° <code>/usr/local/bin``bash&lt;br&gt;cp *.sh /usr/local/bin/&lt;br&gt;</code></td><td align="center"></td></tr><tr><td align="center"><code>rm</code>ï¼ˆæ‰¹é‡åˆ é™¤ï¼‰</td><td align="center">æ‰¹é‡åˆ é™¤æŒ‡å®šç±»å‹ &#x2F; æ¡ä»¶çš„æ–‡ä»¶ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰</td><td align="center"><strong>åœºæ™¯</strong>ï¼šæ‰¹é‡åˆ é™¤å½“å‰ç›®å½•ä¸‹æ‰€æœ‰ç©ºæ–‡ä»¶ï¼ˆå¤§å°ä¸º 0ï¼‰<code>bash&lt;br&gt;rm -f $(find . -type f -size 0)&lt;br&gt;</code></td><td align="center"></td></tr><tr><td align="center"><code>sed</code>ï¼ˆæ‰¹é‡æ›¿æ¢å†…å®¹ï¼‰</td><td align="center">æ‰¹é‡ä¿®æ”¹å¤šä¸ªæ–‡ä»¶å†…çš„æ–‡æœ¬å†…å®¹</td><td align="center"><strong>åœºæ™¯</strong>ï¼šæ‰¹é‡å°†æ‰€æœ‰ <code>.conf</code> æ–‡ä»¶ä¸­çš„ <code>old_ip</code> æ›¿æ¢ä¸º <code>192.168.1.1``bash&lt;br&gt;sed -i &#39;s/old_ip/192.168.1.1/g&#39; *.conf&lt;br&gt;</code>ï¼ˆ<code>-i</code> ç›´æ¥ä¿®æ”¹æ–‡ä»¶ï¼Œ<code>g</code> å…¨å±€æ›¿æ¢ï¼‰</td><td align="center"></td></tr><tr><td align="center"><code>rename</code>ï¼ˆä¸“ç”¨é‡å‘½åï¼‰</td><td align="center">æ›´ç®€æ´çš„æ‰¹é‡é‡å‘½åï¼ˆæ”¯æŒæ­£åˆ™ï¼‰</td><td align="center"><strong>åœºæ™¯</strong>ï¼šæ‰¹é‡å°†æ‰€æœ‰æ–‡ä»¶åä¸­çš„ <code>test</code> æ›¿æ¢ä¸º <code>prod</code>ï¼ˆå¦‚ test1.txt â†’ prod1.txtï¼‰<code>bash&lt;br&gt;rename &#39;s/test/prod/&#39; *.txt&lt;br&gt;</code>ï¼ˆéœ€å…ˆå®‰è£…ï¼š<code>apt install rename</code>&#x2F;<code>yum install rename</code>ï¼‰</td><td align="center"></td></tr><tr><td align="center"><code>awk</code>ï¼ˆæ‰¹é‡å¤„ç†å†…å®¹ï¼‰</td><td align="center">æ‰¹é‡æå– &#x2F; ç­›é€‰æ–‡ä»¶ä¸­çš„æŒ‡å®šæ•°æ®</td><td align="center"><strong>åœºæ™¯</strong>ï¼šæ‰¹é‡æå–æ‰€æœ‰ <code>.csv</code> æ–‡ä»¶ä¸­ç¬¬ 2 åˆ—çš„å†…å®¹å¹¶ä¿å­˜åˆ° <code>result.txt``bash&lt;br&gt;awk -F &#39;,&#39; &#39;&#123;print $2&#125;&#39; *.csv &gt; result.txt&lt;br&gt;</code>ï¼ˆ<code>-F &#39;,&#39;</code> æŒ‡å®šåˆ†éš”ç¬¦ä¸ºé€—å·ï¼‰</td><td align="center"></td></tr></tbody></table><h3 id="5-2-æ­£åˆ™è¡¨è¾¾å¼ç¬¦å·-å­—ç¬¦ç±»-å‘½ä»¤è¡¨"><a href="#5-2-æ­£åˆ™è¡¨è¾¾å¼ç¬¦å·-å­—ç¬¦ç±»-å‘½ä»¤è¡¨" class="headerlink" title="5.2.æ­£åˆ™è¡¨è¾¾å¼ç¬¦å· &#x2F; å­—ç¬¦ç±» å‘½ä»¤è¡¨"></a>5.2.æ­£åˆ™è¡¨è¾¾å¼ç¬¦å· &#x2F; å­—ç¬¦ç±» å‘½ä»¤è¡¨</h3><table><thead><tr><th align="center">æ­£åˆ™ç¬¦å·ï¼ˆå‘½ä»¤ï¼‰</th><th align="center">ç”¨é€”è¯´æ˜</th><th align="center">ç¤ºä¾‹ï¼ˆåŒ¹é… &#x2F; ä¸åŒ¹é…ï¼‰</th><th align="center"></th></tr></thead><tbody><tr><td align="center"><code>*</code></td><td align="center">é‡è¯ï¼ŒåŒ¹é…<strong>å‰é¢çš„å­—ç¬¦ &#x2F; è¡¨è¾¾å¼ 0 æ¬¡æˆ–å¤šæ¬¡</strong>ï¼ˆè´ªå©ªåŒ¹é…ï¼‰</td><td align="center"><code>a*</code>ï¼šåŒ¹é…ç©ºå­—ç¬¦ã€<code>a</code>ã€<code>aa</code>ã€<code>aaa</code>ï¼›ä¸åŒ¹é… <code>b</code>ã€<code>1</code>ï¼ˆä»…é’ˆå¯¹å‰å¯¼å­—ç¬¦<code>a</code>ï¼‰ä¾‹ï¼š&#96;echoâ€aaa bâ€</td><td align="center">grep -o â€˜a*â€™<code>è¾“å‡º</code>aaa<code>ã€ç©ºã€</code>b&#96; æ—çš„ç©º</td></tr><tr><td align="center"><code>?</code></td><td align="center">é‡è¯ï¼ŒåŒ¹é…<strong>å‰é¢çš„å­—ç¬¦ &#x2F; è¡¨è¾¾å¼ 0 æ¬¡æˆ– 1 æ¬¡</strong>ï¼ˆéè´ªå©ªåŒ¹é…ï¼‰</td><td align="center"><code>a?</code>ï¼šåŒ¹é…ç©ºå­—ç¬¦ã€<code>a</code>ï¼›ä¸åŒ¹é… <code>aa</code>ã€<code>aaa</code>ä¾‹ï¼š&#96;echoâ€a aa aaaâ€</td><td align="center">grep -o â€˜a?â€™<code>è¾“å‡º</code>a<code>ã€ç©ºã€</code>a<code>ã€</code>a<code>ã€ç©ºã€</code>a<code>ã€</code>a<code>ã€</code>a<code>ã€ç©º</code></td></tr><tr><td align="center"><code>[[:alpha:]]</code></td><td align="center">åŒ¹é…ä»»æ„<strong>å­—æ¯å­—ç¬¦</strong>ï¼ˆåŒ…å«å¤§å°å†™ï¼Œå¤šè¯­è¨€ç¯å¢ƒé€‚é…ï¼‰</td><td align="center">åŒ¹é…ï¼š<code>a</code>ã€<code>B</code>ã€<code>ä¸­</code>ï¼ˆä¸­æ–‡ç¯å¢ƒï¼‰ï¼›ä¸åŒ¹é…ï¼š<code>1</code>ã€<code>!</code>ã€ï¼ˆç©ºæ ¼ï¼‰ä¾‹ï¼š&#96;echoâ€Ab123 ä¸­ï¼â€</td><td align="center">grep -o â€˜[[:alpha:]]â€™<code>è¾“å‡º</code>A<code>ã€</code>b<code>ã€</code>ä¸­ &#96;</td></tr><tr><td align="center"><code>[[:digit:]]</code></td><td align="center">åŒ¹é…ä»»æ„<strong>æ•°å­—å­—ç¬¦</strong>ï¼Œç­‰ä»·äº [0-9]</td><td align="center">åŒ¹é…ï¼š<code>0</code>ã€<code>5</code>ã€<code>9</code>ï¼›ä¸åŒ¹é…ï¼š<code>a</code>ã€<code>$</code>ã€ï¼ˆç©ºæ ¼ï¼‰ä¾‹ï¼š&#96;echoâ€abc123defâ€</td><td align="center">grep -o â€˜[[:digit:]]â€™<code>è¾“å‡º</code>1<code>ã€</code>2<code>ã€</code>3&#96;</td></tr><tr><td align="center"><code>[[:lower:]]</code></td><td align="center">åŒ¹é…ä»»æ„<strong>å°å†™å­—æ¯</strong>ï¼Œç­‰ä»·äº [a-z]</td><td align="center">åŒ¹é…ï¼š<code>a</code>ã€<code>z</code>ã€<code>m</code>ï¼›ä¸åŒ¹é…ï¼š<code>A</code>ã€<code>1</code>ã€<code>!</code>ä¾‹ï¼š&#96;echoâ€AbCdEf123â€</td><td align="center">grep -o â€˜[[:lower:]]â€™<code>è¾“å‡º</code>b<code>ã€</code>d<code>ã€</code>f&#96;</td></tr><tr><td align="center"><code>[[:upper:]]</code></td><td align="center">åŒ¹é…ä»»æ„<strong>å¤§å†™å­—æ¯</strong>ï¼Œç­‰ä»·äº [A-Z]</td><td align="center">åŒ¹é…ï¼š<code>A</code>ã€<code>Z</code>ã€<code>M</code>ï¼›ä¸åŒ¹é…ï¼š<code>a</code>ã€<code>9</code>ã€<code>@</code>ä¾‹ï¼š&#96;echoâ€AbCdEf123â€</td><td align="center">grep -o â€˜[[:upper:]]â€™<code>è¾“å‡º</code>A<code>ã€</code>C<code>ã€</code>E&#96;</td></tr><tr><td align="center"><code>[[:alnum:]]</code></td><td align="center">åŒ¹é…ä»»æ„<strong>å­—æ¯æˆ–æ•°å­—å­—ç¬¦</strong>ï¼Œç­‰ä»·äº [a-zA-Z0-9]</td><td align="center">åŒ¹é…ï¼š<code>a</code>ã€<code>B</code>ã€<code>8</code>ï¼›ä¸åŒ¹é…ï¼š<code>!</code>ã€ï¼ˆç©ºæ ¼ï¼‰ã€<code>@</code>ä¾‹ï¼š&#96;echoâ€abc123!@#â€</td><td align="center">grep -o â€˜[[:alnum:]]â€™<code>è¾“å‡º</code>a<code>ã€</code>b<code>ã€</code>c<code>ã€</code>1<code>ã€</code>2<code>ã€</code>3&#96;</td></tr><tr><td align="center"><code>[[:punct:]]</code></td><td align="center">åŒ¹é…ä»»æ„<strong>æ ‡ç‚¹ç¬¦å·</strong>ï¼ˆéå­—æ¯ã€æ•°å­—ã€ç©ºç™½çš„å¯æ‰“å°å­—ç¬¦ï¼‰</td><td align="center">åŒ¹é…ï¼š<code>!</code>ã€<code>@</code>ã€<code>#</code>ã€<code>,</code>ã€<code>.</code>ã€<code>:</code>ï¼›ä¸åŒ¹é…ï¼š<code>a</code>ã€<code>5</code>ã€ï¼ˆç©ºæ ¼ï¼‰ä¾‹ï¼š&#96;echoâ€abc!123@defâ€</td><td align="center">grep -o â€˜[[:punct:]]â€™<code>è¾“å‡º</code>!<code>ã€</code>@&#96;</td></tr><tr><td align="center"><code>[[:space:]]</code></td><td align="center">åŒ¹é…ä»»æ„<strong>ç©ºç™½å­—ç¬¦</strong>ï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ \tã€æ¢è¡Œç¬¦ \n ç­‰ï¼‰</td><td align="center">åŒ¹é…ï¼šï¼ˆç©ºæ ¼ï¼‰ã€<code>\t</code>ï¼ˆåˆ¶è¡¨ç¬¦ï¼‰ã€<code>\n</code>ï¼ˆæ¢è¡Œï¼‰ï¼›ä¸åŒ¹é…ï¼š<code>a</code>ã€<code>9</code>ã€<code>!</code>ä¾‹ï¼š&#96;echoâ€a b\tc\ndâ€</td><td align="center">grep -o â€˜[[:space:]]â€™<code> è¾“å‡º ç©ºæ ¼ã€</code>\t<code>ã€</code>\n&#96;</td></tr></tbody></table><h3 id="5-3-è¡¥å……è¯´æ˜"><a href="#5-3-è¡¥å……è¯´æ˜" class="headerlink" title="5.3.è¡¥å……è¯´æ˜"></a>5.3.è¡¥å……è¯´æ˜</h3><ol><li>ç¤ºä¾‹ä¸­çš„ <code>grep -o</code> æ˜¯ç»ˆç«¯å¸¸ç”¨å‘½ä»¤ï¼Œ<code>-o</code> å‚æ•°è¡¨ç¤º â€œåªè¾“å‡ºåŒ¹é…åˆ°çš„éƒ¨åˆ†â€ï¼Œæ–°æ‰‹å¯ç›´æ¥å¤åˆ¶å‘½ä»¤åˆ°ç»ˆç«¯æ‰§è¡Œï¼Œç›´è§‚çœ‹åˆ°æ•ˆæœï¼›</li><li>éƒ¨åˆ†å­—ç¬¦ç±»ï¼ˆå¦‚ <code>[[:alpha:]]</code>ï¼‰åœ¨ä¸­æ–‡ &#x2F; å¤šè¯­è¨€ç³»ç»Ÿä¸­å¯åŒ¹é…éè‹±æ–‡å­—æ¯ï¼ˆå¦‚ä¸­æ–‡ã€æ—¥æ–‡ï¼‰ï¼Œè€Œ <code>[a-zA-Z]</code> ä»…åŒ¹é…è‹±æ–‡å­—æ¯ï¼Œè¿™æ˜¯ POSIX å­—ç¬¦ç±»çš„ä¼˜åŠ¿ã€‚</li></ol><h3 id="5-4-æ€»ç»“"><a href="#5-4-æ€»ç»“" class="headerlink" title="5.4.æ€»ç»“"></a>5.4.æ€»ç»“</h3><ol><li><code>*</code>&#x2F;<code>?</code> æ˜¯<strong>é‡è¯</strong>ï¼Œç¤ºä¾‹æ ¸å¿ƒçœ‹ â€œå‰å¯¼å­—ç¬¦çš„åŒ¹é…æ¬¡æ•°â€ï¼Œè€ŒéåŒ¹é…ç‰¹å®šå­—ç¬¦ï¼›</li><li><code>[[:xxx:]]</code> å­—ç¬¦ç±»çš„ç¤ºä¾‹éœ€åŒºåˆ† â€œåŒ¹é… &#x2F; ä¸åŒ¹é…â€ï¼Œå¿«é€ŸæŒæ¡å­—ç¬¦èŒƒå›´ï¼›</li><li>ç»“åˆ <code>grep -o</code> å‘½ä»¤å¯ç›´æ¥éªŒè¯ç¤ºä¾‹æ•ˆæœï¼Œæ˜¯æ–°æ‰‹å­¦ä¹ æ­£åˆ™çš„é«˜æ•ˆæ–¹å¼ã€‚</li></ol><h2 id="6-Linuxä¸­çš„è¾“å…¥å’Œè¾“å‡º"><a href="#6-Linuxä¸­çš„è¾“å…¥å’Œè¾“å‡º" class="headerlink" title="6.Linuxä¸­çš„è¾“å…¥å’Œè¾“å‡º"></a>6.Linuxä¸­çš„è¾“å…¥å’Œè¾“å‡º</h2><h3 id="6-1-å­—ç¬¦è®¾å¤‡æ˜¯å•¥ï¼Ÿ"><a href="#6-1-å­—ç¬¦è®¾å¤‡æ˜¯å•¥ï¼Ÿ" class="headerlink" title="6.1.å­—ç¬¦è®¾å¤‡æ˜¯å•¥ï¼Ÿ"></a>6.1.å­—ç¬¦è®¾å¤‡æ˜¯å•¥ï¼Ÿ</h3><p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œ<strong>å­—ç¬¦è®¾å¤‡ï¼ˆCharacter Deviceï¼‰</strong> æ˜¯ä¸€ç±»ä»¥<strong>å­—ç¬¦æµï¼ˆå­—èŠ‚æµï¼‰</strong> ä¸ºå•ä½è¿›è¡Œæ•°æ®ä¼ è¾“çš„ç¡¬ä»¶è®¾å¤‡ï¼Œä¹Ÿæ˜¯ Linux è®¾å¤‡æ–‡ä»¶çš„ä¸¤å¤§æ ¸å¿ƒåˆ†ç±»ä¹‹ä¸€ï¼ˆå¦ä¸€ç±»æ˜¯å—è®¾å¤‡ï¼‰ã€‚</p><p><strong>ä¸å—è®¾å¤‡çš„æ ¸å¿ƒåŒºåˆ«</strong></p><table><thead><tr><th align="center">ç‰¹æ€§</th><th align="center">å­—ç¬¦è®¾å¤‡</th><th align="center">å—è®¾å¤‡</th></tr></thead><tbody><tr><td align="center">è®¿é—®å•ä½</td><td align="center">å­—èŠ‚ï¼ˆå­—ç¬¦æµï¼‰</td><td align="center">å›ºå®šå¤§å°çš„å—ï¼ˆé€šå¸¸ 512B&#x2F;4KBï¼‰</td></tr><tr><td align="center">è®¿é—®æ–¹å¼</td><td align="center">ä¸²è¡Œã€é¡ºåºè®¿é—®ï¼Œä¸æ”¯æŒéšæœºè®¿é—®</td><td align="center">æ”¯æŒéšæœºè®¿é—®ï¼ˆå¯è·³è½¬åˆ°ä»»æ„å—ï¼‰</td></tr><tr><td align="center">ç¼“å†²åŒº</td><td align="center">æ— ç¼“å†²æˆ–å°ç¼“å†²</td><td align="center">æœ‰è¾ƒå¤§çš„å†…å­˜ç¼“å†²åŒºï¼ˆæå‡è¯»å†™æ•ˆç‡ï¼‰</td></tr><tr><td align="center">æ–‡ä»¶ç±»å‹æ ‡è¯†</td><td align="center"><code>c</code></td><td align="center"><code>b</code></td></tr><tr><td align="center">å…¸å‹è®¾å¤‡</td><td align="center">é”®ç›˜ã€é¼ æ ‡ã€ä¸²å£</td><td align="center">ç¡¬ç›˜ã€U ç›˜ã€SD å¡</td></tr></tbody></table><h3 id="6-2-è¾“å…¥ä¸è¾“å‡º"><a href="#6-2-è¾“å…¥ä¸è¾“å‡º" class="headerlink" title="6.2.è¾“å…¥ä¸è¾“å‡º"></a>6.2.è¾“å…¥ä¸è¾“å‡º</h3><p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œ<strong>è¾“å…¥ï¼ˆInputï¼‰å’Œè¾“å‡ºï¼ˆOutputï¼‰çš„æ ¸å¿ƒåŸç†å›´ç»• â€œä¸€åˆ‡çš†æ–‡ä»¶â€ æ€æƒ³å±•å¼€</strong>ï¼Œæœ¬è´¨æ˜¯<strong>ç”¨æˆ·ç¨‹åºé€šè¿‡å†…æ ¸æä¾›çš„æ¥å£ï¼Œå¯¹æ–‡ä»¶æè¿°ç¬¦è¿›è¡Œè¯»å†™æ“ä½œ</strong>ï¼Œå†…æ ¸å†ä½œä¸ºä¸­ä»‹å®Œæˆç”¨æˆ·ç¨‹åºä¸ç¡¬ä»¶è®¾å¤‡çš„äº¤äº’ã€‚</p><p>Linux æŠŠæ‰€æœ‰è¾“å…¥è¾“å‡ºè®¾å¤‡éƒ½æŠ½è±¡æˆ<strong>æ–‡ä»¶</strong>ï¼Œç”¨æˆ·ç¨‹åºæ— éœ€å…³å¿ƒç¡¬ä»¶ç»†èŠ‚ï¼Œåªéœ€é€šè¿‡<strong>æ–‡ä»¶æè¿°ç¬¦ï¼ˆFile Descriptorï¼ŒFDï¼‰</strong> æ¥æ ‡è¯†å’Œæ“ä½œè¿™äº› â€œæ–‡ä»¶â€ã€‚</p><ol><li><p><strong>æ–‡ä»¶æè¿°ç¬¦</strong></p><p>æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ï¼Œå†…æ ¸ç”¨å®ƒæ¥ç´¢å¼•å’Œç®¡ç†æ‰“å¼€çš„æ–‡ä»¶ï¼ˆåŒ…æ‹¬ç¡¬ä»¶è®¾å¤‡ã€æ™®é€šæ–‡ä»¶ã€ç®¡é“ç­‰ï¼‰ã€‚</p><p>ç³»ç»Ÿé»˜è®¤åˆ†é… 3 ä¸ªæ ‡å‡†æ–‡ä»¶æè¿°ç¬¦ï¼Œä¾›æ‰€æœ‰è¿›ç¨‹ä½¿ç”¨ï¼š</p></li></ol><table><thead><tr><th align="left">æ–‡ä»¶æè¿°ç¬¦</th><th align="left">åç§°</th><th align="left">å¯¹åº”è®¾å¤‡ &#x2F; ç”¨é€”</th><th align="left">ç¼©å†™</th></tr></thead><tbody><tr><td align="left">0</td><td align="left">æ ‡å‡†è¾“å…¥</td><td align="left">é”®ç›˜ã€ç®¡é“è¾“å…¥ç­‰</td><td align="left">stdin</td></tr><tr><td align="left">1</td><td align="left">æ ‡å‡†è¾“å‡º</td><td align="left">ç»ˆç«¯ã€ç®¡é“è¾“å‡ºç­‰</td><td align="left">stdout</td></tr><tr><td align="left">2</td><td align="left">æ ‡å‡†é”™è¯¯</td><td align="left">ç»ˆç«¯ï¼ˆä¸“é—¨è¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼‰</td><td align="left">stderr</td></tr></tbody></table><ol start="2"><li><p><strong>æ ¸å¿ƒåŸåˆ™</strong></p><p> è¾“å…¥ &#x3D; ä»æ–‡ä»¶æè¿°ç¬¦ <strong>è¯»å–æ•°æ®</strong>ï¼ˆå¦‚ä» stdin è¯»é”®ç›˜è¾“å…¥ï¼‰</p><p> è¾“å‡º &#x3D; å‘æ–‡ä»¶æè¿°ç¬¦ <strong>å†™å…¥æ•°æ®</strong>ï¼ˆå¦‚å‘ stdout å†™ç»ˆç«¯è¾“å‡ºï¼‰</p></li><li><p><strong>æœ¬è´¨</strong></p><p>Linux è¾“å…¥è¾“å‡ºçš„æœ¬è´¨æ˜¯ <strong>â€œç”¨æˆ·ç¨‹åº â†” å†…æ ¸ â†” ç¡¬ä»¶â€ çš„ä¸‰å±‚äº¤äº’æ¨¡å‹</strong>ï¼š</p><ul><li>ç”¨æˆ·ç¨‹åºï¼šé€šè¿‡ <code>read/write</code> ç³»ç»Ÿè°ƒç”¨å‘èµ· IO è¯·æ±‚ï¼Œåªæ“ä½œæ–‡ä»¶æè¿°ç¬¦ï¼Œä¸ç¢°ç¡¬ä»¶ã€‚</li><li>å†…æ ¸ï¼šè´Ÿè´£ç®¡ç†æ–‡ä»¶æè¿°ç¬¦ã€ç¼“å†²åŒºï¼Œä»¥åŠè®¾å¤‡é©±åŠ¨ï¼Œæ˜¯ IO äº¤äº’çš„æ ¸å¿ƒä¸­ä»‹ã€‚</li><li>ç¡¬ä»¶ï¼šç”±é©±åŠ¨ç¨‹åºæ§åˆ¶ï¼Œå®Œæˆæ•°æ®çš„ç‰©ç†è¾“å…¥è¾“å‡ºï¼ˆå¦‚é”®ç›˜æ¥æ”¶æŒ‰é”®ã€å±å¹•æ˜¾ç¤ºå­—ç¬¦ï¼‰ã€‚</li></ul></li></ol><h1 id="26-1-14-å¤ä¹ "><a href="#26-1-14-å¤ä¹ " class="headerlink" title="26-1-14 (å¤ä¹ )"></a>26-1-14 (å¤ä¹ )</h1><h2 id="1-Rhel9-6å®‰è£…"><a href="#1-Rhel9-6å®‰è£…" class="headerlink" title="1.Rhel9.6å®‰è£…"></a>1.Rhel9.6å®‰è£…</h2><p> <img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_11-20-55.png" alt="PixPin_2026-01-17_11-20-55"></p><blockquote><p>é€‰é¡¹â€“&gt;é«˜çº§â€“&gt;å›ºä»¶ç±»å‹ æ”¹ä¸º<strong>BIOS</strong></p></blockquote><blockquote><p>å®‰è£…æºé€‰æ‹© æœåŠ¡å™¨</p></blockquote><p><strong>è™šæ‹Ÿç½‘ç»œé…ç½®</strong></p><p> <img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_11-26-38.png" alt="PixPin_2026-01-17_11-26-38"></p><p> <img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_11-26-45.png" alt="PixPin_2026-01-17_11-26-45"></p><h2 id="2-Rhel9-6é…ç½®"><a href="#2-Rhel9-6é…ç½®" class="headerlink" title="2.Rhel9.6é…ç½®"></a>2.Rhel9.6é…ç½®</h2><h3 id="2-1-å…³é—­å®‰å…¨é…ç½®"><a href="#2-1-å…³é—­å®‰å…¨é…ç½®" class="headerlink" title="2.1.å…³é—­å®‰å…¨é…ç½®"></a>2.1.å…³é—­å®‰å…¨é…ç½®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å…³é—­é˜²ç«å¢™</span></span><br><span class="line">[root@base ~]# systemctl <span class="built_in">disable</span> --now firewalld</span><br><span class="line">Removed <span class="string">&quot;/etc/systemd/system/multi-user.target.wants/firewalld.service&quot;</span>.</span><br><span class="line">Removed <span class="string">&quot;/etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service&quot;</span>.</span><br><span class="line">[root@base ~]# systemctl mask firewalld</span><br><span class="line">Created symlink /etc/systemd/system/firewalld.service â†’ /dev/null.</span><br><span class="line"></span><br><span class="line"><span class="comment">#å…³é—­SELiunx</span></span><br><span class="line">[root@base ~]# vim /etc/sysconfig/selinux</span><br><span class="line">SELINUX=disabled</span><br></pre></td></tr></table></figure><h3 id="2-2-æ›´æ”¹ç½‘ç»œé…ç½®"><a href="#2-2-æ›´æ”¹ç½‘ç»œé…ç½®" class="headerlink" title="2.2.æ›´æ”¹ç½‘ç»œé…ç½®"></a>2.2.æ›´æ”¹ç½‘ç»œé…ç½®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@base ~]# vim /boot/loader/entries/1199b04b0d974659ad491305f98dcfe0-5.14.0-570.12.1.el9_6.x86_64.conf</span><br><span class="line">åœ¨quiet æ·»åŠ  net.ifnames=0</span><br><span class="line">[root@base ~]# <span class="built_in">cd</span> /etc/NetworkManager/system-connections/</span><br><span class="line">[root@base system-connections]# <span class="built_in">mv</span> ens160.nmconnection eth0.nmconnection</span><br><span class="line">[root@base system-connections]# vim eth0.nmconnection</span><br><span class="line">ä¿®æ”¹<span class="built_in">id</span>ä¸interface-nameä¸º eth0</span><br><span class="line">åˆ é™¤uuid</span><br><span class="line"><span class="comment">#å¦‚æœç½‘å¡å‡ºé—®é¢˜</span></span><br><span class="line">nmcli connection reload</span><br><span class="line">nmcli connection up eth0</span><br><span class="line">nmcli networking</span><br><span class="line">nmcli networking on</span><br><span class="line">nmcli networking show</span><br><span class="line">ifconfig</span><br></pre></td></tr></table></figure><h3 id="2-3-æ°¸ä¹…æŒ‚è½½"><a href="#2-3-æ°¸ä¹…æŒ‚è½½" class="headerlink" title="2.3.æ°¸ä¹…æŒ‚è½½"></a>2.3.æ°¸ä¹…æŒ‚è½½</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@base ~]# <span class="built_in">mkdir</span> /rhel9</span><br><span class="line">[root@base ~]# mount /dev/cdrom /rhel9/</span><br><span class="line">mount: /rhel9: WARNING: <span class="built_in">source</span> write-protected, mounted read-only.</span><br><span class="line">[root@base ~]# vim /etc/rc.d/rc.local</span><br><span class="line">æœ€åä¸€è¡Œæ·»åŠ mount /dev/cdrom /rhel9</span><br><span class="line">[root@base ~]# vim /etc/rc.d/rc.local</span><br><span class="line">[root@base ~]# <span class="built_in">chmod</span> +x /etc/rc.d/rc.local</span><br></pre></td></tr></table></figure><h3 id="2-4-æºä»“åº“é…ç½®"><a href="#2-4-æºä»“åº“é…ç½®" class="headerlink" title="2.4.æºä»“åº“é…ç½®"></a>2.4.æºä»“åº“é…ç½®</h3><h4 id="2-4-1-æœ¬åœ°ä»“åº“æº"><a href="#2-4-1-æœ¬åœ°ä»“åº“æº" class="headerlink" title="2.4.1.æœ¬åœ°ä»“åº“æº"></a>2.4.1.æœ¬åœ°ä»“åº“æº</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@base ~]# <span class="built_in">cd</span> /etc/yum.repos.d/</span><br><span class="line">[root@base yum.repos.d]# vim rhel.repo</span><br><span class="line">[AppStarem]</span><br><span class="line">name = AppStream</span><br><span class="line">baseurl = file:///rhel9/AppStream</span><br><span class="line">gpgcheck = 0</span><br><span class="line">[BaseOS]</span><br><span class="line">name = BaseOS</span><br><span class="line">baseurl = file:///rhel9/BaseOS</span><br><span class="line">gpgcheck = 0</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ£€æµ‹</span></span><br><span class="line">[root@base yum.repos.d]# dnf list httpd</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="2-4-2-ç½‘ç»œæº"><a href="#2-4-2-ç½‘ç»œæº" class="headerlink" title="2.4.2.ç½‘ç»œæº"></a>2.4.2.ç½‘ç»œæº</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#dockerå®¹å™¨çš„ç½‘ç»œæº</span></span><br><span class="line">https://mirrors.aliyun.com/docker-ce/linux/rhel/9.6/x86_64/stable/</span><br><span class="line"><span class="comment">#epelæº</span></span><br><span class="line">https://mirrors.aliyun.com/epel-archive/9.6-2025-11-11/Everything/x86_64/</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ£€æµ‹</span></span><br><span class="line">[root@base ~]# dnf search docker</span><br><span class="line">[root@base ~]# dnf search ansible</span><br></pre></td></tr></table></figure><h4 id="2-4-3-è‡ªå»ºä»“åº“æº"><a href="#2-4-3-è‡ªå»ºä»“åº“æº" class="headerlink" title="2.4.3.è‡ªå»ºä»“åº“æº"></a>2.4.3.è‡ªå»ºä»“åº“æº</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@base ~]# dnf install httpd -y</span><br><span class="line">[root@base ~]# systemctl <span class="built_in">enable</span> --now httpd</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/httpd.service â†’ /usr/lib/systemd/system/httpd.service.</span><br><span class="line">[root@base ~]# <span class="built_in">mkdir</span> /var/www/html/software</span><br><span class="line">[root@base ~]# dnf install docker-ce --downloadonly --destdir /mnt -y</span><br><span class="line">[root@base ~]# <span class="built_in">mv</span> /mnt/* /var/www/html/software/</span><br><span class="line">[root@base ~]# dnf install createrepo  -y</span><br><span class="line">[root@base ~]# createrepo -v /var/www/html/software/</span><br><span class="line">[root@base yum.repos.d]# vim software.repo</span><br><span class="line">[software]</span><br><span class="line">name = software</span><br><span class="line">baseurl = http://172.25.254.128/software/</span><br><span class="line">gpgcheck = 0</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ£€æµ‹</span></span><br><span class="line">[root@base ~]# dnf info docker-ce.x86_64</span><br></pre></td></tr></table></figure><h1 id="26-1-16-å¤ä¹ "><a href="#26-1-16-å¤ä¹ " class="headerlink" title="26-1-16 (å¤ä¹ )"></a>26-1-16 (å¤ä¹ )</h1><h2 id="1-ç½‘ç»œç®¡ç†"><a href="#1-ç½‘ç»œç®¡ç†" class="headerlink" title="1.ç½‘ç»œç®¡ç†"></a>1.ç½‘ç»œç®¡ç†</h2><h3 id="1-1-ç½‘ç»œipé…ç½®"><a href="#1-1-ç½‘ç»œipé…ç½®" class="headerlink" title="1.1.ç½‘ç»œipé…ç½®"></a>1.1.ç½‘ç»œipé…ç½®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ¤æ–­ç½‘å¡æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">[root@node1 system-connections]# <span class="built_in">ls</span> /sys/class/net/ | grep eth1</span><br><span class="line">eth1</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ¤æ–­ç½‘å¡æ˜¯å¦è¢«ä½¿ç”¨</span></span><br><span class="line">[root@node1 system-connections]# nmcli connection show</span><br><span class="line">NAME  UUID                                  TYPE      DEVICE</span><br><span class="line">eth0  7ba00b1d-8cdd-30da-91ad-bb83ed4f7474  ethernet  eth0</span><br><span class="line">lo    d97aa458-8557-4dd1-a224-0167b68b3f84  loopback  lo</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹ç½‘å¡ip</span></span><br><span class="line">[root@node1 ~]# nmcli connection modify eth0 ipv4.addresses 172.25.254.130/24</span><br><span class="line"><span class="comment"># é‡æ–°è¿æ¥ç½‘å¡</span></span><br><span class="line">[root@node1 system-connections]# nmcli connection reload</span><br><span class="line">[root@node1 system-connections]# nmcli connection up eth0</span><br><span class="line"></span><br><span class="line">[root@node1 ~]# <span class="built_in">cd</span> /etc/NetworkManager/system-connections/</span><br><span class="line">[root@node1 system-connections]# vim eth1.nmconnection</span><br><span class="line">[connection]</span><br><span class="line"><span class="built_in">id</span>=eth1</span><br><span class="line"><span class="built_in">type</span>=ethernet</span><br><span class="line">interface-name=eth1</span><br><span class="line"></span><br><span class="line">[ipv4]</span><br><span class="line">method=manual</span><br><span class="line">address1=172.25.254.100/24</span><br><span class="line">gateway=172.25.254.2</span><br><span class="line">dns=114.114.114.114;</span><br><span class="line"></span><br><span class="line">[root@node1 system-connections]# <span class="built_in">chmod</span>  600 eth1.nmconnection</span><br><span class="line"></span><br><span class="line">ip a s eth1<span class="comment">#æŸ¥çœ‹ip</span></span><br><span class="line">route  -n<span class="comment">#ç½‘å…³</span></span><br><span class="line"><span class="built_in">cat</span> /etc/resolv.conf<span class="comment">#æŸ¥çœ‹dns</span></span><br></pre></td></tr></table></figure><p>1.2.ç½‘ç»œè„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># ===================== å‚æ•°è¯´æ˜ï¼ˆç»Ÿä¸€é¡ºåºï¼Œé¿å…æ··æ·†ï¼‰=====================</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># ç”¨æ³•: vmset.sh &lt;ä¸»æœºå&gt; &lt;ç½‘å¡å&gt; &lt;IPåœ°å€&gt; [å¯é€‰å‚æ•°ï¼šnogateway/ç½‘å…³]</span></span><br><span class="line"><span class="comment"># ç¤ºä¾‹1ï¼šå¸¦ç½‘å…³ï¼ˆé»˜è®¤172.25.254.2ï¼‰â†’ ä¸»ç½‘å¡ç”¨</span></span><br><span class="line"><span class="comment">#    vmset.sh base eth0 172.25.254.100</span></span><br><span class="line"><span class="comment"># ç¤ºä¾‹2ï¼šæ— ç½‘å…³ï¼ˆé¿å…é‡å¤è·¯ç”±ï¼‰â†’ ä»ç½‘å¡ç”¨</span></span><br><span class="line"><span class="comment">#    vmset.sh base et0 172.25.254.101 nogateway</span></span><br><span class="line"><span class="comment"># ç¤ºä¾‹3ï¼šè‡ªå®šä¹‰ç½‘å…³</span></span><br><span class="line"><span class="comment">#    vmset.sh eth0 base 192.168.1.100 192.168.1.1</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># =========================================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.å‚æ•°æ•ˆéªŒ(è‡³å°‘3ä¸ªå‚æ•°ï¼šä¸»æœºåã€ç½‘å¡åã€IPåœ°å€)</span></span><br><span class="line">[ <span class="variable">$#</span> -lt 3 ] &amp;&amp; &#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;é”™è¯¯ï¼šè¯·ä¼ å…¥è‡³å°‘3ä¸ªå‚æ•°!&quot;</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;ç”¨æ³•ï¼švmset.sh &lt;ä¸»æœºå&gt; &lt;ç½‘å¡å&gt; &lt;IPåœ°å€&gt; [nogateway/ç½‘å…³]&quot;</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;ç”¨æ³•ï¼švmset.sh haha eth1 172.25.254.100 nogateway&quot;</span></span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.å˜é‡å®šä¹‰</span></span><br><span class="line">HOSTNAME=<span class="variable">$1</span>       <span class="comment"># ä¸»æœºåï¼ˆå¿…å¡«ï¼Œå¦‚baseï¼‰</span></span><br><span class="line">IFACE=<span class="variable">$2</span>        <span class="comment"># ç½‘å¡åï¼ˆå¿…å¡«ï¼Œå¦‚eth1ï¼‰</span></span><br><span class="line">IP=<span class="variable">$3</span>             <span class="comment"># IPåœ°å€ï¼ˆå¿…å¡«ï¼Œå¦‚172.25.254.100ï¼‰</span></span><br><span class="line">DEFAULT_GW=<span class="string">&quot;172.25.254.2&quot;</span>    <span class="comment"># nogateway</span></span><br><span class="line">OPTION=<span class="variable">$&#123;4:-<span class="variable">$DEFAULT_GW</span>&#125;</span>     <span class="comment"># å¯é€‰å‚æ•°ï¼šnogateway ï¼ˆæ— ç½‘å…³ï¼‰æˆ– è‡ªå®šä¹‰ç½‘å…³ï¼ˆå¦‚172.25.254.2ï¼‰</span></span><br><span class="line"></span><br><span class="line">CONNECTION=$(nmcli connection show | awk <span class="string">&quot;/<span class="variable">$IFACE</span>/ &#123;print \$1&#125;&quot;</span> | grep <span class="variable">$IFACE</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.åˆ¤æ–­ç½‘å¡æ˜¯å¦ä½¿ç”¨</span></span><br><span class="line">[ -n <span class="string">&quot;<span class="variable">$CONNECTION</span>&quot;</span>  ] &amp;&amp; &#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$IFACE</span> æ­£åœ¨ä½¿ç”¨!!!&quot;</span></span><br><span class="line">  nmcli connection delete <span class="variable">$CONNECTION</span></span><br><span class="line">&#125; || &#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$IFACE</span> æœªåœ¨ä½¿ç”¨&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.é€‰æ‹©ç½‘å…³</span></span><br><span class="line">[ <span class="string">&quot;<span class="variable">$OPTION</span>&quot;</span> = <span class="string">&quot;nogateway&quot;</span> ] &amp;&amp; &#123;</span><br><span class="line"><span class="built_in">cat</span> &gt;  /etc/NetworkManager/system-connections/<span class="variable">$IFACE</span>.nmconnection &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">[connection]</span></span><br><span class="line"><span class="string">id=$IFACE</span></span><br><span class="line"><span class="string">type=ethernet</span></span><br><span class="line"><span class="string">interface-name=$IFACE</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[ipv4]</span></span><br><span class="line"><span class="string">method=manual</span></span><br><span class="line"><span class="string">address1=$IP/24</span></span><br><span class="line"><span class="string">dns=8.8.8.8</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">&#125; || &#123;</span><br><span class="line"><span class="built_in">cat</span> &gt;  /etc/NetworkManager/system-connections/<span class="variable">$IFACE</span>.nmconnection &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">[connection]</span></span><br><span class="line"><span class="string">id=$IFACE</span></span><br><span class="line"><span class="string">type=ethernet</span></span><br><span class="line"><span class="string">interface-name=$IFACE</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[ipv4]</span></span><br><span class="line"><span class="string">method=manual</span></span><br><span class="line"><span class="string">address1=$IP/24,$OPTION</span></span><br><span class="line"><span class="string">dns=8.8.8.8;</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.ç½‘å¡é‡æ–°åŠ è½½</span></span><br><span class="line"><span class="built_in">chmod</span> 600 /etc/NetworkManager/system-connections/<span class="variable">$IFACE</span>.nmconnection</span><br><span class="line">nmcli connection reload</span><br><span class="line">nmcli connection up <span class="variable">$IFACE</span></span><br><span class="line">hostnamectl hostname <span class="variable">$HOSTNAME</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.åŸŸåæ˜ å°„</span></span><br><span class="line"><span class="built_in">cat</span> &gt; /etc/hosts&lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span></span><br><span class="line"><span class="string">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span></span><br><span class="line"><span class="string">$IP                 $HOSTNAME</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;=====ç½‘å¡è¯¦ç»†ä¿¡æ¯====&quot;</span></span><br><span class="line">ip a s <span class="variable">$IFACE</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;====è·¯ç”±è¡¨====&quot;</span></span><br><span class="line">route -n</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;====ä¸»æœºå====&quot;</span></span><br><span class="line">hostname</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">set</span> -euo pipefail  <span class="comment"># ä¸¥æ ¼æ¨¡å¼ï¼Œå‘½ä»¤å¤±è´¥ç›´æ¥é€€å‡ºï¼Œé¿å…æ— æ•ˆé…ç½®</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ===================== å‚æ•°è¯´æ˜ï¼ˆç»Ÿä¸€é¡ºåºï¼Œé¿å…æ··æ·†ï¼‰=====================</span></span><br><span class="line"><span class="comment"># ç”¨æ³•ï¼šbash vmset.sh &lt;ç½‘å¡å&gt; &lt;ä¸»æœºå&gt; &lt;IPåœ°å€&gt; [å¯é€‰å‚æ•°ï¼šnoroute/ç½‘å…³]</span></span><br><span class="line"><span class="comment"># ç¤ºä¾‹1ï¼šå¸¦ç½‘å…³ï¼ˆé»˜è®¤172.25.254.2ï¼‰â†’ ä¸»ç½‘å¡ç”¨</span></span><br><span class="line"><span class="comment">#   vmset.sh eth0 base 172.25.254.100</span></span><br><span class="line"><span class="comment"># ç¤ºä¾‹2ï¼šæ— ç½‘å…³ï¼ˆé¿å…é‡å¤è·¯ç”±ï¼‰â†’ ä»ç½‘å¡ç”¨</span></span><br><span class="line"><span class="comment">#   vmset.sh eth1 base 172.25.254.101 noroute</span></span><br><span class="line"><span class="comment"># ç¤ºä¾‹3ï¼šè‡ªå®šä¹‰ç½‘å…³</span></span><br><span class="line"><span class="comment">#   vmset.sh eth0 base 192.168.1.100 192.168.1.1</span></span><br><span class="line"><span class="comment"># =======================================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. å‚æ•°æ ¡éªŒï¼ˆè‡³å°‘3ä¸ªå¿…å¡«å‚æ•°ï¼šç½‘å¡åã€ä¸»æœºåã€IPåœ°å€ï¼‰</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> -lt 3 ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;é”™è¯¯ï¼šè¯·ä¼ å…¥è‡³å°‘3ä¸ªå‚æ•°ï¼&quot;</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;ç”¨æ³•ï¼švmset.sh &lt;ç½‘å¡å&gt; &lt;ä¸»æœºå&gt; &lt;IPåœ°å€&gt; [noroute/ç½‘å…³]&quot;</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;ç¤ºä¾‹ï¼švmset.sh eth1 base 172.25.254.101 norouteï¼ˆä»ç½‘å¡ï¼Œæ— ç½‘å…³ï¼‰&quot;</span></span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. å˜é‡å®šä¹‰ï¼ˆæ¸…æ™°å‘½åï¼Œé¿å…æ··æ·†ï¼‰</span></span><br><span class="line">IFACE=<span class="variable">$1</span>          <span class="comment"># ç½‘å¡åï¼ˆå¿…å¡«ï¼Œå¦‚eth1ï¼‰</span></span><br><span class="line">HOSTNAME=<span class="variable">$2</span>       <span class="comment"># ä¸»æœºåï¼ˆå¿…å¡«ï¼Œå¦‚baseï¼‰</span></span><br><span class="line">IP=<span class="variable">$3</span>             <span class="comment"># IPåœ°å€ï¼ˆå¿…å¡«ï¼Œå¦‚172.25.254.100ï¼‰</span></span><br><span class="line">OPTION=<span class="variable">$&#123;4:-&#125;</span>     <span class="comment"># å¯é€‰å‚æ•°ï¼šnorouteï¼ˆæ— ç½‘å…³ï¼‰æˆ– è‡ªå®šä¹‰ç½‘å…³ï¼ˆå¦‚172.25.254.2ï¼‰</span></span><br><span class="line">DEFAULT_GW=<span class="string">&quot;172.25.2`:w;54.2&quot;</span>  <span class="comment"># é»˜è®¤ç½‘å…³ï¼ˆå¯é€‰å‚æ•°ä¸ºç©ºæ—¶ä½¿ç”¨ï¼‰</span></span><br><span class="line">CONN_FILE=<span class="string">&quot;/etc/NetworkManager/system-connections/<span class="variable">$&#123;IFACE&#125;</span>.nmconnection&quot;</span>  <span class="comment"># é…ç½®æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. åŸºç¡€æ ¡éªŒï¼ˆé¿å…ä½çº§é”™è¯¯ï¼‰</span></span><br><span class="line"><span class="comment"># 3.1 æ£€æŸ¥ç½‘å¡æ˜¯å¦çœŸå®å­˜åœ¨</span></span><br><span class="line"><span class="keyword">if</span> ! ip <span class="built_in">link</span> show <span class="string">&quot;<span class="variable">$IFACE</span>&quot;</span> &amp;&gt;/dev/null; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;é”™è¯¯ï¼šç½‘å¡ <span class="variable">$IFACE</span> ä¸å­˜åœ¨ï¼è¯·æ£€æŸ¥ç½‘å¡åæ˜¯å¦æ­£ç¡®&quot;</span></span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.2 æ£€æŸ¥IPæ ¼å¼æ˜¯å¦åˆæ³•ï¼ˆé¿å…è¾“é”™IPï¼‰</span></span><br><span class="line"><span class="keyword">if</span> ! <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$IP</span>&quot;</span> | grep -E <span class="string">&#x27;^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.)&#123;3&#125;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$&#x27;</span> &amp;&gt;/dev/null; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;é”™è¯¯ï¼šIPåœ°å€ <span class="variable">$IP</span> æ ¼å¼éæ³•ï¼è¯·è¾“å…¥æ­£ç¡®çš„IPv4åœ°å€&quot;</span></span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. å¤„ç†å¯é€‰å‚æ•°ï¼ˆç¡®å®šç½‘å…³æ˜¯å¦å¯ç”¨ï¼‰</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$OPTION</span>&quot;</span> = <span class="string">&quot;noroute&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">  GW=<span class="string">&quot;&quot;</span>  <span class="comment"># æ— ç½‘å…³ï¼ˆä»ç½‘å¡ç”¨ï¼Œé¿å…é‡å¤è·¯ç”±ï¼‰</span></span><br><span class="line">  DNS=<span class="string">&quot;&quot;</span> <span class="comment"># æ— ç½‘å…³æ—¶ä¸é…ç½®DNS</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="comment"># å¯é€‰å‚æ•°ä¸ºè‡ªå®šä¹‰ç½‘å…³ï¼Œæˆ–ä½¿ç”¨é»˜è®¤ç½‘å…³</span></span><br><span class="line">  GW=<span class="variable">$&#123;OPTION:-<span class="variable">$DEFAULT_GW</span>&#125;</span></span><br><span class="line">  DNS=<span class="string">&quot;8.8.8.8;&quot;</span>  <span class="comment"># æœ‰ç½‘å…³æ—¶é…ç½®DNS</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. åˆ é™¤ç½‘å¡å·²æœ‰è¿æ¥ï¼ˆé¿å…é…ç½®å†²çªï¼Œç²¾ç¡®åŒ¹é…è¿æ¥åï¼‰</span></span><br><span class="line">CONNECTION=$(nmcli connection show | awk -v iface=<span class="string">&quot;<span class="variable">$IFACE</span>&quot;</span> <span class="string">&#x27;$1 == iface &#123;print $1&#125;&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> [ -n <span class="string">&quot;<span class="variable">$CONNECTION</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;â†’ æ­£åœ¨åˆ é™¤ç½‘å¡ <span class="variable">$IFACE</span> çš„å·²æœ‰è¿æ¥ï¼š<span class="variable">$CONNECTION</span>&quot;</span></span><br><span class="line">  nmcli connection delete <span class="string">&quot;<span class="variable">$CONNECTION</span>&quot;</span> || &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;é”™è¯¯ï¼šåˆ é™¤è¿æ¥ <span class="variable">$CONNECTION</span> å¤±è´¥ï¼&quot;</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. ç”ŸæˆNetworkManageré…ç½®æ–‡ä»¶ï¼ˆè¦†ç›–å†™å…¥ï¼Œé¿å…é‡å¤é…ç½®æ®µï¼‰</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;â†’ ç”Ÿæˆç½‘å¡ <span class="variable">$IFACE</span> çš„é…ç½®æ–‡ä»¶ï¼š<span class="variable">$CONN_FILE</span>&quot;</span></span><br><span class="line"><span class="built_in">cat</span> &gt; <span class="string">&quot;<span class="variable">$CONN_FILE</span>&quot;</span> &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">[connection]</span></span><br><span class="line"><span class="string">id=$IFACE</span></span><br><span class="line"><span class="string">type=ethernet</span></span><br><span class="line"><span class="string">interface-name=$IFACE</span></span><br><span class="line"><span class="string">autoconnect=true  # å¼€æœºè‡ªåŠ¨æ¿€æ´»ç½‘å¡</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[ipv4]</span></span><br><span class="line"><span class="string">method=manual</span></span><br><span class="line"><span class="string"># é…ç½®IPå’Œç½‘å…³ï¼ˆæ— ç½‘å…³æ—¶ä»…å†™IPï¼‰</span></span><br><span class="line"><span class="string">address1=$IP/24$( [ -n &quot;$GW&quot; ] &amp;&amp; echo &quot;,$GW&quot; || &quot;&quot; )</span></span><br><span class="line"><span class="string">dns=$DNS</span></span><br><span class="line"><span class="string">ignore-auto-dns=true  # å¿½ç•¥è‡ªåŠ¨åˆ†é…çš„DNS</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. é…ç½®æ–‡ä»¶æƒé™ï¼ˆNetworkManagerè¦æ±‚å¿…é¡»æ˜¯600ï¼Œå¦åˆ™æŠ¥é”™ï¼‰</span></span><br><span class="line"><span class="built_in">chmod</span> 600 <span class="string">&quot;<span class="variable">$CONN_FILE</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 8. é‡è½½å¹¶æ¿€æ´»ç½‘å¡è¿æ¥</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;â†’ é‡è½½NetworkManageré…ç½®...&quot;</span></span><br><span class="line">nmcli connection reload</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;â†’ æ¿€æ´»ç½‘å¡ <span class="variable">$IFACE</span>...&quot;</span></span><br><span class="line">nmcli connection up <span class="string">&quot;<span class="variable">$IFACE</span>&quot;</span> || &#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;é”™è¯¯ï¼šæ¿€æ´»ç½‘å¡ <span class="variable">$IFACE</span> å¤±è´¥ï¼è¯·æ£€æŸ¥é…ç½®&quot;</span></span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 9. è®¾ç½®ä¸»æœºå</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;â†’ è®¾ç½®ä¸»æœºåä¸ºï¼š<span class="variable">$HOSTNAME</span>&quot;</span></span><br><span class="line">hostnamectl hostname <span class="string">&quot;<span class="variable">$HOSTNAME</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 10. ä¿®æ”¹/etc/hostsï¼ˆè¿½åŠ IP-ä¸»æœºåæ˜ å°„ï¼Œä¸è¦†ç›–åŸæœ‰é…ç½®ï¼ï¼‰</span></span><br><span class="line"><span class="keyword">if</span> ! grep -q <span class="string">&quot;<span class="variable">$IP</span> <span class="variable">$HOSTNAME</span>&quot;</span> /etc/hosts; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;â†’ å‘/etc/hostsæ·»åŠ æ˜ å°„ï¼š<span class="variable">$IP</span> <span class="variable">$HOSTNAME</span>&quot;</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$IP</span>     <span class="variable">$HOSTNAME</span>&quot;</span> &gt;&gt; /etc/hosts</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;â†’ /etc/hostså·²å­˜åœ¨æ˜ å°„ï¼š<span class="variable">$IP</span> <span class="variable">$HOSTNAME</span>ï¼ˆæ— éœ€é‡å¤æ·»åŠ ï¼‰&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 11. é…ç½®ç»“æœéªŒè¯ï¼ˆè®©ä½ ç›´è§‚çœ‹åˆ°æ˜¯å¦ç”Ÿæ•ˆï¼‰</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\n======= é…ç½®ç»“æœéªŒè¯ =======&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ç½‘å¡ <span class="variable">$IFACE</span> åœ°å€ï¼š&quot;</span></span><br><span class="line">ip a show <span class="string">&quot;<span class="variable">$IFACE</span>&quot;</span> | grep -A2 <span class="string">&quot;inet &quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å½“å‰ä¸»æœºåï¼š<span class="subst">$(hostname)</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;è·¯ç”±è¡¨ï¼ˆé»˜è®¤è·¯ç”±ï¼Œä»…ä¸»ç½‘å¡æ˜¾ç¤ºï¼‰ï¼š&quot;</span></span><br><span class="line">ip route show default 2&gt;/dev/null || <span class="built_in">echo</span> <span class="string">&quot;æ— é»˜è®¤è·¯ç”±ï¼ˆç¬¦åˆnorouteé…ç½®ï¼‰&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;=============================&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;âœ… é…ç½®å®Œæˆï¼&quot;</span></span><br></pre></td></tr></table></figure><h1 id="26-1-17-å¤ä¹ "><a href="#26-1-17-å¤ä¹ " class="headerlink" title="26-1-17 (å¤ä¹ )"></a>26-1-17 (å¤ä¹ )</h1><h2 id="1-ç³»ç»Ÿå¼•å¯¼è¿‡ç¨‹ä¿®å¤"><a href="#1-ç³»ç»Ÿå¼•å¯¼è¿‡ç¨‹ä¿®å¤" class="headerlink" title="1.ç³»ç»Ÿå¼•å¯¼è¿‡ç¨‹ä¿®å¤"></a>1.ç³»ç»Ÿå¼•å¯¼è¿‡ç¨‹ä¿®å¤</h2><p><strong><code>å¼•å¯¼è¿‡ç¨‹</code></strong></p> <img src="https://b5dbf24.webp.li/Linux/é¡µ-1.png" alt="é¡µ-1" style="zoom: 25%;" /><h3 id="1-1-ç£ç›˜æŸåä¿®å¤"><a href="#1-1-ç£ç›˜æŸåä¿®å¤" class="headerlink" title="1.1.ç£ç›˜æŸåä¿®å¤"></a>1.1.ç£ç›˜æŸåä¿®å¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[root@base ~]# fdisk -l</span><br><span class="line">Disk /dev/nvme0n1ï¼š100 GiBï¼Œ107374182400 å­—èŠ‚ï¼Œ209715200 ä¸ªæ‰‡åŒº</span><br><span class="line">ç£ç›˜å‹å·ï¼šVMware Virtual NVMe Disk</span><br><span class="line">å•å…ƒï¼šæ‰‡åŒº / 1 * 512 = 512 å­—èŠ‚</span><br><span class="line">æ‰‡åŒºå¤§å°(é€»è¾‘/ç‰©ç†)ï¼š512 å­—èŠ‚ / 512 å­—èŠ‚</span><br><span class="line">I/O å¤§å°(æœ€å°/æœ€ä½³)ï¼š512 å­—èŠ‚ / 512 å­—èŠ‚</span><br><span class="line">ç£ç›˜æ ‡ç­¾ç±»å‹ï¼šdos</span><br><span class="line">ç£ç›˜æ ‡è¯†ç¬¦ï¼š0xb7f6e5e4</span><br><span class="line"></span><br><span class="line">è®¾å¤‡           å¯åŠ¨    èµ·ç‚¹      æœ«å°¾      æ‰‡åŒº å¤§å° Id ç±»å‹</span><br><span class="line">/dev/nvme0n1p1 *       2048   2099199   2097152   1G 83 Linux</span><br><span class="line">/dev/nvme0n1p2      2099200 209715199 207616000  99G 8e Linux LVM</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disk /dev/mapper/rhel_172-rootï¼š95.08 GiBï¼Œ102093553664 å­—èŠ‚ï¼Œ199401472 ä¸ªæ‰‡åŒº</span><br><span class="line">å•å…ƒï¼šæ‰‡åŒº / 1 * 512 = 512 å­—èŠ‚</span><br><span class="line">æ‰‡åŒºå¤§å°(é€»è¾‘/ç‰©ç†)ï¼š512 å­—èŠ‚ / 512 å­—èŠ‚</span><br><span class="line">I/O å¤§å°(æœ€å°/æœ€ä½³)ï¼š512 å­—èŠ‚ / 512 å­—èŠ‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disk /dev/mapper/rhel_172-swapï¼š3.91 GiBï¼Œ4202692608 å­—èŠ‚ï¼Œ8208384 ä¸ªæ‰‡åŒº</span><br><span class="line">å•å…ƒï¼šæ‰‡åŒº / 1 * 512 = 512 å­—èŠ‚</span><br><span class="line">æ‰‡åŒºå¤§å°(é€»è¾‘/ç‰©ç†)ï¼š512 å­—èŠ‚ / 512 å­—èŠ‚</span><br><span class="line">I/O å¤§å°(æœ€å°/æœ€ä½³)ï¼š512 å­—èŠ‚ / 512 å­—èŠ‚</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…ç©ºç£ç›˜/dev/nvme0n1çš„MBRå¼•å¯¼æ‰‡åŒºï¼ˆå‰446å­—èŠ‚ï¼‰ï¼Œä½†ä¿ç•™åˆ†åŒºè¡¨ï¼ˆå66å­—èŠ‚ï¼‰</span></span><br><span class="line">[root@base ~]# <span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=/dev/nvme0n1 bs=446 count=1</span><br><span class="line">è®°å½•äº†1+0 çš„è¯»å…¥</span><br><span class="line">è®°å½•äº†1+0 çš„å†™å‡º</span><br><span class="line">446å­—èŠ‚å·²å¤åˆ¶ï¼Œ0.000239378 sï¼Œ1.9 MB/s</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="1-1-1-ç£ç›˜å¼•å¯¼é—®é¢˜è¡¨ç°"><a href="#1-1-1-ç£ç›˜å¼•å¯¼é—®é¢˜è¡¨ç°" class="headerlink" title="1.1.1.ç£ç›˜å¼•å¯¼é—®é¢˜è¡¨ç°"></a>1.1.1.ç£ç›˜å¼•å¯¼é—®é¢˜è¡¨ç°</h4><img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_10-59-28.png" alt="PixPin_2026-01-17_10-59-28"  /> <blockquote><p>è§£å†³æ–¹æ³•</p><p>1.å…³æœº</p><p>2.æ’å…¥å¯å®‰è£…ç³»ç»Ÿçš„è®¾å¤‡</p><p>3.ä»æ­¤è®¾å¤‡å¯åŠ¨</p></blockquote><h4 id="1-1-2-ç£ç›˜å¼•å¯¼ä¿®å¤è¿‡ç¨‹"><a href="#1-1-2-ç£ç›˜å¼•å¯¼ä¿®å¤è¿‡ç¨‹" class="headerlink" title="1.1.2.ç£ç›˜å¼•å¯¼ä¿®å¤è¿‡ç¨‹"></a>1.1.2.ç£ç›˜å¼•å¯¼ä¿®å¤è¿‡ç¨‹</h4> <img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_10-59-28.png" alt="PixPin_2026-01-17_10-59-28"  /> <img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_11-01-22.png" alt="PixPin_2026-01-17_11-01-22" style="zoom:112%;" /> <img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_11-01-48.png" alt="PixPin_2026-01-17_11-01-48" style="zoom:112%;" /> <img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_11-01-22.png" alt="PixPin_2026-01-17_11-01-22" style="zoom:113%;" /><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è¾“å…¥1å¹¶ä¸”0å›è½¦åè¾“å…¥</span></span><br><span class="line">bash-5.1# <span class="built_in">chroot</span> /mnt/sysroot</span><br><span class="line">bash-5.1# grub2-install /dev/nvme0n1</span><br></pre></td></tr></table></figure><img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_11-08-08.png" alt="PixPin_2026-01-17_11-08-08"  /><h3 id="1-2-å¼•å¯¼æ–‡ä»¶ç¼ºå¤±ä¿®å¤"><a href="#1-2-å¼•å¯¼æ–‡ä»¶ç¼ºå¤±ä¿®å¤" class="headerlink" title="1.2.å¼•å¯¼æ–‡ä»¶ç¼ºå¤±ä¿®å¤"></a>1.2.å¼•å¯¼æ–‡ä»¶ç¼ºå¤±ä¿®å¤</h3><h4 id="1-2-1-æŸ¥è¯¢å¼•å¯¼æ–‡ä»¶"><a href="#1-2-1-æŸ¥è¯¢å¼•å¯¼æ–‡ä»¶" class="headerlink" title="1.2.1.æŸ¥è¯¢å¼•å¯¼æ–‡ä»¶"></a>1.2.1.æŸ¥è¯¢å¼•å¯¼æ–‡ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~]# ll /boot/grub2/grub.cfg</span><br><span class="line">-rw-------. 1 root root 6955  1æœˆ 15 21:11 /boot/grub2/grub.cfg</span><br><span class="line">[root@node2 ~]# ll /boot/loader/entries/</span><br><span class="line">æ€»ç”¨é‡ 8</span><br><span class="line">-rw-r--r--. 1 root root 500  1æœˆ 15 21:11 1199b04b0d974659ad491305f98dcfe0-0-rescue.conf</span><br><span class="line">-rw-r--r--. 1 root root 475  1æœˆ 15 21:23 1199b04b0d974659ad491305f98dcfe0-5.14.0-570.12.1.el9_6.x86_64.conf</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç£ç›˜</span></span><br><span class="line">[root@node2 ~]# <span class="built_in">df</span></span><br><span class="line">æ–‡ä»¶ç³»ç»Ÿ                     1K-å—     å·²ç”¨     å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹</span><br><span class="line">devtmpfs                      4096        0     4096    0% /dev</span><br><span class="line">tmpfs                      1855068        0  1855068    0% /dev/shm</span><br><span class="line">tmpfs                       742028     9220   732808    2% /run</span><br><span class="line">/dev/mapper/rhel_172-root 99635200  3278240 96356960    4% /</span><br><span class="line">/dev/nvme0n1p1              983040   315524   667516   33% /boot</span><br><span class="line">/dev/sr0                  12462174 12462174        0  100% /rhel9</span><br><span class="line">tmpfs                       371012        0   371012    0% /run/user/0</span><br></pre></td></tr></table></figure><h4 id="1-2-2-ä¸»å¼•å¯¼æ–‡ä»¶ç¼ºå¤±ä¿®å¤"><a href="#1-2-2-ä¸»å¼•å¯¼æ–‡ä»¶ç¼ºå¤±ä¿®å¤" class="headerlink" title="1.2.2.ä¸»å¼•å¯¼æ–‡ä»¶ç¼ºå¤±ä¿®å¤"></a>1.2.2.ä¸»å¼•å¯¼æ–‡ä»¶ç¼ºå¤±ä¿®å¤</h4><h5 id="1-2-2-1-åˆ é™¤ä¸»å¼•å¯¼æ–‡ä»¶"><a href="#1-2-2-1-åˆ é™¤ä¸»å¼•å¯¼æ–‡ä»¶" class="headerlink" title="1.2.2.1.åˆ é™¤ä¸»å¼•å¯¼æ–‡ä»¶"></a>1.2.2.1.åˆ é™¤ä¸»å¼•å¯¼æ–‡ä»¶</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~]# <span class="built_in">rm</span> -rf /boot/grub2/grub.cfg</span><br></pre></td></tr></table></figure><h5 id="1-2-2-2-é—®é¢˜è¡¨ç°"><a href="#1-2-2-2-é—®é¢˜è¡¨ç°" class="headerlink" title="1.2.2.2.é—®é¢˜è¡¨ç°"></a>1.2.2.2.é—®é¢˜è¡¨ç°</h5><p><img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_23-22-57.png" alt="PixPin_2026-01-17_23-22-57"></p><h5 id="1-2-2-3-ä¿®å¤è¿‡ç¨‹"><a href="#1-2-2-3-ä¿®å¤è¿‡ç¨‹" class="headerlink" title="1.2.2.3.ä¿®å¤è¿‡ç¨‹"></a>1.2.2.3.ä¿®å¤è¿‡ç¨‹</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line">grub&gt; <span class="built_in">set</span> root=(hd0,msdos1)</span><br><span class="line"><span class="comment">#</span></span><br><span class="line">grub&gt; linux16 /vmlinuz-5.14.0-570.12.1.e19_6.x86_64 ro root=/dev/mapper/rhel_172-root net.ifnames=0</span><br><span class="line"><span class="comment">#</span></span><br><span class="line">grub&gt;initrd16 /initramfs-5.14.0-570.12.1.e19_6.x86_64.img</span><br><span class="line"><span class="comment"># å¯åŠ¨ç³»ç»Ÿ</span></span><br><span class="line">grub&gt; boot</span><br></pre></td></tr></table></figure><blockquote><p>å½“æ‰‹åŠ¨å¼•å¯¼å¯åŠ¨ç³»ç»Ÿåï¼Œéœ€è¦ä¿®å¤è‡ªåŠ¨å¼•å¯¼æ–‡ä»¶ï¼Œå¦åˆ™ç³»ç»Ÿé‡å¯åä»ç„¶è¦æ‰‹åŠ¨å¼•å¯¼</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¿®å¤è‡ªåŠ¨å¼•å¯¼æ–‡ä»¶</span></span><br><span class="line">[root@base ~]# grub2-mkconfig  &gt; /boot/grub2/grub.cfg    <span class="comment">#ä¿®å¤å®Œæˆ</span></span><br></pre></td></tr></table></figure><p><img src="C:\Users\hym\Desktop\Linux\PixPin_2026-01-17_23-39-31.png" alt="PixPin_2026-01-17_23-39-31"></p><h4 id="1-2-3-å­å¼•å¯¼æ–‡ä»¶ç¼ºå¤±ä¿®å¤"><a href="#1-2-3-å­å¼•å¯¼æ–‡ä»¶ç¼ºå¤±ä¿®å¤" class="headerlink" title="1.2.3.å­å¼•å¯¼æ–‡ä»¶ç¼ºå¤±ä¿®å¤"></a>1.2.3.å­å¼•å¯¼æ–‡ä»¶ç¼ºå¤±ä¿®å¤</h4><h5 id="1-2-3-1-åˆ é™¤å­å¼•å¯¼æ–‡ä»¶"><a href="#1-2-3-1-åˆ é™¤å­å¼•å¯¼æ–‡ä»¶" class="headerlink" title="1.2.3.1.åˆ é™¤å­å¼•å¯¼æ–‡ä»¶"></a>1.2.3.1.åˆ é™¤å­å¼•å¯¼æ–‡ä»¶</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@base ~]# <span class="built_in">rm</span> -fr /boot/loader/entries/*</span><br></pre></td></tr></table></figure><h5 id="1-2-3-2-é—®é¢˜è¡¨ç°"><a href="#1-2-3-2-é—®é¢˜è¡¨ç°" class="headerlink" title="1.2.3.2.é—®é¢˜è¡¨ç°"></a>1.2.3.2.é—®é¢˜è¡¨ç°</h5><p><img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_23-22-57.png" alt="PixPin_2026-01-17_23-22-57"></p><h5 id="1-2-3-3-ä¿®å¤è¿‡ç¨‹"><a href="#1-2-3-3-ä¿®å¤è¿‡ç¨‹" class="headerlink" title="1.2.3.3.ä¿®å¤è¿‡ç¨‹"></a>1.2.3.3.ä¿®å¤è¿‡ç¨‹</h5><p>ä¸ä¸Šé¢çš„<a href="#1.2.4.2.%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B">ä¸»å¼•å¯¼æ–‡ä»¶ä¿®å¤è¿‡ç¨‹</a>ä¸€è‡´</p><p>è¿›å…¥ç³»ç»Ÿå</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@base ~]# kernel-install add $(<span class="built_in">uname</span> -r) /boot/vmlinuz-5.14.0-570.12.1.el9_6.x86_64</span><br><span class="line">[root@base ~]# <span class="built_in">ls</span> /boot/loader/entries/</span><br></pre></td></tr></table></figure><p><img src="C:\Users\hym\Desktop\Linux\PixPin_2026-01-18_00-06-54.png" alt="PixPin_2026-01-18_00-06-54"></p><blockquote><p>å½“ä¿®å¤å­å¯åŠ¨æ–‡ä»¶åç½‘å¡çš„åç§°è®¾å®šå‚æ•°å°±ä¸¢å¤±äº†éœ€è¦é‡æ–°è®¾å®šï¼Œæ­¤å‚æ•°å’Œç³»ç»Ÿä¿®å¤æœ¬èº«æ— å…³</p></blockquote><p><img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-18_00-15-39.png" alt="PixPin_2026-01-18_00-15-39"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@base ~]#  grubby --update-kernel ALL --args net.ifnames=0</span><br><span class="line"><span class="comment"># é‡å¯åç½‘ç»œæ¢å¤</span></span><br></pre></td></tr></table></figure><h3 id="1-3-å†…æ ¸æ–‡ä»¶ä¿®å¤"><a href="#1-3-å†…æ ¸æ–‡ä»¶ä¿®å¤" class="headerlink" title="1.3.å†…æ ¸æ–‡ä»¶ä¿®å¤"></a>1.3.å†…æ ¸æ–‡ä»¶ä¿®å¤</h3><h4 id="1-3-1-åˆ é™¤å†…æ ¸æ–‡ä»¶"><a href="#1-3-1-åˆ é™¤å†…æ ¸æ–‡ä»¶" class="headerlink" title="1.3.1.åˆ é™¤å†…æ ¸æ–‡ä»¶"></a>1.3.1.åˆ é™¤å†…æ ¸æ–‡ä»¶</h4><p><img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_15-42-46.png" alt="PixPin_2026-01-17_15-42-46"></p><h4 id="1-3-2-é—®é¢˜è¡¨ç°"><a href="#1-3-2-é—®é¢˜è¡¨ç°" class="headerlink" title="1.3.2.é—®é¢˜è¡¨ç°"></a>1.3.2.é—®é¢˜è¡¨ç°</h4><p><img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_15-44-30.png" alt="PixPin_2026-01-17_15-44-30"></p><h4 id="1-3-3-è§£å†³æ–¹æ³•"><a href="#1-3-3-è§£å†³æ–¹æ³•" class="headerlink" title="1.3.3.è§£å†³æ–¹æ³•"></a>1.3.3.è§£å†³æ–¹æ³•</h4><p>ï¼ˆ1ï¼‰æ‰“å¼€ç”µæºæ—¶è¿›å…¥å›ºä»¶</p> <img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_15-45-45.png" alt="PixPin_2026-01-17_15-45-45" style="zoom:80%;" /><p>ï¼ˆ2ï¼‰è¿›å…¥BOOTé¡µé¢ï¼Œå°†å…‰é©±å¯åŠ¨è°ƒåˆ°æœ€å‰é¢</p> <img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_15-47-07.png" alt="PixPin_2026-01-17_15-47-07" style="zoom:33%;" /><p>ï¼ˆ3ï¼‰ä¿å­˜åï¼Œè¿‡ç¨‹åŒ<a href="#1.1.2.%E7%A3%81%E7%9B%98%E5%BC%95%E5%AF%BC%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B">ç£ç›˜ä¿®å¤</a>ä¸€è‡´</p> <img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_15-47-31.png" alt="PixPin_2026-01-17_15-47-31" style="zoom:33%;" /><p>ï¼ˆ4ï¼‰è¿›å…¥ä¸‹æ–¹é¡µé¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bash-5.1# <span class="built_in">df</span></span><br><span class="line">bash-5.1# mount --<span class="built_in">bind</span> /run/install/repo/ /mnt/sys/</span><br><span class="line">bash-5.1# <span class="built_in">chroot</span> /mnt/sysroot/</span><br><span class="line">bash-5.1# rpm -ivh /media/BaseOS/Packages/kernel-core-5.14.0-570.12.1.el9_6.x86_64.rpm --force</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-17_15-57-32.png" alt="PixPin_2026-01-17_15-57-32"></p><h1 id="2026-1-19-å¤ä¹ "><a href="#2026-1-19-å¤ä¹ " class="headerlink" title="2026-1-19 (å¤ä¹ )"></a>2026-1-19 (å¤ä¹ )</h1><h2 id="1-apacheæ„å»ºwebæœåŠ¡å™¨"><a href="#1-apacheæ„å»ºwebæœåŠ¡å™¨" class="headerlink" title="1.apacheæ„å»ºwebæœåŠ¡å™¨"></a>1.apacheæ„å»ºwebæœåŠ¡å™¨</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…æœåŠ¡å¹¶å¯åŠ¨æœåŠ¡</span></span><br><span class="line">[root@base ~]# dnf install httpd -y</span><br><span class="line">[root@base ~]# systemctl <span class="built_in">enable</span> --now httpd</span><br><span class="line">[root@base ~]# dnf install httpd-manual -y<span class="comment"># httpdæœåŠ¡æ‰‹å†Œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŸºæœ¬é…ç½®ä¿¡æ¯</span></span><br><span class="line">ç«¯å£ï¼š   80</span><br><span class="line">é»˜è®¤å‘å¸ƒç›®å½•ï¼š/var/www/html</span><br><span class="line">é»˜è®¤å‘å¸ƒæ–‡ä»¶ï¼šindex.html</span><br><span class="line">ä¸»é…ç½®æ–‡ä»¶ï¼š/etc/httpd/conf/httpd.conf</span><br><span class="line">å­é…ç½®æ–‡ä»¶ï¼š/etc/httpd/conf.d/*.conf</span><br><span class="line">ç®¡ç†å‘½ä»¤ï¼šsystemctl   <span class="built_in">enable</span> --now httpd</span><br></pre></td></tr></table></figure><h3 id="1-1-ä¸»é…ç½®æ–‡ä»¶"><a href="#1-1-ä¸»é…ç½®æ–‡ä»¶" class="headerlink" title="1.1.ä¸»é…ç½®æ–‡ä»¶"></a>1.1.ä¸»é…ç½®æ–‡ä»¶</h3><h4 id="1-1-1-æ›´æ”¹é»˜è®¤å‘å¸ƒæ–‡ä»¶"><a href="#1-1-1-æ›´æ”¹é»˜è®¤å‘å¸ƒæ–‡ä»¶" class="headerlink" title="1.1.1.æ›´æ”¹é»˜è®¤å‘å¸ƒæ–‡ä»¶"></a>1.1.1.æ›´æ”¹é»˜è®¤å‘å¸ƒæ–‡ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@node4 ~]#  <span class="built_in">echo</span> <span class="string">&quot;index.html ---&gt; /var/www/html&quot;</span> &gt; /var/www/html/index.html</span><br><span class="line">[root@node4 ~]#  <span class="built_in">echo</span> <span class="string">&quot;test.html ---&gt; /var/www/html &quot;</span> &gt; /var/www/html/test.html</span><br><span class="line"></span><br><span class="line">[root@node4 ~]# curl 172.25.254.130</span><br><span class="line">index.html ---&gt; /var/www/html</span><br><span class="line"><span class="comment">## ä¿®æ”¹Apacheé…ç½®</span></span><br><span class="line">[root@node4 ~]# vim /etc/httpd/conf/httpd.conf</span><br><span class="line">168 &lt;IfModule dir_module&gt;</span><br><span class="line">169     DirectoryIndex index.html</span><br><span class="line">170 &lt;/IfModule&gt;</span><br><span class="line"><span class="comment">## é‡å¯æœåŠ¡</span></span><br><span class="line">[root@base ~]# systemctl restart httpd</span><br><span class="line"><span class="comment">## å†æ¬¡æµ‹è¯•</span></span><br><span class="line">[root@node4 ~]# curl 172.25.254.130</span><br><span class="line">test.html ---&gt; /var/www/html</span><br></pre></td></tr></table></figure><h4 id="1-1-2-ä¿®æ”¹é»˜è®¤å‘å¸ƒç›®å½•"><a href="#1-1-2-ä¿®æ”¹é»˜è®¤å‘å¸ƒç›®å½•" class="headerlink" title="1.1.2.ä¿®æ”¹é»˜è®¤å‘å¸ƒç›®å½•"></a>1.1.2.ä¿®æ”¹é»˜è®¤å‘å¸ƒç›®å½•</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@node4 ~]# <span class="built_in">mkdir</span> /web/html -p</span><br><span class="line">[root@node4 ~]# <span class="built_in">echo</span> <span class="string">&quot;index.html ---&gt; /web/html&quot;</span> &gt; /web/html/index.html</span><br><span class="line"></span><br><span class="line">[root@node4 ~]# vim /etc/httpd/conf/httpd.conf</span><br><span class="line">124 <span class="comment"># DocumentRoot &quot;/var/www/html&quot;</span></span><br><span class="line">125 DocumentRoot <span class="string">&quot;/web/html&quot;</span></span><br><span class="line">126</span><br><span class="line">127 <span class="comment">#</span></span><br><span class="line">128 <span class="comment"># Relax access to content within /var/www.</span></span><br><span class="line">129 <span class="comment">#</span></span><br><span class="line">130 &lt;Directory <span class="string">&quot;/web&quot;</span>&gt;</span><br><span class="line">131     AllowOverride None</span><br><span class="line">132     <span class="comment"># Allow open access:</span></span><br><span class="line">133     Require all granted</span><br><span class="line">134 &lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line">[root@node4 ~]# systemctl restart httpd</span><br><span class="line">[root@node4 ~]# curl 172.25.254.130</span><br><span class="line">index.html ---&gt; /web/html</span><br></pre></td></tr></table></figure><h4 id="1-1-3-ç«¯å£ä¿®æ”¹"><a href="#1-1-3-ç«¯å£ä¿®æ”¹" class="headerlink" title="1.1.3.ç«¯å£ä¿®æ”¹"></a>1.1.3.ç«¯å£ä¿®æ”¹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@node4 ~]# vim /etc/httpd/conf/httpd.conf</span><br><span class="line">47 Listen 80</span><br><span class="line">48 Listen 8000</span><br><span class="line">[root@node4 ~]# systemctl restart httpd</span><br><span class="line">[root@node4 ~]# netstat -antlupe | grep httpd</span><br><span class="line">tcp6       0      0 :::8000                 :::*                    LISTEN      0          32220      2538/httpd</span><br><span class="line">  2538/httpd</span><br><span class="line">[root@node4 ~]# curl 172.25.254.130:8000</span><br><span class="line">index.html ---&gt; /var/www/html</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="1-2-å­é…ç½®æ–‡ä»¶"><a href="#1-2-å­é…ç½®æ–‡ä»¶" class="headerlink" title="1.2.å­é…ç½®æ–‡ä»¶"></a>1.2.å­é…ç½®æ–‡ä»¶</h3><h4 id="1-2-1-è™šæ‹Ÿä¸»æœº"><a href="#1-2-1-è™šæ‹Ÿä¸»æœº" class="headerlink" title="1.2.1.è™šæ‹Ÿä¸»æœº"></a>1.2.1.è™šæ‹Ÿä¸»æœº</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºåŸºç¡€ç›®å½•</span></span><br><span class="line">[root@node4 ~]# <span class="built_in">mkdir</span> /etc/httpd/logs/node4_log<span class="comment"># æ—¥å¿—ç›®å½•</span></span><br><span class="line">[root@node4 ~]# <span class="built_in">mkdir</span> <span class="built_in">mkdir</span> -p /web/node4/&#123;news,bbs&#125;/html<span class="comment"># å‘å¸ƒç›®å½•</span></span><br><span class="line"><span class="comment"># åˆ›å»ºå‘å¸ƒæ–‡ä»¶</span></span><br><span class="line">[root@node4 ~]# <span class="built_in">echo</span> news.node4.com &gt; /web/node4/news/html/index.html</span><br><span class="line">[root@node4 ~]# <span class="built_in">echo</span> bbs.node4.com &gt; /web/node4/bbs/html/index.html</span><br><span class="line"><span class="comment"># ä¿®æ”¹é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@node4 ~]# vim /etc/httpd/conf.d/vhosts.conf</span><br><span class="line">&lt;Directory <span class="string">&quot;/web&quot;</span>&gt;</span><br><span class="line">    AllowOverride None</span><br><span class="line">    Require all granted</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line">&lt;VirtualHost _default_:80&gt;</span><br><span class="line">    DocumentRoot <span class="string">&quot;/web/html&quot;</span></span><br><span class="line">    CustomLog logs/default.log combined</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line"></span><br><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">    DocumentRoot <span class="string">&quot;/web/node4/news/html&quot;</span></span><br><span class="line">    ServerName news.node4.com</span><br><span class="line">    CustomLog logs/node4_log/news.log combined</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line"></span><br><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">    DocumentRoot <span class="string">&quot;/web/node4/bbs/html&quot;</span></span><br><span class="line">    ServerName bbs.node4.com</span><br><span class="line">    CustomLog logs/node4_log/bbs.log combined</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@node4 ~]# systemctl restart httpd</span><br><span class="line">[root@node4 ~]# vim /etc/hosts</span><br><span class="line">172.25.254.130     node4   www.node4.com   bbs.node4.com  news.node4.com</span><br><span class="line"><span class="comment"># æµ‹è¯•www.node4.com</span></span><br><span class="line">[root@node4 ~]# curl www.node4.com</span><br><span class="line">index.html ---&gt; /web/html</span><br><span class="line"><span class="comment"># æµ‹è¯•news.node4.com</span></span><br><span class="line">[root@node4 ~]# curl news.node4.com</span><br><span class="line">news.node4.com</span><br><span class="line"><span class="comment"># æµ‹è¯•bbs.node4.com</span></span><br><span class="line">[root@node4 ~]# curl bbs.node4.com</span><br><span class="line">bbs.node4.com</span><br></pre></td></tr></table></figure><h4 id="1-2-2-è®¿é—®æ§åˆ¶"><a href="#1-2-2-è®¿é—®æ§åˆ¶" class="headerlink" title="1.2.2.è®¿é—®æ§åˆ¶"></a>1.2.2.è®¿é—®æ§åˆ¶</h4><h5 id="1-2-2-1-åŸºäºIP"><a href="#1-2-2-1-åŸºäºIP" class="headerlink" title="1.2.2.1.åŸºäºIP"></a>1.2.2.1.åŸºäºIP</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@node4 ~]# <span class="built_in">mkdir</span> /web/html/admin</span><br><span class="line">[root@node4 ~]# <span class="built_in">echo</span> admin &gt; /web/html/admin/index.html</span><br><span class="line">[root@node4 ~]# curl 172.25.254.130/admin/</span><br><span class="line">admin</span><br><span class="line"><span class="comment"># æ‹’ç»å…¶ä»–IPï¼Œä»…é€šè¿‡.1çš„æµé‡</span></span><br><span class="line">[root@node4 ~]# vim /etc/httpd/conf.d/vhosts.conf</span><br><span class="line">&lt;Directory <span class="string">&quot;/web/html/admin/&quot;</span>&gt;</span><br><span class="line">    Order Deny,Allow</span><br><span class="line">    Deny from all</span><br><span class="line">    Allow from 172.25.254.1</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"><span class="comment"># é‡å¯æœåŠ¡</span></span><br><span class="line">[root@node4 ~]# systemctl restart httpd</span><br><span class="line"><span class="comment"># æµ‹è¯•ï¼Œæœ¬æœºæµ‹è¯•</span></span><br><span class="line">[root@node4 ~]# curl 172.25.254.130/admin/</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">&quot;-//IETF//DTD HTML 2.0//EN&quot;</span>&gt;</span><br><span class="line">&lt;html&gt;&lt;<span class="built_in">head</span>&gt;</span><br><span class="line">&lt;title&gt;403 Forbidden&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Forbidden&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;You don<span class="string">&#x27;t have permission to access this resource.&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;&lt;/html&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>172.25.254.1è¿›è¡Œæµ‹è¯•</p></blockquote><p> <img src="https://b5dbf24.webp.li/Linux/PixPin_2026-01-19_16-09-46.png"></p><h5 id="1-2-2-2-åŸºäºç”¨æˆ·è®¤è¯"><a href="#1-2-2-2-åŸºäºç”¨æˆ·è®¤è¯" class="headerlink" title="1.2.2.2.åŸºäºç”¨æˆ·è®¤è¯"></a>1.2.2.2.åŸºäºç”¨æˆ·è®¤è¯</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">[root@node4 ~]# <span class="built_in">mkdir</span> -p /web/html/auth/</span><br><span class="line">[root@node4 ~]# <span class="built_in">echo</span> auth &gt; /web/html/auth/index.html</span><br><span class="line">[root@node4 ~]# curl 172.25.254.130/auth/</span><br><span class="line">auth</span><br><span class="line"></span><br><span class="line"><span class="comment">## ç”Ÿæˆè®¤è¯æ–‡ä»¶</span></span><br><span class="line">[root@node4 ~]# htpasswd -cm /etc/httpd/.htpasswd haha</span><br><span class="line">New password:</span><br><span class="line">Re-<span class="built_in">type</span> new password:</span><br><span class="line">Adding password <span class="keyword">for</span> user haha</span><br><span class="line">[root@node4 ~]# <span class="built_in">cat</span> /etc/httpd/.htpasswd</span><br><span class="line">haha:$apr1$MKFuKZB6<span class="variable">$eTeFSJ4Mhn8TMnueDnARX0</span></span><br><span class="line"></span><br><span class="line">[root@node4 ~]# vim /etc/httpd/conf.d/vhosts.conf</span><br><span class="line">&lt;Directory <span class="string">&quot;/web/html/auth/&quot;</span>&gt;</span><br><span class="line">    AuthUserFile /etc/httpd/.htpasswd</span><br><span class="line">    AuthType basic</span><br><span class="line">    AuthName <span class="string">&quot;Please input your username and password&quot;</span></span><br><span class="line">    Require valid-user</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"><span class="comment"># é‡å¯</span></span><br><span class="line">[root@node4 ~]# systemctl restart httpd</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•</span></span><br><span class="line"><span class="comment">## rootç”¨æˆ·</span></span><br><span class="line">[root@node4 ~]# curl  172.25.254.130/auth/</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">&quot;-//IETF//DTD HTML 2.0//EN&quot;</span>&gt;</span><br><span class="line">&lt;html&gt;&lt;<span class="built_in">head</span>&gt;</span><br><span class="line">&lt;title&gt;401 Unauthorized&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Unauthorized&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;This server could not verify that you</span><br><span class="line">are authorized to access the document</span><br><span class="line">requested.  Either you supplied the wrong</span><br><span class="line">credentials (e.g., bad password), or your</span><br><span class="line">browser doesn<span class="string">&#x27;t understand how to supply</span></span><br><span class="line"><span class="string">the credentials required.&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;&lt;/html&gt;</span></span><br><span class="line"><span class="string">## hahaç”¨æˆ·</span></span><br><span class="line"><span class="string">[root@node4 ~]# curl  172.25.254.130/auth/ -u haha:haha</span></span><br><span class="line"><span class="string">auth</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure><h4 id="1-2-3-https"><a href="#1-2-3-https" class="headerlink" title="1.2.3.https"></a>1.2.3.https</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">[root@node4 ~]# dnf install mod_ssl.x86_64 -y</span><br><span class="line">[root@node4 ~]# <span class="built_in">mkdir</span> -p /etc/httpd/certs</span><br><span class="line">[root@node4 ~]# openssl req -newkey rsa:2048 -nodes -sha256 -keyout /etc/httpd/certs/node4.key -x509 -days 365 -out /etc/httpd/certs/node4.crt</span><br><span class="line">[root@node4 ~]# ll /etc/httpd/certs/</span><br><span class="line">æ€»ç”¨é‡ 8</span><br><span class="line">-rw-r--r-- 1 root root 1237  1æœˆ 19 20:22 node4.crt</span><br><span class="line">-rw------- 1 root root 1704  1æœˆ 19 20:22 node4.key</span><br><span class="line"></span><br><span class="line">[root@node4 ~]# <span class="built_in">mkdir</span> -p /web/node4/login/html</span><br><span class="line">[root@node4 ~]# <span class="built_in">echo</span> login.node4.com &gt; /web/node4/login/html/index.html</span><br><span class="line"></span><br><span class="line">[root@node4 ~]# vim /etc/httpd/conf.d/vhosts.conf</span><br><span class="line">&lt;VirtualHost *:443&gt;</span><br><span class="line">    DocumentRoot <span class="string">&quot;/web/node4/login/html&quot;</span></span><br><span class="line">    ServerName login.node4.com</span><br><span class="line">    CustomLog logs/node4_log/login.log combined</span><br><span class="line">    SSLEngine on</span><br><span class="line">    SSLCertificateFile /etc/httpd/certs/node4.crt</span><br><span class="line">    SSLCertificateKeyFile /etc/httpd/certs/node4.key</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line"></span><br><span class="line">[root@node4 ~]# systemctl restart httpd</span><br><span class="line">[root@node4 ~]# curl -k https://login.node4.com</span><br><span class="line">login.node4.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># httpé‡å®šå‘</span></span><br><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">    ServerName login.node4.com</span><br><span class="line">    RewriteEngine On</span><br><span class="line">    RewriteRule  ^/(.*)$ https://login.node4.com/<span class="variable">$1</span></span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line">[root@node4 ~]#  systemctl restart httpd</span><br><span class="line"></span><br><span class="line">[root@node4 ~]# curl -I login.node4.com</span><br><span class="line">HTTP/1.1 302 Found</span><br><span class="line">Date: Mon, 19 Jan 2026 12:30:48 GMT</span><br><span class="line">Server: Apache/2.4.62 (Red Hat Enterprise Linux) OpenSSL/3.2.2</span><br><span class="line">Location: https://login.node4.com/</span><br><span class="line">Content-Type: text/html; charset=iso-8859-1</span><br></pre></td></tr></table></figure><h1 id="2026-1-20"><a href="#2026-1-20" class="headerlink" title="2026-1-20"></a>2026-1-20</h1><h2 id="1-NATæ¨¡å¼å®ç°æ–¹æ³•"><a href="#1-NATæ¨¡å¼å®ç°æ–¹æ³•" class="headerlink" title="1.NATæ¨¡å¼å®ç°æ–¹æ³•"></a>1.NATæ¨¡å¼å®ç°æ–¹æ³•</h2><p><img src="https://d1aa036.webp.li/Build/20260123_NAT.png" alt="20260123_NAT"></p><h3 id="1-1-VSä¸»æœºé…ç½®"><a href="#1-1-VSä¸»æœºé…ç½®" class="headerlink" title="1.1.VSä¸»æœºé…ç½®"></a>1.1.VSä¸»æœºé…ç½®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@vsnode ~]# vmset.sh vsnode eth0 172.25.254.100 </span><br><span class="line">[root@vsnode ~]# vmset.sh vsnode eth1 192.168.0.100 vsnode nogateway</span><br><span class="line"></span><br><span class="line">[root@vsnode ~]# route -n</span><br><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br><span class="line">0.0.0.0         172.25.254.2    0.0.0.0         UG    100    0        0 eth0</span><br><span class="line">172.25.254.0    0.0.0.0         255.255.255.0   U     100    0        0 eth0</span><br></pre></td></tr></table></figure><h3 id="1-2-RS1é…ç½®"><a href="#1-2-RS1é…ç½®" class="headerlink" title="1.2.RS1é…ç½®"></a>1.2.RS1é…ç½®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@vsnode ~]# vmset.sh RS1 eth0 192.168.0.10 192.168.0.100</span><br><span class="line"></span><br><span class="line">[root@RS1 ~]# route -n</span><br><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br><span class="line">0.0.0.0         192.168.0.100   0.0.0.0         UG    100    0        0 eth0</span><br><span class="line">192.168.0.0     0.0.0.0         255.255.255.0   U     100    0        0 eth0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@RS1 ~]# dnf install httpd -y --disablerepo=docker,epel</span><br><span class="line">[root@RS1 ~]# systemctl <span class="built_in">enable</span> --now httpd</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/httpd.service â†’ /usr/lib/systemd/system/httpd.service.</span><br><span class="line">[root@RS1 ~]# <span class="built_in">echo</span> 192.168.0.10 --- RS1 &gt; /var/www/html/index.html</span><br></pre></td></tr></table></figure><h3 id="1-3-RS2é…ç½®"><a href="#1-3-RS2é…ç½®" class="headerlink" title="1.3.RS2é…ç½®"></a>1.3.RS2é…ç½®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@vsnode ~]# vmset.sh RS2 eth0 192.168.0.20 192.168.0.100</span><br><span class="line"></span><br><span class="line">[root@RS2 ~]# route -n</span><br><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br><span class="line">0.0.0.0         192.168.0.100   0.0.0.0         UG    100    0        0 eth0</span><br><span class="line">192.168.0.0     0.0.0.0         255.255.255.0   U     100    0        0 eth0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@RS2 ~]# dnf install httpd -y --disablerepo=docker,epel</span><br><span class="line">[root@RS2 ~]# systemctl <span class="built_in">enable</span> --now httpd</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/httpd.service â†’ </span><br><span class="line">[root@RS2 ~]# <span class="built_in">echo</span> 192.168.0.20 --- RS1 &gt; /var/www/html/index.html</span><br></pre></td></tr></table></figure><h3 id="1-4-éªŒè¯"><a href="#1-4-éªŒè¯" class="headerlink" title="1.4.éªŒè¯"></a>1.4.éªŒè¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># VSnodeä¸­</span></span><br><span class="line">[root@vsnode ~]# curl 192.168.0.10</span><br><span class="line">192.168.0.10 --- RS1</span><br><span class="line">[root@vsnode ~]# curl 192.168.0.20</span><br><span class="line">192.168.0.20 --- RS2</span><br></pre></td></tr></table></figure><h1 id="2026-1-22"><a href="#2026-1-22" class="headerlink" title="2026-1-22"></a>2026-1-22</h1><h2 id="1-DRæ¨¡å¼"><a href="#1-DRæ¨¡å¼" class="headerlink" title="1.DRæ¨¡å¼"></a>1.DRæ¨¡å¼</h2><h3 id="1-1-ç¯å¢ƒæµç¨‹å›¾"><a href="#1-1-ç¯å¢ƒæµç¨‹å›¾" class="headerlink" title="1.1.ç¯å¢ƒæµç¨‹å›¾"></a>1.1.ç¯å¢ƒæµç¨‹å›¾</h3><p><img src="G:\å›¾ç‰‡\20260123-DR.png" alt="20260123-DR"></p><h3 id="1-2-ç¯å¢ƒé…ç½®"><a href="#1-2-ç¯å¢ƒé…ç½®" class="headerlink" title="1.2.ç¯å¢ƒé…ç½®"></a>1.2.ç¯å¢ƒé…ç½®</h3><h4 id="1-2-1-é…ç½®è·¯ç”±å™¨"><a href="#1-2-1-é…ç½®è·¯ç”±å™¨" class="headerlink" title="1.2.1.é…ç½®è·¯ç”±å™¨"></a>1.2.1.é…ç½®è·¯ç”±å™¨</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@router ~]# vmset.sh router eth0 172.25.254.100</span><br><span class="line">[root@router ~]# vmset.sh router eth1 192.168.0.100 nogateway</span><br><span class="line"></span><br><span class="line">[root@router ~]# dnf install ipvsadm -y</span><br><span class="line">[root@router ~]# systemctl <span class="built_in">disable</span> --now ipvsadm.service</span><br><span class="line">[root@router ~]# ipvsadm -C</span><br><span class="line"></span><br><span class="line">[root@router ~]# <span class="built_in">echo</span> net.ipv4.ip_forward=1 &gt;&gt; /etc/sysctl.conf</span><br><span class="line">[root@router ~]# sysctl  -p</span><br><span class="line">net.ipv4.ip_forward = 1</span><br><span class="line"></span><br><span class="line">[root@router ~]# iptables -t nat -A POSTROUTING -o eth1 -j SNAT --to-source 192.168.0.100</span><br><span class="line">[root@router ~]# iptables -t nat -A POSTROUTING -o eth0 -j SNAT --to-source 172.25.254.100</span><br></pre></td></tr></table></figure><h4 id="1-2-2-vsnodeè°ƒåº¦å™¨"><a href="#1-2-2-vsnodeè°ƒåº¦å™¨" class="headerlink" title="1.2.2.vsnodeè°ƒåº¦å™¨"></a>1.2.2.vsnodeè°ƒåº¦å™¨</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">[root@vsnode ~]# vmset.sh vsnode eth0 192.168.0.50 192.168.0.100</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@vsnode ~]# <span class="built_in">cd</span>  /etc/NetworkManager/system-connections/</span><br><span class="line">[root@vsnode system-connections]#  <span class="built_in">cp</span> -p eth0.nmconnection lo.nmconnection</span><br><span class="line">[root@vsnode system-connections]# vim lo.nmconnection</span><br><span class="line">[connection]</span><br><span class="line"><span class="built_in">id</span>=lo</span><br><span class="line"><span class="built_in">type</span>=loopback</span><br><span class="line">interface-name=lo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[ipv4]</span><br><span class="line">method=manual</span><br><span class="line">address1==127.0.0.1/8</span><br><span class="line">address2=192.168.0.200/32</span><br><span class="line"></span><br><span class="line">[root@vsnode system-connections]# nmcli connection reload</span><br><span class="line">[root@vsnode system-connections]# nmcli connection up lo</span><br><span class="line">è¿æ¥å·²æˆåŠŸæ¿€æ´»ï¼ˆD-Bus æ´»åŠ¨è·¯å¾„ï¼š/org/freedesktop/NetworkManager/ActiveConnection/8ï¼‰</span><br><span class="line"></span><br><span class="line">[root@vsnode ~]# route -n</span><br><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br><span class="line">0.0.0.0         192.168.0.100   0.0.0.0         UG    100    0        0 eth0</span><br><span class="line">192.168.0.0     0.0.0.0         255.255.255.0   U     100    0        0 eth0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@vsnode ~]# ip a</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet 192.168.0.200/32 scope global lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:2c:93:ef brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    altname enp3s0</span><br><span class="line">    altname ens160</span><br><span class="line">    inet 192.168.0.50/24 brd 192.168.0.255 scope global noprefixroute eth0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::ee1f:f906:ed7:7719/64 scope <span class="built_in">link</span> noprefixroute</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="1-2-3-å®¢æˆ·ç«¯"><a href="#1-2-3-å®¢æˆ·ç«¯" class="headerlink" title="1.2.3.å®¢æˆ·ç«¯"></a>1.2.3.å®¢æˆ·ç«¯</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@client ~]# vmset.sh client eth0 172.25.254.99</span><br><span class="line"></span><br><span class="line">[root@client ~]# ping 192.168.0.200 -c 2</span><br><span class="line">PING 192.168.0.200 (192.168.0.200) 56(84) æ¯”ç‰¹çš„æ•°æ®ã€‚</span><br><span class="line">64 æ¯”ç‰¹ï¼Œæ¥è‡ª 192.168.0.200: icmp_seq=1 ttl=128 æ—¶é—´=0.841 æ¯«ç§’</span><br><span class="line">64 æ¯”ç‰¹ï¼Œæ¥è‡ª 192.168.0.200: icmp_seq=2 ttl=128 æ—¶é—´=0.691 æ¯«ç§’</span><br><span class="line"></span><br><span class="line">--- 192.168.0.200 ping ç»Ÿè®¡ ---</span><br><span class="line">å·²å‘é€ 2 ä¸ªåŒ…ï¼Œ å·²æ¥æ”¶ 2 ä¸ªåŒ…, 0% packet loss, <span class="keyword">time</span> 1031ms</span><br><span class="line">rtt min/avg/max/mdev = 0.691/0.766/0.841/0.075 ms</span><br></pre></td></tr></table></figure><h4 id="1-2-4-RS1"><a href="#1-2-4-RS1" class="headerlink" title="1.2.4.RS1"></a>1.2.4.RS1</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">[root@RS1 ~]# vmset.sh RS1 eth0 192.168.0.10 192.168.0.100</span><br><span class="line">eth0 æ­£åœ¨ä½¿ç”¨!!!</span><br><span class="line">æˆåŠŸåˆ é™¤è¿æ¥ <span class="string">&quot;eth0&quot;</span> (7ba00b1d-8cdd-30da-91ad-bb83ed4f7474)ã€‚</span><br><span class="line">è¿æ¥å·²æˆåŠŸæ¿€æ´»ï¼ˆD-Bus æ´»åŠ¨è·¯å¾„ï¼š/org/freedesktop/NetworkManager/ActiveConnection/6ï¼‰</span><br><span class="line"></span><br><span class="line">=====ç½‘å¡è¯¦ç»†ä¿¡æ¯====</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:75:27:4f brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    altname enp3s0</span><br><span class="line">    altname ens160</span><br><span class="line">    inet 192.168.0.10/24 brd 192.168.0.255 scope global noprefixroute eth0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::d364:aca6:84cb:34d7/64 scope <span class="built_in">link</span> tentative noprefixroute</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">====è·¯ç”±è¡¨====</span><br><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br><span class="line">0.0.0.0         192.168.0.100   0.0.0.0         UG    100    0        0 eth0</span><br><span class="line">192.168.0.0     0.0.0.0         255.255.255.0   U     100    0        0 eth0</span><br><span class="line">====ä¸»æœºå====</span><br><span class="line">RS1</span><br><span class="line"></span><br><span class="line">[root@RS1 ~]# <span class="built_in">cd</span> /etc/NetworkManager/system-connections/</span><br><span class="line">[root@RS1 system-connections]# <span class="built_in">cp</span> -p eth0.nmconnection lo.nmconnection</span><br><span class="line">[root@RS1 system-connections]# vim lo.nmconnection</span><br><span class="line">[connection]</span><br><span class="line"><span class="built_in">id</span>=lo</span><br><span class="line"><span class="built_in">type</span>=loopback</span><br><span class="line">interface-name=lo</span><br><span class="line"></span><br><span class="line">[ipv4]</span><br><span class="line">address1=127.0.0.1/8</span><br><span class="line">address2=192.168.0.200/32</span><br><span class="line">method=manual</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@RS1 system-connections]# nmcli connection reload</span><br><span class="line">[root@RS1 system-connections]# nmcli connection up lo</span><br><span class="line">è¿æ¥å·²æˆåŠŸæ¿€æ´»ï¼ˆD-Bus æ´»åŠ¨è·¯å¾„ï¼š/org/freedesktop/NetworkManager/ActiveConnection/6ï¼‰</span><br><span class="line">[root@RS1 system-connections]# ip a</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet 192.168.0.200/32 scope global lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:c4:c1:29 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    altname enp3s0</span><br><span class="line">    altname ens160</span><br><span class="line">    inet 192.168.0.10/24 brd 192.168.0.255 scope global noprefixroute eth0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::d364:aca6:84cb:34d7/64 scope <span class="built_in">link</span> noprefixroute</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"></span><br><span class="line"><span class="comment"># arp ç¦æ­¢å“åº”</span></span><br><span class="line">[root@RS1 ~]# vim arp.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/net/ipv4/conf/all/arp_ignore</span><br><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/net/ipv4/conf/lo/arp_ignore</span><br><span class="line"><span class="built_in">echo</span> 2 &gt; /proc/sys/net/ipv4/conf/lo/arp_announce</span><br><span class="line"><span class="built_in">echo</span> 2 &gt; /proc/sys/net/ipv4/conf/all/arp_announce</span><br><span class="line"><span class="built_in">echo</span> æ‰§è¡ŒæˆåŠŸ</span><br><span class="line">[root@RS1 ~]# bash arp.sh</span><br></pre></td></tr></table></figure><h4 id="1-2-5-RS2"><a href="#1-2-5-RS2" class="headerlink" title="1.2.5.RS2"></a>1.2.5.RS2</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">[root@RS2 ~]#  vmset.sh RS2 eth0 192.168.0.20 192.168.0.100</span><br><span class="line">eth0 æ­£åœ¨ä½¿ç”¨!!!</span><br><span class="line">æˆåŠŸåˆ é™¤è¿æ¥ <span class="string">&quot;eth0&quot;</span> (7ba00b1d-8cdd-30da-91ad-bb83ed4f7474)ã€‚</span><br><span class="line"></span><br><span class="line">è¿æ¥å·²æˆåŠŸæ¿€æ´»ï¼ˆD-Bus æ´»åŠ¨è·¯å¾„ï¼š/org/freedesktop/NetworkManager/ActiveConnection/6ï¼‰</span><br><span class="line"></span><br><span class="line">=====ç½‘å¡è¯¦ç»†ä¿¡æ¯====</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:30:97:ac brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    altname enp3s0</span><br><span class="line">    altname ens160</span><br><span class="line">    inet 192.168.0.20/24 brd 192.168.0.255 scope global noprefixroute eth0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::d364:aca6:84cb:34d7/64 scope <span class="built_in">link</span> tentative noprefixroute</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">====è·¯ç”±è¡¨====</span><br><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br><span class="line">0.0.0.0         192.168.0.100   0.0.0.0         UG    100    0        0 eth0</span><br><span class="line">192.168.0.0     0.0.0.0         255.255.255.0   U     100    0        0 eth0</span><br><span class="line">====ä¸»æœºå====</span><br><span class="line">RS2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@RS2 ~]# <span class="built_in">cd</span> /etc/NetworkManager/system-connections/</span><br><span class="line">[root@RS2 system-connections]# <span class="built_in">cp</span> -p eth0.nmconnection lo.nmconnection</span><br><span class="line">[root@RS2 system-connections]# vim lo.nmconnection</span><br><span class="line">[connection]</span><br><span class="line"><span class="built_in">id</span>=lo</span><br><span class="line"><span class="built_in">type</span>=loopback</span><br><span class="line">interface-name=lo</span><br><span class="line"></span><br><span class="line">[ethernet]</span><br><span class="line"></span><br><span class="line">[ipv4]</span><br><span class="line">method=manual</span><br><span class="line">address1=127.0.0.1/8</span><br><span class="line">address2=192.168.0.200/32</span><br><span class="line"></span><br><span class="line">[root@RS2 system-connections]# nmcli connection reload</span><br><span class="line">[root@RS2 system-connections]#  nmcli connection up lo</span><br><span class="line">è¿æ¥å·²æˆåŠŸæ¿€æ´»ï¼ˆD-Bus æ´»åŠ¨è·¯å¾„ï¼š/org/freedesktop/NetworkManager/ActiveConnection/8ï¼‰</span><br><span class="line"></span><br><span class="line"><span class="comment"># arp ç¦æ­¢å“åº”</span></span><br><span class="line">[root@RS1 ~]# vim arp.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/net/ipv4/conf/all/arp_ignore</span><br><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/net/ipv4/conf/lo/arp_ignore</span><br><span class="line"><span class="built_in">echo</span> 2 &gt; /proc/sys/net/ipv4/conf/lo/arp_announce</span><br><span class="line"><span class="built_in">echo</span> 2 &gt; /proc/sys/net/ipv4/conf/all/arp_announce</span><br><span class="line"><span class="built_in">echo</span> æ‰§è¡ŒæˆåŠŸ</span><br><span class="line">[root@RS1 ~]# bash arp.sh</span><br></pre></td></tr></table></figure><h2 id="2-åˆ©ç”¨ç«å¢™æ ‡è®°è§£å†³è½®è¯¢é”™è¯¯"><a href="#2-åˆ©ç”¨ç«å¢™æ ‡è®°è§£å†³è½®è¯¢é”™è¯¯" class="headerlink" title="2.åˆ©ç”¨ç«å¢™æ ‡è®°è§£å†³è½®è¯¢é”™è¯¯"></a>2.åˆ©ç”¨ç«å¢™æ ‡è®°è§£å†³è½®è¯¢é”™è¯¯</h2><h3 id="2-1-åœ¨rsä¸»æœºä¸­åŒæ—¶å¼€å§‹httpå’Œhttpsä¸¤ç§åè®®"><a href="#2-1-åœ¨rsä¸»æœºä¸­åŒæ—¶å¼€å§‹httpå’Œhttpsä¸¤ç§åè®®" class="headerlink" title="2.1.åœ¨rsä¸»æœºä¸­åŒæ—¶å¼€å§‹httpå’Œhttpsä¸¤ç§åè®®"></a>2.1.åœ¨rsä¸»æœºä¸­åŒæ—¶å¼€å§‹httpå’Œhttpsä¸¤ç§åè®®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@RS1 ~]# dnf install ipvsadm -y</span><br><span class="line">[root@RS1 ~]# dnf install mod_ssl -y</span><br><span class="line">[root@RS1 ~]# systemctl <span class="built_in">disable</span> --now ipvsadm.service</span><br><span class="line">[root@RS1 ~]# ipvsadm -C</span><br><span class="line">[root@RS1 ~]# systemctl restart httpd</span><br></pre></td></tr></table></figure><h3 id="2-2-åœ¨vsnodeä¸­æ·»åŠ httpsçš„è½®è¯¢ç­–ç•¥"><a href="#2-2-åœ¨vsnodeä¸­æ·»åŠ httpsçš„è½®è¯¢ç­–ç•¥" class="headerlink" title="2.2. åœ¨vsnodeä¸­æ·»åŠ httpsçš„è½®è¯¢ç­–ç•¥"></a>2.2. åœ¨vsnodeä¸­æ·»åŠ httpsçš„è½®è¯¢ç­–ç•¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@vsnode ~]# dnf install ipvsadm -y</span><br><span class="line"></span><br><span class="line">[root@vsnode ~]# ipvsadm -A -t 192.168.0.200:80  -s rr</span><br><span class="line">[root@vsnode ~]# ipvsadm -a -t 192.168.0.200:80 -r 192.168.0.20 -g</span><br><span class="line">[root@vsnode ~]# ipvsadm -a -t 192.168.0.200:80 -r 192.168.0.10 -g</span><br><span class="line"></span><br><span class="line">[root@vsnode ~]# ipvsadm -A -t 192.168.0.200:443 -s rr</span><br><span class="line">[root@vsnode ~]# ipvsadm -a -t 192.168.0.200:443 -r 192.168.0.10:443 -g</span><br><span class="line">[root@vsnode ~]# ipvsadm -a -t 192.168.0.200:443 -r 192.168.0.20:443 -g</span><br><span class="line"></span><br><span class="line">[root@vsnode ~]# ipvsadm -Ln</span><br><span class="line">IP Virtual Server version 1.2.1 (size=4096)</span><br><span class="line">Prot LocalAddress:Port Scheduler Flags</span><br><span class="line">  -&gt; RemoteAddress:Port           Forward Weight ActiveConn InActConn</span><br><span class="line">TCP  192.168.0.200:80 rr</span><br><span class="line">  -&gt; 192.168.0.10:80              Route   1      0          0</span><br><span class="line">  -&gt; 192.168.0.20:80              Route   1      0          0</span><br><span class="line">TCP  192.168.0.200:443 rr</span><br><span class="line">  -&gt; 192.168.0.10:443             Route   1      0          0</span><br><span class="line">  -&gt; 192.168.0.20:443             Route   1      0          0</span><br></pre></td></tr></table></figure><h3 id="2-3-è½®è¯¢é”™è¯¯å±•ç¤º"><a href="#2-3-è½®è¯¢é”™è¯¯å±•ç¤º" class="headerlink" title="2.3. è½®è¯¢é”™è¯¯å±•ç¤º"></a>2.3. è½®è¯¢é”™è¯¯å±•ç¤º</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@client ~]# curl  192.168.0.200;curl -k https://192.168.0.200</span><br><span class="line">192.168.0.10 --- RS1</span><br><span class="line">192.168.0.10 --- RS1</span><br><span class="line"></span><br><span class="line"><span class="comment">#å½“ä¸Šè¿°è®¾å®šå®Œæˆåhttpå’Œhttpsæ˜¯ç‹¬ç«‹çš„serviceï¼Œè½®è¯¢ä¼šå‡ºç°é‡å¤é—®é¢˜</span></span><br></pre></td></tr></table></figure><h3 id="2-4-è§£å†³æ–¹æ¡ˆ"><a href="#2-4-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="2.4.è§£å†³æ–¹æ¡ˆ"></a>2.4.è§£å†³æ–¹æ¡ˆ</h3><p>ä½¿ç”¨ç«å¢™æ ‡è®°è®¿é—®vipçš„80å’Œ443çš„æ‰€æœ‰æ•°æ®åŒ…ï¼Œè®¾å®šæ ‡è®°ä¸º6666ï¼Œç„¶åå¯¹æ­¤æ ‡è®°è¿›è¡Œè´Ÿè½½</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@vsnode ~]# ipvsadm -C</span><br><span class="line">[root@vsnode ~]# iptables -t mangle -A PREROUTING -d 192.168.0.200 -p tcp -m multiport --dports 80,443 -j MARK --set-mark  6666</span><br><span class="line"></span><br><span class="line">[root@vsnode ~]# ipvsadm -A -f 6666 -s rr</span><br><span class="line">[root@vsnode ~]# ipvsadm  -a -f 6666 -r 192.168.0.10 -g</span><br><span class="line">[root@vsnode ~]# ipvsadm  -a -f 6666 -r 192.168.0.20 -g</span><br></pre></td></tr></table></figure><h3 id="2-5-æµ‹è¯•"><a href="#2-5-æµ‹è¯•" class="headerlink" title="2.5.æµ‹è¯•"></a>2.5.æµ‹è¯•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@client ~]# curl  192.168.0.200;curl -k https://192.168.0.200</span><br><span class="line">192.168.0.20 --- RS2</span><br><span class="line">192.168.0.10 --- RS1</span><br></pre></td></tr></table></figure><h2 id="3-åˆ©ç”¨æŒä¹…è¿æ¥å®ç°ä¼šè¯ç²˜æ»"><a href="#3-åˆ©ç”¨æŒä¹…è¿æ¥å®ç°ä¼šè¯ç²˜æ»" class="headerlink" title="3.åˆ©ç”¨æŒä¹…è¿æ¥å®ç°ä¼šè¯ç²˜æ»"></a>3.åˆ©ç”¨æŒä¹…è¿æ¥å®ç°ä¼šè¯ç²˜æ»</h2><p>è®¾å®šipvsè°ƒåº¦ç­–ç•¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@vsnode ~]# ipvsadm -A -f 6666 -s rr -p 1</span><br></pre></td></tr></table></figure><h1 id="2026-1-23"><a href="#2026-1-23" class="headerlink" title="2026-1-23"></a>2026-1-23</h1><h2 id="1-HAPORXYå®éªŒ"><a href="#1-HAPORXYå®éªŒ" class="headerlink" title="1.HAPORXYå®éªŒ"></a>1.HAPORXYå®éªŒ</h2><h3 id="1-ç¯å¢ƒå›¾"><a href="#1-ç¯å¢ƒå›¾" class="headerlink" title="1.ç¯å¢ƒå›¾"></a>1.ç¯å¢ƒå›¾</h3><p><img src="G:\å›¾ç‰‡\2026-1-24_HA.png" alt="2026-1-24_HA"></p><h2 id="2-ç¯å¢ƒæ­å»º"><a href="#2-ç¯å¢ƒæ­å»º" class="headerlink" title="2.ç¯å¢ƒæ­å»º"></a>2.ç¯å¢ƒæ­å»º</h2><h3 id="2-1-haproxyä¸»æœº"><a href="#2-1-haproxyä¸»æœº" class="headerlink" title="2.1.haproxyä¸»æœº"></a>2.1.haproxyä¸»æœº</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@haproxy ~]# vmset.sh haproxy eth0 172.25.254.100</span><br><span class="line">[root@haproxy ~]# vmset.sh haproxy eth1 192.168.0.100 nogateway</span><br><span class="line"></span><br><span class="line">[root@haproxy ~]# <span class="built_in">echo</span> net.ipv4.ip_forward=1 &gt; /etc/sysctl.conf</span><br><span class="line">[root@haproxy ~]# sysctl -p</span><br><span class="line">net.ipv4.ip_forward = 1</span><br></pre></td></tr></table></figure><h3 id="2-2-webserver1"><a href="#2-2-webserver1" class="headerlink" title="2.2.webserver1"></a>2.2.webserver1</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@webserver1 ~]# vmset.sh webserver1 eth0 192.168.0.10 nogateway</span><br><span class="line">[root@webserver1 ~]# dnf install httpd -y</span><br><span class="line">[root@webserver1 ~]# <span class="built_in">echo</span> webserver1 - 192.168.0.10 &gt; /var/www/html/index.html</span><br><span class="line">[root@webserver1 ~]# systemctl <span class="built_in">enable</span> --now httpd</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/httpd.service â†’ /usr/lib/systemd/system/httpd.service.</span><br></pre></td></tr></table></figure><h3 id="2-3-webserver2"><a href="#2-3-webserver2" class="headerlink" title="2.3.webserver2"></a>2.3.webserver2</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@webserver2 ~]# vmset.sh webserver2 eth0 192.168.0.20 nogateway</span><br><span class="line">[root@webserver2 ~]# <span class="built_in">echo</span> webserver2 - 192.168.0.20 &gt; /var/www/html/index.html</span><br><span class="line">[root@webserver2 ~]# systemctl <span class="built_in">enable</span> --now httpd</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/httpd.service â†’ /usr/lib/systemd/system/httpd.service.</span><br></pre></td></tr></table></figure><h3 id="2-4-ç¯å¢ƒéªŒè¯"><a href="#2-4-ç¯å¢ƒéªŒè¯" class="headerlink" title="2.4.ç¯å¢ƒéªŒè¯"></a>2.4.ç¯å¢ƒéªŒè¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@haproxy ~]# curl  192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">[root@haproxy ~]# curl  192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br></pre></td></tr></table></figure><h2 id="3-Haproxyçš„å®‰è£…åŠé…ç½®å‚æ•°"><a href="#3-Haproxyçš„å®‰è£…åŠé…ç½®å‚æ•°" class="headerlink" title="3.Haproxyçš„å®‰è£…åŠé…ç½®å‚æ•°"></a>3.Haproxyçš„å®‰è£…åŠé…ç½®å‚æ•°</h2><h3 id="3-1-å®‰è£…"><a href="#3-1-å®‰è£…" class="headerlink" title="3.1.å®‰è£…"></a>3.1.å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨è°ƒåº¦å™¨ï¼ˆåŒç½‘å¡ä¸»æœºä¸­ï¼‰</span></span><br><span class="line">[root@haproxy ~]# dnf install haproxy.x86_64 -y</span><br><span class="line">[root@haproxy ~]# systemctl <span class="built_in">enable</span> --now haproxy</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/haproxy.service â†’ /usr/lib/systemd/system/haproxy.service.</span><br></pre></td></tr></table></figure><h3 id="3-2-harpoxyçš„å‚æ•°è¯¦è§£å®éªŒ"><a href="#3-2-harpoxyçš„å‚æ•°è¯¦è§£å®éªŒ" class="headerlink" title="3.2.harpoxyçš„å‚æ•°è¯¦è§£å®éªŒ"></a>3.2.harpoxyçš„å‚æ•°è¯¦è§£å®éªŒ</h3><h1 id="2026-1-25"><a href="#2026-1-25" class="headerlink" title="2026-1-25"></a>2026-1-25</h1><h2 id="1-Haproxyç®—æ³•å®éªŒ"><a href="#1-Haproxyç®—æ³•å®éªŒ" class="headerlink" title="1.Haproxyç®—æ³•å®éªŒ"></a>1.Haproxyç®—æ³•å®éªŒ</h2><h3 id="1-1-é™æ€ç®—æ³•"><a href="#1-1-é™æ€ç®—æ³•" class="headerlink" title="1.1.é™æ€ç®—æ³•"></a>1.1.é™æ€ç®—æ³•</h3><h4 id="1-1-1-static-rr"><a href="#1-1-1-static-rr" class="headerlink" title="1.1.1.static-rr"></a>1.1.1.static-rr</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">listen webcluster</span><br><span class="line">    <span class="built_in">bind</span>        *:80</span><br><span class="line">    balance     static-rr</span><br><span class="line">    hash-type   consistent</span><br><span class="line">    server haha 192.168.0.10:80 check inter 3s fall 3 rise 5 weight 4</span><br><span class="line">    server hehe 192.168.0.20:80 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line"></span><br><span class="line">[root@haproxy ~]# systemctl restart haproxy.service</span><br><span class="line"></span><br><span class="line">[kaitumei.DESKTOP-BMTM34T] â® <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..10&#125;; <span class="keyword">do</span> curl 172.25.254.100; <span class="keyword">done</span></span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ£€æµ‹æ˜¯å¦æ”¯æŒçƒ­æ›´æ–°</span></span><br><span class="line">[root@haproxy ~]# <span class="built_in">echo</span> <span class="string">&quot;get  weight webcluster/haha&quot;</span> | socat  stdio /var/lib/haproxy/stats</span><br><span class="line">4 (initial 4)</span><br><span class="line"></span><br><span class="line">[root@haproxy ~]# <span class="built_in">echo</span> <span class="string">&quot;set  weight webcluster/haha 1&quot;</span> | socat  stdio /var/lib/haproxy/stats</span><br><span class="line">Backend is using a static LB algorithm and only accepts weights <span class="string">&#x27;0%&#x27;</span> and <span class="string">&#x27;100%&#x27;</span>.</span><br></pre></td></tr></table></figure><h4 id="1-1-2-first"><a href="#1-1-2-first" class="headerlink" title="1.1.2.first"></a>1.1.2.first</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">[root@haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">listen webcluster</span><br><span class="line">    <span class="built_in">bind</span>        *:80</span><br><span class="line">    balance     first</span><br><span class="line">    hash-type   consistent</span><br><span class="line">    server haha 192.168.0.10:80 maxconn 1 check inter 3s fall 3 rise 5 weight 4</span><br><span class="line">    server hehe 192.168.0.20:80 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line"></span><br><span class="line">[root@haproxy ~]# systemctl restart haproxy.service</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[kaitumei.DESKTOP-BMTM34T] â® <span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span> curl 172.25.254.100; <span class="keyword">done</span></span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†å¼€ä¸€ä¸ªç»ˆç«¯</span></span><br><span class="line">[kaitumei.DESKTOP-BMTM34T] â® <span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span> curl 172.25.254.100; <span class="keyword">done</span></span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br></pre></td></tr></table></figure><h3 id="1-2-åŠ¨æ€ç®—æ³•"><a href="#1-2-åŠ¨æ€ç®—æ³•" class="headerlink" title="1.2.åŠ¨æ€ç®—æ³•"></a>1.2.åŠ¨æ€ç®—æ³•</h3><h4 id="1-2-1-roundrobin"><a href="#1-2-1-roundrobin" class="headerlink" title="1.2.1.roundrobin"></a>1.2.1.roundrobin</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">[root@haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">listen webcluster</span><br><span class="line">    <span class="built_in">bind</span>        *:80</span><br><span class="line">    balance     roundrobin</span><br><span class="line">    hash-type   consistent</span><br><span class="line">    server haha 192.168.0.10:80 check inter 3s fall 3 rise 5 weight 4</span><br><span class="line">    server hehe 192.168.0.20:80 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line"></span><br><span class="line">[root@haproxy ~]# systemctl restart haproxy.service</span><br><span class="line"></span><br><span class="line">[kaitumei.DESKTOP-BMTM34T] â®  <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..10&#125;; <span class="keyword">do</span> curl 172.25.254.100; <span class="keyword">done</span></span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ¨æ€æƒé‡æ›´æ–°</span></span><br><span class="line">[root@haproxy ~]# <span class="built_in">echo</span> <span class="string">&quot;get weight webcluster/haha&quot;</span> | socat stdio /var/lib/haproxy/stats</span><br><span class="line">4 (initial 4)</span><br><span class="line"></span><br><span class="line">[root@haproxy ~]# <span class="built_in">echo</span> <span class="string">&quot;set  weight  webcluster/haha 1  &quot;</span> | socat stdio /var/lib/haproxy/stats</span><br><span class="line">[root@haproxy ~]# <span class="built_in">echo</span> <span class="string">&quot;get  weight webcluster/haha&quot;</span> | socat  stdio /var/lib/haproxy/stats</span><br><span class="line">1 (initial 4)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•ˆæœ</span></span><br><span class="line">[kaitumei.DESKTOP-BMTM34T] â® <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..10&#125;; <span class="keyword">do</span> curl 172.25.254.100; <span class="keyword">done</span></span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="1-2-2-leastconn"><a href="#1-2-2-leastconn" class="headerlink" title="1.2.2.leastconn"></a>1.2.2.leastconn</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">listen webcluster</span><br><span class="line">    <span class="built_in">bind</span>        *:80</span><br><span class="line">    balance     leastconn</span><br><span class="line">    hash-type   consistent</span><br><span class="line">    server haha 192.168.0.10:80 check inter 3s fall 3 rise 5 weight 4</span><br><span class="line">    server hehe 192.168.0.20:80 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line"></span><br><span class="line">[root@haproxy ~]# systemctl restart haproxy </span><br><span class="line"></span><br><span class="line">[kaitumei.DESKTOP-BMTM34T] â® <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..10&#125;; <span class="keyword">do</span> curl 172.25.254.100; <span class="keyword">done</span></span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br></pre></td></tr></table></figure><h3 id="1-3-æ··åˆç®—æ³•"><a href="#1-3-æ··åˆç®—æ³•" class="headerlink" title="1.3.æ··åˆç®—æ³•"></a>1.3.æ··åˆç®—æ³•</h3><h4 id="1-3-1-source"><a href="#1-3-1-source" class="headerlink" title="1.3.1.source"></a>1.3.1.source</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤é™æ€ç®—æ³•</span></span><br><span class="line">[root@haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">listen webcluster</span><br><span class="line">    <span class="built_in">bind</span>        *:80</span><br><span class="line">    balance     <span class="built_in">source</span></span><br><span class="line">    server haha 192.168.0.10:80 check inter 3s fall 3 rise 5 weight 4</span><br><span class="line">    server hehe 192.168.0.20:80 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line"></span><br><span class="line">[root@haproxy ~]# systemctl restart haproxy </span><br><span class="line"></span><br><span class="line">[kaitumei.DESKTOP-BMTM34T] â® <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..10&#125;; <span class="keyword">do</span> curl 172.25.254.100; <span class="keyword">done</span></span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ¨æ€ç®—æ³•</span></span><br><span class="line">[root@haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">listen webcluster</span><br><span class="line">    <span class="built_in">bind</span>        *:80</span><br><span class="line">    balance     <span class="built_in">source</span></span><br><span class="line">hash-type   consistent</span><br><span class="line">    server haha 192.168.0.10:80 check inter 3s fall 3 rise 5 weight 4</span><br><span class="line">    server hehe 192.168.0.20:80 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line"></span><br><span class="line">[root@haproxy ~]# systemctl restart haproxy </span><br><span class="line"></span><br><span class="line">[kaitumei.DESKTOP-BMTM34T] â® <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..10&#125;; <span class="keyword">do</span> curl 172.25.254.100; <span class="keyword">done</span></span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br></pre></td></tr></table></figure><h4 id="1-3-2-uri"><a href="#1-3-2-uri" class="headerlink" title="1.3.2.uri"></a>1.3.2.uri</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¸»å¤‡å®éªŒç¯å¢ƒ</span></span><br><span class="line">[root@webserver1 ~]# <span class="built_in">echo</span> RS1 - 192.168.0.10 &gt; /var/www/html/index1.html</span><br><span class="line">[root@webserver1 ~]# <span class="built_in">echo</span> RS1 - 192.168.0.10 &gt; /var/www/html/index2.html</span><br><span class="line">[root@webserver2 ~]# <span class="built_in">echo</span> RS2 - 192.168.0.20 &gt; /var/www/html/index1.html</span><br><span class="line">[root@webserver2 ~]# <span class="built_in">echo</span> RS2 - 192.168.0.20 &gt; /var/www/html/index2.html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾å®šuriç®—æ³•</span></span><br><span class="line">[root@haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">listen webcluster</span><br><span class="line">    <span class="built_in">bind</span>        *:80</span><br><span class="line">    balance     uri</span><br><span class="line">    hash-type   consistent</span><br><span class="line">    server haha 192.168.0.10:80 check inter 3s fall 3 rise 5 weight 4</span><br><span class="line">    server hehe 192.168.0.20:80 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line"></span><br><span class="line">[root@haproxy ~]# systemctl restart haproxy.service</span><br><span class="line"></span><br><span class="line">[kaitumei.DESKTOP-BMTM34T] â® <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..10&#125;; <span class="keyword">do</span> curl 172.25.254.100/index1.html; <span class="keyword">done</span></span><br><span class="line">RS1 - 192.168.0.10</span><br><span class="line">RS1 - 192.168.0.10</span><br><span class="line">RS1 - 192.168.0.10</span><br><span class="line">RS1 - 192.168.0.10</span><br><span class="line">RS1 - 192.168.0.10</span><br><span class="line">RS1 - 192.168.0.10</span><br><span class="line">RS1 - 192.168.0.10</span><br><span class="line">RS1 - 192.168.0.10</span><br><span class="line">RS1 - 192.168.0.10</span><br><span class="line">RS1 - 192.168.0.10</span><br><span class="line">                                                                       </span><br><span class="line">[kaitumei.DESKTOP-BMTM34T] â® <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..10&#125;; <span class="keyword">do</span> curl 172.25.254.100/index2.html; <span class="keyword">done</span></span><br><span class="line">RS2 - 192.168.0.20</span><br><span class="line">RS2 - 192.168.0.20</span><br><span class="line">RS2 - 192.168.0.20</span><br><span class="line">RS2 - 192.168.0.20</span><br><span class="line">RS2 - 192.168.0.20</span><br><span class="line">RS2 - 192.168.0.20</span><br><span class="line">RS2 - 192.168.0.20</span><br><span class="line">RS2 - 192.168.0.20</span><br><span class="line">RS2 - 192.168.0.20</span><br><span class="line">RS2 - 192.168.0.20</span><br></pre></td></tr></table></figure><h4 id="1-3-3-url-param"><a href="#1-3-3-url-param" class="headerlink" title="1.3.3.url_param"></a>1.3.3.url_param</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾å®šurl_paramç®—æ³•</span></span><br><span class="line">[root@haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">listen webcluster</span><br><span class="line">    <span class="built_in">bind</span>        *:80</span><br><span class="line">    balance     url_param name</span><br><span class="line">    hash-type consistent</span><br><span class="line">    server haha 192.168.0.10:80 check inter 3s fall 3 rise 5 weight 2</span><br><span class="line">    server hehe 192.168.0.20:80 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line">    </span><br><span class="line">[root@haproxy ~]# systemctl restart haproxy</span><br><span class="line"></span><br><span class="line">[kaitumei.DESKTOP-BMTM34T] â® <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..10&#125;; <span class="keyword">do</span> curl 172.25.254.100/index.html?name=hua; <span class="keyword">done</span></span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line"></span><br><span class="line">[kaitumei.DESKTOP-BMTM34T] â® <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..10&#125;; <span class="keyword">do</span> curl 172.25.254.100/index.html?name=huaaaaa; <span class="keyword">done</span></span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver1 - 192.168.0.10</span><br></pre></td></tr></table></figure><h4 id="1-3-4-hdr"><a href="#1-3-4-hdr" class="headerlink" title="1.3.4.hdr"></a>1.3.4.hdr</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">listen webcluster</span><br><span class="line">    <span class="built_in">bind</span>        *:80</span><br><span class="line">    balance     hdr(User-Agent)</span><br><span class="line">    hash-type   consistent</span><br><span class="line">    server haha 192.168.0.10:80 check inter 3s fall 3 rise 5 weight 4</span><br><span class="line">    server hehe 192.168.0.20:80 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line"></span><br><span class="line">[root@haproxy ~]# systemctl restart haproxy</span><br><span class="line"></span><br><span class="line">[kaitumei.DESKTOP-BMTM34T] â® curl -A <span class="string">&quot;hua&quot;</span> 172.25.254.100</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line"></span><br><span class="line">[kaitumei.DESKTOP-BMTM34T] â® curl -A <span class="string">&quot;Yeming&quot;</span> 172.25.254.100</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="2-åŸºäºcookieçš„ä¼šè¯ä¿æŒ"><a href="#2-åŸºäºcookieçš„ä¼šè¯ä¿æŒ" class="headerlink" title="2.åŸºäºcookieçš„ä¼šè¯ä¿æŒ"></a>2.åŸºäºcookieçš„ä¼šè¯ä¿æŒ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">listen webcluster</span><br><span class="line">    <span class="built_in">bind</span>        *:80</span><br><span class="line">    balance     roundrobin</span><br><span class="line">    hash-type   consistent</span><br><span class="line">    cookie WEBCOOKIE insert nocache indirect</span><br><span class="line">    server haha 192.168.0.10:80 cookie web1 check inter 3s fall 3 rise 5 weight 4</span><br><span class="line">    server hehe 192.168.0.20:80 cookie web2 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line"></span><br><span class="line">[root@haproxy ~]# systemctl restart haproxy.service</span><br></pre></td></tr></table></figure><p><img src="G:\å›¾ç‰‡\PixPin_2026-01-26_00-02-24.png" alt="PixPin_2026-01-26_00-02-24"></p><h2 id="3-HAProxyçŠ¶æ€é¡µ"><a href="#3-HAProxyçŠ¶æ€é¡µ" class="headerlink" title="3.HAProxyçŠ¶æ€é¡µ"></a>3.HAProxyçŠ¶æ€é¡µ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">listen stats</span><br><span class="line">    mode        http</span><br><span class="line">    <span class="built_in">bind</span> 0.0.0.0:1234</span><br><span class="line">    stats       <span class="built_in">enable</span></span><br><span class="line">    <span class="built_in">log</span>         global</span><br><span class="line"><span class="comment">#   stats       refresh</span></span><br><span class="line">    stats uri   /status</span><br><span class="line">    stats auth  hua:hua</span><br><span class="line">[root@haproxy ~]# systemctl restart haproxy.service</span><br></pre></td></tr></table></figure><h1 id="2026-1-26"><a href="#2026-1-26" class="headerlink" title="2026-1-26"></a>2026-1-26</h1><h2 id="1-IPé€ä¼ "><a href="#1-IPé€ä¼ " class="headerlink" title="1.IPé€ä¼ "></a>1.IPé€ä¼ </h2><h3 id="1-1-ä¸ƒå±‚é€ä¼ "><a href="#1-1-ä¸ƒå±‚é€ä¼ " class="headerlink" title="1.1.ä¸ƒå±‚é€ä¼ "></a>1.1.ä¸ƒå±‚é€ä¼ </h3><h4 id="1-1-1-ç¯å¢ƒæ­å»º"><a href="#1-1-1-ç¯å¢ƒæ­å»º" class="headerlink" title="1.1.1.ç¯å¢ƒæ­å»º"></a>1.1.1.ç¯å¢ƒæ­å»º</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Haproxyä¸­</span></span><br><span class="line">[root@Haproxy ~]# dnf install haproxy -y</span><br><span class="line">[root@Haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">listen webcluster</span><br><span class="line">    <span class="built_in">bind</span>    *:80</span><br><span class="line">    blance  roundrobin</span><br><span class="line">    server  haha 192.168.0.10:80 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line">    server  haha 192.168.0.20:80 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line"></span><br><span class="line">[root@Haproxy ~]# systemctl restart haproxy</span><br><span class="line"></span><br><span class="line"><span class="comment"># Webserver1ä¸Webserver2ä¸­</span></span><br><span class="line"><span class="comment">## webserver1</span></span><br><span class="line">[root@Webserver1 ~]# dnf install httpd -y --disablerepo=docker,epel</span><br><span class="line">[root@Webserver1 ~]# <span class="built_in">echo</span> <span class="string">&quot;webserver1 --- 192.168.0.10&quot;</span> &gt; /var/www/html/index.html</span><br><span class="line">[root@Webserver1 ~]# systemctl restart httpd</span><br><span class="line"><span class="comment">## webserver2</span></span><br><span class="line">[root@Webserver1 ~]# dnf install httpd -y --disablerepo=docker,epel</span><br><span class="line">[root@Webserver1 ~]# <span class="built_in">echo</span> <span class="string">&quot;webserver2 --- 192.168.0.20&quot;</span> &gt; /var/www/html/index.html</span><br><span class="line">[root@Webserver1 ~]# systemctl restart httpd</span><br></pre></td></tr></table></figure><h4 id="1-1-2-æµ‹è¯•ç¯å¢ƒ"><a href="#1-1-2-æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="1.1.2.æµ‹è¯•ç¯å¢ƒ"></a>1.1.2.æµ‹è¯•ç¯å¢ƒ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># clientä¸­</span></span><br><span class="line">[root@Client ~]# <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..5&#125;;<span class="keyword">do</span> curl 172.25.254.100;<span class="keyword">done</span></span><br><span class="line">webserver1 --- 192.168.0.10</span><br><span class="line">webserver2 --- 192.168.0.20</span><br><span class="line">webserver1 --- 192.168.0.10</span><br><span class="line">webserver2 --- 192.168.0.20</span><br><span class="line">webserver1 --- 192.168.0.10</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨rsä¸»æœºä¸­é»˜è®¤æ˜¯æœªå¼€å¯é€ä¼ åŠŸèƒ½çš„</span></span><br><span class="line"><span class="comment">## webserver1 or 2ä¸­</span></span><br><span class="line">[[root@Webserver1 ~]# <span class="built_in">cat</span> /etc/httpd/logs/access_log</span><br><span class="line">192.168.0.20 - - [27/Jan/2026:15:45:38 +0800] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 28 <span class="string">&quot;-&quot;</span> <span class="string">&quot;curl/7.76.1&quot;</span></span><br><span class="line">192.168.0.100 - - [27/Jan/2026:15:46:12 +0800] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 28 <span class="string">&quot;-&quot;</span> <span class="string">&quot;curl/7.76.1&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯ipé€ä¼ çš„æ–¹å¼</span></span><br><span class="line"><span class="comment">## haproxyä¸­</span></span><br><span class="line">[root@Haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">defaults</span><br><span class="line">    mode                    http</span><br><span class="line">    <span class="built_in">log</span>                     global</span><br><span class="line">    option                  httplog</span><br><span class="line">    option                  dontlognull</span><br><span class="line">    option http-server-close</span><br><span class="line">    option forwardfor       except 127.0.0.0/8 <span class="comment">#å¼€å¯haproxyé€ä¼ åŠŸèƒ½</span></span><br><span class="line">    option                  redispatch</span><br><span class="line">    retries                 3</span><br><span class="line">    <span class="built_in">timeout</span> http-request    10s</span><br><span class="line">    <span class="built_in">timeout</span> queue           1m</span><br><span class="line">    <span class="built_in">timeout</span> connect         10s</span><br><span class="line">    <span class="built_in">timeout</span> client          1m</span><br><span class="line">    <span class="built_in">timeout</span> server          1m</span><br><span class="line">    <span class="built_in">timeout</span> http-keep-alive 10s</span><br><span class="line">    <span class="built_in">timeout</span> check           10s</span><br><span class="line">    maxconn                 3000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨rsä¸­è®¾å®šé‡‡é›†é€ä¼ IP</span></span><br><span class="line"><span class="comment">## webserver1 or 2ä¸­</span></span><br><span class="line">[root@Webserver1 ~]# vim /etc/httpd/conf/httpd.conf</span><br><span class="line">201     LogFormat <span class="string">&quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%&#123;X-Forwarded-For&#125;i\&quot; \&quot;%&#123;Referer    &#125;i\&quot; \&quot;%&#123;User-Agent&#125;i\&quot;&quot;</span> combined</span><br><span class="line"></span><br><span class="line">[root@Webserver1 ~]# systemctl restart httpd</span><br></pre></td></tr></table></figure><h4 id="1-1-3-æµ‹è¯•æ•ˆæœ"><a href="#1-1-3-æµ‹è¯•æ•ˆæœ" class="headerlink" title="1.1.3.æµ‹è¯•æ•ˆæœ"></a>1.1.3.æµ‹è¯•æ•ˆæœ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># clientä¸­</span></span><br><span class="line">[root@Client ~]# <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..5&#125;;<span class="keyword">do</span> curl 172.25.254.100;<span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># webserver1 or 2ä¸­</span></span><br><span class="line">[root@Webserver1 ~]# <span class="built_in">cat</span> /etc/httpd/logs/access_log</span><br><span class="line">192.168.0.100 - - [27/Jan/2026:15:55:39 +0800] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 28 <span class="string">&quot;172.25.254.99&quot;</span> <span class="string">&quot;-&quot;</span> <span class="string">&quot;curl/7.76.1&quot;</span></span><br><span class="line">192.168.0.100 - - [27/Jan/2026:15:55:39 +0800] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 28 <span class="string">&quot;172.25.254.99&quot;</span> <span class="string">&quot;-&quot;</span> <span class="string">&quot;curl/7.76.1&quot;</span></span><br></pre></td></tr></table></figure><h3 id="1-2-å››å±‚é€ä¼ "><a href="#1-2-å››å±‚é€ä¼ " class="headerlink" title="1.2.å››å±‚é€ä¼ "></a>1.2.å››å±‚é€ä¼ </h3><h4 id="1-2-1-ç¯å¢ƒæ­å»º"><a href="#1-2-1-ç¯å¢ƒæ­å»º" class="headerlink" title="1.2.1.ç¯å¢ƒæ­å»º"></a>1.2.1.ç¯å¢ƒæ­å»º</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨RSä¸­æŠŠapacheåœæ­¢</span></span><br><span class="line">[root@Webserver1 ~]# systemctl <span class="built_in">disable</span> --now httpd</span><br><span class="line">[root@Webserver2 ~]# systemctl <span class="built_in">disable</span> --now httpd</span><br><span class="line"></span><br><span class="line"><span class="comment"># éƒ¨ç½²nginx</span></span><br><span class="line"><span class="comment"># webserver1</span></span><br><span class="line">[root@Webserver1 ~]# dnf install nginx -y --disablerepo=docker,epel</span><br><span class="line">[root@Webserver1 ~]# <span class="built_in">echo</span> webserver1 - 192.168.0.10 &gt; /usr/share/nginx/html/index.html</span><br><span class="line">[root@Webserver1 ~]# systemctl <span class="built_in">enable</span> --now nginx</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/nginx.service â†’ /usr/lib/systemd/system/nginx.service.</span><br><span class="line"><span class="comment"># webserver2</span></span><br><span class="line">[root@Webserver2 ~]# dnf install nginx -y --disablerepo=docker,epel</span><br><span class="line">[root@Webserver2 ~]# <span class="built_in">echo</span> webserver2 - 192.168.0.20 &gt; /usr/share/nginx/html/index.html</span><br><span class="line">[root@Webserver2 ~]# systemctl <span class="built_in">enable</span> --now nginx</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/nginx.service â†’ /usr/lib/systemd/system/nginx.service.</span><br></pre></td></tr></table></figure><h4 id="1-2-2-æµ‹è¯•ç¯å¢ƒ"><a href="#1-2-2-æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="1.2.2.æµ‹è¯•ç¯å¢ƒ"></a>1.2.2.æµ‹è¯•ç¯å¢ƒ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯ç”¨nginxçš„å››å±‚è®¿é—®æ§åˆ¶</span></span><br><span class="line"><span class="comment"># webserver1 and 2</span></span><br><span class="line">[root@webserver1 ~]# vim /etc/nginx/nginx.conf</span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80 proxy_protocol;<span class="comment"># å¯ç”¨å››å±‚è®¿é—®</span></span><br><span class="line">        listen       [::]:80;</span><br><span class="line">        server_name  _;</span><br><span class="line">        root         /usr/share/nginx/html;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Load configuration files for the default server block.</span></span><br><span class="line">        include /etc/nginx/default.d/*.conf;</span><br><span class="line"></span><br><span class="line">        error_page 404 /404.html;</span><br><span class="line">        location = /404.html &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        error_page 500 502 503 504 /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">[root@Webserver1 ~]# systemctl restart nginx.service</span><br><span class="line">[root@Webserver2 ~]# systemctl restart nginx.service</span><br><span class="line"></span><br><span class="line"><span class="comment">## client</span></span><br><span class="line">[root@Client ~]# <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..5&#125;; <span class="keyword">do</span> curl 172.25.254.100; <span class="keyword">done</span></span><br><span class="line">&lt;html&gt;&lt;body&gt;&lt;h1&gt;502 Bad Gateway&lt;/h1&gt;</span><br><span class="line">The server returned an invalid or incomplete response.</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br><span class="line">&lt;html&gt;&lt;body&gt;&lt;h1&gt;502 Bad Gateway&lt;/h1&gt;</span><br><span class="line">The server returned an invalid or incomplete response.</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br><span class="line">&lt;html&gt;&lt;body&gt;&lt;h1&gt;502 Bad Gateway&lt;/h1&gt;</span><br><span class="line">The server returned an invalid or incomplete response.</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br><span class="line">&lt;html&gt;&lt;body&gt;&lt;h1&gt;502 Bad Gateway&lt;/h1&gt;</span><br><span class="line">The server returned an invalid or incomplete response.</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br><span class="line">&lt;html&gt;&lt;body&gt;&lt;h1&gt;502 Bad Gateway&lt;/h1&gt;</span><br><span class="line">The server returned an invalid or incomplete response.</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡ºç°ä¸Šè¿°æŠ¥é”™æ ‡è¯†nginxåªæ”¯æŒå››å±‚è®¿é—®</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.è®¾å®šhaproxyè®¿é—®4å±‚</span></span><br><span class="line"><span class="comment">## haproxy</span></span><br><span class="line">[root@Haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">listen webcluster</span><br><span class="line">    <span class="built_in">bind</span>    *:80</span><br><span class="line">    mode    tcp<span class="comment"># å¼€å¯å››å±‚è®¿é—®</span></span><br><span class="line">    balance roundrobin</span><br><span class="line">    server  haha 192.168.0.10:80 send-proxy check inter 3s fall 3 rise 5 weight 1</span><br><span class="line">    server  hehe 192.168.0.20:80 send-proxy check inter 3s fall 3 rise 5 weight 1</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">[root@Haproxy ~]# systemctl restart haproxy.service</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.è®¾ç½®4å±‚ipé€ä¼ </span></span><br><span class="line"><span class="comment"># Webserver1 and 2</span></span><br><span class="line">[root@Webserver1 ~]# vim /etc/nginx/nginx.conf</span><br><span class="line">    log_format  main  <span class="string">&#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span></span><br><span class="line">                      <span class="string">&#x27; &quot;$proxy_protocol_addr&quot; &#x27;</span>        <span class="comment">#é‡‡é›†é€ä¼ ä¿¡æ¯</span></span><br><span class="line">                      <span class="string">&#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span></span><br><span class="line">                      <span class="string">&#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@Webserver1 ~]# systemctl restart nginx.service</span><br></pre></td></tr></table></figure><h4 id="1-2-3-æµ‹è¯•æ•ˆæœ"><a href="#1-2-3-æµ‹è¯•æ•ˆæœ" class="headerlink" title="1.2.3.æµ‹è¯•æ•ˆæœ"></a>1.2.3.æµ‹è¯•æ•ˆæœ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># client</span></span><br><span class="line">[root@Client ~]# <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..5&#125;; <span class="keyword">do</span> curl 172.25.254.100; <span class="keyword">done</span></span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># webserver1 and 2</span></span><br><span class="line">[root@Webserver1 ~]# <span class="built_in">cat</span> /var/log/nginx/access.log</span><br><span class="line">192.168.0.100 - - [27/Jan/2026:16:33:22 +0800] <span class="string">&quot;GET / HTTP/1.1&quot;</span>  <span class="string">&quot;172.25.254.99&quot;</span> 200 26 <span class="string">&quot;-&quot;</span> <span class="string">&quot;curl/7.76.1&quot;</span> <span class="string">&quot;-&quot;</span></span><br><span class="line">192.168.0.100 - - [27/Jan/2026:16:33:22 +0800] <span class="string">&quot;GET / HTTP/1.1&quot;</span>  <span class="string">&quot;172.25.254.99&quot;</span> 200 26 <span class="string">&quot;-&quot;</span> <span class="string">&quot;curl/7.76.1&quot;</span> <span class="string">&quot;-&quot;</span></span><br><span class="line">192.168.0.100 - - [27/Jan/2026:16:33:22 +0800] <span class="string">&quot;GET / HTTP/1.1&quot;</span>  <span class="string">&quot;172.25.254.99&quot;</span> 200 26 <span class="string">&quot;-&quot;</span> <span class="string">&quot;curl/7.76.1&quot;</span> <span class="string">&quot;-&quot;</span></span><br></pre></td></tr></table></figure><h2 id="2-å››å±‚è´Ÿè½½"><a href="#2-å››å±‚è´Ÿè½½" class="headerlink" title="2.å››å±‚è´Ÿè½½"></a>2.å››å±‚è´Ÿè½½</h2><h3 id="2-1-ç¯å¢ƒæ­å»º"><a href="#2-1-ç¯å¢ƒæ­å»º" class="headerlink" title="2.1.ç¯å¢ƒæ­å»º"></a>2.1.ç¯å¢ƒæ­å»º</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># éƒ¨ç½²mariadbæ•°æ®åº“</span></span><br><span class="line"><span class="comment"># webserver1 and 2</span></span><br><span class="line">[root@Webserver1 ~]# dnf install mariadb-server mariadb  -y --disablerepo=docker,epel</span><br><span class="line">[root@Webserver1 ~]# vim /etc/my.cnf.d/mariadb-server.cnf</span><br><span class="line">[mysqld]</span><br><span class="line">server_id=10<span class="comment"># webserver2ä¸­20</span></span><br><span class="line">datadir=/var/lib/mysql</span><br><span class="line">socket=/var/lib/mysql/mysql.sock</span><br><span class="line">log-error=/var/log/mariadb/mariadb.log</span><br><span class="line">pid-file=/run/mariadb/mariadb.pid</span><br><span class="line"></span><br><span class="line">[root@Webserver1 ~]# systemctl restart mariadb</span><br><span class="line"></span><br><span class="line"><span class="comment"># å»ºç«‹è¿œç¨‹ç™»å½•ç”¨æˆ·å¹¶æˆæƒ</span></span><br><span class="line">[root@Webserver1 ~]# mysql</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection <span class="built_in">id</span> is 5</span><br><span class="line">Server version: 10.5.27-MariaDB MariaDB Server</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; CREATE USER <span class="string">&#x27;hua&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified by <span class="string">&#x27;hua&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; GRANT ALL ON *.* TO <span class="string">&#x27;hua&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; quit</span><br><span class="line">Bye</span><br><span class="line"></span><br><span class="line">[root@Webserver1 ~]# systemctl restart mariadb</span><br><span class="line"></span><br><span class="line"><span class="comment"># haproxy</span></span><br><span class="line">[root@Haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">listen mariadbcluster</span><br><span class="line">    <span class="built_in">bind</span>    *:6663</span><br><span class="line">    mode    tcp</span><br><span class="line">    balance roundrobin</span><br><span class="line">    server  haha 192.168.0.10:3306 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line">    server  hehe 192.168.0.20:3306 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line"></span><br><span class="line">[root@Haproxy ~]# systemctl restart haproxy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@Haproxy ~]# netstat -antlupe | grep haproxy</span><br><span class="line">tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      0          49468      2525/haproxy</span><br><span class="line">tcp        0      0 0.0.0.0:6663            0.0.0.0:*               LISTEN      0          49469      2525/haproxy</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-2-ç¯å¢ƒæµ‹è¯•"><a href="#2-2-ç¯å¢ƒæµ‹è¯•" class="headerlink" title="2.2.ç¯å¢ƒæµ‹è¯•"></a>2.2.ç¯å¢ƒæµ‹è¯•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># client</span></span><br><span class="line">[root@Client ~]# mysql -uhua -phua -h172.25.254.100 -P 6663</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection <span class="built_in">id</span> is 6</span><br><span class="line">Server version: 10.5.27-MariaDB MariaDB Server</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; SELECT @@server_id;</span><br><span class="line">+-------------+</span><br><span class="line">| @@server_id |</span><br><span class="line">+-------------+</span><br><span class="line">|          20 |</span><br><span class="line">+-------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; quit</span><br><span class="line">Bye</span><br><span class="line">[root@Client ~]# mysql -uhua -phua -h172.25.254.100 -P 6663</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection <span class="built_in">id</span> is 6</span><br><span class="line">Server version: 10.5.27-MariaDB MariaDB Server</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; SELECT @@server_id;</span><br><span class="line">+-------------+</span><br><span class="line">| @@server_id |</span><br><span class="line">+-------------+</span><br><span class="line">|          10 |</span><br><span class="line">+-------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; quit</span><br><span class="line">Bye</span><br></pre></td></tr></table></figure><h2 id="3-è‡ªå®šä¹‰HAProxy-é”™è¯¯ç•Œé¢"><a href="#3-è‡ªå®šä¹‰HAProxy-é”™è¯¯ç•Œé¢" class="headerlink" title="3.è‡ªå®šä¹‰HAProxy é”™è¯¯ç•Œé¢"></a>3.è‡ªå®šä¹‰HAProxy é”™è¯¯ç•Œé¢</h2><h3 id="3-1-sorryserverçš„è®¾å®š"><a href="#3-1-sorryserverçš„è®¾å®š" class="headerlink" title="3.1.sorryserverçš„è®¾å®š"></a>3.1.sorryserverçš„è®¾å®š</h3><blockquote><p>æ­£å¸¸çš„æ‰€æœ‰æœåŠ¡å™¨å¦‚æœå‡ºç°å®•æœºï¼Œé‚£ä¹ˆå®¢æˆ·å°†è¢«å®šå‘åˆ°æŒ‡å®šçš„ä¸»æœºä¸­ï¼Œè¿™ä¸ªå½“ä¸šåŠ¡ä¸»æœºå‡ºé—®é¢˜æ—¶è¢«ä¸´æ—¶è®¿é—®çš„ä¸»æœºå«åš sorryserver</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨æ–°ä¸»æœºä¸­å®‰è£…apacheï¼ˆå¯ä»¥ç”¨haproxyä¸»æœºä»£æ›¿ï¼‰</span></span><br><span class="line"><span class="comment"># client</span></span><br><span class="line">[root@Client ~]# dnf install httpd -y</span><br><span class="line">[root@Client ~]# vim /etc/httpd/conf/httpd.conf</span><br><span class="line">47 Listen 8080</span><br><span class="line">[root@Client ~]# systemctl <span class="built_in">enable</span> --now httpd</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/httpd.service â†’ /usr/lib/systemd/system/httpd.service.</span><br><span class="line"></span><br><span class="line">[root@Client ~]# <span class="built_in">echo</span> <span class="string">&quot;å“ˆå“ˆå“ˆ&quot;</span> &gt; /var/www/html/index.html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®sorryserverä¸Šçº¿</span></span><br><span class="line">[root@Haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">    <span class="built_in">bind</span>    *:80</span><br><span class="line">    mode    tcp</span><br><span class="line">    balance roundrobin</span><br><span class="line">    server  haha 192.168.0.10:80 send-proxy check inter 3s fall 3 rise 5 weight 1</span><br><span class="line">    server  hehe 192.168.0.20:80 send-proxy check inter 3s fall 3 rise 5 weight 1</span><br><span class="line">    server  wuwu 172.25.254.99:8080  backup <span class="comment">#sorryserver</span></span><br><span class="line">    </span><br><span class="line">[root@Haproxy ~]# systemctl restart haproxy</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•</span></span><br><span class="line"><span class="comment"># client</span></span><br><span class="line">[root@Client ~]# curl 172.25.254.100</span><br><span class="line">webserver1 - 192.168.0.10</span><br><span class="line">[root@Client ~]# curl 172.25.254.100</span><br><span class="line">webserver2 - 192.168.0.20</span><br><span class="line"></span><br><span class="line"><span class="comment">#å…³é—­ä¸¤å°æ­£å¸¸çš„ä¸šåŠ¡ä¸»æœº</span></span><br><span class="line"><span class="comment"># webserver1 and 2</span></span><br><span class="line">[root@Webserver1 ~]# systemctl stop httpd</span><br><span class="line">[root@Webserver2 ~]# systemctl stop httpd</span><br><span class="line"></span><br><span class="line"><span class="comment"># client</span></span><br><span class="line">[root@Client ~]# curl 172.25.254.100</span><br><span class="line">å“ˆå“ˆå“ˆ</span><br></pre></td></tr></table></figure><h3 id="3-2-è‡ªå®šä¹‰é”™è¯¯é¡µé¢"><a href="#3-2-è‡ªå®šä¹‰é”™è¯¯é¡µé¢" class="headerlink" title="3.2.è‡ªå®šä¹‰é”™è¯¯é¡µé¢"></a>3.2.è‡ªå®šä¹‰é”™è¯¯é¡µé¢</h3><p>å½“æ‰€æœ‰ä¸»æœºåŒ…æ‹¬sorryserveréƒ½å®•æœºäº†ï¼Œé‚£ä¹ˆhaproxyä¼šæä¾›ä¸€ä¸ªé»˜è®¤è®¿é—®çš„é”™è¯¯é¡µé¢ï¼Œè¿™ä¸ªé”™è¯¯é¡µé¢è·ŸæŠ¥é”™ä»£ç æœ‰å…³ï¼Œè¿™ä¸ªé¡µé¢å¯ä»¥é€šè¿‡å®šä¹‰æ¥æœºå‹è®¾ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‡ºç°çš„é”™è¯¯é¡µé¢</span></span><br><span class="line">[root@Webserver1 ~]# systemctl stop httpd</span><br><span class="line">[root@Webserver2 ~]# systemctl stop httpd</span><br><span class="line">[root@Client ~]# systemctl stop httpd</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰€æœ‰åç«¯webæœåŠ¡éƒ½å®•æœº</span></span><br><span class="line">[Administrator.DESKTOP-VJ307M3] â¤ curl 172.25.254.100</span><br><span class="line">&lt;html&gt;&lt;body&gt;&lt;h1&gt;503 Service Unavailable&lt;/h1&gt;</span><br><span class="line">No server is available to handle this request.</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@haproxy ~]# <span class="built_in">mkdir</span> /errorpage/html/ -p</span><br><span class="line">[root@haproxy ~]# vim /errorpage/html/503.http</span><br><span class="line">HTTP/1.0 503 Service Unavailable</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html;charset=UTF-8</span><br><span class="line"></span><br><span class="line">&lt;html&gt;&lt;body&gt;&lt;h1&gt;ä»€ä¹ˆåŠ¨ç‰©ç”Ÿæ°”æœ€å®‰é™&lt;/h1&gt;</span><br><span class="line">å¤§çŒ©çŒ©ï¼ï¼</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br><span class="line">[root@haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">defaults</span><br><span class="line">    mode                    http</span><br><span class="line">    <span class="built_in">log</span>                     global</span><br><span class="line">    option                  httplog</span><br><span class="line">    option                  dontlognull</span><br><span class="line">    option http-server-close</span><br><span class="line">    option forwardfor       except 127.0.0.0/8</span><br><span class="line">    option                  redispatch</span><br><span class="line">    retries                 3</span><br><span class="line">    <span class="built_in">timeout</span> http-request    10s</span><br><span class="line">    <span class="built_in">timeout</span> queue           1m</span><br><span class="line">    <span class="built_in">timeout</span> connect         10s</span><br><span class="line">    <span class="built_in">timeout</span> client          1m</span><br><span class="line">    <span class="built_in">timeout</span> server          1m</span><br><span class="line">    <span class="built_in">timeout</span> http-keep-alive 10s</span><br><span class="line">    <span class="built_in">timeout</span> check           10s</span><br><span class="line">    maxconn                 3000</span><br><span class="line">    errorfile 503           /errorpage/html/503.http<span class="comment">#error é¡µé¢</span></span><br><span class="line">    </span><br><span class="line">listen webcluster</span><br><span class="line">    <span class="built_in">bind</span>    *:80</span><br><span class="line">    mode    http</span><br><span class="line">    balance roundrobin</span><br><span class="line">    server  haha 192.168.0.10:80 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line">    server  hehe 192.168.0.20:80 check inter 3s fall 3 rise 5 weight 1</span><br><span class="line">    server  wuwu 172.25.254.99:8080  backup</span><br><span class="line"></span><br><span class="line">[root@haproxy ~]# systemctl restart haproxy.service</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@Client ~]# curl 172.25.254.100</span><br><span class="line">&lt;html&gt;&lt;body&gt;&lt;h1&gt;ä»€ä¹ˆåŠ¨ç‰©ç”Ÿæ°”æœ€å®‰é™&lt;/h1&gt;</span><br><span class="line">å¤§çŒ©çŒ©ï¼ï¼</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure><h3 id="3-3-é‡å®šå‘é”™è¯¯åˆ°æŒ‡å®šç½‘ç«™"><a href="#3-3-é‡å®šå‘é”™è¯¯åˆ°æŒ‡å®šç½‘ç«™" class="headerlink" title="3.3.é‡å®šå‘é”™è¯¯åˆ°æŒ‡å®šç½‘ç«™"></a>3.3.é‡å®šå‘é”™è¯¯åˆ°æŒ‡å®šç½‘ç«™</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">defaults</span><br><span class="line">    mode                    http</span><br><span class="line">    <span class="built_in">log</span>                     global</span><br><span class="line">    option                  httplog</span><br><span class="line">    option                  dontlognull</span><br><span class="line">    option http-server-close</span><br><span class="line">    option forwardfor       except 127.0.0.0/8</span><br><span class="line">    option                  redispatch</span><br><span class="line">    retries                 3</span><br><span class="line">    <span class="built_in">timeout</span> http-request    10s</span><br><span class="line">    <span class="built_in">timeout</span> queue           1m</span><br><span class="line">    <span class="built_in">timeout</span> connect         10s</span><br><span class="line">    <span class="built_in">timeout</span> client          1m</span><br><span class="line">    <span class="built_in">timeout</span> server          1m</span><br><span class="line">    <span class="built_in">timeout</span> http-keep-alive 10s</span><br><span class="line">    <span class="built_in">timeout</span> check           10s</span><br><span class="line">    maxconn                 3000</span><br><span class="line">    errorloc 503            http://www.baidu.com<span class="comment">#error é¡µé¢</span></span><br><span class="line">[root@haproxy ~]# systemctl restart haproxy.service</span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨æµè§ˆå™¨ä¸­è®¿é—®</span></span><br></pre></td></tr></table></figure><p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-27_22-52-16.gif" alt="PixPin_2026-01-27_22-52-16"></p><h2 id="4-Haproxy-ACLè®¿é—®æ§åˆ¶"><a href="#4-Haproxy-ACLè®¿é—®æ§åˆ¶" class="headerlink" title="4.Haproxy ACLè®¿é—®æ§åˆ¶"></a>4.Haproxy ACLè®¿é—®æ§åˆ¶</h2><h3 id="4-1-å®éªŒç´ æ"><a href="#4-1-å®éªŒç´ æ" class="headerlink" title="4.1.å®éªŒç´ æ"></a>4.1.å®éªŒç´ æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨æµè§ˆå™¨æˆ–è€…curlä¸»æœºä¸­è®¾å®šæœ¬åœ°è§£æ</span></span><br><span class="line">ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€ C:\Windows\System32\drivers\etc\hosts</span><br><span class="line">172.25.254.100  www.kaitumei.com     bbs.kaitumei.com    news.kaitumei.com   login.kaitumei.com</span><br><span class="line"><span class="comment"># #åœ¨Linuxä¸­è®¾å®šè§£æ</span></span><br><span class="line">vim /etc/hosts</span><br><span class="line">172.25.254.100  www.kaitumei.com     bbs.kaitumei.com    news.kaitumei.com   login.kaitumei.com</span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">ping  bbs.timinglee.org</span><br></pre></td></tr></table></figure><h3 id="4-2-è®¾å®šåŸºç¡€çš„haproxyå®éªŒé…ç½®"><a href="#4-2-è®¾å®šåŸºç¡€çš„haproxyå®éªŒé…ç½®" class="headerlink" title="4.2.è®¾å®šåŸºç¡€çš„haproxyå®éªŒé…ç½®"></a>4.2.è®¾å®šåŸºç¡€çš„haproxyå®éªŒé…ç½®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@Haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">frontend webcluster</span><br><span class="line">    <span class="built_in">bind</span>            *:80</span><br><span class="line">    mode            http</span><br><span class="line">    use_backend     webserver-80-web1</span><br><span class="line"></span><br><span class="line">backend webserver-80-web1</span><br><span class="line">    server web1 192.168.0.10:80 check inter 3s fall 3 rise 5</span><br><span class="line"></span><br><span class="line">backend webserver-80-web2</span><br><span class="line">    server web2 192.168.0.20:80 check inter 3s fall 3 rise 5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@Haproxy ~]# systemctl restart haproxy</span><br></pre></td></tr></table></figure><h3 id="4-3-åŸºç¡€aclç¤ºä¾‹"><a href="#4-3-åŸºç¡€aclç¤ºä¾‹" class="headerlink" title="4.3.åŸºç¡€aclç¤ºä¾‹"></a>4.3.åŸºç¡€aclç¤ºä¾‹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨è®¿é—®çš„ç½‘å€ä¸­ï¼Œæ‰€æœ‰ä»¥.com  ç»“å°¾çš„è®¿é—®10ï¼Œå…¶ä»–è®¿é—®20</span></span><br><span class="line">[root@Haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">frontend webcluster</span><br><span class="line">    <span class="built_in">bind</span>            *:80</span><br><span class="line">    mode            http</span><br><span class="line">    </span><br><span class="line">    acl <span class="built_in">test</span> hdr_end(host) -i .com<span class="comment">#aclåˆ—è¡¨</span></span><br><span class="line">    </span><br><span class="line">    use_backend  webserver-80-web1 <span class="keyword">if</span> <span class="built_in">test</span><span class="comment">#aclåˆ—è¡¨è®¿é—®åŒ¹é…</span></span><br><span class="line">    default_backend webserver-80-web2<span class="comment">#aclåˆ—è¡¨è®¿é—®ä¸åŒ¹é…</span></span><br><span class="line"></span><br><span class="line">backend webserver-80-web1</span><br><span class="line">    server web1 192.168.0.10:80 check inter 3s fall 3 rise 5</span><br><span class="line"></span><br><span class="line">backend webserver-80-web2</span><br><span class="line">    server web2 192.168.0.20:80 check inter 3s fall 3 rise 5</span><br><span class="line"></span><br><span class="line">[root@Haproxy ~]# systemctl restart haproxy</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@Client ~]# curl  www.kaitumei.com</span><br><span class="line">webserver1 --- 192.168.0.10</span><br><span class="line">[root@Client ~]# curl  www.kaitumei.org</span><br><span class="line">webserver2 --- 192.168.0.20</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#åŸºäºè®¿é—®å¤´éƒ¨</span></span><br><span class="line">[root@Haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">frontend webcluster</span><br><span class="line">    <span class="built_in">bind</span>            *:80</span><br><span class="line">    mode            http</span><br><span class="line">    acl <span class="built_in">test</span> hdr_end(host) -i .com          <span class="comment">#aclåˆ—è¡¨</span></span><br><span class="line">    acl <span class="built_in">head</span> hdr_beg(host) -i bbs.</span><br><span class="line"></span><br><span class="line">    use_backend  webserver-80-web1 <span class="keyword">if</span> <span class="built_in">head</span>  <span class="comment">#aclåˆ—è¡¨è®¿é—®åŒ¹é…</span></span><br><span class="line">    default_backend webserver-80-web2       <span class="comment">#aclåˆ—è¡¨è®¿é—®ä¸åŒ¹é…</span></span><br><span class="line"></span><br><span class="line">backend webserver-80-web1</span><br><span class="line">    server web1 192.168.0.10:80 check inter 3s fall 3 rise 5</span><br><span class="line"></span><br><span class="line">backend webserver-80-web2</span><br><span class="line">    server web2 192.168.0.20:80 check inter 3s fall 3 rise 5</span><br><span class="line"></span><br><span class="line">[root@Haproxy ~]# systemctl restart haproxy</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•æ•ˆæœ</span></span><br><span class="line">[root@Client ~]# curl  bbs.kaitumei.com</span><br><span class="line">webserver1 --- 192.168.0.10</span><br><span class="line">[root@Client ~]# curl  www.kaitumei.com</span><br><span class="line">webserver2 --- 192.168.0.20</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#baseå‚æ•°acl</span></span><br><span class="line">[root@Haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">frontend webcluster</span><br><span class="line">    <span class="built_in">bind</span>            *:80</span><br><span class="line">    mode            http</span><br><span class="line">    </span><br><span class="line">    acl pathdir base_dir -i /yeming</span><br><span class="line">    use_backend  webserver-80-web1 <span class="keyword">if</span> pathdir</span><br><span class="line">    default_backend webserver-80-web2<span class="comment">#aclåˆ—è¡¨è®¿é—®ä¸åŒ¹é…</span></span><br><span class="line"></span><br><span class="line">backend webserver-80-web1</span><br><span class="line">    server web1 192.168.0.10:80 check inter 3s fall 3 rise 5</span><br><span class="line"></span><br><span class="line">backend webserver-80-web2</span><br><span class="line">    server web2 192.168.0.20:80 check inter 3s fall 3 rise 5</span><br><span class="line">[root@Haproxy ~]# systemctl restart haproxy</span><br><span class="line"></span><br><span class="line">[root@Webserver1+2 ~]# <span class="built_in">mkdir</span> -p /var/www/html/yeming/</span><br><span class="line">[root@Webserver1+2 ~]# <span class="built_in">mkdir</span> -p /var/www/html/yeming/test/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@Webserver1 ~]# <span class="built_in">echo</span> yeming - 192.168.0.10  &gt; /var/www/html/yeming/index.html</span><br><span class="line">[root@Webserver1 ~]# <span class="built_in">echo</span> yeming/test - 192.168.0.10 &gt; /var/www/html/yeming/test/index.html</span><br><span class="line">[root@Webserver2 ~]# <span class="built_in">echo</span> yeming - 192.168.0.20  &gt; /var/www/html/yeming/index.html</span><br><span class="line">[root@Webserver2 ~]# <span class="built_in">echo</span> yeming/test - 192.168.0.20 &gt; /var/www/html/yeming/test/index.html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@Client ~]# curl 172.25.254.100/yeming/</span><br><span class="line">yeming - 192.168.0.10</span><br><span class="line">[root@Client ~]# curl 172.25.254.100/yeming/test/</span><br><span class="line">yeming/test - 192.168.0.10</span><br><span class="line">[root@Client ~]# curl 172.25.254.100/index.html</span><br><span class="line">webserver2 --- 192.168.0.20</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#aclç¦æ­¢åˆ—è¡¨é»‘åå•</span></span><br><span class="line">[root@haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">frontend webcluster</span><br><span class="line">    <span class="built_in">bind</span>            *:80</span><br><span class="line">    mode            http</span><br><span class="line">    </span><br><span class="line">    acl <span class="built_in">test</span> hdr_end(host) -i .com<span class="comment">#aclåˆ—è¡¨</span></span><br><span class="line">    </span><br><span class="line">    use_backend  webserver-80-web1 <span class="keyword">if</span> <span class="built_in">test</span><span class="comment">#aclåˆ—è¡¨è®¿é—®åŒ¹é…</span></span><br><span class="line">    default_backend webserver-80-web2<span class="comment">#aclåˆ—è¡¨è®¿é—®ä¸åŒ¹é…</span></span><br><span class="line"></span><br><span class="line">acl invalid_src src 172.25.254.99</span><br><span class="line">    http-request deny <span class="keyword">if</span> invalid_src</span><br><span class="line"></span><br><span class="line">backend webserver-80-web1</span><br><span class="line">    server web1 192.168.0.10:80 check inter 3s fall 3 rise 5</span><br><span class="line"></span><br><span class="line">backend webserver-80-web2</span><br><span class="line">    server web2 192.168.0.20:80 check inter 3s fall 3 rise 5</span><br><span class="line"></span><br><span class="line">[root@Haproxy ~]# systemctl restart haproxy</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•ï¼š</span></span><br><span class="line">[root@Client ~]# curl 172.25.254.100</span><br><span class="line">&lt;html&gt;&lt;body&gt;&lt;h1&gt;403 Forbidden&lt;/h1&gt;</span><br><span class="line">Request forbidden by administrative rules.</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¦æ­¢åˆ—è¡¨ç™½åå•</span></span><br><span class="line">[root@haproxy ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">frontend webcluster</span><br><span class="line">    <span class="built_in">bind</span>            *:80</span><br><span class="line">    mode            http</span><br><span class="line">    acl <span class="built_in">test</span> hdr_end(host) -i .com          <span class="comment">#aclåˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line">    use_backend  webserver-80-web1 <span class="keyword">if</span> <span class="built_in">test</span>  <span class="comment">#aclåˆ—è¡¨è®¿é—®åŒ¹é…</span></span><br><span class="line">    default_backend webserver-80-web2       <span class="comment">#aclåˆ—è¡¨è®¿é—®ä¸åŒ¹é…</span></span><br><span class="line"></span><br><span class="line">    acl invalid_src src 172.25.254.99</span><br><span class="line">    http-request deny <span class="keyword">if</span> ! invalid_src</span><br><span class="line"></span><br><span class="line">backend webserver-80-web1</span><br><span class="line">    server web1 192.168.0.10:80 check inter 3s fall 3 rise 5</span><br><span class="line"></span><br><span class="line">backend webserver-80-web2</span><br><span class="line">    server web2 192.168.0.20:80 check inter 3s fall 3 rise 5</span><br><span class="line">    </span><br><span class="line"><span class="comment">#æµ‹è¯•ï¼š</span></span><br><span class="line">[root@Client ~]# curl 172.25.254.100</span><br><span class="line">webserver2 --- 192.168.0.20</span><br><span class="line"></span><br><span class="line">[root@Haproxy ~]# curl  172.25.254.100</span><br><span class="line">&lt;html&gt;&lt;body&gt;&lt;h1&gt;403 Forbidden&lt;/h1&gt;</span><br><span class="line">Request forbidden by administrative rules.</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>Haproxyå…¨ç«™åŠ å¯†</p><p>1.åˆ¶ä½œè¯ä¹¦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@Haproxy ~]# <span class="built_in">mkdir</span> /etc/haproxy/certs/</span><br><span class="line">[[root@Haproxy ~]# openssl req -newkey rsa:2048 -nodes -sha256  -keyout /etc/haproxy/certs/yeming.key -x509 -days 365 -out /etc/haproxy/certs/yeming.crt</span><br><span class="line">.+...+.+++++++++++++++++++++++++++++++++++++++*.+.+.....+++++++++++++++++++++++++++++++++++++++*.......+...+......+.+..............+.......+.....+...+....+...+.....+....+...+........+.............+.....+......+...............+.+.....+.........+..........+...+..++++++</span><br><span class="line">...+++++++++++++++++++++++++++++++++++++++*.....+..+.........+.+........+......+++++++++++++++++++++++++++++++++++++++*...+.+.....+.......+......+.........+..+..................+.+.....+..........+.........+............+........+.+..+....+.....+.........+......+.+...............+...+.........+.....+.......+..................+.....+............+....+............+.....+.............+.........+..+...+.+..+..................+.+..............+....+...+..+......+.+........+...+.........+.+........+....+...+...+.....+......+.+..+...+.......+.....+.+.....++++++</span><br><span class="line">-----</span><br><span class="line">You are about to be asked to enter information that will be incorporated</span><br><span class="line">into your certificate request.</span><br><span class="line">What you are about to enter is what is called a Distinguished Name or a DN.</span><br><span class="line">There are quite a few fields but you can leave some blank</span><br><span class="line">For some fields there will be a default value,</span><br><span class="line">If you enter <span class="string">&#x27;.&#x27;</span>, the field will be left blank.</span><br><span class="line">-----</span><br><span class="line">Country Name (2 letter code) [XX]:CN</span><br><span class="line">State or Province Name (full name) []:Hunan</span><br><span class="line">Locality Name (eg, city) [Default City]:Hengyang</span><br><span class="line">Organization Name (eg, company) [Default Company Ltd]:hh</span><br><span class="line">Organizational Unit Name (eg, section) []:hh</span><br><span class="line">Common Name (eg, your name or your server<span class="string">&#x27;s hostname) []:www.kaitumei.com</span></span><br><span class="line"><span class="string">Email Address []:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[root@Haproxy ~]# ls /etc/haproxy/certs/</span></span><br><span class="line"><span class="string">yeming.crt  yeming.key</span></span><br><span class="line"><span class="string">[root@Haproxy ~]# cat /etc/haproxy/certs/yeming.&#123;key,crt&#125; &gt; /etc/haproxy/certs/yeming.pem</span></span><br></pre></td></tr></table></figure><p>2.å…¨ç«™åŠ å¯†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">[root@Haproxy ~]# vim /etc/haproxy/haproxy.cfg </span><br><span class="line">frontend webcluster-http</span><br><span class="line">    <span class="built_in">bind</span>        *:80</span><br><span class="line">    redirect scheme https <span class="keyword">if</span> ! &#123; ssl_fc &#125;</span><br><span class="line"></span><br><span class="line">listen webcluster-https</span><br><span class="line">    <span class="built_in">bind</span>        *:443 ssl  crt /etc/haproxy/certs/yeming.pem</span><br><span class="line">    mode        http</span><br><span class="line">    balance     roundrobin</span><br><span class="line">    server haha 192.168.0.10:80  check inter 3s fall 3 rise 5 weight 1</span><br><span class="line">    server hehe 192.168.0.20:80  check inter 3s fall 3 rise 5 weight 1</span><br><span class="line"></span><br><span class="line">[root@Haproxy ~]# systemctl restart haproxy</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•ï¼š</span></span><br><span class="line">[root@Client ~]# curl -v -k -L http://172.25.254.100</span><br><span class="line">*   Trying 172.25.254.100:80...</span><br><span class="line">* Connected to 172.25.254.100 (172.25.254.100) port 80 (#0)</span><br><span class="line">&gt; GET / HTTP/1.1</span><br><span class="line">&gt; Host: 172.25.254.100</span><br><span class="line">&gt; User-Agent: curl/7.76.1</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt;</span><br><span class="line">* Mark bundle as not supporting multiuse</span><br><span class="line">&lt; HTTP/1.1 302 Found</span><br><span class="line">&lt; content-length: 0</span><br><span class="line">&lt; location: https://172.25.254.100/</span><br><span class="line">&lt; cache-control: no-cache</span><br><span class="line">&lt;</span><br><span class="line">* Connection <span class="comment">#0 to host 172.25.254.100 left intact</span></span><br><span class="line">* Clear auth, redirects to port from 80 to 443Issue another request to this URL: <span class="string">&#x27;https://172.25.254.100/&#x27;</span></span><br><span class="line">*   Trying 172.25.254.100:443...</span><br><span class="line">* Connected to 172.25.254.100 (172.25.254.100) port 443 (#1)</span><br><span class="line">* ALPN, offering h2</span><br><span class="line">* ALPN, offering http/1.1</span><br><span class="line">*  CAfile: /etc/pki/tls/certs/ca-bundle.crt</span><br><span class="line">* TLSv1.0 (OUT), TLS header, Certificate Status (22):</span><br><span class="line">* TLSv1.3 (OUT), TLS handshake, Client hello (1):</span><br><span class="line">* TLSv1.2 (IN), TLS header, Certificate Status (22):</span><br><span class="line">* TLSv1.3 (IN), TLS handshake, Server hello (2):</span><br><span class="line">* TLSv1.2 (IN), TLS header, Finished (20):</span><br><span class="line">* TLSv1.2 (IN), TLS header, Unknown (23):</span><br><span class="line">* TLSv1.3 (IN), TLS handshake, Encrypted Extensions (8):</span><br><span class="line">* TLSv1.2 (IN), TLS header, Unknown (23):</span><br><span class="line">* TLSv1.3 (IN), TLS handshake, Certificate (11):</span><br><span class="line">* TLSv1.2 (IN), TLS header, Unknown (23):</span><br><span class="line">* TLSv1.3 (IN), TLS handshake, CERT verify (15):</span><br><span class="line">* TLSv1.2 (IN), TLS header, Unknown (23):</span><br><span class="line">* TLSv1.3 (IN), TLS handshake, Finished (20):</span><br><span class="line">* TLSv1.2 (OUT), TLS header, Finished (20):</span><br><span class="line">* TLSv1.3 (OUT), TLS change cipher, Change cipher spec (1):</span><br><span class="line">* TLSv1.2 (OUT), TLS header, Unknown (23):</span><br><span class="line">* TLSv1.3 (OUT), TLS handshake, Finished (20):</span><br><span class="line">* SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA384</span><br><span class="line">* ALPN, server did not agree to a protocol</span><br><span class="line">* Server certificate:</span><br><span class="line">*  subject: C=CN; ST=Hunan; L=Hengyang; O=hh; OU=hh; CN=www.kaitumei.com</span><br><span class="line">*  start <span class="built_in">date</span>: Jan 27 17:03:35 2026 GMT</span><br><span class="line">*  expire <span class="built_in">date</span>: Jan 27 17:03:35 2027 GMT</span><br><span class="line">*  issuer: C=CN; ST=Hunan; L=Hengyang; O=hh; OU=hh; CN=www.kaitumei.com</span><br><span class="line">*  SSL certificate verify result: self-signed certificate (18), continuing anyway.</span><br><span class="line">* TLSv1.2 (OUT), TLS header, Unknown (23):</span><br><span class="line">&gt; GET / HTTP/1.1</span><br><span class="line">&gt; Host: 172.25.254.100</span><br><span class="line">&gt; User-Agent: curl/7.76.1</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt;</span><br><span class="line">* TLSv1.2 (IN), TLS header, Unknown (23):</span><br><span class="line">* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):</span><br><span class="line">* TLSv1.2 (IN), TLS header, Unknown (23):</span><br><span class="line">* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):</span><br><span class="line">* old SSL session ID is stale, removing</span><br><span class="line">* TLSv1.2 (IN), TLS header, Unknown (23):</span><br><span class="line">* Mark bundle as not supporting multiuse</span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; <span class="built_in">date</span>: Tue, 27 Jan 2026 17:09:23 GMT</span><br><span class="line">&lt; server: Apache/2.4.62 (Red Hat Enterprise Linux)</span><br><span class="line">&lt; last-modified: Tue, 27 Jan 2026 07:43:15 GMT</span><br><span class="line">&lt; etag: <span class="string">&quot;1c-64959c6bf22d5&quot;</span></span><br><span class="line">&lt; accept-ranges: bytes</span><br><span class="line">&lt; content-length: 28</span><br><span class="line">&lt; content-type: text/html; charset=UTF-8</span><br><span class="line">&lt;</span><br><span class="line">webserver1 --- 192.168.0.10</span><br><span class="line">* Connection <span class="comment">#1 to host 172.25.254.100 left intact</span></span><br></pre></td></tr></table></figure><h1 id="2026-1-28"><a href="#2026-1-28" class="headerlink" title="2026-1-28"></a>2026-1-28</h1><h2 id="1-Keepalivedå®éªŒç¯å¢ƒè®¾å®š"><a href="#1-Keepalivedå®éªŒç¯å¢ƒè®¾å®š" class="headerlink" title="1.Keepalivedå®éªŒç¯å¢ƒè®¾å®š"></a>1.Keepalivedå®éªŒç¯å¢ƒè®¾å®š</h2><h3 id="1-ç¯å¢ƒè®¾å®šå›¾"><a href="#1-ç¯å¢ƒè®¾å®šå›¾" class="headerlink" title="1.ç¯å¢ƒè®¾å®šå›¾"></a>1.ç¯å¢ƒè®¾å®šå›¾</h3><p> <img src="G:\å›¾ç‰‡\kastatus.png" alt="kastatus"></p><h3 id="2-ç¯å¢ƒè®¾å®š"><a href="#2-ç¯å¢ƒè®¾å®š" class="headerlink" title="2.ç¯å¢ƒè®¾å®š"></a>2.ç¯å¢ƒè®¾å®š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#éƒ¨ç½²rs1å’Œrh2ï¼ˆå•ç½‘å¡NATæ¨¡å¼ï¼‰</span></span><br><span class="line">[root@rs1 ~]# vmset.sh rs1 eth0 172.25.254.10 </span><br><span class="line">[root@rs1 ~]# dnf install httpd -y</span><br><span class="line">[root@rs1 ~]# <span class="built_in">echo</span> RS1 - 172.25.254.10 &gt; /var/www/html/index.html</span><br><span class="line">[root@rs1 ~]# systemctl <span class="built_in">enable</span> --now httpd</span><br><span class="line"></span><br><span class="line">[root@rs2 ~]# vmset.sh rs2 eth0 172.25.254.20 </span><br><span class="line">[root@rs2 ~]# dnf install httpd -y</span><br><span class="line">[root@rs2 ~]# <span class="built_in">echo</span> RS2 - 172.25.254.20 &gt; /var/www/html/index.html</span><br><span class="line">[root@rs2 ~]# systemctl <span class="built_in">enable</span> --now httpd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•ï¼š</span></span><br><span class="line">[Administrator.DESKTOP-VJ307M3] â¤ curl 172.25.254.10</span><br><span class="line">RS1 - 172.25.254.10</span><br><span class="line">                                                                                                    âœ”</span><br><span class="line">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br><span class="line">[2026-01-28 10:36.42]  ~</span><br><span class="line">[Administrator.DESKTOP-VJ307M3] â¤ curl 172.25.254.20</span><br><span class="line">RS2 - 172.25.254.20</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾å®ška1å’Œka2</span></span><br><span class="line">[root@KA1 ~]# vmset.sh KA1 eth0 172.25.254.50 </span><br><span class="line">[root@KA2 ~]# vmset.sh KA2 eth0 172.25.254.60 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾å®šæœ¬åœ°è§£æ</span></span><br><span class="line">[root@KA1 ~]# vim /etc/hosts</span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">172.25.254.50     KA1</span><br><span class="line">172.25.254.60     KA2</span><br><span class="line">172.25.254.10     rs1</span><br><span class="line">172.25.254.20     rs2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# <span class="keyword">for</span> i <span class="keyword">in</span> 60 10 20; <span class="keyword">do</span> scp /etc/hosts 172.25.254.<span class="variable">$i</span>:/etc/hosts; <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨æ‰€æœ‰ä¸»æœºä¸­æŸ¥çœ‹/etc/hosts</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨ka1ä¸­å¼€å¯æ—¶é—´åŒæ­¥æœåŠ¡</span></span><br><span class="line">[root@KA1 ~]# vim /etc/chrony.conf</span><br><span class="line"> 26 allow 0.0.0.0/0</span><br><span class="line"> 29 <span class="built_in">local</span> stratum 10</span><br><span class="line"> </span><br><span class="line">[root@KA1 ~]# systemctl restart chronyd</span><br><span class="line">[root@KA1 ~]# systemctl <span class="built_in">enable</span> --now chronyd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨ka2ä¸­ä½¿ç”¨ka1çš„æ—¶é—´åŒæ­¥æœåŠ¡</span></span><br><span class="line">[root@KA2 ~]# vim /etc/chrony.conf</span><br><span class="line">pool 172.25.254.50 iburst</span><br><span class="line"></span><br><span class="line">[root@KA2 ~]# systemctl restart chronyd</span><br><span class="line">[root@KA2 ~]# systemctl <span class="built_in">enable</span> --now chronyd</span><br><span class="line"></span><br><span class="line">[root@KA2 ~]# chronyc sources -v</span><br><span class="line"></span><br><span class="line">  .-- Source mode  <span class="string">&#x27;^&#x27;</span> = server, <span class="string">&#x27;=&#x27;</span> = peer, <span class="string">&#x27;#&#x27;</span> = <span class="built_in">local</span> clock.</span><br><span class="line"> / .- Source state <span class="string">&#x27;*&#x27;</span> = current best, <span class="string">&#x27;+&#x27;</span> = combined, <span class="string">&#x27;-&#x27;</span> = not combined,</span><br><span class="line">| /             <span class="string">&#x27;x&#x27;</span> = may be <span class="keyword">in</span> error, <span class="string">&#x27;~&#x27;</span> = too variable, <span class="string">&#x27;?&#x27;</span> = unusable.</span><br><span class="line">||                                                 .- xxxx [ yyyy ] +/- zzzz</span><br><span class="line">||      Reachability register (octal) -.           |  xxxx = adjusted offset,</span><br><span class="line">||      Log2(Polling interval) --.      |          |  yyyy = measured offset,</span><br><span class="line">||                                \     |          |  zzzz = estimated error.</span><br><span class="line">||                                 |    |           \</span><br><span class="line">MS Name/IP address         Stratum Poll Reach LastRx Last sample</span><br><span class="line">===============================================================================</span><br><span class="line">^* KA1                           3   6    17    13   +303ns[+6125ns] +/-   69ms </span><br></pre></td></tr></table></figure><h2 id="2-Keepalivedæ—¥å¿—åˆ†ç¦»"><a href="#2-Keepalivedæ—¥å¿—åˆ†ç¦»" class="headerlink" title="2.Keepalivedæ—¥å¿—åˆ†ç¦»"></a>2.Keepalivedæ—¥å¿—åˆ†ç¦»</h2><p>é»˜è®¤æƒ…å†µä¸‹ã€‚keepalivedçš„æ—¥å¿—ä¼šè¢«ä¿å­˜åœ¨&#x2F;var&#x2F;log&#x2F;messagesæ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸­é™¤äº†å«æœ‰keepalivedçš„æ—¥å¿—å¤–ï¼Œè¿˜æœ‰å…¶ä»–æœåŠ¡çš„æ—¥å¿—ä¿¡æ¯ï¼Œè¿™æ ·ä¸åˆ©äºå¯¹äºkeepalivedçš„æ—¥å¿—è¿›è¡ŒæŸ¥çœ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@KA1 ~]# vim /etc/sysconfig/keepalived</span><br><span class="line">KEEPALIVED_OPTIONS=<span class="string">&quot;-D -S 6&quot;</span></span><br><span class="line">[root@KA1 ~]# systemctl restart keepalived.service</span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# vim /etc/rsyslog.conf</span><br><span class="line">local6.*                                                /var/log/keepalived.log</span><br><span class="line">[root@KA1 ~]# systemctl restart rsyslog.service</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@KA1 ~]# <span class="built_in">ls</span> -l /var/log/keepalived.log</span><br><span class="line"><span class="built_in">ls</span>: æ— æ³•è®¿é—® <span class="string">&#x27;keepalived.log&#x27;</span>: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•</span><br><span class="line">[root@KA1 ~]# systemctl restart keepalived.service</span><br><span class="line">[root@KA1 ~]#  <span class="built_in">ls</span> -l /var/log/keepalived.log</span><br><span class="line">-rw------- 1 root root 3294  1æœˆ 28 15:09 /var/log/keepalived.log</span><br></pre></td></tr></table></figure><h2 id="3-Keepalivedçš„å­é…ç½®æ–‡ä»¶è®¾å®š"><a href="#3-Keepalivedçš„å­é…ç½®æ–‡ä»¶è®¾å®š" class="headerlink" title="3.Keepalivedçš„å­é…ç½®æ–‡ä»¶è®¾å®š"></a>3.Keepalivedçš„å­é…ç½®æ–‡ä»¶è®¾å®š</h2><p>åœ¨ä¸»é…ç½®æ–‡ä»¶ä¸­å¦‚æœå†™å…¥è¿‡å¤šçš„é…ç½®ä¸åˆ©äºå¯¹äºä¸»é…ç½®æ–‡ä»¶çš„é˜…è¯»</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">[root@KA1 ~]# vim /etc/keepalived/keepalived.conf</span><br><span class="line">! Configuration File <span class="keyword">for</span> keepalived</span><br><span class="line"></span><br><span class="line">global_defs &#123;</span><br><span class="line">   notification_email &#123;</span><br><span class="line">     timinglee_zln@163.com</span><br><span class="line">   &#125;</span><br><span class="line">   notification_email_from timinglee_zln@163.com</span><br><span class="line">   smtp_server 127.0.0.1</span><br><span class="line">   smtp_connect_timeout 30</span><br><span class="line">   router_id KA1</span><br><span class="line">   vrrp_skip_check_adv_addr</span><br><span class="line">   <span class="comment">#vrrp_strict</span></span><br><span class="line">   vrrp_garp_interval 1</span><br><span class="line">   vrrp_gna_interval 1</span><br><span class="line">   vrrp_mcast_group4 224.0.0.44</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">include /etc/keepalived/conf.d/*.conf<span class="comment">#æŒ‡å®šç‹¬ç«‹å­é…ç½®æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# <span class="built_in">mkdir</span>  /etc/keepalived/conf.d -p</span><br><span class="line">[root@KA1 ~]# vim /etc/keepalived/conf.d/webvip.conf</span><br><span class="line">vrrp_instance WEB_VIP &#123;</span><br><span class="line">    state MASTER</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    priority 100</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        172.25.254.100/24 dev eth0 label eth0:0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# keepalived -t -f /etc/keepalived/keepalived.conf</span><br><span class="line">[root@KA1 ~]# systemctl restart keepalived.service</span><br><span class="line">[root@KA1 ~]# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.50  netmask 255.255.255.0  broadcast 172.25.254.255</span><br><span class="line">        inet6 fe80::3901:aeea:786a:7227  prefixlen 64  scopeid 0x20&lt;<span class="built_in">link</span>&gt;</span><br><span class="line">        ether 00:0c:29:26:33:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 17383  bytes 1417554 (1.3 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 32593  bytes 3135052 (2.9 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">eth0:0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.100  netmask 255.255.255.0  broadcast 0.0.0.0</span><br><span class="line">        ether 00:0c:29:26:33:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 118  bytes 6828 (6.6 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 118  bytes 6828 (6.6 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="4-æŠ¢å æ¨¡å¼"><a href="#4-æŠ¢å æ¨¡å¼" class="headerlink" title="4.æŠ¢å æ¨¡å¼"></a>4.æŠ¢å æ¨¡å¼</h2><h3 id="4-1-æŠ¢å æ¨¡å¼-é»˜è®¤çš„ï¼Œè°ä¼˜å…ˆçº§é«˜å°±æŠŠvipæ”¾åˆ°å“ªé‡Œ"><a href="#4-1-æŠ¢å æ¨¡å¼-é»˜è®¤çš„ï¼Œè°ä¼˜å…ˆçº§é«˜å°±æŠŠvipæ”¾åˆ°å“ªé‡Œ" class="headerlink" title="4.1.æŠ¢å æ¨¡å¼( é»˜è®¤çš„ï¼Œè°ä¼˜å…ˆçº§é«˜å°±æŠŠvipæ”¾åˆ°å“ªé‡Œ)"></a>4.1.æŠ¢å æ¨¡å¼( é»˜è®¤çš„ï¼Œè°ä¼˜å…ˆçº§é«˜å°±æŠŠvipæ”¾åˆ°å“ªé‡Œ)</h3><h3 id="4-2-éæŠ¢å æ¨¡å¼ï¼ˆæŒæœ‰vipåªè¦vrrpé€šå‘Šæ­£å¸¸å°±ä¸åšvipè¿ç§»ï¼‰"><a href="#4-2-éæŠ¢å æ¨¡å¼ï¼ˆæŒæœ‰vipåªè¦vrrpé€šå‘Šæ­£å¸¸å°±ä¸åšvipè¿ç§»ï¼‰" class="headerlink" title="4.2.éæŠ¢å æ¨¡å¼ï¼ˆæŒæœ‰vipåªè¦vrrpé€šå‘Šæ­£å¸¸å°±ä¸åšvipè¿ç§»ï¼‰"></a>4.2.éæŠ¢å æ¨¡å¼ï¼ˆæŒæœ‰vipåªè¦vrrpé€šå‘Šæ­£å¸¸å°±ä¸åšvipè¿ç§»ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#kA1ä¸­</span></span><br><span class="line">[root@KA1 ~]# vim /etc/keepalived/keepalived.conf</span><br><span class="line">vrrp_instance WEB_VIP &#123;</span><br><span class="line">    state BACKUP<span class="comment">#éæŠ¢å æ¨¡å¼äº’ä¸ºbackup</span></span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    nopreempt<span class="comment">#å¯åŠ¨éæŠ¢å æ¨¡å¼</span></span><br><span class="line">    priority 100</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        172.25.254.100/24 dev eth0 label eth0:0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# systemctl stop keepalived.service</span><br><span class="line"></span><br><span class="line"><span class="comment">#KA2ä¸­</span></span><br><span class="line">[root@KA2 ~]# vim /etc/keepalived/keepalived.conf</span><br><span class="line">vrrp_instance WEB_VIP &#123;</span><br><span class="line">    state BACKUP</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    nopreempt<span class="comment">#å¼€å¯éæŠ¢å æ¨¡å¼</span></span><br><span class="line">    priority 80</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        172.25.254.100/24 dev eth0 label eth0:0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">[root@KA2 ~]# systemctl stop keepalived.service</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•ï¼š</span></span><br><span class="line">[root@KA1 ~]# systemctl start keepalived.service</span><br><span class="line">[root@KA2 ~]# systemctl start keepalived.service</span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.50  netmask 255.255.255.0  broadcast 172.25.254.255</span><br><span class="line">        inet6 fe80::3901:aeea:786a:7227  prefixlen 64  scopeid 0x20&lt;<span class="built_in">link</span>&gt;</span><br><span class="line">        ether 00:0c:29:26:33:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 18917  bytes 1546417 (1.4 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 34775  bytes 3349412 (3.1 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">eth0:0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.100  netmask 255.255.255.0  broadcast 0.0.0.0</span><br><span class="line">        ether 00:0c:29:26:33:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 162  bytes 9028 (8.8 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 162  bytes 9028 (8.8 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# systemctl stop keepalived.service</span><br><span class="line"></span><br><span class="line">[root@KA2 ~]# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.60  netmask 255.255.255.0  broadcast 172.25.254.255</span><br><span class="line">        inet6 fe80::26df:35e5:539:56bc  prefixlen 64  scopeid 0x20&lt;<span class="built_in">link</span>&gt;</span><br><span class="line">        ether 00:0c:29:1e:fd:7a  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 22521  bytes 1553701 (1.4 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 18517  bytes 1535122 (1.4 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">eth0:0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.100  netmask 255.255.255.0  broadcast 0.0.0.0</span><br><span class="line">        ether 00:0c:29:1e:fd:7a  txqueuelen 1000  (Ethernet)</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 84  bytes 5128 (5.0 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 84  bytes 5128 (5.0 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¼€å¯KA1çš„æœåŠ¡ipä¸ä¼šè¢«æŠ¢å åˆ°1ä¸­</span></span><br><span class="line">[root@KA1 ~]# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.50  netmask 255.255.255.0  broadcast 172.25.254.255</span><br><span class="line">        inet6 fe80::3901:aeea:786a:7227  prefixlen 64  scopeid 0x20&lt;<span class="built_in">link</span>&gt;</span><br><span class="line">        ether 00:0c:29:26:33:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 19102  bytes 1561277 (1.4 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 35034  bytes 3375682 (3.2 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 162  bytes 9028 (8.8 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 162  bytes 9028 (8.8 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure><h3 id="4-3-å»¶è¿ŸæŠ¢å "><a href="#4-3-å»¶è¿ŸæŠ¢å " class="headerlink" title="4.3.å»¶è¿ŸæŠ¢å "></a>4.3.å»¶è¿ŸæŠ¢å </h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#kA1ä¸­</span></span><br><span class="line">[root@KA1 ~]# vim /etc/keepalived/keepalived.conf</span><br><span class="line">vrrp_instance WEB_VIP &#123;</span><br><span class="line">    state BACKUP<span class="comment">#éæŠ¢å æ¨¡å¼äº’ä¸ºbackup</span></span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    preempt_delay 10<span class="comment">#å¯åŠ¨å»¶è¿ŸæŠ¢å ï¼Œå»¶è¿Ÿ10sæŠ¢å </span></span><br><span class="line">    priority 100</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        172.25.254.100/24 dev eth0 label eth0:0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# systemctl stop keepalived.service</span><br><span class="line"></span><br><span class="line"><span class="comment">#KA2ä¸­</span></span><br><span class="line">[root@KA2 ~]# vim /etc/keepalived/keepalived.conf</span><br><span class="line">vrrp_instance WEB_VIP &#123;</span><br><span class="line">    state BACKUP</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    preempt_delay 10<span class="comment">#å¯åŠ¨å»¶è¿ŸæŠ¢å ï¼Œå»¶è¿Ÿ10sæŠ¢å </span></span><br><span class="line">    priority 80</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        172.25.254.100/24 dev eth0 label eth0:0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">[root@KA2 ~]# systemctl stop keepalived.service</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•ï¼š</span></span><br><span class="line">[root@KA1 ~]# systemctl start keepalived.service</span><br><span class="line">[root@KA2 ~]# systemctl start keepalived.service</span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨ä¸€ä¸ªç‹¬ç«‹çš„shellä¸­å¼€å¯ipçš„ç›‘æ§</span></span><br><span class="line">[root@KA1 ~]# watch -n 1 ifconfig</span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨KA1å¦å¤–çš„shellä¸­å…³é—­keepalived</span></span><br><span class="line">[root@KA1 ~]# systemctl stop keepalived.service</span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# systemctl start  keepalived.service</span><br><span class="line"><span class="comment">#æ“ä½œå®Œæ¯•åè§‚å¯Ÿç›‘æ§ä¸­vipçš„è¿ç§»å»¶è¿Ÿè¿‡ç¨‹</span></span><br></pre></td></tr></table></figure><h2 id="5-keepalivedçš„å•æ’­æ¨¡å¼"><a href="#5-keepalivedçš„å•æ’­æ¨¡å¼" class="headerlink" title="5.keepalivedçš„å•æ’­æ¨¡å¼"></a>5.keepalivedçš„å•æ’­æ¨¡å¼</h2><p>ä¸ºä»€ä¹ˆè¦å•æ’­ï¼Œç»„æ’­æ¨¡å¼ä½¿ç”¨çš„ç½‘å€èµ„æºæœ€å°‘ï¼Œä½†æ˜¯ä¸èƒ½è·¨ç½‘ç»œï¼Œå¦‚æœä¸»å¤‡ä¸¤å°ä¸»æœºæ˜¯è·¨ç½‘ç»œçš„ï¼Œé‚£ä¹ˆåªèƒ½å¯ç”¨å•æ’­æ¥å®ç°vrrpé€šå‘Š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨KA1ä¸­</span></span><br><span class="line">[root@KA1 ~]# vim /etc/keepalived/keepalived.conf</span><br><span class="line">! Configuration File <span class="keyword">for</span> keepalived</span><br><span class="line"></span><br><span class="line">global_defs &#123;</span><br><span class="line">   notification_email &#123;</span><br><span class="line">     timinglee_zln@163.com</span><br><span class="line">   &#125;</span><br><span class="line">   notification_email_from timinglee_zln@163.com</span><br><span class="line">   smtp_server 127.0.0.1</span><br><span class="line">   smtp_connect_timeout 30</span><br><span class="line">   router_id KA1</span><br><span class="line">   vrrp_skip_check_adv_addr</span><br><span class="line">   <span class="comment">#vrrp_strict</span></span><br><span class="line">   vrrp_garp_interval 1</span><br><span class="line">   vrrp_gna_interval 1</span><br><span class="line">   <span class="comment">#vrrp_mcast_group4 224.0.0.44#å…³é—­ç»„æ’­</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance WEB_VIP &#123;</span><br><span class="line">    state MASTER</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    priority 100</span><br><span class="line">    advert_int 1</span><br><span class="line">    unicast_src_ip 172.25.254.50<span class="comment">#æŒ‡å®šå•æ’­æºåœ°å€ï¼Œé€šå¸¸æ˜¯æœ¬æœºIP</span></span><br><span class="line">    unicast_peer &#123;</span><br><span class="line">      172.25.254.60<span class="comment">#æŒ‡å®šå•æ’­æ¥æ”¶åœ°å€</span></span><br><span class="line">    &#125;</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        172.25.254.100/24 dev eth0 label eth0:0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨KA2ä¸­</span></span><br><span class="line">[root@KA2 ~]# vim /etc/keepalived/keepalived.conf</span><br><span class="line">! Configuration File <span class="keyword">for</span> keepalived</span><br><span class="line"></span><br><span class="line">global_defs &#123;</span><br><span class="line">   notification_email &#123;</span><br><span class="line">     timinglee_zln@163.com</span><br><span class="line">   &#125;</span><br><span class="line">   notification_email_from timinglee_zln@163.com</span><br><span class="line">   smtp_server 127.0.0.1</span><br><span class="line">   smtp_connect_timeout 30</span><br><span class="line">   router_id KA1</span><br><span class="line">   vrrp_skip_check_adv_addr</span><br><span class="line">   <span class="comment">#vrrp_strict</span></span><br><span class="line">   vrrp_garp_interval 1</span><br><span class="line">   vrrp_gna_interval 1</span><br><span class="line">   <span class="comment">#vrrp_mcast_group4 224.0.0.44#å…³é—­ç»„æ’­</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance WEB_VIP &#123;</span><br><span class="line">    state MASTER</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    priority 100</span><br><span class="line">    advert_int 1</span><br><span class="line">    unicast_src_ip 172.25.254.60<span class="comment">#æŒ‡å®šå•æ’­æºåœ°å€ï¼Œé€šå¸¸æ˜¯æœ¬æœºIP</span></span><br><span class="line">    unicast_peer &#123;</span><br><span class="line">      172.25.254.50<span class="comment">#æŒ‡å®šå•æ’­æ¥æ”¶åœ°å€</span></span><br><span class="line">    &#125;</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        172.25.254.100/24 dev eth0 label eth0:0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# systemctl restart keepalived.service</span><br><span class="line">[root@KA2 ~]# systemctl restart keepalived.service</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line"><span class="comment">#åœ¨KA1ä¸­å¼€å¯ç‹¬ç«‹shellç›‘æ§æ’­æŠ¥ä¿¡æ¯</span></span><br><span class="line">[root@KA1 ~]# tcpdump -i eth0 -nn src host 172.25.254.50 and dst 172.25.254.60</span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨KA2ä¸­å¼€å¯ç‹¬ç«‹shellç›‘æ§æ’­æŠ¥ä¿¡æ¯</span></span><br><span class="line">[root@KA2 ~]# tcpdump -i eth0 -nn src host 172.25.254.60 and dst 172.25.254.50</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨KA1æ­£å¸¸æ—¶</span></span><br><span class="line"><span class="comment">#ka2æ’­æŠ¥ä¿¡æ¯ä¸æ˜¾ç¤ºé€šå‘Šå†…å®¹</span></span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# systemctl stop keepalived.service</span><br><span class="line"></span><br><span class="line"><span class="comment">#vipä¼šè¢«è¿ç§»åˆ°KA2,KA2ä¸Šå¼€å§‹æ˜¾ç¤ºæ’­æŠ¥å†…å®¹</span></span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# systemctl start keepalived.service</span><br><span class="line"></span><br><span class="line"><span class="comment">#vipå› ä¸ºä¼˜å…ˆçº§è¢«KA1æŠ¢å ï¼ŒKA2ä¸­æ’­æŠ¥åœæ­¢</span></span><br></pre></td></tr></table></figure><p>Keepalivedä¸šåŠ¡vipè¿ç§»å‘Šè­¦</p><p>1.é‚®ä»¶å‘Šè­¦ç¯å¢ƒæ„å»º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®‰è£…é‚®ä»¶è½¯ä»¶</span></span><br><span class="line">[root@KA1 ~]#  dnf install s-nail postfix   -y</span><br><span class="line">[root@KA2 ~]#  dnf install s-nail postfix   -y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯åŠ¨é‚®ä»¶ä»£ç†</span></span><br><span class="line">[root@KA1 ~]# systemctl start postfix.service</span><br><span class="line">[root@KA2 ~]# systemctl start postfix.service</span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾å®šsendmailå¯ä»¥é€šè¿‡å…¬ç½‘é‚®ç®±å‘é€é‚®ä»¶ä¸‹é¢æ–¹å¼äººé€‰å…¶ä¸€</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨Linuxä¸»æœºä¸­é…ç½®mailrcï¼ˆKA1+KA2ï¼‰</span></span><br><span class="line">[root@KA1+KA2 ~]# vim /etc/mail.rc</span><br><span class="line"><span class="built_in">set</span> smtp=smtp.qq.com</span><br><span class="line"><span class="built_in">set</span> smtp-auth=login</span><br><span class="line"><span class="built_in">set</span> smtp-auth-user=kaitumei@foxmail.com</span><br><span class="line"><span class="built_in">set</span> smtp-auth-password=oxsfthfenecmfaae</span><br><span class="line"><span class="built_in">set</span> from=kaitumei@foxmail.com</span><br><span class="line"><span class="built_in">set</span> ssl-verify=ignore</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•é‚®ä»¶</span></span><br><span class="line">[root@KA1 mail]# <span class="built_in">echo</span> hello | mailx -s <span class="built_in">test</span> kaitumei@163.com</span><br><span class="line"></span><br><span class="line">[root@KA1 mail]# mailq<span class="comment">#æŸ¥çœ‹é‚®ä»¶é˜Ÿåˆ—</span></span><br><span class="line">Mail queue is empty</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@KA1 mail]# mail<span class="comment">#æŸ¥çœ‹æ˜¯å¦åˆé€€ä¿¡</span></span><br><span class="line">s-nail version v14.9.22.  Type `?<span class="string">&#x27; for help</span></span><br><span class="line"><span class="string">/var/spool/mail/root: 1 message</span></span><br><span class="line"><span class="string">â–¸   1 Mail Delivery Subsys  2026-01-28 16:26   69/2210  &quot;Returned mail: see transcript for details  &quot;</span></span><br><span class="line"><span class="string">&amp;q é€€å‡º</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#æŸ¥çœ‹å¯¹åº”é‚®ç®±æ˜¯å¦æœ‰é‚®ä»¶æ”¶åˆ°</span></span><br></pre></td></tr></table></figure><p>2.è®¾å®škeepalivedå‘Šè­¦è„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">[root@KA1 ~]# <span class="built_in">mkdir</span>  -p /etc/keepalived/scripts</span><br><span class="line">[root@KA2 ~]#  <span class="built_in">mkdir</span>  -p /etc/keepalived/scripts</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¼–å†™å‘Šè­¦è„šæœ¬</span></span><br><span class="line">[root@KA1+2 ~]#  vim /etc/keepalived/scripts/waring.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">mail_dest=<span class="string">&#x27;kaitumei@163.com&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">mail_send</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">    mail_subj=<span class="string">&quot;<span class="variable">$HOSTNAME</span> to be <span class="variable">$1</span> vip è½¬ç§»&quot;</span></span><br><span class="line">    mail_mess=<span class="string">&quot;`date +%F\ %T`: vrrp è½¬ç§»,<span class="variable">$HOSTNAME</span> å˜ä¸º <span class="variable">$1</span>&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$mail_mess</span>&quot;</span> | mail -s <span class="string">&quot;<span class="variable">$mail_subj</span>&quot;</span> <span class="variable">$mail_dest</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">    master)</span><br><span class="line">    mail_send master</span><br><span class="line">    ;;</span><br><span class="line">    backup)</span><br><span class="line">    mail_send backup</span><br><span class="line">    ;;</span><br><span class="line">    fault)</span><br><span class="line">    mail_send fault</span><br><span class="line">    ;;</span><br><span class="line">    *)</span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line">    ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@KA1+2 ~]# <span class="built_in">chmod</span>  +x /etc/keepalived/scripts/waring.sh</span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# /etc/keepalived/scripts/waring.sh master</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯¹åº”é‚®ç®±ä¸­ä¼šå‡ºç°é‚®ä»¶</span></span><br></pre></td></tr></table></figure><p>3.é…ç½®keepalivedå‘Šè­¦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨KA1å’ŒKA2ä¸­è®¾å®šé…ç½®æ–‡ä»¶</span></span><br><span class="line">! Configuration File <span class="keyword">for</span> keepalived</span><br><span class="line"></span><br><span class="line">global_defs &#123;</span><br><span class="line">   notification_email &#123;</span><br><span class="line">     timinglee_zln@163.com</span><br><span class="line">   &#125;</span><br><span class="line">   notification_email_from timinglee_zln@163.com</span><br><span class="line">   smtp_server 127.0.0.1</span><br><span class="line">   smtp_connect_timeout 30</span><br><span class="line">   router_id KA1</span><br><span class="line">   vrrp_skip_check_adv_addr</span><br><span class="line">   <span class="comment">#vrrp_strict</span></span><br><span class="line">   vrrp_garp_interval 1</span><br><span class="line">   vrrp_gna_interval 1</span><br><span class="line">   vrrp_mcast_group4 224.0.0.44</span><br><span class="line">   enable_script_security</span><br><span class="line">   script_user root</span><br><span class="line">&#125;</span><br><span class="line">vrrp_instance WEB_VIP &#123;</span><br><span class="line">    state MASTER</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    priority 100</span><br><span class="line">    advert_int 1</span><br><span class="line">  <span class="comment"># unicast_src_ip 172.25.254.50</span></span><br><span class="line">  <span class="comment"># unicast_peer &#123;</span></span><br><span class="line">  <span class="comment">#   172.25.254.60</span></span><br><span class="line"><span class="comment">#   &#125;</span></span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        172.25.254.100/24 dev eth0 label eth0:0</span><br><span class="line">    &#125;</span><br><span class="line">    notify_master <span class="string">&quot;/etc/keepalived/scripts/waring.sh master&quot;</span></span><br><span class="line">    notify_backup <span class="string">&quot;/etc/keepalived/scripts/waring.sh backup&quot;</span></span><br><span class="line">    notify_fault <span class="string">&quot;/etc/keepalived/scripts/waring.sh fault&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@KA1+2 ~]# systemctl restart keepalived.service</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@KA1 ~]# systemctl stop keepalived.service<span class="comment">#åœæ­¢æœåŠ¡åæŸ¥çœ‹é‚®ä»¶</span></span><br><span class="line">[root@KA1 ~]# systemctl start keepalived.service<span class="comment">#å¼€å¯æœåŠ¡åæŸ¥çœ‹é‚®ä»¶</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="6-KeepalivedåŒä¸»æ¨¡å¼"><a href="#6-KeepalivedåŒä¸»æ¨¡å¼" class="headerlink" title="6.KeepalivedåŒä¸»æ¨¡å¼"></a>6.KeepalivedåŒä¸»æ¨¡å¼</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨KA1ä¸­</span></span><br><span class="line">[root@KA1 ~]# vim /etc/keepalived/keepalived.conf</span><br><span class="line">vrrp_instance WEB_VIP &#123;<span class="comment">#ç¬¬ä¸€ä¸ªè™šæ‹Ÿè·¯ç”±ï¼Œä»¥masterèº«ä»½è®¾å®š</span></span><br><span class="line">    state MASTER</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    priority 100</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        172.25.254.100/24 dev eth0 label eth0:0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance DB_VIP &#123;<span class="comment">#ç¬¬äºŒä¸ªè™šæ‹Ÿè·¯ç”±ã€‚ä»¥backupèº«ä»½è®¾å®š</span></span><br><span class="line">    state BACKUP</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 52</span><br><span class="line">    priority 80</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        172.25.254.200/24 dev eth0 label eth0:1</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#KA2ä¸­</span></span><br><span class="line">[root@KA2 ~]# vim /etc/keepalived/keepalived.conf</span><br><span class="line">vrrp_instance WEB_VIP &#123;</span><br><span class="line">    state BACKUP</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    preempt_delay 10</span><br><span class="line">    priority 80</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">      172.25.254.100/24 dev eth0 label eth0:0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">vrrp_instance DB_VIP &#123;</span><br><span class="line">    state MASTER</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 52</span><br><span class="line">    preempt_delay 10</span><br><span class="line">    priority 100</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">      172.25.254.200/24 dev eth0 label eth0:1</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">[root@KA1 ~]# systemctl restart keepalived.service</span><br><span class="line">[root@KA2 ~]# systemctl restart keepalived.service</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@KA1 ~]# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.50  netmask 255.255.255.0  broadcast 172.25.254.255</span><br><span class="line">        inet6 fe80::3901:aeea:786a:7227  prefixlen 64  scopeid 0x20&lt;<span class="built_in">link</span>&gt;</span><br><span class="line">        ether 00:0c:29:26:33:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 38766  bytes 3548249 (3.3 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 67456  bytes 6209788 (5.9 MiB)</span><br><span class="line">        TX errors 0  dropped 2 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">eth0:0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.100  netmask 255.255.255.0  broadcast 0.0.0.0</span><br><span class="line">        ether 00:0c:29:26:33:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 782  bytes 60465 (59.0 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 782  bytes 60465 (59.0 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@KA2 ~]# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.60  netmask 255.255.255.0  broadcast 172.25.254.255</span><br><span class="line">        inet6 fe80::26df:35e5:539:56bc  prefixlen 64  scopeid 0x20&lt;<span class="built_in">link</span>&gt;</span><br><span class="line">        ether 00:0c:29:1e:fd:7a  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 46164  bytes 3559703 (3.3 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 38170  bytes 3306899 (3.1 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">eth0:1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.200  netmask 255.255.255.0  broadcast 0.0.0.0</span><br><span class="line">        ether 00:0c:29:1e:fd:7a  txqueuelen 1000  (Ethernet)</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 532  bytes 39588 (38.6 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 532  bytes 39588 (38.6 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# systemctl stop keepalived.service</span><br><span class="line">[root@KA2 ~]# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.60  netmask 255.255.255.0  broadcast 172.25.254.255</span><br><span class="line">        inet6 fe80::26df:35e5:539:56bc  prefixlen 64  scopeid 0x20&lt;<span class="built_in">link</span>&gt;</span><br><span class="line">        ether 00:0c:29:1e:fd:7a  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 46204  bytes 3562823 (3.3 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 38240  bytes 3313319 (3.1 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">eth0:0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.100  netmask 255.255.255.0  broadcast 0.0.0.0</span><br><span class="line">        ether 00:0c:29:1e:fd:7a  txqueuelen 1000  (Ethernet)</span><br><span class="line"></span><br><span class="line">eth0:1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.200  netmask 255.255.255.0  broadcast 0.0.0.0</span><br><span class="line">        ether 00:0c:29:1e:fd:7a  txqueuelen 1000  (Ethernet)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@KA2 ~]# systemctl stop keepalived.service</span><br><span class="line">[root@KA1 ~]# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.50  netmask 255.255.255.0  broadcast 172.25.254.255</span><br><span class="line">        inet6 fe80::3901:aeea:786a:7227  prefixlen 64  scopeid 0x20&lt;<span class="built_in">link</span>&gt;</span><br><span class="line">        ether 00:0c:29:26:33:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 39277  bytes 3653121 (3.4 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 67902  bytes 6264989 (5.9 MiB)</span><br><span class="line">        TX errors 0  dropped 2 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">eth0:0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.100  netmask 255.255.255.0  broadcast 0.0.0.0</span><br><span class="line">        ether 00:0c:29:26:33:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line"></span><br><span class="line">eth0:1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.200  netmask 255.255.255.0  broadcast 0.0.0.0</span><br><span class="line">        ether 00:0c:29:26:33:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="7-åŒä¸»æ¨¡å¼ä»£ç†ä¸åŒä¸šåŠ¡å®ç°é«˜å¯ç”¨"><a href="#7-åŒä¸»æ¨¡å¼ä»£ç†ä¸åŒä¸šåŠ¡å®ç°é«˜å¯ç”¨" class="headerlink" title="7.åŒä¸»æ¨¡å¼ä»£ç†ä¸åŒä¸šåŠ¡å®ç°é«˜å¯ç”¨"></a>7.åŒä¸»æ¨¡å¼ä»£ç†ä¸åŒä¸šåŠ¡å®ç°é«˜å¯ç”¨</h2><h3 id="1-å®éªŒç¯å¢ƒ"><a href="#1-å®éªŒç¯å¢ƒ" class="headerlink" title="1.å®éªŒç¯å¢ƒ"></a>1.å®éªŒç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#webæœåŠ¡è®¾å®šå†ä¸ªå®éªŒå·²ç»è®¾å®šå®Œæˆ</span></span><br><span class="line"><span class="comment">#åœ¨rsä¸­è®¾å®šloæ·»åŠ vip2 172.25.254.200ã€32</span></span><br><span class="line"><span class="comment">#åœ¨rsä¸­æ­å»ºæ•°æ®åº“</span></span><br><span class="line">[root@rs1+2 ~]# dnf install mariadb-server -y</span><br><span class="line">[root@rs1+2 ~]# systemctl <span class="built_in">enable</span> --now mariadb</span><br><span class="line">[root@rs1+2 ~]# mysql</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection <span class="built_in">id</span> is 3</span><br><span class="line">Server version: 10.5.27-MariaDB MariaDB Server</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; CREATE USER <span class="string">&#x27;hua&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified by <span class="string">&#x27;hua&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; GRANT ALL ON *.* TO <span class="string">&#x27;hua&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.001 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@rs1 ~]# mysql -uhua -phua -h172.25.254.10</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection <span class="built_in">id</span> is 4</span><br><span class="line">Server version: 10.5.27-MariaDB MariaDB Server</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; quit</span><br><span class="line"></span><br><span class="line">[root@rs1 ~]# mysql -ulee -plee -h172.25.254.20</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection <span class="built_in">id</span> is 4</span><br><span class="line">Server version: 10.5.27-MariaDB MariaDB Server</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; quit</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-å®ç°ä¸åŒvipä»£ç†ä¸åŒä¸šåŠ¡"><a href="#2-å®ç°ä¸åŒvipä»£ç†ä¸åŒä¸šåŠ¡" class="headerlink" title="2.å®ç°ä¸åŒvipä»£ç†ä¸åŒä¸šåŠ¡"></a>2.å®ç°ä¸åŒvipä»£ç†ä¸åŒä¸šåŠ¡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#KA1å’ŒKA2</span></span><br><span class="line">[root@KA1+2 ~]# vim /etc/keepalived/keepalived.conf</span><br><span class="line">include /etc/keepalived/conf.d/webserver.conf</span><br><span class="line">include /etc/keepalived/conf.d/datebase.conf</span><br><span class="line"></span><br><span class="line">[root@KA1+2 ~]# vim /etc/keepalived/conf.d/webserver.conf</span><br><span class="line">virtual_server 172.25.254.100 80 &#123;</span><br><span class="line">    delay_loop 6</span><br><span class="line">    lb_algo rr</span><br><span class="line">    lb_kind DR</span><br><span class="line">    protocol TCP</span><br><span class="line"></span><br><span class="line">    real_server 172.25.254.10 80 &#123;</span><br><span class="line">        weight 1</span><br><span class="line">        HTTP_GET &#123;</span><br><span class="line">            url &#123;</span><br><span class="line">              path /</span><br><span class="line">              status_code 200</span><br><span class="line">            &#125;</span><br><span class="line">            connect_timeout 1</span><br><span class="line">            retry 3</span><br><span class="line">            delay_before_retry 1</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    real_server 172.25.254.20 80 &#123;</span><br><span class="line">        weight 1</span><br><span class="line">        TCP_CHECK &#123;</span><br><span class="line">          connect_timeout 5</span><br><span class="line">          retry 3</span><br><span class="line">          delay_before_retry 3</span><br><span class="line">          connect_port 80</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">[root@KA1 ~]# vim /etc/keepalived/conf.d/datebase.conf</span><br><span class="line">virtual_server 172.25.254.200 3306 &#123;</span><br><span class="line">    delay_loop 6</span><br><span class="line">    lb_algo rr</span><br><span class="line">    lb_kind DR</span><br><span class="line">    protocol TCP</span><br><span class="line"></span><br><span class="line">    real_server 172.25.254.10 3306 &#123;</span><br><span class="line">        weight 1</span><br><span class="line">        TCP_CHECK &#123;</span><br><span class="line">          connect_timeout 5</span><br><span class="line">          retry 3</span><br><span class="line">          delay_before_retry 3</span><br><span class="line">          connect_port 3306</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    real_server 172.25.254.20 3306 &#123;</span><br><span class="line">        weight 1</span><br><span class="line">        TCP_CHECK &#123;</span><br><span class="line">          connect_timeout 5</span><br><span class="line">          retry 3</span><br><span class="line">          delay_before_retry 3</span><br><span class="line">          connect_port 3306</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[root@KA1+2 ~]# systemctl restart keepalived.service</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@rs1+2 ~]# vim /etc/NetworkManager/system-connections/lo.nmconnection</span><br><span class="line">address3=172.25.254.200/32</span><br><span class="line">[root@rs1 ~]# nmcli connection reload</span><br><span class="line">[root@rs1 ~]# nmcli connection up lo</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-æµ‹è¯•"><a href="#3-æµ‹è¯•" class="headerlink" title="3.æµ‹è¯•"></a>3.æµ‹è¯•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@rs2 ~]# mysql -uhua  -phua  -h172.25.254.200</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection <span class="built_in">id</span> is 89</span><br><span class="line">Server version: 10.5.27-MariaDB MariaDB Server</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[Administrator.DESKTOP-VJ307M3] â¤ curl 172.25.254.100</span><br><span class="line">RS1 - 172.25.254.10</span><br><span class="line">                                                                                                    âœ”</span><br><span class="line">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br><span class="line">[2026-01-29 11:58.55]  ~</span><br><span class="line">[Administrator.DESKTOP-VJ307M3] â¤ curl 172.25.254.100</span><br><span class="line">RS2 - 172.25.254.20</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="8-åˆ©ç”¨VRRP-Script-å®ç°å…¨èƒ½é«˜å¯ç”¨"><a href="#8-åˆ©ç”¨VRRP-Script-å®ç°å…¨èƒ½é«˜å¯ç”¨" class="headerlink" title="8.åˆ©ç”¨VRRP Script å®ç°å…¨èƒ½é«˜å¯ç”¨"></a>8.åˆ©ç”¨VRRP Script å®ç°å…¨èƒ½é«˜å¯ç”¨</h2><h3 id="1-å®éªŒç¯å¢ƒ-1"><a href="#1-å®éªŒç¯å¢ƒ-1" class="headerlink" title="1.å®éªŒç¯å¢ƒ"></a>1.å®éªŒç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨KA1å’ŒKA2ä¸­å®‰è£…haproxy</span></span><br><span class="line">[root@KA1+2 ~]# dnf install haproxy-2.4.22-4.el9.x86_64  -y</span><br><span class="line"></span><br><span class="line">[root@KA1+2 ~]# vim /etc/sysctl.conf</span><br><span class="line">net.ipv4.ip_nonlocal_bind=1</span><br><span class="line"></span><br><span class="line">[root@KA1+2 ~]# vim /etc/haproxy/haproxy.cfg</span><br><span class="line">listen webserver</span><br><span class="line">    <span class="built_in">bind</span> 172.25.254.100:80</span><br><span class="line">    mode http</span><br><span class="line">    server web1 172.25.254.10:80 check</span><br><span class="line">    server web2 172.25.254.20:80 check</span><br><span class="line">    </span><br><span class="line">[root@KA1+2 ~]# systemctl <span class="built_in">enable</span> --now haproxy.service</span><br></pre></td></tr></table></figure><h3 id="2-åˆ©ç”¨æ¡ˆä¾‹ç†è§£vrrp-scripts"><a href="#2-åˆ©ç”¨æ¡ˆä¾‹ç†è§£vrrp-scripts" class="headerlink" title="2.åˆ©ç”¨æ¡ˆä¾‹ç†è§£vrrp_scripts"></a>2.åˆ©ç”¨æ¡ˆä¾‹ç†è§£vrrp_scripts</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨KA1ä¸»æœºä¸­</span></span><br><span class="line">[root@KA1 ~]# vim /etc/keepalived/scripts/test.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">[ ! -f <span class="string">&quot;/mnt/lee&quot;</span> ]</span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# vim /etc/keepalived/keepalived.conf</span><br><span class="line">! Configuration File <span class="keyword">for</span> keepalived</span><br><span class="line"></span><br><span class="line">global_defs &#123;</span><br><span class="line">   notification_email &#123;</span><br><span class="line">     acassen@firewall.loc</span><br><span class="line">     failover@firewall.loc</span><br><span class="line">     sysadmin@firewall.loc</span><br><span class="line">   &#125;</span><br><span class="line">   notification_email_from Alexandre.Cassen@firewall.loc</span><br><span class="line">   smtp_server 127.0.0.1</span><br><span class="line">   smtp_connect_timeout 30</span><br><span class="line">   router_id KA1</span><br><span class="line">   vrrp_skip_check_adv_addr</span><br><span class="line">   <span class="comment">#vrrp_strict</span></span><br><span class="line">   vrrp_garp_interval 1</span><br><span class="line">   vrrp_gna_interval 1</span><br><span class="line">   vrrp_mcast_group4 224.0.0.44</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_script check_lee &#123;</span><br><span class="line">    script <span class="string">&quot;/etc/keepalived/scripts/test.sh&quot;</span></span><br><span class="line">    interval 1</span><br><span class="line">    weight -30</span><br><span class="line">    fall 2</span><br><span class="line">    rise 2</span><br><span class="line">    <span class="built_in">timeout</span> 2</span><br><span class="line">    user root</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance WEB_VIP &#123;</span><br><span class="line">    state MASTER</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    priority 100</span><br><span class="line">    advert_int 1</span><br><span class="line">    nopreempt no</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        172.25.254.100/24 dev eth0 label eth0:0</span><br><span class="line">    &#125;</span><br><span class="line">    track_script &#123;</span><br><span class="line">        check_lee</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[root@KA2 ~]# vim /etc/keepalived/keepalived.conf</span><br><span class="line">! Configuration File <span class="keyword">for</span> keepalived</span><br><span class="line"></span><br><span class="line">global_defs &#123;</span><br><span class="line">   notification_email &#123;</span><br><span class="line">     timinglee_zln@163.com</span><br><span class="line">   &#125;</span><br><span class="line">   notification_email_from timinglee_zln@163.com</span><br><span class="line">   smtp_server 127.0.0.1</span><br><span class="line">   smtp_connect_timeout 30</span><br><span class="line">   router_id KA2</span><br><span class="line">   vrrp_skip_check_adv_addr</span><br><span class="line">   <span class="comment">#vrrp_strict</span></span><br><span class="line">   vrrp_garp_interval 1</span><br><span class="line">   vrrp_gna_interval 1</span><br><span class="line">   vrrp_mcast_group4 224.0.0.44</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_script check_lee &#123;</span><br><span class="line">    script <span class="string">&quot;/etc/keepalived/scripts/test.sh&quot;</span></span><br><span class="line">    interval 1</span><br><span class="line">    weight -30</span><br><span class="line">    fall 2</span><br><span class="line">    rise 2</span><br><span class="line">    <span class="built_in">timeout</span> 2</span><br><span class="line">    user root</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">vrrp_instance WEB_VIP &#123;</span><br><span class="line">    state BACKUP</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    priority 80</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        172.25.254.100/24 dev eth0 label eth0:0</span><br><span class="line">    &#125;</span><br><span class="line">    track_script &#123;</span><br><span class="line">        check_lee</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# systemctl restart keepalived.service</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•ï¼š</span></span><br><span class="line">[root@KA1 ~]# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.50  netmask 255.255.255.0  broadcast 172.25.254.255</span><br><span class="line">        inet6 fe80::3901:aeea:786a:7227  prefixlen 64  scopeid 0x20&lt;<span class="built_in">link</span>&gt;</span><br><span class="line">        ether 00:0c:29:26:33:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 98198  bytes 9235557 (8.8 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 145101  bytes 12247386 (11.6 MiB)</span><br><span class="line">        TX errors 0  dropped 9 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">eth0:0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.100  netmask 255.255.255.0  broadcast 0.0.0.0</span><br><span class="line">        ether 00:0c:29:26:33:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 932  bytes 72195 (70.5 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 932  bytes 72195 (70.5 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# <span class="built_in">touch</span> /mnt/lee</span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.50  netmask 255.255.255.0  broadcast 172.25.254.255</span><br><span class="line">        inet6 fe80::3901:aeea:786a:7227  prefixlen 64  scopeid 0x20&lt;<span class="built_in">link</span>&gt;</span><br><span class="line">        ether 00:0c:29:26:33:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 97968  bytes 9216259 (8.7 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 144858  bytes 12219108 (11.6 MiB)</span><br><span class="line">        TX errors 0  dropped 9 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 932  bytes 72195 (70.5 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 932  bytes 72195 (70.5 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# <span class="built_in">rm</span> -fr /mnt/lee</span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.50  netmask 255.255.255.0  broadcast 172.25.254.255</span><br><span class="line">        inet6 fe80::3901:aeea:786a:7227  prefixlen 64  scopeid 0x20&lt;<span class="built_in">link</span>&gt;</span><br><span class="line">        ether 00:0c:29:26:33:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 98198  bytes 9235557 (8.8 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 145101  bytes 12247386 (11.6 MiB)</span><br><span class="line">        TX errors 0  dropped 9 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">eth0:0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.25.254.100  netmask 255.255.255.0  broadcast 0.0.0.0</span><br><span class="line">        ether 00:0c:29:26:33:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 932  bytes 72195 (70.5 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 932  bytes 72195 (70.5 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure><h3 id="3-keepalived-haproxy"><a href="#3-keepalived-haproxy" class="headerlink" title="3.keepalived + haproxy"></a>3.keepalived + haproxy</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">[root@KA1 ~]# vim /etc/keepalived/scripts/haproxy_check.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">killall -0 haproxy &amp;&gt; /dev/null</span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# <span class="built_in">chmod</span> +x /etc/keepalived/scripts/haproxy_check.sh</span><br><span class="line">[root@KA1 ~]# vim /etc/keepalived/keepalived.conf</span><br><span class="line">vrrp_script haporxy_check &#123;</span><br><span class="line">    script <span class="string">&quot;/etc/keepalived/scripts/haproxy_check.sh&quot;</span></span><br><span class="line">    interval 1</span><br><span class="line">    weight -30</span><br><span class="line">    fall 2</span><br><span class="line">    rise 2</span><br><span class="line">    <span class="built_in">timeout</span> 2</span><br><span class="line">    user root</span><br><span class="line">&#125;</span><br><span class="line">vrrp_instance WEB_VIP &#123;</span><br><span class="line">    state MASTER</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    priority 100</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        172.25.254.100/24 dev eth0 label eth0:0</span><br><span class="line">    &#125;</span><br><span class="line">    track_script &#123;</span><br><span class="line">        haporxy_check</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[root@KA1 ~]# systemctl restart keepalived.service</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">é€šè¿‡å…³é—­å’Œå¼€å¯haproxyæ¥è§‚å¯Ÿvipæ˜¯å¦è¿ç§»</span><br></pre></td></tr></table></figure><h1 id="2026-1-29"><a href="#2026-1-29" class="headerlink" title="2026-1-29"></a>2026-1-29</h1><h2 id="1-Nginxçš„æºç ç¼–è¯‘"><a href="#1-Nginxçš„æºç ç¼–è¯‘" class="headerlink" title="1.Nginxçš„æºç ç¼–è¯‘"></a>1.Nginxçš„æºç ç¼–è¯‘</h2><h3 id="1-1-ä¸‹è½½è½¯ä»¶"><a href="#1-1-ä¸‹è½½è½¯ä»¶" class="headerlink" title="1.1.ä¸‹è½½è½¯ä»¶"></a>1.1.ä¸‹è½½è½¯ä»¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@Nginx ~]# wget https://nginx.org/download/nginx-1.28.1.tar.gz</span><br></pre></td></tr></table></figure><h3 id="1-2-è§£å‹"><a href="#1-2-è§£å‹" class="headerlink" title="1.2.è§£å‹"></a>1.2.è§£å‹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@Nginx ~]# tar -zxf nginx-1.28.1.tar.gz</span><br><span class="line">[root@Nginx ~]# cd nginx-1.28.1/</span><br><span class="line">[root@Nginx nginx-1.28.1]# ls</span><br><span class="line">auto     CHANGES.ru          conf       contrib          html     man        SECURITY.md</span><br><span class="line">CHANGES  CODE_OF_CONDUCT.md  configure  CONTRIBUTING.md  LICENSE  README.md  src</span><br></pre></td></tr></table></figure><h3 id="1-3-æ£€æµ‹ç¯å¢ƒ"><a href="#1-3-æ£€æµ‹ç¯å¢ƒ" class="headerlink" title="1.3.æ£€æµ‹ç¯å¢ƒ"></a>1.3.æ£€æµ‹ç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®‰è£…ä¾èµ–æ€§</span></span><br><span class="line">[root@Nginx ~]# dnf install gcc openssl-devel.x86_64 pcre2-devel.x86_64 zlib-devel -y</span><br><span class="line"></span><br><span class="line">[root@Nginx nginx-1.28.1]# ./configure --prefix=/usr/local/nginx --user=nginx --group=nginx --with-http_ssl_module --with-http_v2_module --with-http_realip_module --with-http_stub_status_module --with-http_gzip_static_module --with-pcre --with-stream --with-stream_ssl_module --with-stream_realip_module</span><br></pre></td></tr></table></figure><h3 id="1-4-ç¼–è¯‘"><a href="#1-4-ç¼–è¯‘" class="headerlink" title="1.4.ç¼–è¯‘"></a>1.4.ç¼–è¯‘</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@Nginx nginx-1.28.1]# make</span><br><span class="line">[root@Nginx nginx-1.28.1]# make install</span><br></pre></td></tr></table></figure><h3 id="1-5-nginxå¯åŠ¨"><a href="#1-5-nginxå¯åŠ¨" class="headerlink" title="1.5.nginxå¯åŠ¨"></a>1.5.nginxå¯åŠ¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#è®¾å®šç¯å¢ƒå˜é‡</span><br><span class="line">[root@Nginx sbin]# vim  ~/.bash_profile</span><br><span class="line">export PATH=$PATH:/usr/local/nginx/sbin</span><br><span class="line"></span><br><span class="line">[root@Nginx sbin]# source   ~/.bash_profile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@Nginx logs]# useradd  -s /sbin/nologin -M nginx</span><br><span class="line">[root@Nginx logs]# nginx</span><br><span class="line">[root@Nginx logs]# ps aux | grep nginx</span><br><span class="line">root       44012  0.0  0.1  14688  2356 ?        Ss   17:01   0:00 nginx: master process nginx</span><br><span class="line">nginx      44013  0.0  0.2  14888  3892 ?        S    17:01   0:00 nginx: worker process</span><br><span class="line">root       44015  0.0  0.1   6636  2176 pts/0    S+   17:01   0:00 grep --color=auto nginx</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#æµ‹è¯•</span><br><span class="line">[root@Nginx logs]# echo timinglee &gt; /usr/local/nginx/html/index.html</span><br><span class="line"></span><br><span class="line">[root@Nginx logs]# curl  172.25.254.100</span><br><span class="line">timinglee</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äº‘åŸç”Ÿ </tag>
            
            <tag> liunx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­å»ºç°ä»£åŒ–æµè§ˆå™¨å¯¼èˆªç«™</title>
      <link href="/2026/02/01/Con-Nav-Item%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97/"/>
      <url>/2026/02/01/Con-Nav-Item%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<h1 id="Con-Nav-Item-ç°ä»£åŒ–ä¸ªäººå¯¼èˆªç«™"><a href="#Con-Nav-Item-ç°ä»£åŒ–ä¸ªäººå¯¼èˆªç«™" class="headerlink" title="Con-Nav-Item - ç°ä»£åŒ–ä¸ªäººå¯¼èˆªç«™"></a>Con-Nav-Item - ç°ä»£åŒ–ä¸ªäººå¯¼èˆªç«™</h1><p>Con-Nav-Item æ˜¯ä¸€æ¬¾ä¸“ä¸ºæ•°å­—åŒ–å·¥ä½œè€…æ‰“é€ çš„ç°ä»£åŒ–ä¸ªäººå¯¼èˆªç³»ç»Ÿã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªé“¾æ¥æ”¶è—å¤¹ï¼Œæ›´æ˜¯ä¸€ä¸ªé›†æˆäº† AI æ™ºèƒ½ç”Ÿæˆã€å¤šç«¯åŒæ­¥ã€å¡ç‰‡åŒ–ç®¡ç†å’Œæµè§ˆå™¨æ·±åº¦é›†æˆçš„å…¨èƒ½å·¥ä½œå°ã€‚<a href="https://github.com/zczy-k/Con-Nav-Item?tab=readme-ov-file">Con-Nav-Item: æ–°ä¸€ä»£å¯¼èˆªç½‘ç«™,Aié›†æˆ</a></p><h2 id="1-åŸºäºDockeréƒ¨ç½²"><a href="#1-åŸºäºDockeréƒ¨ç½²" class="headerlink" title="1.åŸºäºDockeréƒ¨ç½²"></a>1.åŸºäºDockeréƒ¨ç½²</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name Con-Nav-Item \</span><br><span class="line">  -p 3000:3000 \</span><br><span class="line">  -v $(<span class="built_in">pwd</span>)/database:/app/database \</span><br><span class="line">  -v $(<span class="built_in">pwd</span>)/backups:/app/backups \</span><br><span class="line">  -e ADMIN_USERNAME=admin \</span><br><span class="line">  -e ADMIN_PASSWORD=123456 \</span><br><span class="line">  --restart unless-stopped \</span><br><span class="line">  ghcr.io/zczy-k/con-nav-item:latest</span><br></pre></td></tr></table></figure><h2 id="2-åˆå§‹åŒ–é…ç½®-å®‰è£…åå¿…çœ‹"><a href="#2-åˆå§‹åŒ–é…ç½®-å®‰è£…åå¿…çœ‹" class="headerlink" title="2.åˆå§‹åŒ–é…ç½® (å®‰è£…åå¿…çœ‹)"></a>2.åˆå§‹åŒ–é…ç½® (å®‰è£…åå¿…çœ‹)</h2><ol><li><strong>è®¿é—®åå°</strong>ï¼šæ‰“å¼€ <code>http://ä½ çš„IP:3000/admin</code></li><li><strong>é»˜è®¤è´¦å·</strong>ï¼šç”¨æˆ·å <code>admin</code>ï¼Œå¯†ç  <code>123456</code>ã€‚</li><li><strong>å®‰å…¨ä¿®æ”¹</strong>ï¼šè¿›å…¥ <strong>[ç”¨æˆ·ç®¡ç†]</strong> èœå•ï¼Œç¬¬ä¸€æ—¶é—´ä¿®æ”¹ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç ã€‚</li><li><strong>é…ç½® AI</strong>ï¼šè¿›å…¥ **[AI æ™ºèƒ½ç”Ÿæˆ]**ï¼Œå¡«å…¥ä½ çš„ API Keyï¼ˆæ¨è DeepSeekï¼‰ï¼Œæµ‹è¯•é€šè¿‡åå³å¯äº«å—ä¸€é”®ç”ŸæˆåŠŸèƒ½ã€‚</li></ol><h2 id="3-æµè§ˆå™¨æ’ä»¶å®‰è£…"><a href="#3-æµè§ˆå™¨æ’ä»¶å®‰è£…" class="headerlink" title="3.æµè§ˆå™¨æ’ä»¶å®‰è£…"></a>3.æµè§ˆå™¨æ’ä»¶å®‰è£…</h2><ol><li>å‰å¾€ <a href="https://github.com/zczy-k/Con-Nav-Item/releases">Releases</a> ä¸‹è½½æœ€æ–° <code>browser-extension.zip</code>ã€‚</li><li>è§£å‹åï¼Œåœ¨ Chrome&#x2F;Edge æµè§ˆå™¨è¿›å…¥ <code>chrome://extensions/</code>ã€‚</li><li>å¼€å¯ <strong>å¼€å‘è€…æ¨¡å¼</strong>ï¼Œé€‰æ‹© <strong>åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº</strong>ã€‚</li><li>åœ¨æ’ä»¶è®¾ç½®ä¸­å¡«å…¥ä½ çš„å¯¼èˆªç«™åœ°å€å’Œå¯†ç ï¼Œå®Œæˆç»‘å®šã€‚</li></ol><h2 id="4-ä½¿ç”¨"><a href="#4-ä½¿ç”¨" class="headerlink" title="4.ä½¿ç”¨"></a>4.ä½¿ç”¨</h2><ol><li>åœ¨åå°æ·»åŠ ä¸€ä¸ªåªå†™äº†â€œURLâ€çš„å¡ç‰‡ã€‚</li><li>å‹¾é€‰è¯¥å¡ç‰‡ï¼Œç‚¹å‡» <strong>æ‰¹é‡ AI ç”Ÿæˆ</strong>ã€‚</li><li>AI ä¼šè‡ªåŠ¨çˆ¬å–æ ‡é¢˜ã€æè¿°ã€å›¾æ ‡å¹¶åˆ†ç±»ï¼Œç‚¹å‡»â€œè¦†ç›–â€æˆ–â€œè¡¥å…¨â€ä¿å­˜ã€‚</li></ol><h2 id="5-å‡çº§ä¸å¸è½½"><a href="#5-å‡çº§ä¸å¸è½½" class="headerlink" title="5.å‡çº§ä¸å¸è½½"></a>5.å‡çº§ä¸å¸è½½</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. æ‹‰å–é•œåƒ</span></span><br><span class="line">docker pull ghcr.io/zczy-k/con-nav-item:latest</span><br><span class="line"><span class="comment"># 2. åˆ é™¤å®¹å™¨ (æ•°æ®ä¸ä¼šä¸¢)</span></span><br><span class="line">docker stop Con-Nav-Item &amp;&amp; docker <span class="built_in">rm</span> Con-Nav-Item</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åˆ†äº« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯¼èˆªæ  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»é›¶å¼€å§‹æ­å»ºå›¾åºŠ</title>
      <link href="/2026/02/01/PicGo%E5%9B%BE%E5%BA%8A%E6%90%AD%E5%BB%BA%E6%8C%87%E5%8D%97/"/>
      <url>/2026/02/01/PicGo%E5%9B%BE%E5%BA%8A%E6%90%AD%E5%BB%BA%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<h1 id="å›¾åºŠæ­å»ºï¼ˆCloudflare-R2-WebP-Cloud-PicGoï¼‰"><a href="#å›¾åºŠæ­å»ºï¼ˆCloudflare-R2-WebP-Cloud-PicGoï¼‰" class="headerlink" title="å›¾åºŠæ­å»ºï¼ˆCloudflare R2 + WebP Cloud + PicGoï¼‰"></a>å›¾åºŠæ­å»ºï¼ˆCloudflare R2 + WebP Cloud + PicGoï¼‰</h1><h2 id="1-å‰è¨€"><a href="#1-å‰è¨€" class="headerlink" title="1.å‰è¨€"></a>1.å‰è¨€</h2><p>å›¾åºŠæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿä»åå­—ä¸Šçœ‹å°±çŸ¥é“æ˜¯ä¸€ä¸ªä¸“é—¨å‚¨å­˜å›¾ç‰‡çš„ä»“åº“ï¼Œå¯ä»¥æå¤§èŠ‚çœå¤§é‡å›¾ç‰‡å¸¦æ¥çš„èµ„æºæ¶ˆè€—ï¼Œæ¯”å¦‚ç”¨åœ¨ç½‘ç«™ä¸Šï¼Œä»¥å‡å°‘å›¾ç‰‡å¤§é‡å †ç§¯è€Œå¯¼è‡´æœåŠ¡å™¨è¿‡è½½ï¼›ä¹Ÿå¯ä»¥ç”¨åœ¨ç¬”è®°é‡Œï¼Œå‡å°‘ç¬”è®°çš„æ€»ä½“å¤§å°ä»¥åŠå›¾ç‰‡è·¯å¾„å¯¼è‡´å›¾ç‰‡æ— æ³•åŠ è½½çš„é—®é¢˜ã€‚</p><p>æ€»ä¹‹ï¼Œå›¾åºŠçš„æ ¸å¿ƒåŠŸèƒ½å°±æ˜¯è·¨å¹³å°è®¿é—®ã€é™ä½èµ„æºæ¶ˆè€—ã€æ–¹ä¾¿ç®¡ç†ç­‰ã€‚æœ¬æ¬¡å›¾åºŠæ­å»ºä¸»è¦æ˜¯åŸºäº<code>Cloudflare R2 + WebP Cloud + PicGo</code>è€Œæ­å»ºçš„ã€‚</p><h2 id="2-ä»é›¶å¼€å§‹æ­å»ºå›¾åºŠ"><a href="#2-ä»é›¶å¼€å§‹æ­å»ºå›¾åºŠ" class="headerlink" title="2.ä»é›¶å¼€å§‹æ­å»ºå›¾åºŠ"></a>2.ä»é›¶å¼€å§‹æ­å»ºå›¾åºŠ</h2><h3 id="2-1-é…ç½®Cloudflare-R2"><a href="#2-1-é…ç½®Cloudflare-R2" class="headerlink" title="2.1.é…ç½®Cloudflare R2"></a>2.1.é…ç½®Cloudflare R2</h3><p>R2 æ˜¯ Cloudflare æ¨å‡ºçš„å…è´¹å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œéœ€è¦å…è´¹æ³¨å†Œä¸€ä¸ª <a href="https://dash.cloudflare.com/1dc74a6575af68307104f0a3b835e5dd/r2/overview">Cloudflare è´¦å·</a>æ‰èƒ½ä½¿ç”¨ã€‚å¹¶ä¸”éœ€è¦å…ˆç»‘å®šå¥½ä¿¡ç”¨å¡ï¼Œå¡«å†™å¥½ä¿¡æ¯åæ‰èƒ½è®¢é˜…æœåŠ¡ã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-02-29.png" alt="PixPin_2026-01-20_22-02-29" style="zoom: 44%;" /> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-09-37.png" alt="PixPin_2026-01-20_22-09-37" style="zoom: 52%;" /> <p>è®¢é˜…ä¹‹åï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ª â€œå­˜å‚¨åº“â€ ã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-20-15.png" alt="PixPin_2026-01-20_22-20-15" style="zoom: 50%;" /><p>éœ€è¦å¡«å†™å­˜å‚¨æ¡¶ï¼ˆBucketï¼‰åç§°ï¼Œå»ºè®®æœ‰ä¸€äº›è¾¨è¯†åº¦ï¼Œåç»­åœ¨é…ç½®ä¸Šä¼ æ—¶ä¼šç”¨åˆ°ã€‚ä½ç½®å’Œé»˜è®¤å­˜å‚¨åº“å¯æ ¹æ®è‡ªå·±éœ€æ±‚é…ç½®ï¼Œéšåç‚¹å‡»è“è‰²æŒ‰é’®åˆ›å»ºå®Œæˆã€‚</p><img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-20-56.png" alt="PixPin_2026-01-20_22-20-56" style="zoom:50%;" /> <p>åˆ›å»ºæˆåŠŸåç‚¹å‡» <code>è®¾ç½®</code> ï¼Œè¿›å…¥ä¸‹é¢é¡µé¢ï¼Œè®°ä½S3 APIçš„å€¼å¹¶ä¸”å¯ç”¨å…¬å…±å¼€å‘URLã€‚å¯ç”¨åå¯è·å¾—ä¸€ä¸ªå…¬ç½‘åœ°å€ã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-21-46.png" alt="PixPin_2026-01-20_22-21-46" style="zoom: 67%;" /><p>å°†è¿™ä¸ªå…¬å…±URLä¹Ÿç»™è®°å½•å¥½ï¼Œåç»­è¦ç”¨åˆ°ã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-28-18.png" alt="PixPin_2026-01-20_22-28-18" style="zoom: 50%;" /><p>å®Œæˆä¸Šé¢çš„è®¾ç½®åï¼Œè¿”å›<code>æ¦‚è¿°</code>é¡µé¢ï¼Œç„¶ååˆ›å»ºAPIä»¤ç‰Œã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-28-59.png" alt="PixPin_2026-01-20_22-28-59" style="zoom:50%;" /> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-29-21.png" alt="PixPin_2026-01-20_22-29-21" style="zoom:50%;" /><p>å¹¶ä¸”å®Œæˆä¸‹é¢çš„é…ç½®åä¿å­˜ã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-29-52.png" alt="PixPin_2026-01-20_22-29-52" style="zoom:50%;" /><p>ä»¤ç‰Œåç§°å¯è‡ªå·±éšæ„è®¾å®šï¼Œæƒé™é€‰æ‹©ç¬¬ä¸‰ä¸ªï¼Œä¿è¯æ–‡ä»¶èƒ½å¤Ÿå†™å…¥ä¸è¯»å–ï¼Œå¹¶ä¸”å°†è¿™ä¸ªAPIæŒ‡å®šåˆ°åˆšæ‰åˆ›å»ºå¥½çš„<code>images</code>ä»“åº“ã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-30-04.png" alt="PixPin_2026-01-20_22-30-04" style="zoom:50%;" /><p>å†åˆ›å»ºå®ŒAPIä»¤ç‰Œåè¿›å…¥ä¸‹é¢é¡µé¢ï¼Œå¹¶ä¸”å°†ä¸‹é¢çš„è®¿é—®å¯†é’¥IDä¸æœºå¯†è®¿é—®å¯†é’¥è®°å½•ä¿å­˜ï¼Œè¿™ä¸¤ä¸ªä¹‹åæ— æ³•æŸ¥è¯¢åˆ°ã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-30-42.png" alt="PixPin_2026-01-20_22-30-42" style="zoom:50%;" /><h3 id="2-2-WebP-Cloud-å›¾ç‰‡ä¼˜åŒ–"><a href="#2-2-WebP-Cloud-å›¾ç‰‡ä¼˜åŒ–" class="headerlink" title="2.2.WebP Cloud å›¾ç‰‡ä¼˜åŒ–"></a>2.2.WebP Cloud å›¾ç‰‡ä¼˜åŒ–</h3><p>é¦–å…ˆï¼Œåˆ°<a href="https://dashboard.webp.se/">WebP Cloude</a>å®˜ç½‘æ³¨å†Œç™»å½•åï¼Œåˆ›å»ºä¸€ä¸ªä»£ç†ã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-32-16.png" alt="PixPin_2026-01-20_22-32-16" style="zoom: 40%;" /><p>ä»£ç†åŒºåŸŸé€‰æ‹©ä¸åº“å½“æ—¶è®¾å®šçš„åœ°åŒºæœ€è¿‘çš„åœ°æ–¹ï¼Œä»£ç†åç§°å¯è‡ªå®šä¹‰ï¼Œæºç«™åœ°å€ä¸ºåº“çš„å…¬å…±URL&#x2F;è‡ªå®šä¹‰URLï¼Œå®Œæˆç›¸å…³é…ç½®åä¿å­˜ã€‚</p><p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-38-20.png" alt="PixPin_2026-01-20_22-38-20" style="zoom: 67%;" />  <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-39-03.png" alt="PixPin_2026-01-20_22-39-03" style="zoom: 40%;" /></p><p>å®Œæˆé…ç½®åå¯åœ¨æˆ‘çš„ä»£ç†ä¸­æŸ¥çœ‹ä»£ç†åœ°å€ï¼Œå¹¶ä¸”ä¿å­˜å¥½ä»£ç†åœ°å€ã€‚</p><h3 id="2-3-PicGo-å·¥å…·"><a href="#2-3-PicGo-å·¥å…·" class="headerlink" title="2.3.PicGo å·¥å…·"></a>2.3.PicGo å·¥å…·</h3><p>PicGo æœ¬ä½“å¹¶ä¸åŒ…æ‹¬ S3 å›¾åºŠï¼Œä½†å¯ä»¥é€šè¿‡ã€Œ<a href="https://sspai.com/link?target=https://github.com/wayjam/picgo-plugin-s3">GitHub - wayjam&#x2F;picgo-plugin-s3</a>ã€æ’ä»¶æ¥æ”¯æŒã€‚æˆ–è€…ï¼Œç›´æ¥åœ¨æ’ä»¶è®¾ç½®ç›´æ¥æœç´¢ç›¸å…³æ’ä»¶å¹¶ä¸”å®‰è£…ã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-39-33.png" alt="PixPin_2026-01-20_22-39-33" style="zoom: 67%;" /><p>æ’ä»¶å®‰è£…å¥½åï¼Œå¯ä»¥åœ¨<code>å›¾åºŠè®¾ç½®</code>é‚£ä¸€æ ç›´æ¥ç¼–è¾‘Amazon S3 ã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-39-42.png" alt="PixPin_2026-01-20_22-39-42" style="zoom:67%;" /><p>éšåå®Œæˆä»¥ä¸‹7ä¸ªé…ç½®ã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-41-56.png" alt="PixPin_2026-01-20_22-41-56" style="zoom:67%;" /><ul><li><strong>å›¾åºŠé…ç½®å</strong> ï¼Œæ ¹æ®å–œå¥½å¡«å†™ã€‚</li><li><strong>åº”ç”¨å¯†é’¥ ID</strong>ï¼Œå¡«å†™ R2 API ä¸­çš„ Access Key IDï¼ˆè®¿é—®å¯†é’¥ IDï¼‰</li><li><strong>åº”ç”¨å¯†é’¥</strong>ï¼Œå¡«å†™ R2 API ä¸­çš„ Secret Access Keyï¼ˆæœºå¯†è®¿é—®å¯†é’¥ï¼‰</li><li><strong>æ¡¶å</strong>ï¼Œå¡«å†™ R2 ä¸­åˆ›å»ºçš„ Bucket åç§°ï¼Œå¦‚æˆ‘ä¸Šæ–‡çš„ <code>images</code></li><li><strong>æ–‡ä»¶è·¯å¾„</strong>ï¼Œä¸Šä¼ åˆ° R2 ä¸­çš„æ–‡ä»¶è·¯å¾„ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨ <code>&#123;fileName&#125;.&#123;extName&#125;</code> æ¥ä¿ç•™åŸæ–‡ä»¶çš„æ–‡ä»¶åå’Œæ‰©å±•åã€‚</li><li><strong>è‡ªå®šä¹‰èŠ‚ç‚¹</strong>ï¼Œå¡«å†™ R2 API ä¸­çš„ <code>S3 API</code>ä»“åº“åå‰é¢çš„åŸŸåï¼Œ<code>/</code> åé¢ä¸ºæƒ³è¦ä¿å­˜çš„åœ°ç‚¹ã€‚ </li><li><strong>è‡ªå®šä¹‰è¾“å‡ºURLæ¨¡æ¿</strong>ï¼Œå¡«å†™ä»£ç†åŸŸåä»¥åŠè·¯å¾„ï¼Œå¯å‚è€ƒç¤ºä¾‹7</li></ul> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-43-41.png" alt="PixPin_2026-01-20_22-43-41" style="zoom:67%;" /><p>å®Œæˆæ‰€æœ‰é…ç½®åç‚¹å‡»ä¿å­˜ï¼Œç„¶åè¿›è¡Œæµ‹è¯•</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-43-57.png" alt="PixPin_2026-01-20_22-43-57" style="zoom:67%;" /><p>éšä¾¿ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡è¿›è¡Œæµ‹è¯•ï¼Œå¦‚æœæ˜¾ç¤ºä¸Šä¼ æˆåŠŸï¼Œåˆ™å›¾åºŠæ­å»ºæˆåŠŸï¼›å¦‚è‹¥æ˜¾ç¤ºä¸Šä¼ å¤±è´¥ï¼Œå¤§æ¦‚ç‡æ˜¯ä¸Šé¢çš„é…ç½®å‡ºé”™äº†ã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-49-34.png" alt="PixPin_2026-01-20_22-49-34" style="zoom: 150%;" /><p>ç„¶åå›åˆ°Cloudflare R2çš„åº“ä¸­æŸ¥çœ‹æ˜¯å¦å†™å…¥å¯¹åº”è·¯å¾„ï¼Œå¯ä»¥çœ‹åˆ°å›¾ç‰‡å·²ç»å†™å…¥åº“ä¸­ç›¸åº”ç›®å½•ã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_22-49-53.png" alt="PixPin_2026-01-20_22-49-53" style="zoom: 50%;" /><h2 id="3-ä¸typoraè”åŠ¨"><a href="#3-ä¸typoraè”åŠ¨" class="headerlink" title="3.ä¸typoraè”åŠ¨"></a>3.ä¸typoraè”åŠ¨</h2><p>æ­å»ºå›¾åºŠçš„ä¸»è¦ç›®çš„è¿˜æ˜¯ä¸ºäº†æ–¹ä¾¿è®°ç¬”è®°ï¼Œæ‰€ä»¥è¿™é‡Œä»¥Typoraä¸ºä¾‹ã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_23-32-51.png" alt="PixPin_2026-01-20_23-32-51"  /><p>é¦–å…ˆæ‰“å¼€æ–‡ä»¶â€”&gt;åå¥½è®¾ç½®â€”&gt;å›¾åƒâ€”&gt;ä¸Šä¼ æœåŠ¡è®¾å®šã€‚</p> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_23-33-17.png" alt="PixPin_2026-01-20_23-33-17" style="zoom: 50%;" /><p>å°†ä¸Šä¼ æœåŠ¡å’ŒPicGOè·¯å¾„æ”¹åã€‚ä¹‹åå›åˆ°ç¬”è®°éšä¾¿æ’å…¥ä¸€å¼ å›¾ç‰‡ï¼Œç„¶åå³å‡»å›¾ç‰‡å®Œæˆä¸Šä¼ å›¾ç‰‡ã€‚</p><blockquote> <img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_23-36-47.png" alt="PixPin_2026-01-20_23-36-47"  /></blockquote><p>å¯ä»¥çœ‹åˆ°ä¸Šä¼ æˆåŠŸåï¼Œä¼šè‡ªåŠ¨å˜æ›´åœ°å€ï¼Œä»ä¹‹å‰çš„ç»å¯¹è·¯å¾„æ›´æ¢ä¸ºç½‘ç»œåœ°å€ï¼Œå¹¶ä¸”å³ä¸‹è§’æ˜¾ç¤ºä¸Šä¼ æˆåŠŸå¼¹çª—ã€‚</p><blockquote><p><img src="https://d1aa036.webp.li/Build/PixPin_2026-01-20_23-37-26.png" alt="PixPin_2026-01-20_23-37-26"></p></blockquote><p>è‡³æ­¤å›¾åºŠçš„æ­å»ºå·²å…¨éƒ¨å®Œæˆã€‚</p><p><strong>ç¼–è¾‘è€…</strong>ï¼š<span style="color:#0000CC;"><code>kaituemi</code></span></p>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾åºŠ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RHCE-Linuxçš„åŸºç¡€éƒ¨åˆ†ç¬”è®°</title>
      <link href="/2026/02/01/RHCE%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"/>
      <url>/2026/02/01/RHCE%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="25-10-16-SSH"><a href="#25-10-16-SSH" class="headerlink" title="25-10-16(SSH)"></a>25-10-16(SSH)</h1><h2 id="1-SSHç†è®º"><a href="#1-SSHç†è®º" class="headerlink" title="1.SSHç†è®º"></a>1.SSHç†è®º</h2><p><strong>ç†è®ºéƒ¨åˆ†å‚è€ƒ</strong>   <a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/01ssh%E7%90%86%E8%AE%BA.md">è·³è½¬</a></p><ul><li><p>æŸ¥çœ‹ sshd æ˜¯å¦ä½¿ç”¨</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>systemctl status sshd</td><td>æŸ¥è¯¢ <code>sshd</code> æœåŠ¡çš„<strong>è¿è¡ŒçŠ¶æ€</strong></td></tr><tr><td>netstat -intup | grep sshd</td><td>æŸ¥è¯¢ <code>sshd</code> æœåŠ¡å¯¹åº”çš„<strong>ç½‘ç»œè¿æ¥ã€ç›‘å¬ç«¯å£</strong></td></tr><tr><td>ps -aux  | grep sshd</td><td>æŸ¥è¯¢ç³»ç»Ÿä¸­æ‰€æœ‰å’Œ <code>sshd</code> ç›¸å…³çš„<strong>è¿›ç¨‹è¯¦æƒ…</strong></td></tr></tbody></table></li><li><p>åŸç†å›¾</p></li></ul><p> <img src="https://b5dbf24.webp.li/image-20251018135704473.png" alt="image-20251018135704473"></p><blockquote><p>yum whatprocides netstat â€“æŸ¥çœ‹è¯¥å‘½ä»¤æ‰€éœ€è½¯ä»¶ï¼ˆâ€“&gt;ä¸‹è½½net-toolsï¼‰</p></blockquote><ul><li>å…³é”®é…ç½®ï¼š<ul><li>ç«¯å£ä¿®æ”¹ï¼ˆ<code>Port</code>ï¼Œé»˜è®¤ 22ï¼Œå»ºè®®è‡ªå®šä¹‰æé«˜å®‰å…¨æ€§ï¼‰ã€‚</li><li>ç¦ç”¨å¯†ç è®¤è¯ï¼ˆ<code>PasswordAuthentication no</code>ï¼‰ï¼Œå¼ºåˆ¶å…¬é’¥è®¤è¯ã€‚</li><li>ç¦ç”¨ root ç›´æ¥ç™»å½•ï¼ˆ<code>PermitRootLogin no</code>ï¼‰ï¼Œé€šè¿‡æ™®é€šç”¨æˆ· sudo ææƒã€‚</li><li>é™åˆ¶å…è®¸ç™»å½•çš„ç”¨æˆ·ï¼ˆ<code>AllowUsers</code>ï¼‰æˆ–ç»„ï¼ˆ<code>AllowGroups</code>ï¼‰</li></ul></li></ul><h2 id="2-SSHå®éªŒ"><a href="#2-SSHå®éªŒ" class="headerlink" title="2.SSHå®éªŒ"></a>2.SSHå®éªŒ</h2><h3 id="2-1-ä¿®æ”¹SSHç«¯å£"><a href="#2-1-ä¿®æ”¹SSHç«¯å£" class="headerlink" title="2.1 ä¿®æ”¹SSHç«¯å£"></a>2.1 ä¿®æ”¹SSHç«¯å£</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é…ç½®(/etc/ssh/sshd_config)(æœåŠ¡å™¨é…ç½®)</span></span><br><span class="line">[root@ssh ~]# vim /etc/ssh/sshd_config</span><br><span class="line">21 <span class="comment">#Port 22#æ”¹ç«¯å£å·</span></span><br><span class="line">22 Port 666</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å…³é—­é˜²ç«å¢™å’Œåˆ‡æ¢å®½å®¹æ¨¡å¼</span></span><br><span class="line">[root@ssh ~]# systemctl --now <span class="built_in">disable</span> firewalld</span><br><span class="line">[root@ssh ~]# setenforce 0</span><br><span class="line">[root@ssh ~]# getenforce</span><br><span class="line"><span class="comment">#é‡å¯æœåŠ¡</span></span><br><span class="line">[root@ssh ~]# systemctl restart sshd</span><br></pre></td></tr></table></figure><p> <img src="https://d1aa036.webp.li/Build/image-20260130002411974.png" alt="image-20260130002411974"></p><h3 id="2-2-æ‹’ç»rootç”¨æˆ·è¿œç¨‹ç™»å½•"><a href="#2-2-æ‹’ç»rootç”¨æˆ·è¿œç¨‹ç™»å½•" class="headerlink" title="2.2 æ‹’ç»rootç”¨æˆ·è¿œç¨‹ç™»å½•"></a>2.2 æ‹’ç»rootç”¨æˆ·è¿œç¨‹ç™»å½•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é…ç½®(/etc/ssh/sshd_config)(æœåŠ¡å™¨é…ç½®)</span></span><br><span class="line">[root@ssh ~]# vim /etc/ssh/sshd_config</span><br><span class="line"><span class="comment">#æ”¹å‚æ•°</span></span><br><span class="line">    <span class="comment"># PermitRootLogin yes   ---&gt;</span></span><br><span class="line">    PermitRootLogin no</span><br><span class="line">[root@ssh ~]# systemctl restart sshd</span><br><span class="line"><span class="comment">#(------è‹¥ä¸ç”Ÿæ•ˆ------)</span></span><br><span class="line"><span class="comment">#é…ç½®(/etc/ssh/sshd_config.d/01-permitrootlogin.conf)</span></span><br><span class="line">[root@ssh ~]# vim /etc/ssh/sshd_config.d/01-permitrootlogin.conf</span><br><span class="line">    <span class="comment"># PermitRootLogin yes   ---&gt;</span></span><br><span class="line">    PermitRootLogin no</span><br><span class="line">[root@ssh ~]# systemctl restart sshd</span><br></pre></td></tr></table></figure><p> <img src="https://d1aa036.webp.li/Build/image-20260130003058267.png" alt="image-20260130003058267"></p><h3 id="2-3-å…è®¸ç‰¹å®šç”¨æˆ·sshç™»å½•ï¼Œå…¶ä½™ç”¨æˆ·æ— æ³•ç™»å½•ï¼ˆåŒ…æ‹¬rootç”¨æˆ·ï¼‰"><a href="#2-3-å…è®¸ç‰¹å®šç”¨æˆ·sshç™»å½•ï¼Œå…¶ä½™ç”¨æˆ·æ— æ³•ç™»å½•ï¼ˆåŒ…æ‹¬rootç”¨æˆ·ï¼‰" class="headerlink" title="2.3 å…è®¸ç‰¹å®šç”¨æˆ·sshç™»å½•ï¼Œå…¶ä½™ç”¨æˆ·æ— æ³•ç™»å½•ï¼ˆåŒ…æ‹¬rootç”¨æˆ·ï¼‰"></a>2.3 å…è®¸ç‰¹å®šç”¨æˆ·sshç™»å½•ï¼Œå…¶ä½™ç”¨æˆ·æ— æ³•ç™»å½•ï¼ˆåŒ…æ‹¬rootç”¨æˆ·ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é…ç½®(/etc/ssh/sshd_config)(æœåŠ¡å™¨é…ç½®)</span></span><br><span class="line">[root@ssh ~]# vim /etc/ssh/sshd_config</span><br><span class="line"><span class="comment">#æ”¹å‚æ•°</span></span><br><span class="line">    <span class="comment">#AllowUsers USERNAME ---&gt;</span></span><br><span class="line">    AllowUsers zhangsan</span><br><span class="line"><span class="comment">#é‡å¯æœåŠ¡</span></span><br><span class="line">[root@ssh ~]# systemctl restart sshd</span><br><span class="line"><span class="comment">#æ³¨ï¼š</span></span><br><span class="line"><span class="comment">#USERNAMEéœ€è¦å­˜åœ¨ï¼Œå¤šä¸ªç”¨æˆ·ä¹‹é—´ä½¿ç”¨ç©ºæ ¼éš”å¼€</span></span><br><span class="line"></span><br><span class="line">[root@ssh ~]# systemctl restart sshd</span><br><span class="line">[root@ssh ~]# useradd zhangsan</span><br><span class="line">[root@ssh ~]# passwd zhangsan</span><br><span class="line">æ›´æ”¹ç”¨æˆ· zhangsan çš„å¯†ç  ã€‚</span><br><span class="line">æ–°çš„å¯†ç ï¼š </span><br><span class="line">æ— æ•ˆçš„å¯†ç ï¼š å¯†ç å°‘äº 8 ä¸ªå­—ç¬¦</span><br><span class="line">é‡æ–°è¾“å…¥æ–°çš„å¯†ç ï¼š </span><br><span class="line">passwdï¼šæ‰€æœ‰çš„èº«ä»½éªŒè¯ä»¤ç‰Œå·²ç»æˆåŠŸæ›´æ–°ã€‚</span><br></pre></td></tr></table></figure><p><img src="https://d1aa036.webp.li/Build/image-20260130003746580.png" alt="image-20260130003746580"></p><h3 id="2-4-liunxå®¢æˆ·ç«¯é€šè¿‡å¯†é’¥ç™»å½•liunxæœåŠ¡ç«¯rootç”¨æˆ·"><a href="#2-4-liunxå®¢æˆ·ç«¯é€šè¿‡å¯†é’¥ç™»å½•liunxæœåŠ¡ç«¯rootç”¨æˆ·" class="headerlink" title="2.4 liunxå®¢æˆ·ç«¯é€šè¿‡å¯†é’¥ç™»å½•liunxæœåŠ¡ç«¯rootç”¨æˆ·"></a>2.4 liunxå®¢æˆ·ç«¯é€šè¿‡å¯†é’¥ç™»å½•liunxæœåŠ¡ç«¯rootç”¨æˆ·</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æœåŠ¡ç«¯(æ— éœ€æ“ä½œ)</span></span><br><span class="line"><span class="comment">#å®¢æˆ·ç«¯ï¼š</span></span><br><span class="line"><span class="comment">#1.åˆ›å»ºå¯†é’¥å¯¹</span></span><br><span class="line">[root@client ~]# ssh-keygen -t rsa</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/root/.ssh/id_rsa): </span><br><span class="line">/root/.ssh/id_rsa already exists.</span><br><span class="line">Overwrite (y/n)? y</span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /root/.ssh/id_rsa</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.pub</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:RiUr92e99iK9aId8lj91L+LfIPOwMO/GBW8+TLMcN6Q root@client</span><br><span class="line">The key<span class="string">&#x27;s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 3072]----+</span></span><br><span class="line"><span class="string">|        . .      |</span></span><br><span class="line"><span class="string">|         +       |</span></span><br><span class="line"><span class="string">|      . +        |</span></span><br><span class="line"><span class="string">|       + .  .. . |</span></span><br><span class="line"><span class="string">|        S . oo+  |</span></span><br><span class="line"><span class="string">|       .   o EBo+|</span></span><br><span class="line"><span class="string">|          oo+X+*=|</span></span><br><span class="line"><span class="string">|           +OO#=.|</span></span><br><span class="line"><span class="string">|           =*B+*=|</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#2.å°†å…¬ç¥å‘é€è‡³æœåŠ¡ç«¯(ç”¨æˆ·çš„å®¶ç›®å½•çš„.ssh/authorized_keys)</span></span><br><span class="line"><span class="string">[root@client ~]# ssh-copy-id root@172.25.254.129</span></span><br><span class="line"><span class="string">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &quot;/root/.ssh/id_rsa.pub&quot;</span></span><br><span class="line"><span class="string">/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed</span></span><br><span class="line"><span class="string">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys</span></span><br><span class="line"><span class="string">root@172.25.254.129&#x27;</span>s password: </span><br><span class="line"></span><br><span class="line">Number of key(s) added: 1</span><br><span class="line"></span><br><span class="line">Now try logging into the machine, with:   <span class="string">&quot;ssh &#x27;root@172.25.254.129&#x27;&quot;</span></span><br><span class="line">and check to make sure that only the key(s) you wanted were added.</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.å®¢æˆ·ç«¯å…å¯†ç™»å½•</span></span><br><span class="line">[root@client ~]# ssh root@172.25.254.129</span><br></pre></td></tr></table></figure><blockquote><p>ssh-keygen (ç”Ÿæˆã€ç®¡ç†å’Œè½¬æ¢è®¤è¯å¯†é’¥)     -t (åˆ¶å®šç±»å‹ RSA)<br>    &#x2F;root&#x2F;.ssh&#x2F;id_rsa  â€”â€”  ç§é’¥æ–‡ä»¶<br>   &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub  â€”â€“  å…¬é’¥æ–‡ä»¶</p></blockquote><p><img src="https://d1aa036.webp.li/Build/image-20260130004928605.png" alt="image-20260130004928605"></p><h3 id="2-5-windowså®¢æˆ·ç«¯é€šè¿‡ç§˜é’¥ç™»å½•linuxæœåŠ¡ç«¯rootç”¨æˆ·"><a href="#2-5-windowså®¢æˆ·ç«¯é€šè¿‡ç§˜é’¥ç™»å½•linuxæœåŠ¡ç«¯rootç”¨æˆ·" class="headerlink" title="2.5 windowså®¢æˆ·ç«¯é€šè¿‡ç§˜é’¥ç™»å½•linuxæœåŠ¡ç«¯rootç”¨æˆ·"></a>2.5 windowså®¢æˆ·ç«¯é€šè¿‡ç§˜é’¥ç™»å½•linuxæœåŠ¡ç«¯rootç”¨æˆ·</h3><blockquote><p>ä¸Šä¼ è‡³<span style="text-decoration:underline;">autgorized_keys</span></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1ã€ç”Ÿæˆå…¬ç§é’¥å¯¹</span></span><br><span class="line">ssh-keygen -t rsa</span><br><span class="line"><span class="comment">#2ã€å°†å…¬é’¥ä¸Šä¼ åˆ°æœåŠ¡å™¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3ã€æµ‹è¯•å…å¯†ç™»å½•</span></span><br><span class="line">ssh  root@192.168.223.5</span><br><span class="line"><span class="comment">#4.ä½¿ç”¨XShellè‡ªå¸¦çš„å¯†é’¥ç”Ÿæˆå¯†é’¥å¯¹ï¼Œç„¶åå¤åˆ¶åˆ°æœåŠ¡å™¨ä¸Š</span></span><br></pre></td></tr></table></figure><blockquote><p>â€‹             åŠ å¯† </p><p>å…¬é’¥&lt;â€”â€”â€”â€”&gt;ç§é’¥</p><p>â€‹    è§£å¯†</p></blockquote><h2 id="3-SSHåè®®åŸç†"><a href="#3-SSHåè®®åŸç†" class="headerlink" title="3. SSHåè®®åŸç†"></a>3. SSHåè®®åŸç†</h2><h3 id="3-1-è¿æ¥è¿‡ç¨‹"><a href="#3-1-è¿æ¥è¿‡ç¨‹" class="headerlink" title="3.1 è¿æ¥è¿‡ç¨‹"></a>3.1 è¿æ¥è¿‡ç¨‹</h3> <img src="https://b5dbf24.webp.li/image-20251012105145531.png" alt="image-20251012105145531"  /><p><strong>è¯´æ˜</strong> </p><p> <img src="https://b5dbf24.webp.li/image-20251012105343249.png" alt="image-20251012105343249"></p><h3 id="3-2-ä¸¤ç§è®¤è¯æ–¹å¼"><a href="#3-2-ä¸¤ç§è®¤è¯æ–¹å¼" class="headerlink" title="3.2 ä¸¤ç§è®¤è¯æ–¹å¼"></a>3.2 ä¸¤ç§è®¤è¯æ–¹å¼</h3><ul><li>å¯†ç è®¤è¯ï¼šé€šè¿‡ç”¨æˆ·å+å¯†ç éªŒè¯ï¼ˆå®‰å…¨æ€§è¾ƒä½ï¼Œæ˜“å—æš´åŠ›ç ´è§£ï¼‰ã€‚</li></ul><p> <img src="https://b5dbf24.webp.li/image-20251012110434119.png" alt="image-20251012110434119"></p><ul><li>å…¬é’¥è®¤è¯ï¼šåŸºäºå¯†é’¥å¯¹ï¼ˆå…¬é’¥å­˜æœåŠ¡å™¨ï¼Œç§é’¥å­˜å®¢æˆ·ç«¯ï¼‰ï¼Œå®‰å…¨æ€§æ›´é«˜ï¼Œæ˜¯æ¨èæ–¹å¼ã€‚</li></ul><p> <img src="https://b5dbf24.webp.li/image-20251012110246733.png" alt="image-20251012110246733"></p><h1 id="25-10-18-at-crond"><a href="#25-10-18-at-crond" class="headerlink" title="25-10-18(at&#x2F;crond)"></a>25-10-18(at&#x2F;crond)</h1><h2 id="1-è®¡åˆ’ä»»åŠ¡ç†è®º"><a href="#1-è®¡åˆ’ä»»åŠ¡ç†è®º" class="headerlink" title="1.è®¡åˆ’ä»»åŠ¡ç†è®º"></a>1.è®¡åˆ’ä»»åŠ¡ç†è®º</h2><p><strong>ç†è®ºéƒ¨åˆ†å‚è€ƒ</strong> <a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/02%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E7%90%86%E8%AE%BA.md">è·³è½¬</a></p><h2 id="2-è®¡åˆ’ä»»åŠ¡"><a href="#2-è®¡åˆ’ä»»åŠ¡" class="headerlink" title="2.è®¡åˆ’ä»»åŠ¡"></a>2.è®¡åˆ’ä»»åŠ¡</h2><p><strong>éšè¯¾è®°</strong></p><blockquote><p>witch at  â€” æŸ¥çœ‹atå‘½ä»¤æ‰€åœ¨ç›®å½•</p><p>yum whatprovides *&#x2F;at â€” æŸ¥æ‰¾å‘½ä»¤ç”±å“ªä¸ªè½¯ä»¶åŒ…æä¾›</p><p>at -V  â€”- æŸ¥çœ‹è½¯ä»¶ç‰ˆæœ¬</p><p>yum install at -y   â€”- å®‰è£…at</p><p>systemctl start atd.service  â€” è¿è¡Œat</p><p>wall ã€å†…å®¹ã€‘ â€”- å¹¿æ’­å†…å®¹</p><p>at -l   â€”- æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡</p><p>at -d  â€” åˆ é™¤è®¡åˆ’ä»»åŠ¡</p><p>atrm [ä»»åŠ¡ç¼–å·]    â€”â€”   åˆ é™¤è®¡åˆ’ä»»åŠ¡</p><p>&#x2F;var&#x2F;log&#x2F;cron â€”-  æ—¥å¿—æ–‡ä»¶</p><p>&#x2F;var&#x2F;spool&#x2F;at</p></blockquote><h3 id="2-1-ä¸€æ¬¡æ€§è®¡åˆ’ä»»åŠ¡ã€atã€‘"><a href="#2-1-ä¸€æ¬¡æ€§è®¡åˆ’ä»»åŠ¡ã€atã€‘" class="headerlink" title="2.1 ä¸€æ¬¡æ€§è®¡åˆ’ä»»åŠ¡ã€atã€‘"></a>2.1 ä¸€æ¬¡æ€§è®¡åˆ’ä»»åŠ¡ã€atã€‘</h3><blockquote><p><span style="color:#CC0000; font-size:1.6em;">at </span> [HH:MM]  [yyyy-mm-dd]   #è®¾ç½®ä¸€æ¬¡æ€§è®¡åˆ’ä»»åŠ¡</p></blockquote><table><thead><tr><th align="center">å‚æ•°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td align="center"><strong>-l</strong></td><td>åˆ—å‡ºç³»ç»Ÿä¸Šæ‰€æœ‰ç”¨æˆ·çš„atä»»åŠ¡ï¼Œç­‰ä»·äºatq</td></tr><tr><td align="center"><strong>-d</strong></td><td>åˆ é™¤æˆ–å–æ¶ˆä¸€ä¸ªä»»åŠ¡</td></tr><tr><td align="center"><strong>-v</strong></td><td>ä½¿ç”¨æ—¶é—´æ ¼å¼ï¼Œåˆ—å‡ºatä»»åŠ¡</td></tr><tr><td align="center"><strong>-c</strong></td><td>å¯ä»¥åˆ—å‡ºä»»åŠ¡ä¹‹åçš„å‘½ä»¤å†…å®¹</td></tr><tr><td align="center"><strong>-f</strong></td><td>ä»æ–‡ä»¶ä¸­è¯»å–</td></tr></tbody></table><h4 id="2-1-1-å®ç°å½¢å¼"><a href="#2-1-1-å®ç°å½¢å¼" class="headerlink" title="2.1.1 å®ç°å½¢å¼"></a>2.1.1 å®ç°å½¢å¼</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è®¾å®šä»»åŠ¡</span></span><br><span class="line">[root@1010 ~]# at 10;00  <span class="comment">#ç³»ç»Ÿæ—¶é—´10ç‚¹æ‰§è¡Œ</span></span><br><span class="line">    warning: commands will be executed using /bin/sh</span><br><span class="line">    at&gt; wall 6666 <span class="comment"># å¹¿æ’­6666</span></span><br><span class="line">    at&gt; &lt;EOT&gt;   <span class="comment">#ctrl d ç”Ÿæˆä»»åŠ¡</span></span><br><span class="line">    job 1 at Sun Jan  5 9:59:00 2025</span><br><span class="line"><span class="comment">#atç›¸å…³å‘½ä»¤</span></span><br><span class="line">    at -l  æˆ–  atq  ---      æŸ¥çœ‹ä»»åŠ¡</span><br><span class="line">    at -c [ç¼–å·]  --- æŸ¥çœ‹ä»»åŠ¡å…·ä½“å†…å®¹</span><br><span class="line">    atrm [ç¼–å·] æˆ– at -d [ç¼–å·] ---   åˆ é™¤ä»»åŠ¡</span><br><span class="line"><span class="built_in">tail</span> -f /var/log/cron--- æŸ¥çœ‹ç³»ç»Ÿæ˜¯å¦æ‰§è¡Œ</span><br><span class="line">æˆ– watch -n [ç¼–å·] <span class="built_in">ls</span> -l /root</span><br></pre></td></tr></table></figure><ul><li><span style="border:1px solid #330000;">è®¡åˆ’ä»»åŠ¡ä¿å­˜åœ¨ç›®å½•ï¼š &#x2F;var&#x2F;spool&#x2F;at</span></li><li><span style="border:1px solid #330000;">è®¡åˆ’ä»»åŠ¡çš„æ—¥å¿—ï¼š&#x2F;var&#x2F;log&#x2F;cron</span></li></ul><p><span style="color:#FF0000;">æ³¨æ„</span>ï¼š</p><blockquote><p>atå‘½ä»¤çš„è¾“å‡ºç»“æœï¼ˆæ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºï¼‰ä¸ä¼šæ˜¾ç¤ºåˆ°å±å¹•ä¸Š </p><p>atå‘½ä»¤ä¸­æ‰§è¡Œçš„å‘½ä»¤æœ€å¥½ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œä¸å®¹æ˜“æŠ¥é”™ </p><p>è¿‡ç¨‹ï¼šè¾“å…¥at æ—¶é—´ -&gt; å›è½¦ -&gt;è¾“å…¥æ‰§è¡Œçš„å‘½ä»¤-&gt;ctrl+dé€€å‡ºat </p><p>atå‘½ä»¤åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œæ—¶é—´è¿‡äº†å°±ä¸å†æ‰§è¡Œ</p></blockquote><h4 id="2-1-2-æ—¶é—´çš„ä¹¦å†™æ ¼å¼"><a href="#2-1-2-æ—¶é—´çš„ä¹¦å†™æ ¼å¼" class="headerlink" title="2.1.2 æ—¶é—´çš„ä¹¦å†™æ ¼å¼"></a>2.1.2 æ—¶é—´çš„ä¹¦å†™æ ¼å¼</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1ã€æŒ‡å®šæ—¶é—´</span></span><br><span class="line">amã€pm   12å°æ—¶åˆ¶</span><br><span class="line">HH:MM   24å°æ—¶åˆ¶</span><br><span class="line">å¹´æœˆæ—¥   06122024   2024-12-06  12/06/2024   06.12.2024</span><br><span class="line">      MMDD[CC]YY  [CC]YY-MM-DD.  MM/DD/[CC]YY  DD.MM.[CC]YY  </span><br><span class="line"> [HH:MM]  [yyyy-mm-dd]  </span><br><span class="line"><span class="comment">#2ã€æ¨¡ç³Šæ—¶é—´</span></span><br><span class="line">noonï¼ˆ12:00ï¼‰   midnightï¼ˆ00:00ï¼‰   teatimeï¼ˆ4pmï¼‰</span><br><span class="line"><span class="comment">#3ã€ç›¸å¯¹æ—¶é—´</span></span><br><span class="line">now +1 min  now +2 days</span><br><span class="line"><span class="comment">#è¦åœ¨ä¸‰å¤©åçš„ä¸‹åˆ4ç‚¹è¿è¡Œä½œä¸š    at 4pm + 3 days</span></span><br><span class="line"><span class="comment">#è¦åœ¨7æœˆ31æ—¥ä¸Šåˆ10ç‚¹è¿è¡Œä½œä¸š   at 10am Jul 31</span></span><br><span class="line"><span class="comment">#è¦åœ¨æ˜å¤©çš„å‡Œæ™¨1ç‚¹è¿è¡Œä½œä¸š     at 1am tomorrow</span></span><br></pre></td></tr></table></figure><h4 id="2-1-3-é»‘ç™½åå•"><a href="#2-1-3-é»‘ç™½åå•" class="headerlink" title="2.1.3 é»‘ç™½åå•"></a>2.1.3 é»‘ç™½åå•</h4><blockquote><p>è¶…çº§ç”¨æˆ·å¯ä»¥åœ¨ä»»ä½•æƒ…å†µä¸‹ä½¿ç”¨è¿™äº›å‘½ä»¤ã€‚</p><p>å¯¹äºå…¶ä»–ç”¨æˆ·ï¼Œä½¿ç”¨ at çš„æƒé™ç”±æ–‡ä»¶ &#x2F;etc&#x2F;at.allow å’Œ &#x2F;etc&#x2F;at.deny ç¡®å®š</p><p>â€‹1ã€æ ¼å¼ï¼šæ¯è¡Œä¸€ä¸ªç”¨æˆ·åç§°ï¼Œä¸å…è®¸æœ‰ç©ºç™½å­—ç¬¦</p><p>â€‹2ã€ç³»ç»Ÿå…ˆæ£€æµ‹at.allow,å¦‚æœat.allowå­˜åœ¨ï¼Œå…¶ä¸­çš„ç”¨æˆ·å…è®¸atï¼Œå³ä½¿at.denyä¹Ÿå­˜      åœ¨è¯¥ç”¨æˆ·ä¹Ÿä¼šè¢«å¿½ç•¥</p><p>â€‹3ã€å¦‚æœat.allowä¸å­˜åœ¨æ‰æ£€æµ‹at.deny,å…¶ä¸­ç”¨æˆ·ä¸å…è®¸atï¼Œå‰©ä¸‹çš„ç”¨æˆ·å¯ä½¿ç”¨at</p><p>â€‹4ã€at.allow at.deny éƒ½ä¸å­˜åœ¨ï¼Œåªæœ‰rootå¯ç”¨at</p></blockquote><h4 id="2-1-4-æ³¨æ„ç‚¹"><a href="#2-1-4-æ³¨æ„ç‚¹" class="headerlink" title="2.1.4 æ³¨æ„ç‚¹"></a>2.1.4 æ³¨æ„ç‚¹</h4><ul><li><span style="background:#CCFFFF;">æƒé™ï¼šä¸åŒç”¨æˆ·å¯¹ç³»ç»Ÿçš„ä½¿ç”¨æƒé™ä¸ä¸€æ ·ï¼Œè®¾ç½®ä»»åŠ¡çš„æ—¶å€™ï¼Œè¯¥ä»»åŠ¡çš„ä¸€å®šè¦åœ¨è¯¥ç”¨æˆ·çš„æƒé™èŒƒå›´ä¹‹å†…</span></li></ul><h3 id="2-2-å‘¨æœŸæ€§è®¡åˆ’ä»»åŠ¡ã€crondã€‘"><a href="#2-2-å‘¨æœŸæ€§è®¡åˆ’ä»»åŠ¡ã€crondã€‘" class="headerlink" title="2.2 å‘¨æœŸæ€§è®¡åˆ’ä»»åŠ¡ã€crondã€‘"></a>2.2 å‘¨æœŸæ€§è®¡åˆ’ä»»åŠ¡ã€crondã€‘</h3><h4 id="2-2-1-å®ç°å½¢å¼"><a href="#2-2-1-å®ç°å½¢å¼" class="headerlink" title="2.2.1 å®ç°å½¢å¼"></a>2.2.1 å®ç°å½¢å¼</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@1010 ~]# systemctl status crond.service <span class="comment">#æŸ¥çœ‹æœåŠ¡æ˜¯å¦å¯åŠ¨</span></span><br><span class="line">[root@1010 ~]# rpm -ql crontabs </span><br><span class="line">/etc/cron.daily</span><br><span class="line">/etc/cron.hourly</span><br><span class="line">/etc/cron.monthly</span><br><span class="line">/etc/cron.weekly</span><br><span class="line">/etc/crontab</span><br><span class="line">/etc/sysconfig/run-parts</span><br><span class="line">/usr/bin/run-parts</span><br><span class="line">/usr/share/licenses/crontabs</span><br><span class="line">/usr/share/licenses/crontabs/COPYING</span><br><span class="line">/usr/share/man/man4/crontabs.4.gz</span><br><span class="line">/usr/share/man/man4/run-parts.4.gz</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è®¾å®šä»»åŠ¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###æ–¹æ³•1.ç¼–è¾‘ç³»ç»Ÿçš„crontab æ–‡ä»¶ï¼Œç”±crondè¿›ç¨‹ç®¡ç†</span></span><br><span class="line">[root@1010 ~]# vim /etc/crontab</span><br><span class="line"></span><br><span class="line">SHELL=/bin/bash</span><br><span class="line">PATH=/sbin:/bin:/usr/sbin:/usr/bin</span><br><span class="line">MAILTO=root</span><br><span class="line"></span><br><span class="line"><span class="comment"># For details see man 4 crontabs</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Example of job definition:</span></span><br><span class="line"><span class="comment"># .---------------- minute (0 - 59)</span></span><br><span class="line"><span class="comment"># |  .------------- hour (0 - 23)</span></span><br><span class="line"><span class="comment"># |  |  .---------- day of month (1 - 31)</span></span><br><span class="line"><span class="comment"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span></span><br><span class="line"><span class="comment"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span></span><br><span class="line"><span class="comment"># |  |  |  |  |</span></span><br><span class="line"><span class="comment"># *  *  *  *  * user-name  command to be executed</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###æ–¹æ³•2.ä»¥ç”¨æˆ·èº«ä»½æ·»åŠ è®¡åˆ’ä»»åŠ¡ï¼Œå¹¶ä»¥ç”¨æˆ·çš„èº«ä»½å‘½åçš„æ–‡ä»¶ä¿å­˜åœ¨/var/spool/cron/ç›®å½•ä¸‹</span></span><br><span class="line">[root@1010 ~]# crontab -e -u root(ç”¨æˆ·)</span><br><span class="line"> *  *  *  *  * <span class="built_in">ls</span> &gt; /file</span><br><span class="line"> </span><br><span class="line">[root@1010 ~]# ll /var/spool/cron/<span class="comment"># æŸ¥çœ‹ä»»åŠ¡ç¼–å·åŠæ•°é‡</span></span><br><span class="line">æ€»ç”¨é‡ 4</span><br><span class="line">-rw-------. 1 root root 26 10æœˆ 18 20:11 root</span><br><span class="line"></span><br><span class="line">[root@1010 ~]# <span class="built_in">cat</span> /var/spool/cron/root  <span class="comment">#æŸ¥çœ‹ä»»åŠ¡å†…å®¹</span></span><br><span class="line"> *  *  *  *  * <span class="built_in">ls</span> &gt; /file</span><br><span class="line"> </span><br><span class="line"><span class="comment">#crontabç›¸å…³å‘½ä»¤</span></span><br><span class="line">crontab -låˆ—å‡ºå½“å‰ç”¨æˆ·çš„ crontab æ–‡ä»¶å†…å®¹ã€‚</span><br><span class="line">crontab -råˆ é™¤å½“å‰ç”¨æˆ·çš„ crontab æ–‡ä»¶ã€‚</span><br><span class="line">crontab -e ä¿®æ”¹ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´å’Œä»»åŠ¡å†…å®¹ã€‚</span><br><span class="line"><span class="comment">#å¯ä»¥æ·»åŠ  -u  æ¥é€‰æ‹©ç”¨æˆ·ï¼Œä½†æ˜¯è¦æ³¨æ„æƒé™é—®é¢˜ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###æ–¹æ³•3.åŒ…å«ä¸ºä¸åŒç”¨æˆ·å­˜å‚¨çš„ä¸åŒç±»åˆ«çš„ä»»åŠ¡ï¼Œç³»ç»Ÿå®šæ—¶ä»»åŠ¡çš„ç›®å½•ï¼Œç”±crondè¿›ç¨‹ç®¡ç†</span></span><br><span class="line"><span class="comment">#/etc/cron.d/ </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªåä¸º nginx_maintenanceçš„æ–‡ä»¶ï¼Œæ”¾åœ¨/etc/cron.d/ç›®å½•ä¸‹ï¼Œå¯ä»¥æ¸…æ™°åœ°çŸ¥é“è¯¥</span></span><br><span class="line"><span class="comment"># æ–‡ä»¶æ˜¯ç”¨äº   nginx   æœåŠ¡çš„ç»´æŠ¤ä»»åŠ¡ï¼Œå¹¶ä¸”èƒ½å¤Ÿå¿«é€Ÿåœ°æ‰¾åˆ°å’Œä¿®æ”¹ç›¸å…³çš„å®šæ—¶ä»»åŠ¡é…ç½®ã€‚</span></span><br><span class="line"></span><br><span class="line">[root@1010 ~]# /etc/cron.d/nginx_maintenance </span><br><span class="line"><span class="comment"># æ¸…ç†æ—§çš„æ—¥å¿—æ–‡ä»¶ï¼Œæ¯å‘¨æ‰§è¡Œä¸€æ¬¡</span></span><br><span class="line">0 2 * * 7 root /usr/local/bin/cleanup_nginx_logs.sh</span><br><span class="line"><span class="comment"># æ£€æŸ¥é…ç½®æ–‡ä»¶çš„å®Œæ•´æ€§ï¼Œæ¯å¤©æ‰§è¡Œä¸€æ¬¡</span></span><br><span class="line">0 1 * * * root /usr/local/bin/check_nginx_config.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#crontabæ‰§è¡Œçš„æ¯ä¸€é¡¹å·¥ä½œéƒ½ä¼šè¢«è®°å½•åˆ°æ—¥å¿—ï¼š/var/log/cron</span></span><br><span class="line"><span class="built_in">tail</span> -f /var/log/cron  <span class="comment">## %éœ€è¦è½¬ä¹‰</span></span><br><span class="line">[root@1010 ~]# <span class="built_in">tail</span> -n 1 /etc/crontab </span><br><span class="line">* 10 * * *   root  <span class="built_in">echo</span> 123 &gt; <span class="string">&quot;/file1_`date +\%R`&quot;</span></span><br></pre></td></tr></table></figure><h4 id="2-2-2-æ—¶é—´ä¹¦å†™æ ¼å¼"><a href="#2-2-2-æ—¶é—´ä¹¦å†™æ ¼å¼" class="headerlink" title="2.2.2 æ—¶é—´ä¹¦å†™æ ¼å¼"></a>2.2.2 æ—¶é—´ä¹¦å†™æ ¼å¼</h4><p><span style="color:#FF0000;">*Â  Â  Â *Â  Â  Â *Â  Â  Â *Â  Â  Â *</span></p><p>åˆ†   æ—¶   æ—¥    æœˆ     å‘¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç‰¹æ®Šç¬¦å·</span></span><br><span class="line">*ï¼šä»£è¡¨æŒ‡å®šæ—¶é—´å•ä½ä¸­çš„æ¯ä¸€ä¸ªæ—¶åˆ»ã€‚ä¾‹å¦‚ï¼Œ*åœ¨åˆ†é’Ÿå­—æ®µä¸­è¡¨ç¤ºæ¯åˆ†é’Ÿã€‚</span><br><span class="line">,ï¼šç”¨äºåˆ†éš”åˆ—è¡¨ä¸­çš„é¡¹ç›®ã€‚ä¾‹å¦‚ï¼Œ1,3,5 * * * * <span class="built_in">command</span> è¡¨ç¤ºæ¯ä¸ªå°æ—¶çš„ç¬¬1ã€3ã€5åˆ†é’Ÿæ‰§è¡Œå‘½ä»¤ã€‚</span><br><span class="line">-ï¼šç”¨äºå®šä¹‰èŒƒå›´ã€‚ä¾‹å¦‚ï¼Œ0 9-17 * * * <span class="built_in">command</span> è¡¨ç¤ºä»æ—©ä¸Š9ç‚¹åˆ°ä¸‹åˆ5ç‚¹æ¯å°æ—¶å¼€å§‹æ—¶æ‰§è¡Œå‘½ä»¤ã€‚</span><br><span class="line">/æ•°å­—ï¼šç”¨äºæŒ‡å®šæ­¥é•¿ã€‚ä¾‹å¦‚ï¼Œ*/15 * * * * <span class="built_in">command</span> è¡¨ç¤ºæ¯15åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡å‘½ä»¤ã€‚</span><br><span class="line"></span><br><span class="line">åˆ† æ—¶ æ—¥ æœˆ å‘¨</span><br><span class="line">*/2 */2 */2 */2 *</span><br><span class="line">* * * * */2</span><br><span class="line">* * L 1-6/2 *</span><br><span class="line">* * * * 2</span><br><span class="line">* 8 * * *  æ¯å¤©8ç‚¹çš„æ¯ä¸€åˆ†é’Ÿ</span><br><span class="line">0 8 * * *  æ¯å¤©8ï¼š00æ‰§è¡Œ</span><br><span class="line">13 0 1 * *   æ¯æœˆ1æ—¥00ï¼š13æ‰§è¡Œ</span><br><span class="line">*/2 12 * * * æ¯å¤©12ç‚¹æ¯ä¸¤åˆ†é’Ÿæ‰§è¡Œ</span><br><span class="line">* 11,23 * * *   æ¯å¤©11ç‚¹å’Œ23ç‚¹çš„æ¯ä¸€åˆ†é’Ÿéƒ½ æ‰§è¡Œ</span><br><span class="line">* 1-3 * * *    æ¯å¤©çš„1ç‚¹ã€2ç‚¹ã€3ç‚¹çš„æ¯ä¸€åˆ†é’Ÿéƒ½æ‰§è¡Œ</span><br><span class="line"></span><br><span class="line"><span class="comment">###ç‰¹æ®Šæƒ…å†µï¼š</span></span><br><span class="line"><span class="comment">#2025å¹´1æœˆ5æ—¥æ˜¯æ˜ŸæœŸæ—¥ï¼Œå½“æ—¥æœŸå’Œæ˜ŸæœŸå†²çªçš„æ—¶å€™ï¼Œé‚£ä¹ˆè¿™å¤©å’Œè¿™ä¸ªæ˜ŸæœŸéƒ½ä¼šæ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###å¦‚æœæƒ³åœ¨æ¯å¹´çš„2æœˆæœ€åä¸€å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line">* * L 2 * </span><br><span class="line"></span><br><span class="line"><span class="comment">#  anacron   èƒ½å¤Ÿåœ¨ç³»ç»Ÿå¯åŠ¨åè‡ªåŠ¨æ‰§è¡Œå®šæœŸä»»åŠ¡ï¼Œå³ä½¿ç³»ç»Ÿåœ¨ä»»åŠ¡é¢„å®šæ—¶é—´æœªè¿è¡Œï¼Œä»»åŠ¡ä¹Ÿä¼šåœ¨ç³»ç»Ÿä¸‹æ¬¡å¯åŠ¨æ—¶æ‰§è¡Œ.</span></span><br><span class="line">[root@1010 ~]# rpm -ql cronie-anacron</span><br><span class="line">/etc/anacrontab</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="2-2-3-é»‘ç™½åå•"><a href="#2-2-3-é»‘ç™½åå•" class="headerlink" title="2.2.3 é»‘ç™½åå•"></a>2.2.3 é»‘ç™½åå•</h4><p><span style="border:1px solid #330000;"> &#x2F;etc&#x2F;cron.allowÂ </span>    <span style="border:1px solid #330000;">&#x2F;etc&#x2F;cron.deny      </span> </p><blockquote><p>cron.allowå’Œcron.denyæ–‡ä»¶ä¸èƒ½ç”¨äºé™åˆ¶cronçš„æ‰§è¡Œï¼›å®ƒä»¬åªé™åˆ¶crontabçš„ä½¿ç”¨ã€‚</p><p>ç‰¹åˆ«æ˜¯ï¼Œé™åˆ¶è®¿é—®crontabå¯¹ç”¨æˆ·çš„ç°æœ‰crontabæ²¡æœ‰å½±å“ã€‚å…¶å·¥ä½œå°†ç»§ç»­ç›´åˆ°crontabè¢«åˆ é™¤ã€‚<br>è°ƒç”¨crontabçš„ç”¨æˆ·å¿…é¡»èƒ½å¤Ÿè¯»å–cron.allowå’Œcron.denyæ–‡ä»¶ã€‚å¦‚æœä¸æ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆå®ƒä»¬å°±è¢«è§†ä¸ºä¸å­˜åœ¨ã€‚</p><p>å½“ç³»ç»Ÿä¸­æœ‰ &#x2F;etc&#x2F;cron.allow æ–‡ä»¶æ—¶ï¼Œåªæœ‰å†™å…¥æ­¤æ–‡ä»¶çš„ç”¨æˆ·å¯ä»¥ä½¿ç”¨ crontab å‘½ä»¤ï¼Œæ²¡æœ‰å†™å…¥çš„ç”¨æˆ·ä¸èƒ½ä½¿ç”¨crontab å‘½ä»¤ã€‚<br>åŒæ ·ï¼Œå¦‚æœæœ‰æ­¤&#x2F;etc&#x2F;cron.allowæ–‡ä»¶ï¼Œ&#x2F;etc&#x2F;cron.deny æ–‡ä»¶ä¼šè¢«å¿½ç•¥ï¼Œå› ä¸º &#x2F;etc&#x2F;cron.allow æ–‡ä»¶çš„ä¼˜å…ˆçº§æ›´é«˜<br>å½“ç³»ç»Ÿä¸­åªæœ‰ &#x2F;etc&#x2F;cron.deny æ–‡ä»¶æ—¶ï¼Œå†™å…¥æ­¤æ–‡ä»¶çš„ç”¨æˆ·ä¸èƒ½ä½¿ç”¨ crontab å‘½ä»¤ï¼Œæ²¡æœ‰å†™å…¥æ–‡ä»¶çš„ç”¨æˆ·å¯ä»¥ä½¿ç”¨ crontab å‘½ä»¤</p><p>crontab æ‰§è¡Œçš„æ¯ä¸€é¡¹å·¥ä½œéƒ½ä¼šè¢« è®°å½•åˆ° &#x2F;var&#x2F;log&#x2F;cron è¿™ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­<br>å½“ç”¨æˆ·ä½¿ç”¨ crontab æ–°å»ºå·¥ä½œä¹‹åï¼Œè¯¥é¡¹å·¥ä½œå°±ä¼šè¢«è®°å½•åˆ° &#x2F;var&#x2F;spool&#x2F;cron&#x2F;ç›®å½•é‡Œé¢</p></blockquote><h4 id="2-2-4-æ‰©å±•-ã€run-partsã€‘"><a href="#2-2-4-æ‰©å±•-ã€run-partsã€‘" class="headerlink" title="2.2.4 æ‰©å±• ã€run-partsã€‘"></a>2.2.4 æ‰©å±• ã€run-partsã€‘</h4><blockquote><p>run-partsï¼šè¯¥å‘½ä»¤å¯å°†åé¢æ¥çš„â€œç›®å½•â€å†…çš„æ‰€æœ‰æ–‡ä»¶æ‰¾å‡ºæ¥æ‰§è¡Œã€‚</p></blockquote><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º scripts çš„ç›®å½•ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹å¯æ‰§è¡Œè„šæœ¬ï¼š<br>&#x2F;scripts&#x2F;<br>â”œâ”€â”€ script1.sh<br>â”œâ”€â”€ script2.sh<br>â””â”€â”€ script3.sh<br>æˆ‘ä»¬æƒ³è¦åœ¨æ¯å¤©çš„å‡Œæ™¨ 1 ç‚¹æ‰§è¡Œè¿™äº›è„šæœ¬ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.ç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™ã€‚</span></span><br><span class="line">[root@1010 ~] <span class="comment">#chmod  +x /scripts/*.sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.è®¾ç½®å‘¨æœŸæ€§ä»»åŠ¡</span></span><br><span class="line">[root@1010 ~] <span class="comment"># vim /etc/crontab</span></span><br><span class="line">01 * * * *   run-parts  /scripts</span><br><span class="line"></span><br><span class="line"><span class="comment">#3.æ£€æŸ¥</span></span><br><span class="line">[root@1010 ~] <span class="comment"># mkdir /shell</span></span><br><span class="line">[root@1010 ~] <span class="comment"># vim /shell/1.sh</span></span><br><span class="line">[root@1010 ~] <span class="comment"># vim /shell/2.sh</span></span><br><span class="line">[root@1010 ~] <span class="comment"># vim /shell/3.sh</span></span><br><span class="line">[root@1010 ~] <span class="comment"># chmod  u+x /shell/* </span></span><br><span class="line">[root@1010 ~] <span class="comment"># vim /etc/crontab</span></span><br><span class="line">* 11 * * *   root   run-parts  /shell    <span class="comment">#æ³¨æ„/shell æ˜¯ç›®å½•</span></span><br><span class="line"><span class="comment">#æ—¥å¿—è¿½è¸ª</span></span><br><span class="line">[root@1010 ~] <span class="comment"># tail -f  /var/log/cron</span></span><br></pre></td></tr></table></figure><h1 id="25-10-23-chrony"><a href="#25-10-23-chrony" class="headerlink" title="25-10-23(chrony)"></a>25-10-23(chrony)</h1><h2 id="1-ntpç†è®º"><a href="#1-ntpç†è®º" class="headerlink" title="1.ntpç†è®º"></a>1.ntpç†è®º</h2><p><strong>ç†è®ºéƒ¨åˆ†å‚è€ƒ</strong>   <a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/03ntp%E7%90%86%E8%AE%BA.md">è·³è½¬</a></p><h2 id="2-ntpå®éªŒ"><a href="#2-ntpå®éªŒ" class="headerlink" title="2.ntpå®éªŒ"></a>2.ntpå®éªŒ</h2><h3 id="2-1-chrony"><a href="#2-1-chrony" class="headerlink" title="2.1.chrony"></a>2.1.chrony</h3><blockquote><p>chronyc sources  â€” æŸ¥çœ‹æ¯ä¸ªæ—¶é—´æºæ›´è¯¦ç»†çš„ç»Ÿè®¡ä¿¡æ¯</p><p>date  â€” æ˜¾ç¤ºæ—¶é—´</p><p>chrony çš„ä¸»é…ç½®æ–‡ä»¶ï¼š&#x2F;etc&#x2F;chrony.conf</p></blockquote><p><strong>æ¦‚å¿µï¼š</strong></p><p>chronyæ˜¯ä¸€ä¸ªå¼€æºçš„è‡ªç”±è½¯ä»¶ï¼Œå®ƒèƒ½å¸®åŠ©ä½ ä¿æŒç³»ç»Ÿæ—¶é’Ÿä¸æ—¶é’ŸæœåŠ¡å™¨ï¼ˆNTPï¼‰åŒæ­¥ï¼Œå› æ­¤è®©ä½ çš„æ—¶é—´ä¿æŒç²¾ç¡®ã€‚</p><h3 id="2-2-å®‰è£…ä¸æŸ¥çœ‹"><a href="#2-2-å®‰è£…ä¸æŸ¥çœ‹" class="headerlink" title="2.2.å®‰è£…ä¸æŸ¥çœ‹"></a>2.2.å®‰è£…ä¸æŸ¥çœ‹</h3><blockquote><p>yum install chrony -y# å®‰è£…</p><p>systemctl start  chronyd #å¯åŠ¨æœåŠ¡</p><p>systemctl start  chronyd #é‡å¯æœåŠ¡</p><p>systemctl enable  chronyd#å¼€æœºè‡ªå¯</p><p>systemctl status ntp # æŸ¥çœ‹ntpçŠ¶æ€</p></blockquote><h4 id="2-2-1-å®éªŒ1â€”-åŒæ­¥æ—¶é—´"><a href="#2-2-1-å®éªŒ1â€”-åŒæ­¥æ—¶é—´" class="headerlink" title="2.2.1 å®éªŒ1â€”-åŒæ­¥æ—¶é—´"></a>2.2.1 å®éªŒ1â€”-åŒæ­¥æ—¶é—´</h4><p><strong>(1) æ‰‹åŠ¨ä¿®æ”¹è‡³é”™è¯¯æ—¶é—´</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@1010 ~]# <span class="built_in">date</span> -s 8:00</span><br><span class="line">2025å¹´ 10æœˆ 23æ—¥ æ˜ŸæœŸå›› 08:00:00 CST</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-10-23_20-00-36.png" alt="PixPin_2025-10-23_20-00-36"></p><p><strong>(2) ç¼–è¾‘é…ç½®æ–‡ä»¶</strong></p><p><strong>æ£€æŸ¥ç½‘ç»œ</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@1010 ~]# ping ntp.aliyun.com<span class="comment">#æ£€æŸ¥æ˜¯å¦èƒ½è¿é€šé˜¿é‡Œäº‘æˆæ—¶ä¸­å¿ƒ</span></span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-10-23_20-04-31.png" alt="PixPin_2025-10-23_20-04-31"></p><p><strong>ä¿®æ”¹&#x2F;etc&#x2F;chrony.confæ–‡ä»¶</strong></p><p><img src="https://b5dbf24.webp.li/PixPin_2025-10-23_20-04-01.png" alt="img"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@1010 ~]# vim /etc/chrony.conf</span><br></pre></td></tr></table></figure><p><strong>(3) é‡å¯æœåŠ¡</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@1010 ~]# systemctl restart  chronyd</span><br><span class="line">[root@1010 ~]# systemctl status  chronyd<span class="comment">#æŸ¥çœ‹æœåŠ¡çŠ¶æ€</span></span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-10-23_20-08-25.png" alt="PixPin_2025-10-23_20-08-25"></p><p><strong>(4) éªŒè¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@1010 ~]# chronyc  sources<span class="comment"># åˆ—å‡ºæ—¶é—´æº  æ·»åŠ -v(æ›´è¯¦ç»†)</span></span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-10-23_20-09-55.png" alt="PixPin_2025-10-23_20-09-55"></p><blockquote><p>ä¸é˜¿é‡Œäº‘åœ°å€ç›¸åŒï¼ŒåŒæ­¥æˆåŠŸ</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@1010 ~]# timedatectl   status</span><br><span class="line">[root@1010 ~]# <span class="built_in">date</span></span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-10-23_20-11-04.png" alt="PixPin_2025-10-23_20-11-04"></p><h4 id="2-2-2-å®éªŒ2â€”æ­å»ºæœ¬åœ°æ—¶é—´åŒæ­¥æœåŠ¡å™¨"><a href="#2-2-2-å®éªŒ2â€”æ­å»ºæœ¬åœ°æ—¶é—´åŒæ­¥æœåŠ¡å™¨" class="headerlink" title="2.2.2 å®éªŒ2â€”æ­å»ºæœ¬åœ°æ—¶é—´åŒæ­¥æœåŠ¡å™¨"></a>2.2.2 å®éªŒ2â€”æ­å»ºæœ¬åœ°æ—¶é—´åŒæ­¥æœåŠ¡å™¨</h4><h5 id="æœåŠ¡ç«¯é…ç½®ï¼ˆ192-168-232-3ï¼‰"><a href="#æœåŠ¡ç«¯é…ç½®ï¼ˆ192-168-232-3ï¼‰" class="headerlink" title="æœåŠ¡ç«¯é…ç½®ï¼ˆ192.168.232.3ï¼‰"></a>æœåŠ¡ç«¯é…ç½®ï¼ˆ192.168.232.3ï¼‰</h5><h5 id="1-ç½‘ç»œæ£€æŸ¥ï¼ˆpingå®¢æˆ·ç«¯ï¼‰"><a href="#1-ç½‘ç»œæ£€æŸ¥ï¼ˆpingå®¢æˆ·ç«¯ï¼‰" class="headerlink" title="(1) ç½‘ç»œæ£€æŸ¥ï¼ˆpingå®¢æˆ·ç«¯ï¼‰"></a>(1) ç½‘ç»œæ£€æŸ¥ï¼ˆpingå®¢æˆ·ç«¯ï¼‰</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@1010 ~]# ping 192.168.232.131</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-10-23_20-21-49.png" alt="PixPin_2025-10-23_20-21-49"></p><h5 id="2-ç¼–è¾‘é…ç½®æ–‡ä»¶-å·²å®‰è£…æœåŠ¡"><a href="#2-ç¼–è¾‘é…ç½®æ–‡ä»¶-å·²å®‰è£…æœåŠ¡" class="headerlink" title="(2) ç¼–è¾‘é…ç½®æ–‡ä»¶(å·²å®‰è£…æœåŠ¡)"></a>(2) ç¼–è¾‘é…ç½®æ–‡ä»¶(å·²å®‰è£…æœåŠ¡)</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@1010 ~]# vim /etc/chrony.conf</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-10-23_20-19-26.png" alt="PixPin_2025-10-23_20-19-26"></p><blockquote><p>åŸºäºå®éªŒä¸€å·²ç»é…ç½®é˜¿é‡Œäº‘çš„æ—¶é—´æºçš„æƒ…å†µä¸‹ï¼Œå…è®¸å®¢æˆ·ç«¯åŒæ­¥æœåŠ¡ç«¯çš„æ—¶é—´æº</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@1010 ~]# systemctl restart chronyd<span class="comment">#é‡å¯æœåŠ¡</span></span><br></pre></td></tr></table></figure><h5 id="å®¢æˆ·ç«¯ï¼ˆ192-168-232-131ï¼‰"><a href="#å®¢æˆ·ç«¯ï¼ˆ192-168-232-131ï¼‰" class="headerlink" title="å®¢æˆ·ç«¯ï¼ˆ192.168.232.131ï¼‰"></a>å®¢æˆ·ç«¯ï¼ˆ192.168.232.131ï¼‰</h5><h5 id="1-ç½‘ç»œæ£€æŸ¥"><a href="#1-ç½‘ç»œæ£€æŸ¥" class="headerlink" title="(1) ç½‘ç»œæ£€æŸ¥"></a>(1) ç½‘ç»œæ£€æŸ¥</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hym ~]# ping 192.168.232.3</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-10-23_20-25-38.png" alt="PixPin_2025-10-23_20-25-38"></p><h5 id="2-è½¯ä»¶å®‰è£…"><a href="#2-è½¯ä»¶å®‰è£…" class="headerlink" title="(2) è½¯ä»¶å®‰è£…"></a>(2) è½¯ä»¶å®‰è£…</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# yum  install  chrony  -y   </span><br><span class="line">[root@hym ~]# systemctl status  chronyd  <span class="comment"># æŸ¥çœ‹æœåŠ¡çŠ¶æ€</span></span><br></pre></td></tr></table></figure><h5 id="3-é…ç½®æ–‡ä»¶ï¼ˆæ—¶é—´æºæ”¹ä¸ºæœåŠ¡ç«¯çš„ï¼‰"><a href="#3-é…ç½®æ–‡ä»¶ï¼ˆæ—¶é—´æºæ”¹ä¸ºæœåŠ¡ç«¯çš„ï¼‰" class="headerlink" title="(3) é…ç½®æ–‡ä»¶ï¼ˆæ—¶é—´æºæ”¹ä¸ºæœåŠ¡ç«¯çš„ï¼‰"></a>(3) é…ç½®æ–‡ä»¶ï¼ˆæ—¶é—´æºæ”¹ä¸ºæœåŠ¡ç«¯çš„ï¼‰</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hym ~]# vim  /etc/chrony.conf </span><br><span class="line">[root@hym ~]# systemctl restart  chronyd<span class="comment">#é‡å¯æœåŠ¡</span></span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-10-23_20-29-40.png" alt="PixPin_2025-10-23_20-29-40"></p><h5 id="4-æ£€æŸ¥"><a href="#4-æ£€æŸ¥" class="headerlink" title="(4) æ£€æŸ¥"></a>(4) æ£€æŸ¥</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hym ~]# chronyc  sources</span><br><span class="line">[root@1010 ~]# timedatectl   status</span><br><span class="line">[root@1010 ~]# <span class="built_in">date</span></span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-10-23_20-32-31.png" alt="PixPin_2025-10-23_20-32-31"></p><h1 id="25-10-24-Nginx"><a href="#25-10-24-Nginx" class="headerlink" title="25-10-24(Nginx)"></a>25-10-24(Nginx)</h1><h2 id="1-Nginxç†è®º"><a href="#1-Nginxç†è®º" class="headerlink" title="1 Nginxç†è®º"></a>1 Nginxç†è®º</h2><p><strong>ç†è®ºéƒ¨åˆ†å‚è€ƒ</strong>  <a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/04web%E7%90%86%E8%AE%BA.md">è·³è½¬</a></p><h2 id="2-Nginxå®éªŒ"><a href="#2-Nginxå®éªŒ" class="headerlink" title="2 Nginxå®éªŒ"></a>2 Nginxå®éªŒ</h2><p><strong>å®‰è£…</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@1010 ~]# yum install nginx -y</span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@1010 ~]# systemctl start nginx.service</span><br></pre></td></tr></table></figure><blockquote><p>systemctl restart nginx.service é‡æ–°å¯åŠ¨NginxæœåŠ¡</p><p>systemctl status nginx.service  æŸ¥çœ‹è¿è¡ŒçŠ¶æ€</p></blockquote><blockquote><p>æ ¸å¿ƒé…ç½®ï¼š&#x2F;etc&#x2F;nginx&#x2F;nginx.conf</p></blockquote><h3 id="2-1-å®éªŒ1ï¼šNginxåŸºç¡€"><a href="#2-1-å®éªŒ1ï¼šNginxåŸºç¡€" class="headerlink" title="2.1 å®éªŒ1ï¼šNginxåŸºç¡€"></a>2.1 å®éªŒ1ï¼šNginxåŸºç¡€</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®‰è£…</span></span><br><span class="line">[root@1010 ~]# yum install nginx -y</span><br><span class="line"><span class="comment">#æœåŠ¡å¯åŠ¨</span></span><br><span class="line">[root@1010 ~]# systemctl start nginx.service</span><br><span class="line"><span class="comment">#å…³é—­é˜²ç«å¢™</span></span><br><span class="line">[root@1010 ~]# systemctl --now <span class="built_in">disable</span> firewalld.service</span><br><span class="line"><span class="comment">#è®¾ç½®å…¼å®¹æ¨¡å¼</span></span><br><span class="line">[root@1010 ~]# setenforce 0</span><br></pre></td></tr></table></figure><blockquote><p>é»˜è®¤ç›®å½•ä¸º&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# curl 192.168.232.3</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-10-24_23-06-42.png" alt="PixPin_2025-10-24_23-06-42"></p><h3 id="2-2-å®éªŒ2ï¼šä¿®æ”¹ç«¯å£ã€é»˜è®¤ç›®å½•ã€é»˜è®¤æ–‡ä»¶è®¿é—®webé¡µé¢"><a href="#2-2-å®éªŒ2ï¼šä¿®æ”¹ç«¯å£ã€é»˜è®¤ç›®å½•ã€é»˜è®¤æ–‡ä»¶è®¿é—®webé¡µé¢" class="headerlink" title="2.2 å®éªŒ2ï¼šä¿®æ”¹ç«¯å£ã€é»˜è®¤ç›®å½•ã€é»˜è®¤æ–‡ä»¶è®¿é—®webé¡µé¢"></a>2.2 å®éªŒ2ï¼šä¿®æ”¹ç«¯å£ã€é»˜è®¤ç›®å½•ã€é»˜è®¤æ–‡ä»¶è®¿é—®webé¡µé¢</h3><h4 id="å¤šç«¯å£è®¿é—®åŒä¸€webé¡µé¢"><a href="#å¤šç«¯å£è®¿é—®åŒä¸€webé¡µé¢" class="headerlink" title="å¤šç«¯å£è®¿é—®åŒä¸€webé¡µé¢"></a>å¤šç«¯å£è®¿é—®åŒä¸€webé¡µé¢</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¼–è¾‘é…ç½®æ–‡ä»¶(/etc/nginx/nginx.conf)</span></span><br><span class="line">[root@1010 ~]# vim /etc/nginx/nginx.conf</span><br><span class="line"></span><br><span class="line">        listen       80;</span><br><span class="line">        listen       81;<span class="comment">#æ·»åŠ 81ç«¯å£</span></span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-10-24_23-12-03.png" alt="PixPin_2025-10-24_23-12-03"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é‡å¯NginxæœåŠ¡</span></span><br><span class="line">[root@1010 ~]# systemctl restart nginx.service </span><br><span class="line"><span class="comment">#é˜²ç«å¢™</span></span><br><span class="line">[root@1010 ~]# systemctl --now <span class="built_in">disable</span> firewalld</span><br><span class="line"><span class="comment">#å…¼å®¹æ¨¡å¼</span></span><br><span class="line">[root@1010 ~]# setenforce 0</span><br><span class="line"><span class="comment">#ç›‘å¬ç«¯å£</span></span><br><span class="line">[root@1010 ~]# netstat -lntup | grep nginx</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-10-24_23-20-52.png" alt="PixPin_2025-10-24_23-20-52"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# curl 192.168.232.3:80</span><br><span class="line">[root@1010 ~]# curl 192.168.232.3:81</span><br></pre></td></tr></table></figure> <img src="https://b5dbf24.webp.li/PixPin_2025-10-24_23-42-35.png" alt="PixPin_2025-10-24_23-42-35" style="zoom: 50%;" /><h4 id="è‡ªå®šä¹‰é»˜è®¤ç›®å½•"><a href="#è‡ªå®šä¹‰é»˜è®¤ç›®å½•" class="headerlink" title="è‡ªå®šä¹‰é»˜è®¤ç›®å½•"></a>è‡ªå®šä¹‰é»˜è®¤ç›®å½•</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¼–è¾‘é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@1010 ~]# vim /etc/nginx/nginx.conf</span><br><span class="line">       <span class="comment"># root         /usr/share/nginx/html;</span></span><br><span class="line">        root         /web;</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-10-24_23-46-53.png" alt="PixPin_2025-10-24_23-46-53"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@1010 ~]# <span class="built_in">mkdir</span> /web</span><br><span class="line">[root@1010 ~]# systemctl restart nginx.service</span><br><span class="line">[root@1010 ~]# vim /web/index.html</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-10-24_23-50-09.png" alt="PixPin_2025-10-24_23-50-09"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# curl 192.168.232.3:80</span><br><span class="line">&lt;!DOCTYPE html PUBLIC <span class="string">&quot;-//W3C//DTD XHTML 1.1//EN&quot;</span> <span class="string">&quot;http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div style=<span class="string">&quot;text-align:center;&quot;</span>&gt;</span><br><span class="line">&lt;img src=<span class="string">&quot;https://ts1.tc.mm.bing.net/th/id/R-C.987f582c510be58755c4933cda68d525?rik=C0D21hJDYvXosw&amp;riu=http%3a%2f%2fimg.pconline.com.cn%2fimages%2fupload%2fupc%2ftx%2fwallpaper%2f1305%2f16%2fc4%2f20990657_1368686545122.jpg&amp;ehk=netN2qzcCVS4ALUQfDOwxAwFcy41oxC%2b0xTFvOYy5ds%3d&amp;risl=&amp;pid=ImgRaw&amp;r=0&quot;</span>  height=<span class="string">&quot;600px&quot;</span> width=<span class="string">&quot;800px&quot;</span>&gt;</span><br><span class="line">&lt;/img&gt;</span><br><span class="line">&lt;div&gt;æµ‹è¯•å›¾åƒ&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure> <img src="https://b5dbf24.webp.li/PixPin_2025-10-24_23-52-31.png" alt="PixPin_2025-10-24_23-52-31" style="zoom: 67%;" /><h4 id="é€šè¿‡ä¸åŒæ–‡ä»¶è®¿é—®webé¡µé¢"><a href="#é€šè¿‡ä¸åŒæ–‡ä»¶è®¿é—®webé¡µé¢" class="headerlink" title="é€šè¿‡ä¸åŒæ–‡ä»¶è®¿é—®webé¡µé¢"></a>é€šè¿‡ä¸åŒæ–‡ä»¶è®¿é—®webé¡µé¢</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¼–è¾‘é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@1010 ~]# vim /etc/nginx/default.d/web.conf</span><br><span class="line">location /html &#123;</span><br><span class="line">  root /web;</span><br><span class="line">  index 1.html;</span><br><span class="line">  error_log /web/error/web_error.log;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@1010 ~]# <span class="built_in">mkdir</span> /web</span><br><span class="line">[root@1010 ~]# <span class="built_in">mkdir</span> /web/html</span><br><span class="line">[root@1010 ~]# <span class="built_in">mkdir</span> /web/error</span><br><span class="line">[root@1010 ~]# <span class="built_in">echo</span> <span class="string">&#x27;/web/html  mulu xia&#x27;</span> &gt; /web/html/1.html</span><br><span class="line"><span class="comment">#é‡å¯æœåŠ¡</span></span><br><span class="line">[root@1010 ~]# systemctl restart nginx</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æŸ¥çœ‹ç›®å½•ç»“æ„</span></span><br><span class="line">[root@1010 ~]# tree /web</span><br></pre></td></tr></table></figure> <img src="https://b5dbf24.webp.li/PixPin_2025-10-25_11-25-24.png" alt="PixPin_2025-10-25_11-25-24" style="zoom: 150%;" /><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# curl 192.168.232.3/html/</span><br><span class="line">/web/html  mulu xia</span><br><span class="line"></span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-10-25_11-19-53.png" alt="PixPin_2025-10-25_11-19-53"></p><h3 id="3-3-å®éªŒä¸‰ï¼šåŸºäºä¸åŒç«¯å£-ç›®å½•ã€IPã€åŸŸå-è®¿é—®ä¸åŒé¡µé¢"><a href="#3-3-å®éªŒä¸‰ï¼šåŸºäºä¸åŒç«¯å£-ç›®å½•ã€IPã€åŸŸå-è®¿é—®ä¸åŒé¡µé¢" class="headerlink" title="3.3 å®éªŒä¸‰ï¼šåŸºäºä¸åŒç«¯å£(ç›®å½•ã€IPã€åŸŸå)è®¿é—®ä¸åŒé¡µé¢"></a>3.3 å®éªŒä¸‰ï¼šåŸºäºä¸åŒç«¯å£(ç›®å½•ã€IPã€åŸŸå)è®¿é—®ä¸åŒé¡µé¢</h3><h4 id="3-3-1-åŸºäºä¸åŒç«¯å£è®¿é—®ä¸åŒé¡µé¢"><a href="#3-3-1-åŸºäºä¸åŒç«¯å£è®¿é—®ä¸åŒé¡µé¢" class="headerlink" title="3.3.1 åŸºäºä¸åŒç«¯å£è®¿é—®ä¸åŒé¡µé¢"></a>3.3.1 åŸºäºä¸åŒç«¯å£è®¿é—®ä¸åŒé¡µé¢</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ–¹æ³•1ï¼š(ä¸è¦†ç›–ä¸»é…ç½®root)</span></span><br><span class="line"><span class="comment">#é…ç½®ç¼–è¾‘æ–‡ä»¶</span></span><br><span class="line">[root@1010 ~]# vim /etc/nginx/conf.d/port.conf</span><br><span class="line">server &#123;</span><br><span class="line">  listen 80;</span><br><span class="line">  location / &#123;</span><br><span class="line">    index port80.html;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">  listen 81;</span><br><span class="line">  location / &#123;</span><br><span class="line">    index port81.html;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#åˆ›å»ºå¯¹åº”html</span></span><br><span class="line">[root@1010 ~]# <span class="built_in">cd</span> /usr/share/nginx/html/</span><br><span class="line">[root@1010 html]# <span class="built_in">echo</span> <span class="string">&quot;This is port 80&quot;</span> &gt; port80.html</span><br><span class="line">[root@1010 html]# <span class="built_in">echo</span> <span class="string">&quot;This is port 81&quot;</span> &gt; port81.html</span><br><span class="line"><span class="comment">#é‡å¯æœåŠ¡</span></span><br><span class="line">[root@1010 ~]# systemctl restart nginx</span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# curl 192.168.232.3:80</span><br><span class="line">This is port 80</span><br><span class="line">[root@1010 ~]# curl 192.168.232.3:81</span><br><span class="line">This is port 81</span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-10-25_15-18-27.png" alt="PixPin_2025-10-25_15-18-27"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ–¹æ³•2ï¼š(è®¾ç½®rootå‚æ•°è¦†ç›–ä¸»é…ç½®æ–‡ä»¶)</span></span><br><span class="line"><span class="comment">#ä¿®æ”¹é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@1010 ~]# vim /etc/nginx/conf.d/port.conf</span><br><span class="line">server &#123;</span><br><span class="line">  listen 80;</span><br><span class="line">  location / &#123;</span><br><span class="line">    root /web;</span><br><span class="line">    index port80.html;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">  listen 81;</span><br><span class="line">  location / &#123;</span><br><span class="line">    root /web;</span><br><span class="line">    index port81.html;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#åˆ›å»ºå¯¹åº”html</span></span><br><span class="line">[root@1010 web]# <span class="built_in">echo</span> <span class="string">&#x27;This is /web 80&#x27;</span> &gt; port80.html</span><br><span class="line">[root@1010 web]# <span class="built_in">echo</span> <span class="string">&#x27;This is /web 81&#x27;</span> &gt; port81.html</span><br><span class="line"><span class="comment">#é‡å¯æœåŠ¡</span></span><br><span class="line">[root@1010 ~]# systemctl restart nginx</span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# curl 192.168.232.3:80</span><br><span class="line">This is /web 80</span><br><span class="line">[root@1010 ~]# curl 192.168.232.3:81</span><br><span class="line">This is /web 81</span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-10-25_15-13-30.png" alt="PixPin_2025-10-25_15-13-30"></p><h4 id="3-3-2-åŸºäºä¸åŒç›®å½•è®¿é—®ä¸åŒé¡µé¢"><a href="#3-3-2-åŸºäºä¸åŒç›®å½•è®¿é—®ä¸åŒé¡µé¢" class="headerlink" title="3.3.2 åŸºäºä¸åŒç›®å½•è®¿é—®ä¸åŒé¡µé¢"></a>3.3.2 åŸºäºä¸åŒç›®å½•è®¿é—®ä¸åŒé¡µé¢</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¼–è¾‘é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@1010 ~]# vim /etc/nginx/conf.d/dir.conf</span><br><span class="line">server &#123;</span><br><span class="line">  listen 82;</span><br><span class="line">  root /web;</span><br><span class="line">  location /dir1 &#123;</span><br><span class="line">    index index1.html;</span><br><span class="line">  &#125;</span><br><span class="line">  location /dir2 &#123;</span><br><span class="line">    index index2.html;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#åˆ›å»ºæ–‡ä»¶</span></span><br><span class="line">[root@1010 ~]# <span class="built_in">mkdir</span> /web/dir1 /web/dir2</span><br><span class="line">[root@1010 ~]# tree /web</span><br><span class="line">/web</span><br><span class="line">â”œâ”€â”€ dir1</span><br><span class="line">â”œâ”€â”€ dir2</span><br><span class="line">â”œâ”€â”€ error</span><br><span class="line">â”‚Â Â  â””â”€â”€ web_error.log</span><br><span class="line">â”œâ”€â”€ html</span><br><span class="line">â”‚Â Â  â””â”€â”€ 1.html</span><br><span class="line">â”œâ”€â”€ index.html</span><br><span class="line">â”œâ”€â”€ port80.html</span><br><span class="line">â””â”€â”€ port81.html</span><br><span class="line"></span><br><span class="line">4 directories, 5 files</span><br><span class="line">[root@1010 ~]# <span class="built_in">echo</span> <span class="string">&#x27;location ---&gt; /web/dir1 &#x27;</span> &gt; /web/dir1/index1.html</span><br><span class="line">[root@1010 ~]# <span class="built_in">echo</span> <span class="string">&#x27;location ---&gt; /web/dir2 &#x27;</span> &gt; /web/dir2/index2.html</span><br><span class="line"><span class="comment">#é‡å¯æœåŠ¡</span></span><br><span class="line">[root@1010 ~]# systemctl restart nginx</span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# curl 192.168.232.3:82/dir1/</span><br><span class="line">location ---&gt; /web/dir1 </span><br><span class="line">[root@1010 ~]# curl 192.168.232.3:82/dir2/</span><br><span class="line">location ---&gt; /web/dir2</span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-10-25_15-41-01.png" alt="PixPin_2025-10-25_15-41-01"></p><blockquote><p>root &#x2F;web å¯æ”¾åœ¨locationå¤–é¢æˆ–é‡Œé¢ï¼›</p></blockquote><h4 id="3-3-3-åŸºäºä¸åŒIPè®¿é—®ä¸åŒé¡µé¢"><a href="#3-3-3-åŸºäºä¸åŒIPè®¿é—®ä¸åŒé¡µé¢" class="headerlink" title="3.3.3 åŸºäºä¸åŒIPè®¿é—®ä¸åŒé¡µé¢"></a>3.3.3 åŸºäºä¸åŒIPè®¿é—®ä¸åŒé¡µé¢</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ·»åŠ IPå¹¶æ¿€æ´»</span></span><br><span class="line">[root@1010 ~]#nmtui</span><br><span class="line"><span class="comment">#ç¼–è¾‘é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@1010 ~]# vim /etc/nginx/conf.d/ip.con</span><br><span class="line">server&#123;</span><br><span class="line">  listen 192.168.232.3:83;</span><br><span class="line">  root /web;</span><br><span class="line">  location /dir1 &#123;</span><br><span class="line">    index index1.html;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">server&#123;</span><br><span class="line">  listen 192.168.232.4:83;</span><br><span class="line">  root /web;</span><br><span class="line">  location /dir2 &#123;</span><br><span class="line">    index index2.html;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#åˆ›å»ºç›®å½•ä¸htmlæ–‡ä»¶</span></span><br><span class="line"><span class="comment">#å»¶ç»­ä¸Šé¢å®éªŒçš„ç›®å½•ï¼Œä¸å†é‡æ–°åˆ›å»º</span></span><br><span class="line"><span class="comment">#ä¿®æ”¹htmlå†…å®¹</span></span><br><span class="line">[root@1010 ~]# <span class="built_in">echo</span> <span class="string">&#x27;192.168.232.3:83 location ---&gt; /web/dir1 &#x27;</span> &gt; /web/dir1/index1.html</span><br><span class="line">[root@1010 ~]# <span class="built_in">echo</span> <span class="string">&#x27;192.168.232.4:83 location ---&gt; /web/dir2 &#x27;</span> &gt; /web/dir2/index2.html</span><br><span class="line"><span class="comment">#é‡å¯æœåŠ¡</span></span><br><span class="line">[root@1010 ~]# systemctl restart nginx</span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# curl 192.168.232.3:83/dir1/</span><br><span class="line">192.168.232.3:83 location ---&gt; /web/dir1 </span><br><span class="line">[root@1010 ~]# curl 192.168.232.4:83/dir2/</span><br><span class="line">192.168.232.4:83 location ---&gt; /web/dir2</span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-10-25_15-54-22.png" alt="PixPin_2025-10-25_15-54-22"></p><h4 id="3-3-4-åŸºäºä¸åŒåŸŸåè®¿é—®ä¸åŒé¡µé¢"><a href="#3-3-4-åŸºäºä¸åŒåŸŸåè®¿é—®ä¸åŒé¡µé¢" class="headerlink" title="3.3.4 åŸºäºä¸åŒåŸŸåè®¿é—®ä¸åŒé¡µé¢"></a>3.3.4 åŸºäºä¸åŒåŸŸåè®¿é—®ä¸åŒé¡µé¢</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¼–è¾‘é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@1010 ~]#  vim /etc/nginx/conf.d/www.conf</span><br><span class="line">server &#123;</span><br><span class="line">  listen 84;</span><br><span class="line">  root /web;</span><br><span class="line">  server_name hym.com;</span><br><span class="line">  location /dir1 &#123;</span><br><span class="line">    index index3.html;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">  listen 84;</span><br><span class="line">  root /web;</span><br><span class="line">  server_name hym.cn;</span><br><span class="line">  location /dir2 &#123;</span><br><span class="line">    index index4.html;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#åˆ›å»ºhtml</span></span><br><span class="line">[root@1010 ~]# <span class="built_in">echo</span> <span class="string">&#x27;hym.com ---&gt; dir1/&#x27;</span> &gt; /web/dir1/index3.html</span><br><span class="line">[root@1010 ~]# <span class="built_in">echo</span> <span class="string">&#x27;hym.cn ---&gt; dir2/&#x27;</span> &gt; /web/dir2/index4.html</span><br><span class="line"><span class="comment">#åŸŸåæ˜ å°„</span></span><br><span class="line"><span class="comment">#liunx</span></span><br><span class="line">[root@1010 ~]# vim /etc/hosts</span><br><span class="line">192.168.232.3 hym.com hym.cn</span><br><span class="line"><span class="comment">#windows</span></span><br><span class="line">C:\Windows\System32\drivers\etc\hosts</span><br><span class="line"><span class="comment">#é‡å¯æœåŠ¡</span></span><br><span class="line">[root@1010 ~]# systemctl restart nginx</span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# curl hym.com:84/dir1/</span><br><span class="line">hym.com ---&gt; dir1/</span><br><span class="line">[root@1010 ~]# curl hym.cn:84/dir2/</span><br><span class="line">hym.cn ---&gt; dir2/</span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-10-25_16-30-39.png" alt="PixPin_2025-10-25_16-30-39"></p><h1 id="25-10-29-Web"><a href="#25-10-29-Web" class="headerlink" title="25-10-29(Web)"></a>25-10-29(Web)</h1><h2 id="1-Webç†è®º"><a href="#1-Webç†è®º" class="headerlink" title="1.Webç†è®º"></a>1.Webç†è®º</h2><p><strong>ç†è®ºéƒ¨åˆ†å‚è€ƒ</strong>  <a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/04web%E7%90%86%E8%AE%BA.md">è·³è½¬</a></p><h2 id="2-Webå®éªŒï¼š"><a href="#2-Webå®éªŒï¼š" class="headerlink" title="2.Webå®éªŒï¼š"></a>2.Webå®éªŒï¼š</h2><h3 id="2-1-å®‰è£…"><a href="#2-1-å®‰è£…" class="headerlink" title="2.1.å®‰è£…"></a>2.1.å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@1010 ~]# dnf install httpd-tools-2.4.57-5.el9.x86_64</span><br></pre></td></tr></table></figure><h3 id="2-2-è®¿é—®æ§åˆ¶"><a href="#2-2-è®¿é—®æ§åˆ¶" class="headerlink" title="2.2.è®¿é—®æ§åˆ¶"></a>2.2.è®¿é—®æ§åˆ¶</h3><h4 id="2-2-1-åŸºäºä¸åŒç”¨æˆ·çš„è®¿é—®æ§åˆ¶è®¿é—®åŒä¸€é¡µé¢"><a href="#2-2-1-åŸºäºä¸åŒç”¨æˆ·çš„è®¿é—®æ§åˆ¶è®¿é—®åŒä¸€é¡µé¢" class="headerlink" title="2.2.1.åŸºäºä¸åŒç”¨æˆ·çš„è®¿é—®æ§åˆ¶è®¿é—®åŒä¸€é¡µé¢"></a>2.2.1.åŸºäºä¸åŒç”¨æˆ·çš„è®¿é—®æ§åˆ¶è®¿é—®åŒä¸€é¡µé¢</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åˆ›å»ºè®¿é—®ç”¨æˆ·</span></span><br><span class="line">[root@1010 ~]# htpasswd -cb /etc/nginx/conf.d/auth_passwd hua1 passwd</span><br><span class="line">Adding password <span class="keyword">for</span> user hua1</span><br><span class="line">[root@1010 ~]# htpasswd -b /etc/nginx/conf.d/auth_passwd hua2 passwd</span><br><span class="line">Adding password <span class="keyword">for</span> user hua2</span><br><span class="line">[root@1010 ~]# <span class="built_in">cat</span>  /etc/nginx/conf.d/auth_passwd</span><br><span class="line">hua1:$apr1$abKnNyKn<span class="variable">$t4P9lZdmWRurMgmzASRn60</span></span><br><span class="line">hua2:$apr1$hS73hLM8<span class="variable">$z8YEsjzZdRpLfocEJ5KXh</span>.</span><br><span class="line"><span class="comment">#é…ç½®åŸºæœ¬æ–‡ä»¶</span></span><br><span class="line">[root@1010 ~]# vim /etc/nginx/conf.d/access.conf</span><br><span class="line">server &#123;</span><br><span class="line">        listen 192.168.232.3:80;</span><br><span class="line">        root /web;</span><br><span class="line">        location / &#123;</span><br><span class="line">                auth_basic on;</span><br><span class="line">                auth_basic_user_file /etc/nginx/conf.d/auth_passwd;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">        listen 192.168.232.4:80;</span><br><span class="line">        root /web;</span><br><span class="line">        location / &#123;</span><br><span class="line">                auth_basic on;</span><br><span class="line">                auth_basic_user_file /etc/nginx/conf.d/auth_passwd;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> <img src="https://b5dbf24.webp.li/PixPin_2025-10-29_20-23-33.png" alt="PixPin_2025-10-29_20-23-33" style="zoom: 80%;" /><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é‡å¯æœåŠ¡</span></span><br><span class="line">[root@1010 ~]# systemctl restart nginx</span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# curl 192.168.232.3:80 -u hua1</span><br><span class="line">[root@1010 ~]# curl 192.168.232.3:80 -u hua2</span><br></pre></td></tr></table></figure><p> ï¼ˆæœ¬æœºï¼‰</p> <img src="https://b5dbf24.webp.li/PixPin_2025-10-29_20-27-30.png" alt="PixPin_2025-10-29_20-27-30" style="zoom: 80%;" /><p> ï¼ˆæµè§ˆå™¨ï¼‰</p> <img src="https://b5dbf24.webp.li/PixPin_2025-10-29_20-28-25.png" alt="PixPin_2025-10-29_20-28-25" style="zoom:80%;" /> <img src="https://b5dbf24.webp.li/PixPin_2025-10-29_20-28-32.png" alt="PixPin_2025-10-29_20-28-32" style="zoom:80%;" /><h4 id="2-2-2-åŸºäºä¸åŒçš„ç”¨æˆ·è®¤è¯è®¿é—®-ä¸åŒçš„é¡µé¢"><a href="#2-2-2-åŸºäºä¸åŒçš„ç”¨æˆ·è®¤è¯è®¿é—®-ä¸åŒçš„é¡µé¢" class="headerlink" title="2.2.2.åŸºäºä¸åŒçš„ç”¨æˆ·è®¤è¯è®¿é—® ä¸åŒçš„é¡µé¢"></a>2.2.2.åŸºäºä¸åŒçš„ç”¨æˆ·è®¤è¯è®¿é—® ä¸åŒçš„é¡µé¢</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">[root@1010 ~]# tree /web</span><br><span class="line">/web</span><br><span class="line">â”œâ”€â”€ access</span><br><span class="line">â”‚Â Â  â””â”€â”€ access.html</span><br><span class="line">â”œâ”€â”€ dir1</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ index1.html</span><br><span class="line">â”‚Â Â  â””â”€â”€ index3.html</span><br><span class="line">â”œâ”€â”€ dir2</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ index2.html</span><br><span class="line">â”‚Â Â  â””â”€â”€ index4.html</span><br><span class="line">â”œâ”€â”€ error</span><br><span class="line">â”‚Â Â  â””â”€â”€ web_error.log</span><br><span class="line">â”œâ”€â”€ html</span><br><span class="line">â”‚Â Â  â””â”€â”€ 1.html</span><br><span class="line">â”œâ”€â”€ index.html</span><br><span class="line">â”œâ”€â”€ port80.html</span><br><span class="line">â””â”€â”€ port81.html</span><br><span class="line"></span><br><span class="line">5 directories, 10 files</span><br><span class="line"></span><br><span class="line">[root@1010 ~]#  htpasswd -cb /etc/nginx/conf.d/auth_passwd1 hua3 passwd</span><br><span class="line">Adding password <span class="keyword">for</span> user hua3</span><br><span class="line">[root@1010 ~]# tree /etc/nginx/conf.d/</span><br><span class="line">/etc/nginx/conf.d/</span><br><span class="line">â”œâ”€â”€ access.conf</span><br><span class="line">â”œâ”€â”€ auth_passwd</span><br><span class="line">â”œâ”€â”€ auth_passwd1</span><br><span class="line">â”œâ”€â”€ dir.conf</span><br><span class="line">â”œâ”€â”€ ip.conf</span><br><span class="line">â”œâ”€â”€ port.conf</span><br><span class="line">â””â”€â”€ www.conf</span><br><span class="line"></span><br><span class="line">0 directories, 7 files</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@1010 ~]# vim /etc/nginx/conf.d/access.conf</span><br><span class="line">server &#123;</span><br><span class="line">        listen 192.168.232.3:80;</span><br><span class="line">        root /web;</span><br><span class="line">        location / &#123;</span><br><span class="line">                auth_basic on;</span><br><span class="line">                auth_basic_user_file /etc/nginx/conf.d/auth_passwd;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">        listen 192.168.232.4:80;</span><br><span class="line">        root /web;</span><br><span class="line">        location /html &#123;</span><br><span class="line">                auth_basic on;</span><br><span class="line">                auth_basic_user_file /etc/nginx/conf.d/auth_passwd1;</span><br><span class="line">                index 1.html;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@1010 ~]# systemctl restart nginx</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# curl 192.168.232.3:80 -u hua2</span><br><span class="line">Enter host password <span class="keyword">for</span> user <span class="string">&#x27;hua2&#x27;</span>:</span><br><span class="line">&lt;!DOCTYPE html PUBLIC <span class="string">&quot;-//W3C//DTD XHTML 1.1//EN&quot;</span> <span class="string">&quot;http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div style=<span class="string">&quot;text-align:center;&quot;</span>&gt;</span><br><span class="line">&lt;img src=<span class="string">&quot;https://ts1.tc.mm.bing.net/th/id/R-C.987f582c510be58755c4933cda68d525?rik=C0D21hJDYvXosw&amp;riu=http%3a%2f%2fimg.pconline.com.cn%2fimages%2fupload%2fupc%2ftx%2fwallpaper%2f1305%2f16%2fc4%2f20990657_1368686545122.jpg&amp;ehk=netN2qzcCVS4ALUQfDOwxAwFcy41oxC%2b0xTFvOYy5ds%3d&amp;risl=&amp;pid=ImgRaw&amp;r=0&quot;</span>  height=<span class="string">&quot;600px&quot;</span> width=<span class="string">&quot;800px&quot;</span>&gt;</span><br><span class="line">&lt;/img&gt;</span><br><span class="line">&lt;div&gt;æµ‹è¯•å›¾åƒ&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">[root@1010 ~]# curl 192.168.232.4:80/html/ -u hua3</span><br><span class="line">Enter host password <span class="keyword">for</span> user <span class="string">&#x27;hua3&#x27;</span>:</span><br><span class="line">/web/html  mulu xia</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p> ï¼ˆæœ¬æœºï¼‰</p> <img src="https://b5dbf24.webp.li/PixPin_2025-10-29_20-43-33.png" alt="PixPin_2025-10-29_20-43-33" style="zoom:80%;" /><p> ï¼ˆæµè§ˆå™¨ï¼‰</p> <img src="https://b5dbf24.webp.li/PixPin_2025-10-29_20-44-03.png" alt="PixPin_2025-10-29_20-44-03" style="zoom:80%;" /><h4 id="2-2-3-åŸºäºæºipçš„è®¿é—®æ§åˆ¶"><a href="#2-2-3-åŸºäºæºipçš„è®¿é—®æ§åˆ¶" class="headerlink" title="2.2.3 åŸºäºæºipçš„è®¿é—®æ§åˆ¶"></a>2.2.3 åŸºäºæºipçš„è®¿é—®æ§åˆ¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¼–è¾‘é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@1010 ~]# vim /etc/nginx/conf.d/access.conf</span><br><span class="line">server &#123;</span><br><span class="line">        listen 192.168.232.3:80;</span><br><span class="line">        root /web;</span><br><span class="line">        location / &#123;</span><br><span class="line">                allow 192.168.232.1;</span><br><span class="line">                deny all;</span><br><span class="line"><span class="comment">#               auth_basic on;</span></span><br><span class="line"><span class="comment">#               auth_basic_user_file /etc/nginx/conf.d/auth_passwd;</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-10-29_20-47-35.png" alt="PixPin_2025-10-29_20-47-35"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é‡å¯æœåŠ¡</span></span><br><span class="line">[root@1010 ~]# systemctl restart nginx</span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# curl 192.168.232.3:80</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;<span class="built_in">head</span>&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;center&gt;&lt;h1&gt;403 Forbidden&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;hr&gt;&lt;center&gt;nginx/1.20.1&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure> <img src="https://b5dbf24.webp.li/PixPin_2025-10-29_20-48-39.png" alt="PixPin_2025-10-29_20-48-39" style="zoom:80%;" /><h3 id="2-3-https"><a href="#2-3-https" class="headerlink" title="2.3 https"></a>2.3 https</h3><h4 id="2-3-1-æ­å»ºnginx-sslçš„åŠ å¯†è®¤è¯webæœåŠ¡å™¨"><a href="#2-3-1-æ­å»ºnginx-sslçš„åŠ å¯†è®¤è¯webæœåŠ¡å™¨" class="headerlink" title="2.3.1 æ­å»ºnginx+sslçš„åŠ å¯†è®¤è¯webæœåŠ¡å™¨"></a>2.3.1 æ­å»ºnginx+sslçš„åŠ å¯†è®¤è¯webæœåŠ¡å™¨</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åˆ›å»ºç§é’¥</span></span><br><span class="line">[root@1010 ~]# openssl genrsa -out /web/https/1.key</span><br><span class="line"><span class="comment">#åŸºäºç§ç¥åˆ›å»ºè¯ä¹¦</span></span><br><span class="line">[root@1010 ~]# openssl req -utf8 -new -key /web/https/1.key -x509 -days 100 -out /web/https/ssl.crt</span><br><span class="line">You are about to be asked to enter information that will be incorporated</span><br><span class="line">into your certificate request.</span><br><span class="line">What you are about to enter is what is called a Distinguished Name or a DN.</span><br><span class="line">There are quite a few fields but you can leave some blank</span><br><span class="line">For some fields there will be a default value,</span><br><span class="line">If you enter <span class="string">&#x27;.&#x27;</span>, the field will be left blank.</span><br><span class="line">-----</span><br><span class="line">Country Name (2 letter code) [XX]:CN</span><br><span class="line">State or Province Name (full name) []:HuNan </span><br><span class="line">Locality Name (eg, city) [Default City]:Changsha</span><br><span class="line">Organization Name (eg, company) [Default Company Ltd]:</span><br><span class="line">Organizational Unit Name (eg, section) []:</span><br><span class="line">Common Name (eg, your name or your server<span class="string">&#x27;s hostname) []:www.hym.com</span></span><br><span class="line"><span class="string">Email Address []:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#ç¼–è¾‘é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="string">[root@1010 ~]# vim /etc/nginx/conf.d/openss.conf</span></span><br><span class="line"><span class="string">server &#123;</span></span><br><span class="line"><span class="string">        listen 192.168.232.3:443 ssl ;</span></span><br><span class="line"><span class="string">        root /web ;</span></span><br><span class="line"><span class="string">        ssl_certificate &quot;/web/https/ssl.crt&quot;;</span></span><br><span class="line"><span class="string">        ssl_certificate_key &quot;/web/https/1.key&quot;;</span></span><br><span class="line"><span class="string">        location / &#123;</span></span><br><span class="line"><span class="string">        index index.html;</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">#é‡å¯æœåŠ¡</span></span><br><span class="line"><span class="string">[root@1010 ~]# systemctl restart nginx</span></span><br><span class="line"><span class="string">#æµ‹è¯•</span></span><br></pre></td></tr></table></figure> <img src="https://b5dbf24.webp.li/PixPin_2025-10-29_20-59-57.png" alt="PixPin_2025-10-29_20-59-57" style="zoom:80%;" /> <img src="https://b5dbf24.webp.li/PixPin_2025-10-29_21-00-08.png" alt="PixPin_2025-10-29_21-00-08" style="zoom:80%;" /><h1 id="25-10-31-DNS"><a href="#25-10-31-DNS" class="headerlink" title="25-10-31(DNS)"></a>25-10-31(DNS)</h1><h2 id="1-DNSç†è®º"><a href="#1-DNSç†è®º" class="headerlink" title="1.DNSç†è®º"></a>1.DNSç†è®º</h2><p><strong>ç†è®ºéƒ¨åˆ†å‚è€ƒ</strong>  <a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/05dns%E7%90%86%E8%AE%BA.md">è·³è½¬</a></p><h2 id="2-DNFå®éªŒ"><a href="#2-DNFå®éªŒ" class="headerlink" title="2.DNFå®éªŒ"></a>2.DNFå®éªŒ</h2><h3 id="2-1-å®‰è£…-1"><a href="#2-1-å®‰è£…-1" class="headerlink" title="2.1.å®‰è£…"></a>2.1.å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æŸ¥è¯¢è½¯ä»¶åŒ…å</span></span><br><span class="line">[root@1010 ~]# dnf search name DNS</span><br><span class="line">[root@1010 ~]# dnf install <span class="built_in">bind</span> bind-utils -y</span><br></pre></td></tr></table></figure><h3 id="2-2-æ­£å‘è§£æ"><a href="#2-2-æ­£å‘è§£æ" class="headerlink" title="2.2.æ­£å‘è§£æ"></a>2.2.æ­£å‘è§£æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¿®æ”¹æ ¸å¿ƒé…ç½®æ–‡ä»¶ /etc/named.conf</span></span><br><span class="line">[root@1010 ~]# vim /etc/named.conf</span><br><span class="line">options &#123;</span><br><span class="line">        listen-on port 53 &#123; any; &#125;;</span><br><span class="line">        directory       <span class="string">&quot;/var/named&quot;</span>;</span><br><span class="line">        allow-query     &#123; any; &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">logging &#123;</span><br><span class="line">        channel default_debug &#123;</span><br><span class="line">                file <span class="string">&quot;data/named.run&quot;</span>;</span><br><span class="line">                severity dynamic;</span><br><span class="line">        &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">zone <span class="string">&quot;.&quot;</span> IN &#123;</span><br><span class="line">        <span class="built_in">type</span> hint;</span><br><span class="line">        file <span class="string">&quot;named.ca&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">include <span class="string">&quot;/etc/named.rfc1912.zones&quot;</span>;</span><br><span class="line">include <span class="string">&quot;/etc/named.root.key&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-11-05_17-33-15.png" alt="PixPin_2025-11-05_17-33-15"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é…ç½®</span></span><br><span class="line">[root@1010 ~]# vim /etc/named.rfc1912.zones</span><br><span class="line">zone <span class="string">&quot;hym.com&quot;</span> IN &#123;</span><br><span class="line">        <span class="built_in">type</span> master;</span><br><span class="line">        file <span class="string">&quot;hym.com.zone&quot;</span>;</span><br><span class="line">        allow-update &#123; none; &#125;;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">#åˆ›å»ºæ•°æ®æ–‡ä»¶ï¼Œå­˜å‚¨dnsè®°å½•</span></span><br><span class="line">[root@1010 ~]# <span class="built_in">cd</span> /var/named/</span><br><span class="line">[root@1010 ~]# <span class="built_in">cp</span>  -a   named.localhost hym.com.zone </span><br><span class="line">[root@1010 ~]# vim hym.com.zone</span><br><span class="line"><span class="variable">$TTL</span> 1D</span><br><span class="line">@       IN SOA  ns.hym.com.  admin.hym.com. (</span><br><span class="line">                                        0       ; serial</span><br><span class="line">                                        1D      ; refresh</span><br><span class="line">                                        1H      ; retry</span><br><span class="line">                                        1W      ; expire</span><br><span class="line">                                        3H )    ; minimum</span><br><span class="line">        NS      ns.hym.com.</span><br><span class="line">ns      A       192.168.232.3</span><br><span class="line">www     A       192.168.232.4</span><br><span class="line">blog    CNAME      www.hym.com</span><br><span class="line"></span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-11-05_18-24-13.png" alt="PixPin_2025-11-05_18-24-13"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#æ·»åŠ æ–°IP</span><br><span class="line">nmcli connection modify ens160 +ipv4.addresses 172.25.0.100/24</span><br><span class="line">nmcli connection down ens160</span><br><span class="line">nmcli connection up ens160</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é‡å¯æœåŠ¡</span></span><br><span class="line">[root@1010 ~]# systemctl restart named</span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# host www.hym.com 192.168.232.3</span><br><span class="line">Using domain server:</span><br><span class="line">Name: 192.168.232.3</span><br><span class="line">Address: 192.168.232.3#53</span><br><span class="line">Aliases: </span><br><span class="line"></span><br><span class="line">www.hym.com has address 192.168.232.4</span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-11-05_19-14-46.png" alt="PixPin_2025-11-05_19-14-46"></p><h3 id="2-3-åå‘è§£æ"><a href="#2-3-åå‘è§£æ" class="headerlink" title="2.3.åå‘è§£æ"></a>2.3.åå‘è§£æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¿®æ”¹åŒºåŸŸé…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@1010 ~]# vim /etc/named.rfc1912.zones</span><br><span class="line">zone <span class="string">&quot;232.168.192.in-addr.arpa&quot;</span> IN &#123;</span><br><span class="line">        <span class="built_in">type</span> master;</span><br><span class="line">        file <span class="string">&quot;192.168.232.zone&quot;</span>;</span><br><span class="line">        allow-update &#123; none; &#125;;</span><br><span class="line">&#125;; </span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-11-05_19-27-14.png" alt="PixPin_2025-11-05_19-27-14"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¼–è¾‘æ•°æ®æ–‡ä»¶</span></span><br><span class="line">[root@1010 named]# <span class="built_in">cd</span> /var/named/</span><br><span class="line">[root@1010 named]# <span class="built_in">cp</span> -a named.loopback 192.168.232.zone</span><br><span class="line">[root@1010 named]# vim 192.168.232.zone</span><br><span class="line"><span class="variable">$TTL</span> 1D</span><br><span class="line">@       IN SOA  ns2.hym.com.  admin.hym.com. (</span><br><span class="line">                                        0       ; serial</span><br><span class="line">                                        1D      ; refresh</span><br><span class="line">                                        1H      ; retry</span><br><span class="line">                                        1W      ; expire</span><br><span class="line">                                        3H )    ; minimum</span><br><span class="line">                NS      ns2.hym.com.</span><br><span class="line">                </span><br><span class="line">4               PTR     ns2.hym.com.</span><br><span class="line">5               PTR     xixi.hym.com.</span><br><span class="line">6               PTR     haha.hym.com.</span><br><span class="line">7               PTR     huhu.hym.com.</span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-11-05_19-25-59.png" alt="PixPin_2025-11-05_19-25-59"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é‡å¯æœåŠ¡</span></span><br><span class="line">[root@1010 named]# systemctl restart named</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 named]# host 192.168.232.6 192.168.232.4</span><br><span class="line">Using domain server:</span><br><span class="line">Name: 192.168.232.4</span><br><span class="line">Address: 192.168.232.4#53</span><br><span class="line">Aliases: </span><br><span class="line"></span><br><span class="line">6.232.168.192.in-addr.arpa domain name pointer haha.hym.com.</span><br><span class="line">[root@1010 named]# host 192.168.232.5 192.168.232.4</span><br><span class="line">Using domain server:</span><br><span class="line">Name: 192.168.232.4</span><br><span class="line">Address: 192.168.232.4#53</span><br><span class="line">Aliases: </span><br><span class="line"></span><br><span class="line">5.232.168.192.in-addr.arpa domain name pointer xixi.hym.com.</span><br><span class="line">[root@1010 named]# host 192.168.232.7 192.168.232.4</span><br><span class="line">Using domain server:</span><br><span class="line">Name: 192.168.232.4</span><br><span class="line">Address: 192.168.232.4#53</span><br><span class="line">Aliases: </span><br><span class="line"></span><br><span class="line">7.232.168.192.in-addr.arpa domain name pointer huhu.hym.com.</span><br><span class="line"></span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-11-05_19-25-07.png" alt="PixPin_2025-11-05_19-25-07"></p><h3 id="2-4-ä¸»ä»åŒæ­¥"><a href="#2-4-ä¸»ä»åŒæ­¥" class="headerlink" title="2.4.ä¸»ä»åŒæ­¥"></a>2.4.ä¸»ä»åŒæ­¥</h3><h4 id="2-4-1-å®Œå…¨åŒæ­¥"><a href="#2-4-1-å®Œå…¨åŒæ­¥" class="headerlink" title="2.4.1.å®Œå…¨åŒæ­¥"></a>2.4.1.å®Œå…¨åŒæ­¥</h4><blockquote><p>ä¸»ï¼š192.168.232.133       ä»ï¼š192.168.232.3</p></blockquote><p><strong>å‰ç½®ï¼šå…³é—­é˜²ç«å¢™ï¼Œè°ƒè‡³å®½å®¹æ¨¡å¼</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl --now <span class="built_in">disable</span> firewalld</span><br><span class="line">setenforce 0</span><br></pre></td></tr></table></figure><p><strong>ä¿®æ”¹é…ç½®æ–‡ä»¶</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¸»æœº</span></span><br><span class="line">[root@hym ~]# vim /etc/named.conf</span><br><span class="line">options &#123;</span><br><span class="line">        listen-on port 53 &#123; any; &#125;;</span><br><span class="line">        directory <span class="string">&quot;/var/named&quot;</span>;</span><br><span class="line">        allow-query     &#123; any; &#125;;</span><br><span class="line"><span class="comment">################################################################</span></span><br><span class="line">allow-transfer &#123; 192.168.232.3; &#125;;<span class="comment">#å…è®¸ä»æœºè½¬ç§»dnsè®°å½•</span></span><br><span class="line"><span class="comment">#################################################################</span></span><br><span class="line">&#125;;</span><br><span class="line">logging &#123;</span><br><span class="line">        channel default_debug &#123;</span><br><span class="line">                file <span class="string">&quot;data/named.run&quot;</span>;</span><br><span class="line">                severity dynamic;</span><br><span class="line">        &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">zone <span class="string">&quot;.&quot;</span> IN &#123;</span><br><span class="line">        <span class="built_in">type</span> hint;</span><br><span class="line">        file <span class="string">&quot;named.ca&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line">zone <span class="string">&quot;hym.com.&quot;</span> IN &#123;</span><br><span class="line">        <span class="built_in">type</span> master;</span><br><span class="line">        file <span class="string">&quot;hym.com.zone&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">zone <span class="string">&quot;232.168.192.in-addr.arpa&quot;</span> IN &#123;</span><br><span class="line">        <span class="built_in">type</span> master;</span><br><span class="line">        file <span class="string">&quot;192.168.232.zone&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">#############################################</span></span><br><span class="line">include <span class="string">&quot;/etc/named.rfc1912.zones&quot;</span>;</span><br><span class="line">include <span class="string">&quot;/etc/named.root.key&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ä»æœº</span></span><br><span class="line">[root@1010 ~]# vim /etc/named.conf</span><br><span class="line">options &#123;</span><br><span class="line">listen-on port 53 &#123; any; &#125;;</span><br><span class="line">directory <span class="string">&quot;/var/named&quot;</span>;</span><br><span class="line">allow-query     &#123; any; &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">logging &#123;</span><br><span class="line">        channel default_debug &#123;</span><br><span class="line">                file <span class="string">&quot;data/named.run&quot;</span>;</span><br><span class="line">                severity dynamic;</span><br><span class="line">        &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">zone <span class="string">&quot;.&quot;</span> IN &#123;</span><br><span class="line"><span class="built_in">type</span> hint;</span><br><span class="line">file <span class="string">&quot;named.ca&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">#########################################</span></span><br><span class="line">zone <span class="string">&quot;hym.com.&quot;</span> IN &#123;</span><br><span class="line">        <span class="built_in">type</span> slave;</span><br><span class="line">masters &#123; 192.168.232.133; &#125;;<span class="comment">#ä¸»</span></span><br><span class="line">        file <span class="string">&quot;slaves/hym.com.zone&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">zone <span class="string">&quot;232.168.192.in-addr.arpa&quot;</span> IN &#123;</span><br><span class="line">        <span class="built_in">type</span> slave;</span><br><span class="line">        masters &#123; 192.168.232.133; &#125;;<span class="comment">#ä¸»</span></span><br><span class="line">        file <span class="string">&quot;slaves/192.168.232.zone&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">##########################################</span></span><br><span class="line">include <span class="string">&quot;/etc/named.rfc1912.zones&quot;</span>;</span><br><span class="line">include <span class="string">&quot;/etc/named.root.key&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>åˆ›å»ºæ•°æ®æ–‡ä»¶ï¼ˆä¸»æœºï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[root@hym ~]# vim /var/named/hym.com.zone</span><br><span class="line"><span class="variable">$TTL</span> 1D</span><br><span class="line">@       IN SOA  ns.hym.com. admin.hym.com. (</span><br><span class="line">                                        0       ; serial</span><br><span class="line">                                        1D      ; refresh</span><br><span class="line">                                        1H      ; retry</span><br><span class="line">                                        1W      ; expire</span><br><span class="line">                                        3H )    ; minimum</span><br><span class="line">        NS      ns.hym.com.</span><br><span class="line"></span><br><span class="line">ns      A       192.168.232.133</span><br><span class="line">ns2     A       192.168.232.134</span><br><span class="line">www     A       192.168.232.135</span><br><span class="line">xixi    A       192.168.232.136</span><br><span class="line">blog    CNAME   www.hym.com.</span><br><span class="line"></span><br><span class="line">[root@hym ~]# vim /var/named/192.168.232.zone</span><br><span class="line"><span class="variable">$TTL</span> 1D</span><br><span class="line">@       IN SOA  ns2.hym.com.  admin.hym.com. (</span><br><span class="line">                                        0       ; serial</span><br><span class="line">                                        1D      ; refresh</span><br><span class="line">                                        1H      ; retry</span><br><span class="line">                                        1W      ; expire</span><br><span class="line">                                        3H )    ; minimum</span><br><span class="line">        NS      ns2.hym.com.</span><br><span class="line">133     PTR     ns.hym.com.</span><br><span class="line">134     PTR     ns2.hym.com.</span><br><span class="line">135     PTR     www.hym.com.</span><br><span class="line">136     PTR     xixi.hym.com.</span><br><span class="line">137     PTR     haha.hym.com.</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>é‡å¯æœåŠ¡</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¸»</span></span><br><span class="line">[root@hym ~]# systemctl restart named</span><br><span class="line"><span class="comment">#ä»</span></span><br><span class="line">[root@1010 ~]# systemctl restart named</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ï¼ˆä»æœºï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æŸ¥çœ‹æ–‡ä»¶å˜åŒ–</span></span><br><span class="line">[root@1010 ~]# tree /var/named/</span><br><span class="line">/var/named/</span><br><span class="line">â”œâ”€â”€ 192.168.232.zone</span><br><span class="line">â”œâ”€â”€ data</span><br><span class="line">â”‚Â Â  â””â”€â”€ named.run</span><br><span class="line">â”œâ”€â”€ dynamic</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ managed-keys.bind</span><br><span class="line">â”‚Â Â  â””â”€â”€ managed-keys.bind.jnl</span><br><span class="line">â”œâ”€â”€ hym.com.zone</span><br><span class="line">â”œâ”€â”€ named.ca</span><br><span class="line">â”œâ”€â”€ named.empty</span><br><span class="line">â”œâ”€â”€ named.localhost</span><br><span class="line">â”œâ”€â”€ named.loopback</span><br><span class="line">â””â”€â”€ slaves</span><br><span class="line">    â”œâ”€â”€ 192.168.232.zone</span><br><span class="line">    â””â”€â”€ hym.com.zone</span><br><span class="line"></span><br><span class="line">3 directories, 11 files</span><br><span class="line"><span class="comment">#ä½¿ç”¨hostæµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# host 192.168.232.136 192.168.232.3</span><br><span class="line">Using domain server:</span><br><span class="line">Name: 192.168.232.3</span><br><span class="line">Address: 192.168.232.3#53</span><br><span class="line">Aliases: </span><br><span class="line"></span><br><span class="line">136.232.168.192.in-addr.arpa domain name pointer xixi.hym.com.</span><br><span class="line">[root@1010 ~]# host xixi.hym.com 192.168.232.3</span><br><span class="line">Using domain server:</span><br><span class="line">Name: 192.168.232.3</span><br><span class="line">Address: 192.168.232.3#53</span><br><span class="line">Aliases: </span><br><span class="line"></span><br><span class="line">xixi.hym.com has address 192.168.232.136</span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-11-06_17-49-24.png" alt="PixPin_2025-11-06_17-49-24"></p><h4 id="2-4-2-å¢é‡åŒæ­¥ï¼ˆæ­£åå‘è§£æåŒç†ï¼‰"><a href="#2-4-2-å¢é‡åŒæ­¥ï¼ˆæ­£åå‘è§£æåŒç†ï¼‰" class="headerlink" title="2.4.2.å¢é‡åŒæ­¥ï¼ˆæ­£åå‘è§£æåŒç†ï¼‰"></a>2.4.2.å¢é‡åŒæ­¥ï¼ˆæ­£åå‘è§£æåŒç†ï¼‰</h4><p><strong>æ·»åŠ è®°å½•ï¼ˆä¸»æœºï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hym ~]# vim /var/named/hym.com.zone</span><br><span class="line">haha    A       192.168.232.137 ;æ–°å¢åŠ </span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-11-06_16-17-04.png" alt="PixPin_2025-11-06_16-17-04"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é‡å¯æœåŠ¡</span></span><br><span class="line">[root@hym ~]# systemctl restart named</span><br></pre></td></tr></table></figure><p><strong>è¿›è¡Œå¢é‡åŒæ­¥å¹¶æµ‹è¯•ï¼ˆä»æœºï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åŒæ­¥</span></span><br><span class="line">[root@1010 ~]# rndc refresh hym.com.</span><br><span class="line">zone refresh queued</span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# host haha.hym.com 192.168.232.3</span><br><span class="line">Using domain server:</span><br><span class="line">Name: 192.168.232.3</span><br><span class="line">Address: 192.168.232.3#53</span><br><span class="line">Aliases: </span><br><span class="line"></span><br><span class="line">haha.hym.com has address 192.168.232.137</span><br></pre></td></tr></table></figure><p> <img src="https://b5dbf24.webp.li/PixPin_2025-11-06_16-18-59.png" alt="PixPin_2025-11-06_16-18-59"></p><h1 id="25-11-6-NFS"><a href="#25-11-6-NFS" class="headerlink" title="25-11-6(NFS)"></a>25-11-6(NFS)</h1><h2 id="1-NFSç†è®º"><a href="#1-NFSç†è®º" class="headerlink" title="1.NFSç†è®º"></a>1.NFSç†è®º</h2><p><strong>ç†è®ºéƒ¨åˆ†å‚è€ƒ</strong>  <a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/06nfs%E7%90%86%E8%AE%BA.md">è·³è½¬</a></p><h2 id="2-NFSå®éªŒ"><a href="#2-NFSå®éªŒ" class="headerlink" title="2.NFSå®éªŒ"></a>2.NFSå®éªŒ</h2><h3 id="2-1-å®‰è£…-ä¸¤ç«¯"><a href="#2-1-å®‰è£…-ä¸¤ç«¯" class="headerlink" title="2.1.å®‰è£…(ä¸¤ç«¯)"></a>2.1.å®‰è£…(ä¸¤ç«¯)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hym ~]# dnf install nfs-utils rpcbind -y</span><br></pre></td></tr></table></figure><h3 id="2-2-æœåŠ¡ç«¯é…ç½®"><a href="#2-2-æœåŠ¡ç«¯é…ç½®" class="headerlink" title="2.2.æœåŠ¡ç«¯é…ç½®"></a>2.2.æœåŠ¡ç«¯é…ç½®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¼–è¾‘é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@hym ~]# vim /etc/exports</span><br><span class="line">/server/dir1    *(rw,root_squash)</span><br><span class="line">/server/dir2    *(rw,all_squash,anonuid=10000,anongid=10000)</span><br><span class="line"><span class="comment">#åˆ›å»ºå¯¹åº”ç›®å½•</span></span><br><span class="line">[root@hym ~]# <span class="built_in">mkdir</span> /server</span><br><span class="line">[root@hym ~]# <span class="built_in">mkdir</span> /server/dir&#123;1,2&#125;</span><br><span class="line">[root@hym ~]# tree /server/</span><br><span class="line">/server/</span><br><span class="line">â”œâ”€â”€ dir1</span><br><span class="line">â””â”€â”€ dir2</span><br><span class="line"><span class="comment">#ç»™äºˆæƒé™</span></span><br><span class="line">[root@hym ~]# <span class="built_in">chmod</span> 755 -R /server/</span><br><span class="line"><span class="comment">#æ ¹æ®é…ç½®æ–‡ä»¶è¿›è¡Œè¡¥å……ï¼Œæ¯”å¦‚ç”¨æˆ·æƒé™</span></span><br><span class="line">[root@hym ~]# useradd -u 10000 hym</span><br><span class="line">[root@hym ~]# <span class="built_in">id</span> hym</span><br><span class="line">ç”¨æˆ·<span class="built_in">id</span>=10000(hym) ç»„<span class="built_in">id</span>=10000(hym) ç»„=10000(hym)</span><br><span class="line">[root@hym ~]# setfacl -m u:hym:rwx /server/dir2</span><br><span class="line"><span class="comment">#å¯¼å‡º</span></span><br><span class="line">[root@hym ~]# exportfs -ar</span><br><span class="line"><span class="comment">#å¯åŠ¨æœåŠ¡</span></span><br><span class="line">[root@hym ~]# systemctl start nfs-server</span><br><span class="line"><span class="comment">#éªŒè¯å…±äº«é…ç½®</span></span><br><span class="line">[root@hym ~]# showmount -e localhost</span><br><span class="line">Export list <span class="keyword">for</span> localhost:</span><br><span class="line">/server/dir2 *</span><br><span class="line">/server/dir1 *</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-11-06_23-09-50.png" alt="PixPin_2025-11-06_23-09-50"></p><h3 id="2-3-å®¢æˆ·ç«¯é…ç½®"><a href="#2-3-å®¢æˆ·ç«¯é…ç½®" class="headerlink" title="2.3.å®¢æˆ·ç«¯é…ç½®"></a>2.3.å®¢æˆ·ç«¯é…ç½®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æµ‹è¯•æœåŠ¡ç«¯å…±äº«</span></span><br><span class="line">[root@1010 ~]# showmount -e 192.168.232.133</span><br><span class="line">Export list <span class="keyword">for</span> 192.168.232.133:</span><br><span class="line">/server/dir2 *</span><br><span class="line">/server/dir1 *</span><br><span class="line"><span class="comment">#åˆ›å»ºæœ¬åœ°æŒ‚è½½ç‚¹</span></span><br><span class="line">[root@1010 ~]# <span class="built_in">mkdir</span> /bendi</span><br><span class="line">[root@1010 ~]# <span class="built_in">mkdir</span> /bendi/dir&#123;1,2&#125;</span><br><span class="line">[root@1010 ~]# tree /bendi/</span><br><span class="line">/bendi/</span><br><span class="line">â”œâ”€â”€ dir1</span><br><span class="line">â””â”€â”€ dir2</span><br><span class="line"><span class="comment">#æŒ‚è½½</span></span><br><span class="line">[root@1010 ~]# mount -t nfs 192.168.232.133:/server/dir1 /bendi/dir1</span><br><span class="line">[root@1010 ~]# mount -t nfs 192.168.232.133:/server/dir2 /bendi/dir2</span><br><span class="line"><span class="comment">#æŸ¥çœ‹æŒ‚è½½çŠ¶æ€</span></span><br><span class="line">[root@1010 ~]# <span class="built_in">df</span> -h</span><br><span class="line">æ–‡ä»¶ç³»ç»Ÿ                      å®¹é‡  å·²ç”¨  å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹</span><br><span class="line">devtmpfs                      4.0M     0  4.0M    0% /dev</span><br><span class="line">tmpfs                         866M     0  866M    0% /dev/shm</span><br><span class="line">tmpfs                         347M  5.1M  342M    2% /run</span><br><span class="line">/dev/mapper/rhel-root          17G  1.7G   15G   11% /</span><br><span class="line">/dev/nvme0n1p2                960M  217M  744M   23% /boot</span><br><span class="line">/dev/nvme0n1p1                599M  7.0M  592M    2% /boot/efi</span><br><span class="line">/dev/sr0                      9.9G  9.9G     0  100% /mnt</span><br><span class="line">tmpfs                         174M     0  174M    0% /run/user/0</span><br><span class="line">192.168.232.133:/server/dir1   17G  1.7G   15G   11% /bendi/dir1</span><br><span class="line">192.168.232.133:/server/dir2   17G  1.7G   15G   11% /bendi/dir2</span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@1010 ~]# <span class="built_in">echo</span> <span class="string">&quot;dir1&quot;</span> &gt; /bendi/dir1/test.txt</span><br><span class="line">-bash: /bendi/dir1/test.txt: æƒé™ä¸å¤Ÿ</span><br><span class="line">[root@1010 ~]# ll -d /bendi/dir1</span><br><span class="line">drwxr-xr-x. 2 root root 6 11æœˆ  6 21:53 /bendi/dir1</span><br><span class="line">[root@1010 ~]# <span class="built_in">echo</span> <span class="string">&quot;dir2&quot;</span> &gt; /bendi/dir2/test.txt</span><br><span class="line">[root@1010 ~]# ll /bendi/dir2/test.txt </span><br><span class="line">-rw-r--r--. 1 10000 10000 5 11æœˆ  6 21:48 /bendi/dir2/test.txt</span><br><span class="line"><span class="comment">####dir1çš„æƒé™ä¸è¶³ï¼Œåªèƒ½æŸ¥çœ‹ï¼Œdir2çš„æƒé™ç»™äº†rwæ‰€ä»¥å®¢æˆ·ç«¯èƒ½å¤Ÿåˆ›å»ºæ–‡ä»¶</span></span><br><span class="line"><span class="comment">####dir1çš„æƒé™ä¸ºå¯è¯»ï¼Œdir2ç›®å½•hymç”¨æˆ·æƒé™ä¸ºå¯è¯»å¯å†™</span></span><br><span class="line"><span class="comment">###dir1éœ€è¦å†™æƒé™æ—¶ï¼Œå¯åœ¨æœåŠ¡ç«¯ä¿®æ”¹å¯¹åº”ç›®å½•æƒé™</span></span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-11-06_22-16-46.png" alt="PixPin_2025-11-06_22-16-46"></p><h3 id="2-4-å¼€æœºæŒ‚è½½"><a href="#2-4-å¼€æœºæŒ‚è½½" class="headerlink" title="2.4.å¼€æœºæŒ‚è½½"></a>2.4.å¼€æœºæŒ‚è½½</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¼–è¾‘é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@1010 ~]# vim /etc/fstab</span><br><span class="line">192.168.232.133:/server/dir1  /bendi/dir1       nfs     defaults        0 0</span><br><span class="line">192.168.232.133:/server/dir2  /bendi/dir2       nfs     defaults        0 0</span><br><span class="line"><span class="comment">#ç«‹å³ç”Ÿæ•ˆ</span></span><br><span class="line">[root@1010 ~]# mount -a</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-11-06_22-49-25.png" alt="PixPin_2025-11-06_22-49-25"></p><p><img src="https://b5dbf24.webp.li/PixPin_2025-11-06_22-49-12.png" alt="PixPin_2025-11-06_22-49-12"></p><h3 id="2-5-åŠ¨æ€æŒ‚è½½-æ— è¿›ç¨‹æ—¶ä¼šè‡ªåŠ¨å¸è½½"><a href="#2-5-åŠ¨æ€æŒ‚è½½-æ— è¿›ç¨‹æ—¶ä¼šè‡ªåŠ¨å¸è½½" class="headerlink" title="2.5.åŠ¨æ€æŒ‚è½½(æ— è¿›ç¨‹æ—¶ä¼šè‡ªåŠ¨å¸è½½)"></a>2.5.åŠ¨æ€æŒ‚è½½(æ— è¿›ç¨‹æ—¶ä¼šè‡ªåŠ¨å¸è½½)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®¢æˆ·ç«¯å®‰è£… autofs</span></span><br><span class="line">[root@1010 ~]# yum install autofs -y</span><br><span class="line"><span class="comment">#ç¼–è¾‘ä¸»é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@1010 ~]# vim /etc/auto.misc</span><br><span class="line">/nfs_auto       /etc/auto.misc</span><br><span class="line"><span class="comment">#ç¼–è¾‘å­é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@1010 ~]# vim /etc/auto.misc</span><br><span class="line">dir1            -fstype=nfs 192.168.232.133:/server/dir1</span><br><span class="line">dir2            -fstype=nfs 192.168.232.133:/server/dir2</span><br><span class="line"><span class="comment">#å¯åŠ¨æœåŠ¡</span></span><br><span class="line">[root@1010 ~]# systemctl start autofs</span><br><span class="line"><span class="comment">#è®¿é—®æŒ‚è½½ç‚¹å®ç°åŠ¨æ€æŒ‚è½½</span></span><br><span class="line">[root@1010 ~]# <span class="built_in">ls</span> /nfs_auto/dir1</span><br><span class="line">hy</span><br><span class="line">[root@1010 ~]# <span class="built_in">ls</span> /nfs_auto/dir2</span><br><span class="line">test.txt</span><br><span class="line"><span class="comment">#æŸ¥çœ‹æŒ‚è½½çŠ¶æ€</span></span><br><span class="line">[root@1010 ~]# <span class="built_in">df</span> -h</span><br><span class="line">æ–‡ä»¶ç³»ç»Ÿ                      å®¹é‡  å·²ç”¨  å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹</span><br><span class="line">devtmpfs                      4.0M     0  4.0M    0% /dev</span><br><span class="line">tmpfs                         866M     0  866M    0% /dev/shm</span><br><span class="line">tmpfs                         347M  6.5M  340M    2% /run</span><br><span class="line">/dev/mapper/rhel-root          17G  1.7G   15G   11% /</span><br><span class="line">/dev/nvme0n1p2                960M  217M  744M   23% /boot</span><br><span class="line">/dev/nvme0n1p1                599M  7.0M  592M    2% /boot/efi</span><br><span class="line">/dev/sr0                      9.9G  9.9G     0  100% /mnt</span><br><span class="line">tmpfs                         174M     0  174M    0% /run/user/0</span><br><span class="line">192.168.232.133:/server/dir1   17G  1.7G   15G   11% /bendi/dir1</span><br><span class="line">192.168.232.133:/server/dir2   17G  1.7G   15G   11% /bendi/dir2</span><br><span class="line">192.168.232.133:/server/dir1   17G  1.7G   15G   11% /nfs_auto/dir1</span><br><span class="line">192.168.232.133:/server/dir2   17G  1.7G   15G   11% /nfs_auto/dir2</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-11-06_22-57-35.png" alt="PixPin_2025-11-06_22-57-35"></p><p><img src="https://b5dbf24.webp.li/PixPin_2025-11-06_22-59-45.png" alt="PixPin_2025-11-06_22-59-45"></p><p><img src="https://b5dbf24.webp.li/PixPin_2025-11-06_23-02-31.png" alt="PixPin_2025-11-06_23-02-31"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¿®æ”¹å¸è½½æ—¶é—´(é»˜è®¤300s)</span></span><br><span class="line">[root@1010 ~]# vim /etc/autofs.conf</span><br><span class="line"><span class="built_in">timeout</span> = 300</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-11-06_23-07-52.png" alt="PixPin_2025-11-06_23-07-52"></p><h1 id="25-11-13-SELiunx"><a href="#25-11-13-SELiunx" class="headerlink" title="25-11-13(SELiunx)"></a>25-11-13(SELiunx)</h1><h2 id="1-SELiunxç†è®º"><a href="#1-SELiunxç†è®º" class="headerlink" title="1.SELiunxç†è®º"></a>1.SELiunxç†è®º</h2><p><strong>ç†è®ºéƒ¨åˆ†å‚è€ƒ</strong>  <a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/07SeLinux.md">è·³è½¬</a> </p><p>SELinux æ˜¯ä¸€ç§å¼ºåˆ¶è®¿é—®æ§åˆ¶ï¼ˆMACï¼‰å®‰å…¨æœºåˆ¶ï¼Œä½œä¸º Linux å†…æ ¸çš„å®‰å…¨æ¨¡å—ï¼Œå®ƒå¼¥è¡¥äº†ä¼ ç»Ÿ Linux è‡ªä¸»è®¿é—®æ§åˆ¶çš„ç¼ºé™·ï¼Œä»å†…æ ¸å±‚é¢å¼ºåŒ–ç³»ç»Ÿå®‰å…¨ã€‚</p><p><strong>å·¥ä½œè¿‡ç¨‹</strong></p><p><img src="https://d1aa036.webp.li/Build/20130809153255828" alt="img"></p><p><strong>ä¸‰ç§å·¥ä½œæ¨¡å¼</strong></p><table><thead><tr><th>æ¨¡å¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>enforcing</td><td>å¼ºåˆ¶æ¨¡å¼ï¼Œæ­£å¸¸åŠ è½½å¹¶æ‰§è¡Œç­–ç•¥ï¼Œæ‹¦æˆªè¿è§„è®¿é—®å¹¶è®°å½•æ—¥å¿—</td></tr><tr><td>permissive</td><td>å®½å®¹æ¨¡å¼ï¼Œä¸æ‹¦æˆªè¿è§„æ“ä½œï¼Œä»…è®°å½•æ—¥å¿—ï¼Œå¸¸ç”¨äºè°ƒè¯•ç­–ç•¥</td></tr><tr><td>disabled</td><td>å…³é—­æ¨¡å¼ï¼ŒSELinux å®Œå…¨ä¸ç”Ÿæ•ˆ</td></tr></tbody></table><h2 id="2-SELiunxå®éªŒ"><a href="#2-SELiunxå®éªŒ" class="headerlink" title="2.SELiunxå®éªŒ"></a>2.SELiunxå®éªŒ</h2><h3 id="2-1-å®éªŒ1ï¼šSELiunxç«¯å£é™åˆ¶å®è·µ"><a href="#2-1-å®éªŒ1ï¼šSELiunxç«¯å£é™åˆ¶å®è·µ" class="headerlink" title="2.1.å®éªŒ1ï¼šSELiunxç«¯å£é™åˆ¶å®è·µ"></a>2.1.å®éªŒ1ï¼šSELiunxç«¯å£é™åˆ¶å®è·µ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å‰ç½®</span></span><br><span class="line">systemctl start nginx</span><br><span class="line">setroubleshoot<span class="comment"># æä¾›è§£å†³æ–¹æ¡ˆ</span></span><br><span class="line"><span class="comment">#æ£€æŸ¥</span></span><br><span class="line">[root@server ~]# systemctl status nginx</span><br><span class="line"><span class="comment">#æŸ¥çœ‹</span></span><br><span class="line">[root@server ~]# ps -axZ | grep nginx</span><br><span class="line">[root@server ~]# systemctl stop nginx</span><br><span class="line">[root@server ~]# semanage port -l | grep http</span><br><span class="line"><span class="comment">#ä¿®æ”¹é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@server ~]# vim /etc/nginx/nginx.conf</span><br><span class="line">server &#123;</span><br><span class="line">        listen  84;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#å¯åŠ¨æœåŠ¡</span></span><br><span class="line">[root@server ~]# systemctl start nginx</span><br><span class="line">Job <span class="keyword">for</span> nginx.service failed because the control process exited with error code.</span><br><span class="line">See <span class="string">&quot;systemctl status nginx.service&quot;</span> and <span class="string">&quot;journalctl -xeu nginx.service&quot;</span> <span class="keyword">for</span> details.</span><br><span class="line">[root@server ~]# dnf install setroubleshoot</span><br><span class="line"><span class="comment">#æŸ¥çœ‹æ—¥å¿—</span></span><br><span class="line">[root@server ~]# <span class="built_in">tail</span> -f /var/log/messages</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-11-21_00-17-36.png" alt="PixPin_2025-11-21_00-17-36"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ ¹æ®æ—¥å¿—è¿›è¡Œé…ç½®</span></span><br><span class="line">[root@server ~]# semanage port -a -t http_port_t -p tcp 82</span><br><span class="line">[root@server ~]# semanage port -l | grep http</span><br><span class="line">[root@server ~]# systemctl restart nginx</span><br></pre></td></tr></table></figure><h3 id="2-2-å®éªŒ2ï¼šSELiunxç±»å‹é™åˆ¶å®è·µ-ç®¡ç†å®‰å…¨ä¸Šä¸‹æ–‡"><a href="#2-2-å®éªŒ2ï¼šSELiunxç±»å‹é™åˆ¶å®è·µ-ç®¡ç†å®‰å…¨ä¸Šä¸‹æ–‡" class="headerlink" title="2.2.å®éªŒ2ï¼šSELiunxç±»å‹é™åˆ¶å®è·µ-ç®¡ç†å®‰å…¨ä¸Šä¸‹æ–‡"></a>2.2.å®éªŒ2ï¼šSELiunxç±»å‹é™åˆ¶å®è·µ-ç®¡ç†å®‰å…¨ä¸Šä¸‹æ–‡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ›´æ”¹SELinuxæ¨¡å¼ä¸ºPermissive</span></span><br><span class="line">[root@server ~]# setenforce 0</span><br><span class="line">[root@server ~]# getenforce</span><br><span class="line">Permissive</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ›å»ºç½‘é¡µé¡µé¢</span></span><br><span class="line">[root@server ~]# <span class="built_in">mkdir</span> /web</span><br><span class="line">[root@server ~]# <span class="built_in">echo</span> â€œSELiunx 82â€ &gt; /web/index.html</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¿®æ”¹nginxé…ç½®</span></span><br><span class="line">[root@server ~]# vim /etc/nginx/nginx.conf</span><br><span class="line">        listen       82;</span><br><span class="line">        root         /web;</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-11-21_23-34-19.png" alt="PixPin_2025-11-21_23-34-19"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é‡å¯æœåŠ¡</span></span><br><span class="line">[root@server ~]# systemctl restart nginx.service</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¿®æ”¹SELinuxæ¨¡å¼ä¸ºEnforcing</span></span><br><span class="line">[root@server ~]# setenforce 1</span><br><span class="line">[root@server ~]# getenforce </span><br><span class="line">Enforcing</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹æ—¥å¿—</span></span><br><span class="line">[root@server ~]# <span class="built_in">tail</span> -f /var/log/messages</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•curlç½‘é¡µ</span></span><br><span class="line">[root@server ~]# curl 192.168.232.133:82</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;<span class="built_in">head</span>&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;center&gt;&lt;h1&gt;403 Forbidden&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;hr&gt;&lt;center&gt;nginx/1.20.1&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="comment">#å‘ç°å¤±è´¥ï¼Œè¿”å›403</span></span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-11-21_23-39-36.png" alt="PixPin_2025-11-21_23-39-36"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æŸ¥çœ‹æ—¥å¿—æŠ¥é”™</span></span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-11-21_23-40-49.png" alt="PixPin_2025-11-21_23-40-49"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ ¹æ®æ—¥å¿—æŠ¥é”™ä¿®æ”¹indexæ–‡ä»¶æ ‡ç­¾</span></span><br><span class="line">[root@server ~]# semanage fcontext -a -t httpd_sys_content_t <span class="string">&#x27;/web/index.html&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹æ–‡ä»¶</span></span><br><span class="line">[root@server ~]# restorecon  -R  -v  /web/index.html</span><br><span class="line">Relabeled /web/index.html from unconfined_u:object_r:default_t:s0 to unconfined_u:object_r:httpd_sys_content_t:s0</span><br><span class="line"></span><br><span class="line"><span class="comment">#é‡æ–°æµ‹è¯•</span></span><br><span class="line">[root@server ~]# curl 192.168.232.133:82</span><br><span class="line">SELiunx 82</span><br></pre></td></tr></table></figure><h3 id="2-3-å®éªŒ3ï¼šSELiunxç±»å‹é™åˆ¶å®è·µ"><a href="#2-3-å®éªŒ3ï¼šSELiunxç±»å‹é™åˆ¶å®è·µ" class="headerlink" title="2.3.å®éªŒ3ï¼šSELiunxç±»å‹é™åˆ¶å®è·µ"></a>2.3.å®éªŒ3ï¼šSELiunxç±»å‹é™åˆ¶å®è·µ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®‰è£…ä¸å¯åŠ¨</span></span><br><span class="line">[root@server ~]# dnf install  nginx  -y </span><br><span class="line">[root@server ~]# yum install setroubleshoot -y</span><br><span class="line">[root@server ~]# systemctl start nginx</span><br><span class="line">[root@server ~]# systemctl start setroubleshootd.service </span><br><span class="line"></span><br><span class="line">[root@server ~]# <span class="built_in">mkdir</span> -p /web/http</span><br><span class="line">[root@server ~]# <span class="built_in">echo</span> <span class="string">&quot;SELinux 84&quot;</span> &gt; /web/http/index.html</span><br><span class="line">[root@server ~]# vim /etc/nginx/nginx.conf</span><br><span class="line">    server &#123;</span><br><span class="line">        listen       84</span><br><span class="line">        root         /web/http;</span><br><span class="line">        &#125;</span><br><span class="line">[root@server ~]# systemctl restart nginx.service </span><br><span class="line">Job <span class="keyword">for</span> nginx.service failed because the control process exited with error code.</span><br><span class="line">See <span class="string">&quot;systemctl status nginx.service&quot;</span> and <span class="string">&quot;journalctl -xeu nginx.service&quot;</span> <span class="keyword">for</span> details.     </span><br><span class="line">[root@server ~]# semanage port -a -t http_port_t -p tcp 84</span><br><span class="line">[root@server ~]# systemctl restart nginx.service </span><br><span class="line"></span><br><span class="line">[root@server ~]# curl 192.168.232.133:84</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;<span class="built_in">head</span>&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;center&gt;&lt;h1&gt;403 Forbidden&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;hr&gt;&lt;center&gt;nginx/1.20.1&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">[root@server ~]# semanage fcontext -a -t httpd_sys_content_t  <span class="string">&#x27;/web/http/index.html&#x27;</span></span><br><span class="line">[root@server ~]# systemctl restart nginx.service </span><br><span class="line">[root@server ~]# curl 192.168.232.133:84</span><br><span class="line">SELinux 84</span><br></pre></td></tr></table></figure><h1 id="25-11-15-iptables-firewall"><a href="#25-11-15-iptables-firewall" class="headerlink" title="25-11-15(iptables&#x2F;firewall)"></a>25-11-15(iptables&#x2F;firewall)</h1><h2 id="1-é˜²ç«å¢™ç†è®º"><a href="#1-é˜²ç«å¢™ç†è®º" class="headerlink" title="1.é˜²ç«å¢™ç†è®º"></a>1.é˜²ç«å¢™ç†è®º</h2><p><strong>ç†è®ºéƒ¨åˆ†å‚è€ƒ</strong>  <a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/08%E9%98%B2%E7%81%AB%E5%A2%99%E7%90%86%E8%AE%BA.md">è·³è½¬</a></p><h3 id="1-1-iptablesåŸºæœ¬å‘½ä»¤"><a href="#1-1-iptablesåŸºæœ¬å‘½ä»¤" class="headerlink" title="1.1.iptablesåŸºæœ¬å‘½ä»¤"></a>1.1.iptablesåŸºæœ¬å‘½ä»¤</h3><p><strong>å®‰è£…iptables</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1ã€RHEL9é»˜è®¤ä½¿ç”¨firewalldï¼Œéœ€å…ˆç¦ç”¨firewalldå¹¶å®‰è£…iptablesæœåŠ¡ï¼š</span></span><br><span class="line">[root@hym ~]# systemctl stop firewalld</span><br><span class="line">[root@hym ~]# systemctl <span class="built_in">disable</span> --now firewalld</span><br><span class="line">[root@hym ~]# systemctl mask firewalld</span><br><span class="line"><span class="comment">#2ã€å®‰è£…iptables</span></span><br><span class="line">dnf install iptables-services -y</span><br><span class="line">systemctl <span class="built_in">enable</span> --now iptables.service</span><br><span class="line">systemctl status iptables.service</span><br></pre></td></tr></table></figure><p><strong>å¢åˆ æ”¹æŸ¥</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.å¢åŠ </span></span><br><span class="line"><span class="comment">#1.1è¿½åŠ åˆ°æœ«å°¾</span></span><br><span class="line">   iptables -A INPUT -p tcp --dport 22 -j ACCEPT  <span class="comment">#å…è®¸SSHé€šè¿‡TCP 22ç«¯å£ï¼ˆè¿½åŠ åˆ°INPUTé“¾æœ«å°¾ï¼‰</span></span><br><span class="line"><span class="comment">#1.2æ’å…¥è§„åˆ™åˆ°é“¾çš„æŒ‡å®šä½ç½®</span></span><br><span class="line">iptables -I INPUT 2 -s 192.168.1.0/24 -j DROP  <span class="comment">#åœ¨INPUTé“¾çš„ç¬¬2æ¡ä½ç½®æ’å…¥è§„åˆ™ï¼Œä¸¢å¼ƒæ¥è‡ª192.168.1.0/24ç½‘æ®µçš„æ‰€æœ‰æµé‡</span></span><br><span class="line"><span class="comment">#1.3æŒ‡å®šè¡¨ï¼ˆå¦‚filterè¡¨ï¼‰æ’å…¥è§„åˆ™</span></span><br><span class="line">iptables -t filter -I FORWARD -d 192.168.10.182 -p tcp --dport 80:443 -j ACCEPT  <span class="comment">#å…è®¸ç›®æ ‡ä¸º192.168.10.182çš„TCP 80-443ç«¯å£æµé‡é€šè¿‡FORWARDé“¾</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#2.åˆ é™¤</span></span><br><span class="line">iptables -t è¡¨å -F é“¾å<span class="comment">#æ¸…ç©ºæŒ‡å®šé“¾</span></span><br><span class="line">iptables -t è¡¨å -F<span class="comment">#æ¸…ç©ºå½“å‰è¡¨çš„æ‰€æœ‰é“¾(é»˜è®¤ `filter` è¡¨)</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#3.æŸ¥è¯¢</span></span><br><span class="line">iptables -L -t filter -n  <span class="comment">#æŸ¥çœ‹æŒ‡å®šè¡¨</span></span><br><span class="line">iptables -L -nv   -t filter   --line-numbers <span class="comment">#æŸ¥çœ‹æ‰€æœ‰é“¾ä¸Šçš„   æŒ‡å®šè¡¨ï¼ˆ -t fileter ï¼‰çš„æ‰€æœ‰è§„åˆ™</span></span><br><span class="line"></span><br><span class="line">vim /etc/sysconfig/iptables   <span class="comment">#è§„åˆ™é“¾å­˜å‚¨æ–‡ä»¶</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>ç›¸å…³å‘½ä»¤</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æŸ¥çœ‹æŒ‡å®šè¡¨</span></span><br><span class="line">[root@localhost ~]# iptables -L -t mangle  -n</span><br><span class="line">[root@localhost ~]# iptables -L -t nat -n</span><br><span class="line">[root@localhost ~]# iptables -L -t raw -n </span><br><span class="line">[root@localhost ~]# iptables -L -t filter -n</span><br><span class="line"></span><br><span class="line"><span class="comment">#è§„åˆ™é“¾å­˜å‚¨æ–‡ä»¶</span></span><br><span class="line">vim /etc/sysconfig/iptables</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹æ‰€æœ‰é“¾ä¸Šçš„   æŒ‡å®šè¡¨ï¼ˆ -t fileter ï¼‰çš„æ‰€æœ‰è§„åˆ™</span></span><br><span class="line"> iptables -L -nv   -t filter   --line-numbers</span><br></pre></td></tr></table></figure><h2 id="2-é˜²ç«å¢™å®éªŒ"><a href="#2-é˜²ç«å¢™å®éªŒ" class="headerlink" title="2.é˜²ç«å¢™å®éªŒ"></a>2.é˜²ç«å¢™å®éªŒ</h2><h3 id="2-1-firewallå®éªŒ"><a href="#2-1-firewallå®éªŒ" class="headerlink" title="2.1.firewallå®éªŒ"></a>2.1.firewallå®éªŒ</h3><h4 id="2-1-1-firewalldåŒºåŸŸæ·»åŠ httpæœåŠ¡ï¼Œä½¿å…¶ä¸ºæ”¾è¡ŒçŠ¶æ€"><a href="#2-1-1-firewalldåŒºåŸŸæ·»åŠ httpæœåŠ¡ï¼Œä½¿å…¶ä¸ºæ”¾è¡ŒçŠ¶æ€" class="headerlink" title="2.1.1.firewalldåŒºåŸŸæ·»åŠ httpæœåŠ¡ï¼Œä½¿å…¶ä¸ºæ”¾è¡ŒçŠ¶æ€"></a>2.1.1.firewalldåŒºåŸŸæ·»åŠ httpæœåŠ¡ï¼Œä½¿å…¶ä¸ºæ”¾è¡ŒçŠ¶æ€</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®‰è£…nginxa</span></span><br><span class="line">[root@server ~]# dnf install -y nginx</span><br><span class="line">[root@server ~]# <span class="built_in">echo</span> <span class="string">&quot;firewalld&quot;</span> &gt; /usr/share/nginx/html/index.html</span><br><span class="line">[root@server ~]# systemctl restart nginx.service</span><br><span class="line"></span><br><span class="line">[root@server ~]# firewall-cmd --get-default-zone </span><br><span class="line">public</span><br><span class="line">[root@server ~]# firewall-cmd --list-all</span><br><span class="line">public (active)</span><br><span class="line">  target: default</span><br><span class="line">  icmp-block-inversion: no</span><br><span class="line">  interfaces: ens160</span><br><span class="line">  sources: </span><br><span class="line">  services: cockpit dhcpv6-client ssh</span><br><span class="line">  ports: </span><br><span class="line">  protocols: </span><br><span class="line">  forward: <span class="built_in">yes</span></span><br><span class="line">  masquerade: no</span><br><span class="line">  forward-ports: </span><br><span class="line">  source-ports: </span><br><span class="line">  icmp-blocks: </span><br><span class="line">  rich rules: </span><br><span class="line">  </span><br><span class="line">  [root@server ~]# firewall-cmd --permanent --zone=public --add-service=http</span><br><span class="line">success</span><br><span class="line">[root@server ~]# firewall-cmd --permanent --zone=public --add-port=80/tcp</span><br><span class="line">success</span><br><span class="line">[root@server ~]# firewall-cmd --reload </span><br><span class="line">success</span><br><span class="line"></span><br><span class="line">[root@server ~]# firewall-cmd --list-all</span><br><span class="line">public (active)</span><br><span class="line">  target: default</span><br><span class="line">  icmp-block-inversion: no</span><br><span class="line">  interfaces: ens160</span><br><span class="line">  sources: </span><br><span class="line">  services: cockpit dhcpv6-client http ssh</span><br><span class="line">  ports: 80/tcp</span><br><span class="line">  protocols: </span><br><span class="line">  forward: <span class="built_in">yes</span></span><br><span class="line">  masquerade: no</span><br><span class="line">  forward-ports: </span><br><span class="line">  source-ports: </span><br><span class="line">  icmp-blocks: </span><br><span class="line">  rich rules:</span><br></pre></td></tr></table></figure><h4 id="2-1-2-æŸäº›æœåŠ¡éœ€è¦ç¼–è¾‘zoneæ–‡ä»¶æ‰èƒ½æ·»åŠ æœåŠ¡ï¼Œæ·»åŠ nginxæœåŠ¡"><a href="#2-1-2-æŸäº›æœåŠ¡éœ€è¦ç¼–è¾‘zoneæ–‡ä»¶æ‰èƒ½æ·»åŠ æœåŠ¡ï¼Œæ·»åŠ nginxæœåŠ¡" class="headerlink" title="2.1.2.æŸäº›æœåŠ¡éœ€è¦ç¼–è¾‘zoneæ–‡ä»¶æ‰èƒ½æ·»åŠ æœåŠ¡ï¼Œæ·»åŠ nginxæœåŠ¡"></a>2.1.2.æŸäº›æœåŠ¡éœ€è¦ç¼–è¾‘zoneæ–‡ä»¶æ‰èƒ½æ·»åŠ æœåŠ¡ï¼Œæ·»åŠ nginxæœåŠ¡</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"> firewall-cmd   --add-service=nginx  --permanent# æŸ¥çœ‹æ‰€æœ‰åŒºåŸŸæ”¯æŒçš„æœåŠ¡</span><br><span class="line">[root@server ~]# firewall-cmd   --get-services</span><br><span class="line"></span><br><span class="line">[root@server ~]#  firewall-cmd --permanent  --add-service=nginx  </span><br><span class="line">Error: INVALID_SERVICE: Zone <span class="string">&#x27;public&#x27;</span>: <span class="string">&#x27;nginx&#x27;</span> not among existing services</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@server ~]# <span class="built_in">cp</span> -a  /usr/lib/firewalld/services/http.xml    /usr/lib/firewalld/services/nginx.xml</span><br><span class="line">[root@server ~]# vim /usr/lib/firewalld/services/nginx.xml</span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">&lt;service&gt;</span><br><span class="line">  &lt;short&gt;nginx&lt;/short&gt;</span><br><span class="line">  &lt;description&gt;&lt;/description&gt;</span><br><span class="line">  &lt;port protocol=<span class="string">&quot;tcp&quot;</span> port=<span class="string">&quot;80&quot;</span>/&gt;</span><br><span class="line">  &lt;port protocol=<span class="string">&quot;tcp&quot;</span> port=<span class="string">&quot;443&quot;</span>/&gt;</span><br><span class="line">&lt;/service&gt;</span><br><span class="line"></span><br><span class="line">[root@server ~]#  firewall-cmd --permanent  --add-service=nginx</span><br><span class="line">success</span><br><span class="line">[root@server ~]# firewall-cmd   --reload </span><br><span class="line">success</span><br><span class="line">[root@server ~]# firewall-cmd  --zone=public  --list-service</span><br><span class="line">cockpit dhcpv6-client http nginx ssh</span><br><span class="line">[root@server ~]# firewall-cmd --list-all</span><br><span class="line">public (active)</span><br><span class="line">  target: default</span><br><span class="line">  icmp-block-inversion: no</span><br><span class="line">  interfaces: ens160</span><br><span class="line">  sources: </span><br><span class="line">  services: cockpit dhcpv6-client http nginx ssh</span><br><span class="line">  ports: 80/tcp</span><br><span class="line">  protocols: </span><br><span class="line">  forward: <span class="built_in">yes</span></span><br><span class="line">  masquerade: no</span><br><span class="line">  forward-ports: </span><br><span class="line">  source-ports: </span><br><span class="line">  icmp-blocks: </span><br><span class="line">  rich rules:</span><br></pre></td></tr></table></figure><h4 id="2-1-3-ç¦æ­¢192-168-48-0-24-ç½‘æ®µçš„åœ°å€è¿›è¡Œping"><a href="#2-1-3-ç¦æ­¢192-168-48-0-24-ç½‘æ®µçš„åœ°å€è¿›è¡Œping" class="headerlink" title="2.1.3.ç¦æ­¢192.168.48.0&#x2F;24 ç½‘æ®µçš„åœ°å€è¿›è¡Œping"></a>2.1.3.ç¦æ­¢192.168.48.0&#x2F;24 ç½‘æ®µçš„åœ°å€è¿›è¡Œping</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@server ~]# man firewalld.richlanguage</span><br><span class="line"></span><br><span class="line">[root@server ~]# firewall-cmd  --permanent  --add-rich-rule=<span class="string">&#x27;rule  family=&quot;ipv4&quot;  source address=&quot;192.168.232.0/24&quot; protocol  value=&quot;icmp&quot;  reject&#x27;</span></span><br><span class="line">success</span><br><span class="line">[root@server ~]# firewall-cmd  --reload</span><br><span class="line">success</span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-11-22_14-24-30.png" alt="PixPin_2025-11-22_14-24-30"></p><h4 id="2-1-4-ç«¯å£è½¬å‘"><a href="#2-1-4-ç«¯å£è½¬å‘" class="headerlink" title="2.1.4.ç«¯å£è½¬å‘"></a>2.1.4.ç«¯å£è½¬å‘</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@server ~]# dnf install net-tools -y</span><br><span class="line">[root@server ~]# netstat  -lntup | grep nginx</span><br><span class="line">tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      1783/nginx: master  </span><br><span class="line">tcp6       0      0 :::80                   :::*                    LISTEN      1783/nginx: master </span><br><span class="line">[root@server ~]# vim /etc/nginx/nginx.conf</span><br><span class="line">[root@server ~]# setenforce 0       </span><br><span class="line">[root@server ~]# systemctl restart nginx.service </span><br><span class="line">[root@server ~]# vim /etc/nginx/nginx.conf</span><br><span class="line">[root@server ~]# setenforce 0</span><br><span class="line">[root@server ~]# systemctl res</span><br><span class="line">rescue        reset-failed  restart       </span><br><span class="line">[root@server ~]# systemctl restart nginx.service </span><br><span class="line">[root@server ~]# firewall-cmd  --permanent --add-rich-rule=<span class="string">&#x27;rule family=&quot;ipv4&quot; source address=&quot;192.168.232.1&quot; forward-port port=&quot;80&quot; protocol=&quot;tcp&quot; to-port=&quot;99&quot;&#x27;</span></span><br><span class="line">success</span><br><span class="line">[root@server ~]# firewall-cmd  --reload</span><br><span class="line">success</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-11-22_14-46-55.png" alt="PixPin_2025-11-22_14-46-55"></p><h1 id="25-12-3-LNMP"><a href="#25-12-3-LNMP" class="headerlink" title="25-12-3(LNMP)"></a>25-12-3(LNMP)</h1><h2 id="1-LNMPç†è®º"><a href="#1-LNMPç†è®º" class="headerlink" title="1.LNMPç†è®º"></a>1.LNMPç†è®º</h2><p><strong>ç†è®ºéƒ¨åˆ†å‚è€ƒ</strong>  <a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/09LNMP%E6%90%AD%E5%BB%BA%E8%AE%BA%E5%9D%9B.md">è·³è½¬</a></p><h2 id="2-LNMPæ­å»ºå®éªŒ"><a href="#2-LNMPæ­å»ºå®éªŒ" class="headerlink" title="2.LNMPæ­å»ºå®éªŒ"></a>2.LNMPæ­å»ºå®éªŒ</h2><h3 id="2-1-ç¼–å†™è„šæœ¬"><a href="#2-1-ç¼–å†™è„šæœ¬" class="headerlink" title="2.1.ç¼–å†™è„šæœ¬"></a>2.1.ç¼–å†™è„šæœ¬</h3><h4 id="2-1-1-åŸºç¡€é…ç½®è„šæœ¬sys-sh"><a href="#2-1-1-åŸºç¡€é…ç½®è„šæœ¬sys-sh" class="headerlink" title="2.1.1.åŸºç¡€é…ç½®è„šæœ¬sys.sh"></a>2.1.1.åŸºç¡€é…ç½®è„šæœ¬sys.sh</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sys.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#1.å®‰è£…åŸºç¡€è½¯ä»¶</span></span><br><span class="line"><span class="function"><span class="title">install_app</span></span>() &#123;</span><br><span class="line">        yum install httpd mariadb-server php php-fpm php-mysqlnd nginx -y &gt;/dev/null</span><br><span class="line">        yum install zip -y &gt;/dev/null</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#2.åˆ›å»ºç›®å½•</span></span><br><span class="line"><span class="function"><span class="title">dir_create</span></span>() &#123;</span><br><span class="line">        <span class="built_in">mkdir</span> -p /web/ssl /web/www</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#3.åˆ›å»ºhttpsè¯ä¹¦</span></span><br><span class="line"><span class="function"><span class="title">ssl</span></span>() &#123;</span><br><span class="line">        openssl genrsa --out /web/ssl/ssl.key</span><br><span class="line">        openssl req -utf8 -new -key /web/ssl/ssl.key -x509 -days 100 -out /web/ssl/ssl.crt \</span><br><span class="line">        -subj <span class="string">&quot;/C=CN/ST=HuNan/L=Changsha/O=./OU=./CN=www.hym.com/emailAddress=admin@hym.com&quot;</span> &gt;/dev/null</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#4.httpå‰ç½®</span></span><br><span class="line"><span class="function"><span class="title">http</span></span>() &#123;</span><br><span class="line">        unzip Dis* -d /web/www  &gt;/dev/null &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;è§£å‹æˆåŠŸ&quot;</span> || <span class="built_in">echo</span> <span class="string">&quot;è§£å‹å¤±è´¥&quot;</span></span><br><span class="line">        <span class="built_in">cd</span> /web/www/upload/</span><br><span class="line">        <span class="built_in">chmod</span> -R 777 config/ uc_* data</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#å…³é—­å®‰å…¨æªæ–½</span></span><br><span class="line"><span class="function"><span class="title">safe</span></span>() &#123;</span><br><span class="line">        setenforce 0</span><br><span class="line">        systemctl <span class="built_in">disable</span> --now firewalld &gt;/dev/null</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-1-2-åº”ç”¨é…ç½®è„šæœ¬app-sh"><a href="#2-1-2-åº”ç”¨é…ç½®è„šæœ¬app-sh" class="headerlink" title="2.1.2.åº”ç”¨é…ç½®è„šæœ¬app.sh"></a>2.1.2.åº”ç”¨é…ç½®è„šæœ¬app.sh</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#app.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#Nginx</span></span><br><span class="line"><span class="function"><span class="title">nginx_config</span></span>() &#123;</span><br><span class="line">        <span class="built_in">mv</span> /root/nginx.conf /etc/nginx/conf.d/nginx.conf &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">        systemctl restart nginx &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#mysql</span></span><br><span class="line"><span class="function"><span class="title">mysql_config</span></span>() &#123;</span><br><span class="line">        systemctl start mariadb &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">        mysql -u root -e <span class="string">&quot;</span></span><br><span class="line"><span class="string">        alter user &#x27;root&#x27;@&#x27;localhost&#x27; identified by &#x27;passwd&#x27;;</span></span><br><span class="line"><span class="string">        create database luntan;</span></span><br><span class="line"><span class="string">        flush privileges; &quot;</span> &gt;/dev/null 2&gt;&amp;1 \</span><br><span class="line">        &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;ä½ çš„æ•°æ®åº“åä¸ºluntan,å¯†ç ä¸ºpasswd&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="2-1-3-è¿è¡Œè„šæœ¬do-sh"><a href="#2-1-3-è¿è¡Œè„šæœ¬do-sh" class="headerlink" title="2.1.3.è¿è¡Œè„šæœ¬do.sh"></a>2.1.3.è¿è¡Œè„šæœ¬do.sh</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#do.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">source</span> sys.sh</span><br><span class="line"><span class="built_in">source</span> app.sh</span><br><span class="line"><span class="comment">#å…³é—­é˜²ç«å¢™</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;==============&quot;</span></span><br><span class="line">safe</span><br><span class="line"><span class="keyword">if</span> [ $? -eq 0 ];<span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> é˜²ç«å¢™å…³é—­ æˆåŠŸ</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> é˜²ç«å¢™å…³é—­ å¤±è´¥</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment">#1.è½¯ä»¶å®‰è£…</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;==============&quot;</span></span><br><span class="line">install_app</span><br><span class="line"><span class="keyword">if</span> [ $? -eq 0 ];<span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> è½¯ä»¶å®‰è£… æˆåŠŸ</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> è½¯ä»¶å®‰è£… å¤±è´¥</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment">#2.åˆ›å»ºç›®å½•</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;==============&quot;</span></span><br><span class="line">dir_create</span><br><span class="line"><span class="keyword">if</span> [ $? -eq 0 ];<span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> ç›®å½•åˆ›å»º æˆåŠŸ</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> ç›®å½•åˆ›å»º å¤±è´¥</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment">#3.åˆ›å»ºhttpsè¯ä¹¦</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;==============&quot;</span></span><br><span class="line">ssl</span><br><span class="line"><span class="keyword">if</span> [ $? -eq 0 ];<span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> è¯ä¹¦åˆ›å»º æˆåŠŸ</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> è¯ä¹¦åˆ›å»º å¤±è´¥</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment">#4.httpæ­å»º</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;==============&quot;</span></span><br><span class="line">http</span><br><span class="line"><span class="keyword">if</span> [ $? -eq 0 ];<span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> httpé…ç½® æˆåŠŸ</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> httpé…ç½® å¤±è´¥</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment">#5.nginxé…ç½®</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;==============&quot;</span></span><br><span class="line">nginx_config</span><br><span class="line"><span class="keyword">if</span> [ $? -eq 0 ];<span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> nginxé…ç½® æˆåŠŸ</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> nginxé…ç½® å¤±è´¥</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment">#6.mysqlé…ç½®</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;==============&quot;</span></span><br><span class="line">mysql_config</span><br><span class="line"><span class="keyword">if</span> [ $? -eq 0 ];<span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> mysqlé…ç½® æˆåŠŸ</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> mysqlé…ç½® å¤±è´¥</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        root /web/www/upload;</span><br><span class="line">        include /etc/nginx/default.d/php.conf;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">        listen 443 ssl http2;</span><br><span class="line">        root /web/www/upload;</span><br><span class="line">        include /etc/nginx/default.d/php.conf;</span><br><span class="line"></span><br><span class="line">        ssl_certificate <span class="string">&quot;/web/ssl/ssl.crt&quot;</span>;</span><br><span class="line">        ssl_certificate_key <span class="string">&quot;/web/ssl/ssl.key&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-2-è¿è¡Œ"><a href="#2-2-è¿è¡Œ" class="headerlink" title="2.2.è¿è¡Œ"></a>2.2.è¿è¡Œ</h3><h4 id="2-2-1-å‡†å¤‡æ–‡ä»¶"><a href="#2-2-1-å‡†å¤‡æ–‡ä»¶" class="headerlink" title="2.2.1.å‡†å¤‡æ–‡ä»¶"></a>2.2.1.å‡†å¤‡æ–‡ä»¶</h4><p><img src="https://b5dbf24.webp.li/PixPin_2025-12-05_17-08-59.png" alt="PixPin_2025-12-05_17-08-59"></p><h4 id="2-2-2-è¿è¡Œshellè„šæœ¬"><a href="#2-2-2-è¿è¡Œshellè„šæœ¬" class="headerlink" title="2.2.2.è¿è¡Œshellè„šæœ¬"></a>2.2.2.è¿è¡Œshellè„šæœ¬</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@server ~]# bash do.sh </span><br><span class="line">==============</span><br><span class="line">Removed <span class="string">&quot;/etc/systemd/system/multi-user.target.wants/firewalld.service&quot;</span>.</span><br><span class="line">Removed <span class="string">&quot;/etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service&quot;</span>.</span><br><span class="line">é˜²ç«å¢™å…³é—­ æˆåŠŸ</span><br><span class="line">==============</span><br><span class="line">è½¯ä»¶å®‰è£… æˆåŠŸ</span><br><span class="line">==============</span><br><span class="line">ç›®å½•åˆ›å»º æˆåŠŸ</span><br><span class="line">==============</span><br><span class="line">è¯ä¹¦åˆ›å»º æˆåŠŸ</span><br><span class="line">==============</span><br><span class="line">è§£å‹æˆåŠŸ</span><br><span class="line">httpé…ç½® æˆåŠŸ</span><br><span class="line">==============</span><br><span class="line">nginxé…ç½® æˆåŠŸ</span><br><span class="line">==============</span><br><span class="line">ä½ çš„æ•°æ®åº“åä¸ºluntan,å¯†ç ä¸ºpasswd</span><br><span class="line">mysqlé…ç½® æˆåŠŸ</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-12-05_17-16-50.png" alt="PixPin_2025-12-05_17-16-50"></p><h3 id="2-3-æµ‹è¯•"><a href="#2-3-æµ‹è¯•" class="headerlink" title="2.3.æµ‹è¯•"></a>2.3.æµ‹è¯•</h3><p><img src="https://b5dbf24.webp.li/PixPin_2025-12-05_17-17-42.png" alt="PixPin_2025-12-05_17-17-42"></p><p><img src="https://b5dbf24.webp.li/PixPin_2025-12-05_17-18-19.png" alt="PixPin_2025-12-05_17-18-19"></p><h1 id="25-12-13-SHELL"><a href="#25-12-13-SHELL" class="headerlink" title="25-12-13(SHELL)"></a>25-12-13(SHELL)</h1><h2 id="1-SHELLç†è®º"><a href="#1-SHELLç†è®º" class="headerlink" title="1.SHELLç†è®º"></a>1.SHELLç†è®º</h2><table><thead><tr><th>01 å…¥é—¨ï¼š</th><th align="center">02 å˜é‡ï¼š</th><th align="center">03 æ¡ä»¶æµ‹è¯•ï¼š</th><th align="center">04 æµç¨‹åˆ¤æ–­ï¼š</th><th align="center">05 å‡½æ•°ï¼š</th><th align="center">06 æ•°ç»„ï¼š</th><th align="center">07 grep:</th><th align="center">08 sed:</th><th align="center">09 awk:</th></tr></thead><tbody><tr><td><a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/10_1SHELL01-%E5%85%A5%E9%97%A8.md">è·³è½¬</a></td><td align="center"><a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/10_2SHELL02-%E5%8F%98%E9%87%8F.md">è·³è½¬</a></td><td align="center"><a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/10_3SHELL03-%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95%20.md">è·³è½¬</a></td><td align="center"><a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/10_4SHELL04-%E6%B5%81%E7%A8%8B%E5%88%A4%E6%96%AD.md">è·³è½¬</a></td><td align="center"><a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/10_5SHELL05-%E5%87%BD%E6%95%B0.md">è·³è½¬</a></td><td align="center"><a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/10_5SHELL05-%E6%95%B0%E7%BB%84.md">è·³è½¬</a></td><td align="center"><a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/10_6SHELL06-grep.md">è·³è½¬</a></td><td align="center"><a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/10_7SHELL07-sed.md">è·³è½¬</a></td><td align="center"><a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/10_8SHELL08-awk.md">è·³è½¬</a></td></tr></tbody></table><h2 id="2-SHELLå®éªŒ"><a href="#2-SHELLå®éªŒ" class="headerlink" title="2.SHELLå®éªŒ:"></a>2.SHELLå®éªŒ:</h2><h3 id="2-1-å®éªŒ1ï¼šæç¤ºç”¨æˆ·è¾“å…¥ç”¨æˆ·åç§°ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨ã€‚"><a href="#2-1-å®éªŒ1ï¼šæç¤ºç”¨æˆ·è¾“å…¥ç”¨æˆ·åç§°ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨ã€‚" class="headerlink" title="2.1.å®éªŒ1ï¼šæç¤ºç”¨æˆ·è¾“å…¥ç”¨æˆ·åç§°ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨ã€‚"></a>2.1.å®éªŒ1ï¼šæç¤ºç”¨æˆ·è¾“å…¥ç”¨æˆ·åç§°ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨ã€‚</h3><blockquote><p>é™„åŠ è¦æ±‚ï¼šæ— è®ºå­˜åœ¨ä¸å¦éƒ½åˆå§‹åŒ–ç”¨æˆ·å¯†ç ä¸ºredhatï¼Œå¦‚æœç”¨æˆ·ä¸å­˜åœ¨å°±åˆ›å»ºç”¨æˆ·ï¼Œç„¶ååˆå§‹åŒ–å¯†ç ä¸ºredhat</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@hym ~]# vim /check_user.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="function"><span class="title">passwd_init</span></span>() &#123;</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;æ­£åœ¨åˆå§‹åŒ–å¯†ç ...&quot;</span></span><br><span class="line">        passwd <span class="variable">$name</span> &lt;&lt;<span class="string">end &gt;/dev/null 2&gt;&amp;1</span></span><br><span class="line"><span class="string">        redhat</span></span><br><span class="line"><span class="string">        redhat</span></span><br><span class="line"><span class="string">end</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;åˆå§‹åŒ–æˆåŠŸï¼Œåˆå§‹å¯†ç ä¸ºredhat&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;è¯·è¾“å…¥ç”¨æˆ·åç§°ï¼š&quot;</span> name</span><br><span class="line"><span class="built_in">id</span> <span class="variable">$name</span> &gt;/dev/null 2&gt;&amp;1</span><br><span class="line"><span class="keyword">if</span> [ $? -eq 0 ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$name</span> å·²å­˜åœ¨&quot;</span></span><br><span class="line">        passwd_init</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;æ­£åœ¨åˆ›å»ºç”¨æˆ·<span class="variable">$name</span>&quot;</span></span><br><span class="line">        useradd <span class="variable">$name</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;ç”¨æˆ·<span class="variable">$name</span>åˆ›å»ºæˆåŠŸ.&quot;</span></span><br><span class="line">        passwd_init</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2026-01-13_23-06-17.png" alt="PixPin_2026-01-13_23-06-17"></p><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p><img src="https://b5dbf24.webp.li/PixPin_2026-01-13_23-10-39.png" alt="PixPin_2026-01-13_23-10-39"></p><h3 id="2-1-å®éªŒ2ï¼šåˆ›å»ºä¸€ä¸ªç®€å•çš„ç³»ç»Ÿä¿¡æ¯æŠ¥å‘Šè„šæœ¬ï¼Œè¾“å‡ºåŸºæœ¬çš„ç³»ç»ŸçŠ¶æ€ä¿¡æ¯"><a href="#2-1-å®éªŒ2ï¼šåˆ›å»ºä¸€ä¸ªç®€å•çš„ç³»ç»Ÿä¿¡æ¯æŠ¥å‘Šè„šæœ¬ï¼Œè¾“å‡ºåŸºæœ¬çš„ç³»ç»ŸçŠ¶æ€ä¿¡æ¯" class="headerlink" title="2.1 å®éªŒ2ï¼šåˆ›å»ºä¸€ä¸ªç®€å•çš„ç³»ç»Ÿä¿¡æ¯æŠ¥å‘Šè„šæœ¬ï¼Œè¾“å‡ºåŸºæœ¬çš„ç³»ç»ŸçŠ¶æ€ä¿¡æ¯"></a>2.1 å®éªŒ2ï¼šåˆ›å»ºä¸€ä¸ªç®€å•çš„ç³»ç»Ÿä¿¡æ¯æŠ¥å‘Šè„šæœ¬ï¼Œè¾“å‡ºåŸºæœ¬çš„ç³»ç»ŸçŠ¶æ€ä¿¡æ¯</h3><blockquote><p>é™„åŠ ï¼šå½“å‰ç™»å½•ç”¨æˆ·åç§°ã€æŠ¥å‘Šç”Ÿæˆæ—¶é—´ã€ç£ç›˜ä½¿ç”¨æƒ…å†µã€å†…å­˜ä½¿ç”¨æƒ…å†µ</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@hym shell]# vim sys.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è¾“å‡ºæŠ¥å‘Š</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;====ç³»ç»ŸåŸºæœ¬ä¿¡æ¯====&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å½“å‰ç”¨æˆ·:&quot;</span></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;----ç£ç›˜ä½¿ç”¨æƒ…å†µ----&quot;</span></span><br><span class="line"><span class="built_in">df</span> -h</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;----å†…å­˜ä½¿ç”¨æƒ…å†µ----&quot;</span></span><br><span class="line">free -h</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ç”Ÿæˆæ—¶é—´:&quot;</span></span><br><span class="line"><span class="built_in">date</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;====æŠ¥å‘Šç»“æŸ====&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2026-01-14_20-52-19.png" alt="PixPin_2026-01-14_20-52-19"></p><h3 id="2-2-å®éªŒ3ï¼šæ£€æŸ¥æ–‡ä»¶"><a href="#2-2-å®éªŒ3ï¼šæ£€æŸ¥æ–‡ä»¶" class="headerlink" title="2.2 å®éªŒ3ï¼šæ£€æŸ¥æ–‡ä»¶"></a>2.2 å®éªŒ3ï¼šæ£€æŸ¥æ–‡ä»¶</h3><blockquote><p>æ£€æŸ¥æ–‡ä»¶ <code>/etc/passwd</code>æ˜¯å¦å­˜åœ¨ <strong>å¹¶ä¸”</strong> å¯è¯»ï¼Œå¦‚æœä¸¤ä¸ªæ¡ä»¶éƒ½æ»¡è¶³ï¼Œåˆ™è¾“å‡ºâ€æ–‡ä»¶å­˜åœ¨ä¸”å¯è¯»â€ï¼Œå¦åˆ™è¾“å‡ºç›¸åº”é”™è¯¯ä¿¡æ¯ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@hym shell]# vim check.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">file=<span class="string">&quot;/etc/passw&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -e <span class="string">&quot;<span class="variable">$file</span>&quot;</span> ] &amp;&amp; [ -r <span class="string">&quot;<span class="variable">$file</span>&quot;</span> ] ; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$file</span> å­˜åœ¨ä¸”å¯è¯»&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">        [ -e <span class="string">&quot;<span class="variable">$file</span>&quot;</span> ] || <span class="string">&quot;<span class="variable">$file</span> ä¸å­˜åœ¨&quot;</span></span><br><span class="line"></span><br><span class="line">        [ -r <span class="string">&quot;<span class="variable">$file</span>&quot;</span> ] || <span class="string">&quot;<span class="variable">$file</span> ä¸å¯è¯»&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•</span></span><br><span class="line">[root@hym shell]# bash check.sh</span><br><span class="line">/etc/passwd å­˜åœ¨ä¸”å¯è¯»</span><br><span class="line"></span><br><span class="line">[root@hym shell]# bash check.sh</span><br><span class="line">check.sh:è¡Œ4: /etc/passw ä¸å­˜åœ¨: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•</span><br><span class="line">check.sh:è¡Œ5: /etc/passw ä¸å¯è¯»: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•</span><br></pre></td></tr></table></figure><h1 id="25-12-20-Ansible"><a href="#25-12-20-Ansible" class="headerlink" title="25-12-20(Ansible)"></a>25-12-20(Ansible)</h1><h2 id="1-Ansibleç†è®º"><a href="#1-Ansibleç†è®º" class="headerlink" title="1.Ansibleç†è®º"></a>1.Ansibleç†è®º</h2><p><strong>ç†è®ºéƒ¨åˆ†å‚è€ƒ</strong>  <a href="https://gitee.com/kaitumei/note/blob/master/Liunx/02RHCE/11ansiblemd%E7%90%86%E8%AE%BA.md">è·³è½¬</a></p><h2 id="2-Ansibleå®éªŒ"><a href="#2-Ansibleå®éªŒ" class="headerlink" title="2.Ansibleå®éªŒ:"></a>2.Ansibleå®éªŒ:</h2><h3 id="2-1-ç”¨ansibleå‘½ä»¤è¡Œå®ç°nginxéƒ¨ç½²ä¿®æ”¹ç«¯å£å·"><a href="#2-1-ç”¨ansibleå‘½ä»¤è¡Œå®ç°nginxéƒ¨ç½²ä¿®æ”¹ç«¯å£å·" class="headerlink" title="2.1.ç”¨ansibleå‘½ä»¤è¡Œå®ç°nginxéƒ¨ç½²ä¿®æ”¹ç«¯å£å·"></a>2.1.ç”¨ansibleå‘½ä»¤è¡Œå®ç°nginxéƒ¨ç½²ä¿®æ”¹ç«¯å£å·</h3><h5 id="2-1-1-å»ºç«‹è¿æ¥"><a href="#2-1-1-å»ºç«‹è¿æ¥" class="headerlink" title="2.1.1.å»ºç«‹è¿æ¥"></a>2.1.1.å»ºç«‹è¿æ¥</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@client ~]vim /hosts</span><br><span class="line">    [server]</span><br><span class="line">    192.168.232.134</span><br><span class="line">[root@client ~]vim /auth.yml    </span><br><span class="line">---</span><br><span class="line">- hosts: server          <span class="comment"># ç›®æ ‡ä¸»æœºç»„ï¼ˆå¯¹åº”ä½ æ¸…å•é‡Œçš„[newserver]ï¼‰</span></span><br><span class="line">  gather_facts: no          <span class="comment"># å…³é—­äº‹å®æ”¶é›†ï¼ˆé¦–æ¬¡æ¨é€å…¬é’¥æ—¶ï¼Œå—æ§èŠ‚ç‚¹å¯èƒ½æœªé…ç½®Pythonä¾èµ–ï¼‰</span></span><br><span class="line">  vars:</span><br><span class="line">    ansible_ssh_pass: <span class="string">&quot;passwd&quot;</span></span><br><span class="line">    ansible_host_key_checking: False</span><br><span class="line">  tasks:</span><br><span class="line">    - name: ç»™rootç”¨æˆ·æ·»åŠ SSHå…¬é’¥ï¼ˆAnsibleç®¡ç†ï¼‰</span><br><span class="line">      authorized_key:</span><br><span class="line">        user: root                    <span class="comment"># æŒ‡å®šç›®æ ‡ç”¨æˆ·ï¼ˆå¿…å¡«ï¼‰</span></span><br><span class="line">        state: present                <span class="comment"># ç¡®ä¿å…¬é’¥å­˜åœ¨ï¼ˆæ·»åŠ ï¼‰</span></span><br><span class="line">        key: <span class="string">&quot;&#123;&#123; lookup(&#x27;file&#x27;, &#x27;/root/.ssh/id_rsa.pub&#x27;) &#125;&#125;&quot;</span>  <span class="comment"># è¯»å–æœ¬åœ°å…¬é’¥</span></span><br><span class="line">[root@client ~]# ansible-playbook -i /hosts /auth.yml</span><br><span class="line"></span><br><span class="line">PLAY [server] ******************************************************************</span><br><span class="line"></span><br><span class="line">TASK [ç»™rootç”¨æˆ·æ·»åŠ SSHå…¬é’¥ï¼ˆAnsibleç®¡ç†ï¼‰] ************************************</span><br><span class="line">changed: [192.168.232.134]</span><br><span class="line"></span><br><span class="line">PLAY RECAP *********************************************************************</span><br><span class="line">192.168.232.134            : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0 </span><br></pre></td></tr></table></figure><h5 id="2-1-2-åˆ›å»ºç›®å½•"><a href="#2-1-2-åˆ›å»ºç›®å½•" class="headerlink" title="2.1.2.åˆ›å»ºç›®å½•"></a>2.1.2.åˆ›å»ºç›®å½•</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@client ~]# vim file.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">mkdir</span> /ansible</span><br><span class="line"></span><br><span class="line"><span class="built_in">mkdir</span> -p /ansible/roles/warehouse/&#123;vars,tasks&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">mkdir</span> -p /ansible/roles/safety/&#123;vars,tasks&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">mkdir</span> -p /ansible/roles/web/&#123;vars,tasks&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">touch</span> /ansible/site.yml</span><br></pre></td></tr></table></figure><p><img src="https://b5dbf24.webp.li/PixPin_2025-12-20_19-31-39.png" alt="PixPin_2025-12-20_19-31-39"></p><h5 id="2-1-3-ç¼–å†™ç›¸å…³é…ç½®"><a href="#2-1-3-ç¼–å†™ç›¸å…³é…ç½®" class="headerlink" title="2.1.3.ç¼–å†™ç›¸å…³é…ç½®"></a>2.1.3.ç¼–å†™ç›¸å…³é…ç½®</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">root@client</span> <span class="string">~</span>]<span class="comment"># cat /ansible/site.yml </span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="number">192.168</span><span class="number">.232</span><span class="number">.134</span></span><br><span class="line">  <span class="attr">gather_facts:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">become:</span> <span class="literal">yes</span></span><br><span class="line">  <span class="attr">roles:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">warehouse</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">safety</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">web</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">root@client</span> <span class="string">~</span>]<span class="comment"># vim /ansible/roles/warehouse/tasks/main.yml</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">æŒ‚è½½</span></span><br><span class="line">  <span class="attr">mount:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">/mnt</span></span><br><span class="line">    <span class="attr">src:</span> <span class="string">/dev/sr0</span></span><br><span class="line">    <span class="attr">state:</span> <span class="string">mounted</span></span><br><span class="line">    <span class="attr">fstype:</span> <span class="string">iso9660</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">é…ç½®ä»“åº“æº1</span></span><br><span class="line">  <span class="attr">yum_repository:</span></span><br><span class="line">    <span class="attr">file:</span> <span class="string">cangku</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">base</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">base</span></span><br><span class="line">    <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">yes</span></span><br><span class="line">    <span class="attr">gpgcheck:</span> <span class="literal">no</span></span><br><span class="line">    <span class="attr">baseurl:</span> <span class="string">/mnt/BaseOS</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">é…ç½®ä»“åº“æº2</span></span><br><span class="line">  <span class="attr">yum_repository:</span></span><br><span class="line">    <span class="attr">file:</span> <span class="string">cangku</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">app</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">app</span></span><br><span class="line">    <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">yes</span></span><br><span class="line">    <span class="attr">gpgcheck:</span> <span class="literal">no</span></span><br><span class="line">    <span class="attr">baseurl:</span> <span class="string">/mnt/AppStream</span></span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">root@client</span> <span class="string">~</span>]<span class="comment"># vim /ansible/roles/safety/tasks/main.yml</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">SELinxè®¾ç½®å®½å®¹æ¨¡å¼</span></span><br><span class="line">  <span class="attr">ansible.builtin.selinux:</span></span><br><span class="line">    <span class="attr">policy:</span> <span class="string">targeted</span></span><br><span class="line">    <span class="attr">state:</span> <span class="string">permissive</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">æ”¾è¡Œ89ç«¯å£</span></span><br><span class="line">  <span class="attr">ansible.builtin.firewalld:</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">89</span><span class="string">/tcp</span></span><br><span class="line">    <span class="attr">permanent:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">immediate:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">state:</span> <span class="string">enabled</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">root@client</span> <span class="string">~</span>]<span class="comment"># vim /ansible/roles/web/tasks/main.yml</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">å®‰è£…nginx</span></span><br><span class="line">  <span class="attr">yum:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">å¯åŠ¨nginx</span></span><br><span class="line">  <span class="attr">service:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ä¿®æ”¹ç«¯å£å·</span></span><br><span class="line">  <span class="attr">lineinfile:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">/etc/nginx/nginx.conf</span></span><br><span class="line">    <span class="attr">regexp:</span> <span class="string">&#x27;^(\s*)listen\s.*;&#x27;</span></span><br><span class="line">    <span class="attr">line:</span> <span class="string">&#x27;\1listen 89;&#x27;</span></span><br><span class="line">    <span class="attr">backup:</span> <span class="literal">yes</span></span><br><span class="line">    <span class="attr">backrefs:</span> <span class="literal">yes</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">é‡å¯é…ç½®</span></span><br><span class="line">  <span class="attr">systemd:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">state:</span> <span class="string">restarted</span></span><br></pre></td></tr></table></figure><h5 id="2-1-4-æµ‹è¯•"><a href="#2-1-4-æµ‹è¯•" class="headerlink" title="2.1.4.æµ‹è¯•"></a>2.1.4.æµ‹è¯•</h5><p><img src="https://b5dbf24.webp.li/image-20251220194237778.png" alt="image-20251220194237778"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> RHCE </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
